<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Practice Exercises</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part176.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part178.htm">下一个 &gt;</a></p><p class="s45" style="padding-top: 4pt;padding-left: 68pt;text-indent: 0pt;text-align: left;">Practice Exercises</p><p style="padding-top: 12pt;padding-left: 150pt;text-indent: -24pt;text-align: justify;"><b>8.1  </b>Provide information about the student named Shankar in our sample univer- sity database, including information from the <i>student </i>tuple corresponding to Shankar, the <i>takes </i>tuples corresponding to Shankar and the <i>course </i>tuples cor- responding to these <i>takes </i>tuples, in each of the following representations:</p><p style="padding-top: 7pt;padding-left: 157pt;text-indent: 0pt;text-align: left;">a. Using <span class="s44">JSON</span>, with an appropriate nested representation.</p><p style="padding-top: 6pt;padding-left: 157pt;text-indent: 0pt;text-align: left;">b. Using <span class="s44">XML</span>, with the same nested representation.</p><p style="padding-top: 6pt;padding-left: 157pt;text-indent: 0pt;text-align: left;">c. Using <span class="s44">RDF </span>triples.</p><p style="padding-top: 6pt;padding-left: 157pt;text-indent: 0pt;text-align: left;">d. As an <span class="s44">RDF </span>graph.</p><p style="padding-top: 7pt;padding-left: 150pt;text-indent: -25pt;text-align: justify;"><b>8.2  </b>Consider the <span class="s44">RDF </span>representation of information from the university schema as shown in Figure 8.3. Write the following queries in <span class="s44">SPARQL</span>.</p><p style="padding-top: 7pt;padding-left: 157pt;text-indent: 0pt;text-align: justify;">a.  Find the titles of all courses taken by any student named Zhang.</p><p style="padding-top: 6pt;padding-left: 176pt;text-indent: -19pt;text-align: justify;">b.  Find titles of all courses such that a student named Zhang takes a section of the course that is taught by an instructor named Srinivasan.</p><p style="padding-top: 6pt;padding-left: 176pt;text-indent: -18pt;text-align: justify;">c.  Find the attribute names and values of all attributes of the instruc- tor named Srinivasan, without enumerating the attribute names in your query.</p><p class="s46" style="padding-top: 7pt;padding-left: 150pt;text-indent: -25pt;text-align: justify;">8.3  <span class="p">A car-rental company maintains a database for all vehicles in its current ﬂeet. For all vehicles, it includes the vehicle identiﬁcation number, license number, manufacturer, model, date of purchase, and color. Special data are included for certain types of vehicles:</span></p><p class="s39" style="padding-top: 5pt;padding-left: 154pt;text-indent: 0pt;text-align: left;">• <span class="s40">Trucks: cargo capacity.</span></p><p class="s39" style="padding-top: 3pt;padding-left: 154pt;text-indent: 0pt;text-align: left;">• <span class="s40">Sports cars: horsepower, renter age requirement.</span></p><p class="s39" style="padding-top: 3pt;padding-left: 154pt;text-indent: 0pt;text-align: left;">• <span class="s40">Vans: number of passengers.</span></p><p class="s39" style="padding-top: 3pt;padding-left: 154pt;text-indent: 0pt;text-align: left;">• <span class="s40">Oﬀ-road vehicles: ground clearance, drivetrain (four- or two-wheel drive).</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s259" style="padding-top: 2pt;padding-left: 9pt;text-indent: 0pt;text-align: left;">ID</p><p class="s192" style="padding-left: 9pt;text-indent: 0pt;text-align: left;">name</p><p class="s192" style="padding-left: 22pt;text-indent: 0pt;text-align: left;">first_name middle_inital last_name</p><p class="s192" style="text-indent: 0pt;text-align: right;">address</p><p class="s192" style="text-indent: 0pt;text-align: right;">street</p><p class="s192" style="padding-left: 35pt;text-indent: 0pt;text-align: left;">street_number street_name apt_number</p><p class="s192" style="padding-left: 22pt;text-indent: 0pt;text-align: left;">city state zip</p><p class="s260" style="padding-left: 9pt;text-indent: 0pt;text-align: left;">{<span class="s192">phone_number</span>} <span class="s192">date_of_birth age </span>( )</p><p style="text-indent: 0pt;text-align: left;"/><p class="s261" style="padding-top: 4pt;padding-left: 30pt;text-indent: 0pt;text-align: left;">instructor</p><p style="text-indent: 0pt;text-align: left;"/><p class="s73" style="padding-top: 4pt;padding-left: 59pt;text-indent: 0pt;text-align: center;">Figure 8.7 <span class="s151">E-R </span><span class="s152">diagram with composite, multivalued, and derived attributes.</span></p><p style="padding-top: 10pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">Construct an <span class="s44">SQL </span>schema deﬁnition for this database. Use inheritance where appropriate.</p><p style="padding-top: 6pt;padding-left: 119pt;text-indent: -25pt;text-align: justify;"><b>8.4  </b>Consider a database schema with a relation <i>Emp </i>whose attributes are as shown below, with types speciﬁed for multivalued attributes.</p><p class="s13" style="padding-top: 8pt;padding-left: 138pt;text-indent: 0pt;text-align: left;">Emp = (ename, ChildrenSet <b>multiset</b>(Children), SkillSet <b>multiset</b>(Skills)) Children = (name, birthday)</p><p class="s13" style="padding-left: 138pt;text-indent: 0pt;text-align: left;">Skills = (type, ExamSet <b>setof</b>(Exams)) Exams = (year, city)</p><p style="padding-top: 8pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">Deﬁne the above schema in <span class="s44">SQL</span>, using the <span class="s44">SQL S</span>erver table type syntax from Section 8.2.1.1 to declare multiset attributes.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_2182.png"/></span></p><p style="padding-top: 6pt;padding-left: 119pt;text-indent: -25pt;text-align: justify;"><b>8.5  </b>Consider the <span class="s44">E-R </span>diagram in Figure 8.7 showing entity set <i>instructor</i>. Give an <span class="s44">SQL </span>schema deﬁnition corresponding to the <span class="s44">E-R </span>diagram, treating <i>phone number </i>as an array of 10 elements, using Oracle or <span class="s44">P</span>ostgre<span class="s44">SQL </span>syntax.</p><p class="s46" style="padding-top: 6pt;padding-left: 93pt;text-indent: 0pt;text-align: justify;">8.6  <span class="p">Consider the relational schema shown in Figure 8.8.</span></p><p style="padding-top: 6pt;padding-left: 145pt;text-indent: -18pt;text-align: left;">a. Give a schema deﬁnition in <span class="s44">SQL </span>corresponding to the relational schema but using references to express foreign-key relationships.</p><p style="padding-top: 6pt;padding-left: 125pt;text-indent: 0pt;text-align: left;">b.  Write each of the following queries on the schema, using <span class="s44">SQL</span>.</p><p style="padding-top: 2pt;padding-left: 144pt;text-indent: 0pt;text-align: left;">i. Find the company with the most employees.</p><p class="s64" style="padding-top: 3pt;padding-left: 119pt;text-indent: 0pt;text-align: right;">Exercises  <span class="s164">399</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="494" height="1" alt="image" src="Image_2183.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_2184.png"/></span></p><p class="s13" style="padding-top: 4pt;padding-bottom: 1pt;padding-left: 213pt;text-indent: 0pt;text-align: left;">employee <span class="p">(</span>person name<span class="p">, </span>street<span class="p">, </span>city<span class="p">)</span></p><p style="padding-left: 258pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="71" height="1" alt="image" src="Image_2185.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_2186.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="72" height="1" alt="image" src="Image_2187.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_2188.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_2189.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="85" height="1" alt="image" src="Image_2190.png"/></span></p><p class="s13" style="padding-left: 213pt;text-indent: 0pt;line-height: 113%;text-align: left;">works <span class="p">(</span>person name<span class="p">, </span>company name<span class="p">, </span>salary<span class="p">) </span>company <span class="p">(</span>company name<span class="p">, </span>city<span class="p">)</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_2191.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_2192.png"/></span></p><p class="s13" style="padding-bottom: 1pt;padding-left: 213pt;text-indent: 0pt;text-align: left;">manages <span class="p">(</span>person name<span class="p">, </span>manager name<span class="p">)</span></p><p style="padding-left: 257pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="71" height="1" alt="image" src="Image_2193.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="494" height="1" alt="image" src="Image_2194.png"/></span></p><p class="s73" style="padding-top: 8pt;padding-left: 199pt;text-indent: 0pt;text-align: left;">Figure 8.8 <span class="s74">Relational database for Exercise 8.6.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 173pt;text-indent: 0pt;text-align: left;">ii. Find the company with the smallest payroll.</p><p style="padding-top: 3pt;padding-left: 192pt;text-indent: -22pt;text-align: left;">iii.  Find those companies whose employees earn a higher salary, on aver- age, than the average salary at First Bank Corporation.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part176.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part178.htm">下一个 &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
