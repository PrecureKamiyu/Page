<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>21.5  Parallel Indexing</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part387.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part389.htm">下一个 &gt;</a></p><p class="s65" style="padding-left: 72pt;text-indent: 0pt;text-align: left;">21.5  <span style=" color: #00AEEF;">Parallel Indexing</span></p><p style="padding-top: 12pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">Indices in a parallel data storage system can be divided into two kinds: local and global indices. In the following discussion, when virtual node partitioning is used, the term <i>node </i>should be understood to mean virtual node (or equivalently, tablet).</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s39" style="padding-left: 139pt;text-indent: -16pt;text-align: justify;">• <span class="s40">A </span><span class="s46">local index </span><span class="p">is an index built on tuples stored in a particular node; typically, such an index would be built on all the partitions of a given relation. The index contents are stored on the same node as the data.</span></p><p class="s39" style="padding-top: 3pt;padding-left: 139pt;text-indent: -16pt;text-align: justify;">• <span class="s40">A </span><span class="s46">global index </span><span class="p">is an index built on data stored across multiple nodes; a global index can be used to eﬃciently ﬁnd matching tuples, regardless of where the tuples are stored.</span></p><p style="padding-left: 139pt;text-indent: 14pt;text-align: justify;">While the contents of a global index could be stored at a single central location, such a scheme would result in poor scalability; as a result, the contents of a global index should partitioned across multiple nodes.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">A <span class="s63">global primary index </span>on a relation is a global index on the attributes on which the tuples of the relation are partitioned. A global index on partitioning attribute <i>K </i>is constructed by merely creating local indices on <i>K </i>on each partition.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">A query that is intended to retrieve tuples with a speciﬁc key value <i>k</i>1 for <i>K </i>can be answered by ﬁrst ﬁnding which partition could hold the key value <i>k</i>1, and then using the local index in that partition to ﬁnd the required tuples.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">For example, suppose the <i>student </i>relation is partitioned on the attribute <span class="s44">ID</span>, and a global index is to be constructed on the attribute <span class="s44">ID</span>. All that is required is to construct a local index on <span class="s44">ID </span>on each partition. Figure 21.6(a) shows a global primary index on the <i>student </i>relation, on attribute <span class="s44">ID</span>; the local indices are not shown explicitly in the ﬁgure.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">A query that is intended to retrieve tuples with a speciﬁc value for <span class="s44">ID</span>, say 557, can be answered by ﬁrst using the partitioning function on <span class="s44">ID </span>to ﬁrst ﬁnd which partition could contain the speciﬁed <span class="s44">ID </span>value 557; the query is then sent to the corresponding node, which uses the local index on <span class="s44">ID </span>to locate the required tuples.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">Note that <span class="s44">ID </span>is the primary key for the relation <i>student</i>; however, the above scheme would work even if the partitioning attribute were not the primary key. The scheme can be extended to handle range queries, provided the partitioning function is itself based on ranges of values; a partitioning scheme based on hashing cannot support range queries.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">A <span class="s63">global secondary index </span>on a relation is a global index whose index attributes do not match the attributes on which the tuples are partitioned.</p><p class="s13" style="padding-top: 1pt;padding-left: 119pt;text-indent: 17pt;line-height: 82%;text-align: justify;"><span class="p">Suppose the partitioning attributes are </span>K<span class="s97">p</span><span class="p">, while the index attributes are </span>K<span class="s97">i</span><span class="p">, with </span>K<span class="s97">p </span><span class="s86">≠ </span>K<span class="s97">i</span><span class="p">. One approach for answering a selection query on attributes </span>K<span class="s97">i </span><span class="p">is as follows: If a local index is created on </span>K<span class="s97">i </span><span class="p">on each partition of the relation, the query is sent to each</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s470" style="padding-left: 119pt;text-indent: 0pt;text-align: right;">Partition Table</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s470" style="padding-left: 119pt;text-indent: 0pt;text-align: right;">231</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s470" style="padding-left: 119pt;text-indent: 0pt;text-align: right;">543</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s470" style="padding-top: 3pt;padding-left: 119pt;text-indent: 0pt;text-align: right;">765</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s470" style="padding-top: 4pt;padding-bottom: 1pt;padding-left: 30pt;text-indent: 0pt;text-align: left;">Tablet 1</p><table style="border-collapse:collapse;margin-left:30.8665pt" cellspacing="0"><tr style="height:9pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 2pt;padding-right: 4pt;text-indent: 0pt;line-height: 7pt;text-align: center;">001</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Zhang</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 3pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Comp. Sci.</p></td><td style="width:19pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-right: 2pt;text-indent: 0pt;line-height: 7pt;text-align: right;">102</p></td></tr><tr style="height:9pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 2pt;padding-right: 4pt;text-indent: 0pt;line-height: 7pt;text-align: center;">123</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Shankar</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 3pt;text-indent: 0pt;line-height: 8pt;text-align: left;">Comp. Sci.</p></td><td style="width:19pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-right: 2pt;text-indent: 0pt;line-height: 7pt;text-align: right;">32</p></td></tr><tr style="height:9pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 2pt;padding-right: 4pt;text-indent: 0pt;line-height: 7pt;text-align: center;">199</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Brandt</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 3pt;text-indent: 0pt;line-height: 7pt;text-align: left;">History</p></td><td style="width:19pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-right: 2pt;text-indent: 0pt;line-height: 7pt;text-align: right;">80</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="79" height="190" alt="image" src="Image_3151.png"/></span></p><p class="s470" style="padding-top: 4pt;padding-bottom: 1pt;padding-left: 31pt;text-indent: 0pt;text-align: left;">Tablet 2</p><table style="border-collapse:collapse;margin-left:31.1475pt" cellspacing="0"><tr style="height:9pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 8pt;text-align: left;">231</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 8pt;text-align: left;">Chavez</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 3pt;text-indent: 0pt;line-height: 8pt;text-align: left;">Finance</p></td><td style="width:19pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-right: 2pt;text-indent: 0pt;line-height: 8pt;text-align: right;">110</p></td></tr><tr style="height:9pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">445</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Peltier</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 3pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Physics</p></td><td style="width:19pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-right: 2pt;text-indent: 0pt;line-height: 7pt;text-align: right;">56</p></td></tr><tr style="height:9pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">456</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Levy</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 3pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Physics</p></td><td style="width:19pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-right: 2pt;text-indent: 0pt;line-height: 7pt;text-align: right;">46</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s470" style="padding-top: 3pt;padding-bottom: 1pt;padding-left: 31pt;text-indent: 0pt;text-align: left;">Tablet 3</p><table style="border-collapse:collapse;margin-left:31.1475pt" cellspacing="0"><tr style="height:9pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">543</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Williams</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Comp. Sci.</p></td><td style="width:19pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-right: 2pt;text-indent: 0pt;line-height: 7pt;text-align: right;">54</p></td></tr><tr style="height:9pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">557</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Sanchez</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Music</p></td><td style="width:19pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-right: 2pt;text-indent: 0pt;line-height: 7pt;text-align: right;">38</p></td></tr><tr style="height:9pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">705</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Snow</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Physics</p></td><td style="width:19pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-right: 2pt;text-indent: 0pt;line-height: 7pt;text-align: right;">0</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s470" style="padding-top: 3pt;padding-bottom: 1pt;padding-left: 31pt;text-indent: 0pt;text-align: left;">Tablet 4</p><table style="border-collapse:collapse;margin-left:30.6735pt" cellspacing="0"><tr style="height:9pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 3pt;padding-right: 4pt;text-indent: 0pt;line-height: 7pt;text-align: center;">765</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Brown</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Comp. Sci.</p></td><td style="width:19pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-right: 2pt;text-indent: 0pt;line-height: 7pt;text-align: right;">58</p></td></tr><tr style="height:9pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 3pt;padding-right: 4pt;text-indent: 0pt;text-align: center;">766</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">Aoi</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">Elec. Eng.</p></td><td style="width:19pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-right: 3pt;text-indent: 0pt;text-align: right;">6</p></td></tr><tr style="height:8pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 3pt;padding-right: 4pt;text-indent: 0pt;line-height: 7pt;text-align: center;">987</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Bourakis</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Elec. Eng.</p></td><td style="width:19pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-right: 2pt;text-indent: 0pt;line-height: 7pt;text-align: right;">98</p></td></tr><tr style="height:9pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 3pt;padding-right: 4pt;text-indent: 0pt;line-height: 7pt;text-align: center;">989</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Tanaka</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Biology</p></td><td style="width:19pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-right: 2pt;text-indent: 0pt;line-height: 7pt;text-align: right;">120</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s470" style="padding-left: 50pt;text-indent: 0pt;text-align: left;">(a) Primary index on ID</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s470" style="padding-top: 4pt;padding-bottom: 1pt;padding-left: 33pt;text-indent: 0pt;text-align: left;">Tablet 6</p><table style="border-collapse:collapse;margin-left:33.156pt" cellspacing="0"><tr style="height:9pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">766</p></td><td style="width:41pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Aoi</p></td></tr><tr style="height:9pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">987</p></td><td style="width:41pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 3pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Bourakis</p></td></tr><tr style="height:9pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">199</p></td><td style="width:41pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 3pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Brandt</p></td></tr><tr style="height:9pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">765</p></td><td style="width:41pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 3pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Brown</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:32.376pt" cellspacing="0"><tr style="height:9pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">123</p></td><td style="width:41pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Shankar</p></td></tr><tr style="height:9pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">705</p></td><td style="width:41pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Snow</p></td></tr><tr style="height:9pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">989</p></td><td style="width:41pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Tanaka</p></td></tr><tr style="height:10pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">543</p></td><td style="width:41pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Williams</p></td></tr><tr style="height:9pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">001</p></td><td style="width:41pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s471" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Zhang</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="184" height="184" alt="image" src="Image_3152.png"/></span></p><p class="s470" style="text-indent: 0pt;line-height: 7pt;text-align: left;">Partition Table</p><p style="text-indent: 0pt;text-align: left;"/><p class="s470" style="text-indent: 0pt;line-height: 7pt;text-align: left;">Tablet 7</p><p style="text-indent: 0pt;text-align: left;"/><p class="s470" style="text-indent: 0pt;line-height: 7pt;text-align: left;">Tablet 8</p><p style="text-indent: 0pt;text-align: left;"/><p class="s470" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">Sanchez</p><p style="text-indent: 0pt;text-align: left;"/><p class="s470" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">557</p><p style="text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s470" style="padding-left: 2pt;text-indent: 0pt;text-align: left;">Shankar</p><p style="text-indent: 0pt;text-align: left;"/><p class="s470" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">Peltier</p><p style="text-indent: 0pt;text-align: left;"/><p class="s470" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">445</p><p style="text-indent: 0pt;text-align: left;"/><p class="s470" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">Levy</p><p style="text-indent: 0pt;text-align: left;"/><p class="s470" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">456</p><p style="text-indent: 0pt;text-align: left;"/><p class="s470" style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Chavez</p><p style="text-indent: 0pt;text-align: left;"/><p class="s470" style="padding-left: 3pt;text-indent: 0pt;line-height: 7pt;text-align: left;">231</p><p style="text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s470" style="padding-left: 2pt;text-indent: 0pt;text-align: left;">Chavez</p><p style="text-indent: 0pt;text-align: left;"/><p class="s470" style="padding-left: 27pt;text-indent: 0pt;text-align: left;">(b) Secondary index on name</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s74" style="padding-top: 4pt;padding-left: 59pt;text-indent: 0pt;text-align: center;"><span class="s73">Figure 21.6 </span>Global primary and secondary indices on <i>student </i>relation</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 88pt;text-indent: 0pt;text-align: justify;">partition, and the local index is used to ﬁnd matching tuples. Such an approach using local indices is very ineﬃcient if the number of partitions is large, since every partition has to be queried, even if only one or a few partitions contain matching tuples.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_3153.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_3154.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_3155.png"/></span></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">We now illustrate an eﬃcient scheme for constructing a global secondary index by using an example. Consider again the <i>student </i>relation partitioned on the attribute <span class="s44">ID</span>, and suppose a global index is to be constructed on the attribute <i>name</i>. A simple way to construct such an index is to create a set of (<i>name</i>, <span class="s44">ID</span>) tuples, with one tuple per <i>student </i>tuple; let us call this set of tuples <i>index name</i>. Now, the <i>index name </i>tuples are partitioned on the attribute <i>name</i>. A local index on <i>name </i>is then constructed on each partition of <i>index name</i>. In addition, a global index is created on the <span class="s44">ID</span>, which is the partitioning attribute. Figure 21.6(b) shows a secondary index on the <i>student </i>relation on attribute <i>name</i>; local indices are not explicitly shown in the ﬁgure.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_3156.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_3157.png"/></span></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">Now, a query that needs to retrieve students with a given name can be handled by ﬁrst examining the partition function of <i>index name </i>to ﬁnd which partition could store <i>index name </i>tuples with the given name; the query is then sent to that partition, which uses the local index on <i>name </i>to ﬁnd the corresponding <span class="s44">ID </span>value. Next, the global index on the <span class="s44">ID </span>value is used to ﬁnd the required tuple.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_3158.png"/></span></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">Note that in the example above, the partitioning attribute <span class="s44">ID </span>does not have du- plicates; hence it suﬃces to add only the index key <i>name </i>and the attribute <span class="s44">ID </span>to the <i>index name </i>relation. Otherwise, further attributes would have to be added to ensure tuples can be uniquely identiﬁed, as described next.</p><p class="s109" style="text-indent: 0pt;line-height: 8pt;text-align: left;">i</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-top: 1pt;padding-left: 88pt;text-indent: 17pt;line-height: 88%;text-align: justify;">In general, given a relation <i>r</i>, which is partitioned on a set of attributes <i>K</i><span class="s145">p</span>, if we wish to create a global secondary index on a set of attributes <i>K</i><span class="s97">i</span>, we create a new relation <i>r</i><i>s</i>, containing the following attributes:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="padding-top: 4pt;padding-left: 128pt;text-indent: 0pt;text-align: left;"><a name="bookmark466"><span class="s63">1. </span></a>K<span class="s145">i</span><span class="p">, and </span>K<span class="s145">p</span><a name="bookmark512">&zwnj;</a></p><p class="s13" style="padding-top: 5pt;padding-left: 145pt;text-indent: -17pt;line-height: 86%;text-align: left;"><span class="s63">2. </span><span class="p">If the partitioning attributes </span>K<span class="s97">p </span><span class="p">have duplicates, we would have to add further attributes </span>K<span class="s97">u</span><span class="p">, such that </span>K<span class="s97">p </span><span class="s15">∪ </span>K<span class="s97">u </span><span class="p">is a key for the relation being indexed.</span></p><p class="s109" style="text-indent: 0pt;line-height: 8pt;text-align: left;">i</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-top: 13pt;padding-left: 119pt;text-indent: 0pt;line-height: 87%;text-align: left;"><span class="p">The relation </span>r<span class="s238">s</span> <span class="p">is partitioned on </span>K<span class="s97">i</span><span class="p">, and a local index is created on </span>K<span class="s97">i</span><span class="p">. In addition, a local index on attributes (</span>K<span class="s97">p</span><span class="p">, </span>K<span class="s97">u</span><span class="p">) is created on each partition of relation </span>r<span class="p">.</span></p><p style="padding-left: 137pt;text-indent: 0pt;line-height: 11pt;text-align: left;">We now consider how to use a global secondary index to answer a query. Consider</p><p style="padding-left: 119pt;text-indent: 0pt;text-align: left;">a query that speciﬁes a particular value <i>v </i>for <i>K</i><span class="s145">i</span>. The query is processed as follows:</p><p class="s109" style="text-indent: 0pt;line-height: 8pt;text-align: left;">i</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-top: 12pt;padding-left: 128pt;text-indent: 0pt;text-align: left;"><span class="s63">1. </span><span class="p">The relevant partition of </span>r<span class="s238">s</span> <span class="p">for the value </span>v <span class="p">is found using the partitioning function</span></p><p style="padding-left: 145pt;text-indent: 0pt;text-align: left;">on <i>K</i><span class="s145">i</span>.</p><p class="s109" style="text-indent: 0pt;line-height: 8pt;text-align: left;">i</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-top: 4pt;padding-left: 128pt;text-indent: 0pt;line-height: 14pt;text-align: left;"><span class="s63">2. </span><span class="p">Use the local index on </span>K<span class="s97">i </span><span class="p">at the above partition to ﬁnd tuples of </span>r<span class="s238">s</span> <span class="p">that have the</span></p><p style="padding-left: 145pt;text-indent: 0pt;line-height: 14pt;text-align: left;">speciﬁed value <i>v </i>for <i>K</i><span class="s97">i</span>.</p><p style="padding-top: 4pt;padding-left: 145pt;text-indent: -17pt;line-height: 90%;text-align: left;"><span class="s63">3. </span>The tuples in the preceding result are partitioned based on the <i>K</i><span class="s145">p </span>value and sent to the corresponding nodes.</p><p class="s13" style="padding-top: 6pt;padding-left: 145pt;text-indent: -17pt;text-align: left;"><span class="s63">4. </span><span class="p">At each node, the tuples received from the preceding step are used along with the local index on </span>r <span class="p">on attributes </span>K<span class="s145">p </span><span class="s15">∪ </span>K<span class="s145">u</span><span class="p">, to ﬁnd matching </span>r <span class="p">tuples.</span></p><p class="s13" style="padding-top: 5pt;padding-left: 137pt;text-indent: 0pt;line-height: 7pt;text-align: left;"><span class="p">Note that relation </span>r<span class="s238">s</span> <span class="p">is basically a materialized view deﬁned as </span>r<span class="s238">s</span> <span class="s15">= Π</span><span class="s123">K</span> <span class="s98">,</span><span class="s123">K</span> <span class="s98">,</span><span class="s123">K</span> <span class="p">(</span>r<span class="p">).</span></p><p class="s472" style="padding-left: 223pt;text-indent: 0pt;line-height: 7pt;text-align: left;">i                            i     <span class="s218">i  p  u</span></p><p style="padding-left: 119pt;text-indent: 0pt;line-height: 12pt;text-align: left;">Whenever <i>r </i>is modiﬁed by inserts, deletions, or updates to tuples, the materialized view</p><p class="s109" style="text-indent: 0pt;line-height: 8pt;text-align: left;">i</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 119pt;text-indent: 0pt;text-align: left;">r<span class="s238">s</span> <span class="p">must be correspondingly updated.</span></p><p class="s109" style="text-indent: 0pt;line-height: 8pt;text-align: left;">i</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">Note also that updates to a tuple of <i>r </i>at some node may result in updates to tuples of <i>r</i><i>s</i><i> </i>at other nodes. For example, in Figure 21.6, if the name of <span class="s44">ID </span>001 is updated from Zhang to Yang, the tuple (Zhang, 001) at Tablet8 will be updated to (Yang, 001); since both Zhang and Yang belong in the same partition of the secondary index, no other partition is aﬀected. On the other hand, if the name is updated from Zhang to Bolin, the tuple (Zhang, 001) will be deleted from Tablet8 and a new entry (Bolin, 001) added to Tablet6.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">Performing the above updates to the secondary index as part of the same transac- tion that updates the base relation requires updates to be committed atomically across multiple nodes. Two-phase commit, discussed in Section 23.2, can be used for this task. Alternatives based on persistent messaging can also be used as described in Sec- tion 23.2.3, provided it is acceptable for the secondary index to be somewhat out of date.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part387.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part389.htm">下一个 &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
