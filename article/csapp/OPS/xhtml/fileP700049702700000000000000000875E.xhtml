<?xml version='1.0' encoding='utf-8'?>
<html xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:svg="http://www.w3.org/2000/svg" xmlns:epub="http://www.idpf.org/2007/ops" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" epub:prefix="index: http://www.index.com/">
  <head>
    <meta name="dcterms.conformsTo" content="PXE Basic 1.0"/>
    <meta name="generator" content="PXE Tools version 1.39.52"/>
    <!--Created by pxe.pl for standard version PXE Basic 1.0,data-profile-product=standard by PXE Tools 1.39.52, partial=false-->
    <title>Solutions to Practice Problems </title>
    <link rel="alternate stylesheet" type="text/css" title="night" href="../css/theme/night.css"/>
    <link rel="alternate stylesheet" type="text/css" title="sepia" href="../css/theme/sepia.css"/>
    <script src="js/format_lg_obj.js"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="../../stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="../../page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body epub:type="bodymatter" class="calibre pcalibre pcalibre1">
<section id="P700049702700000000000000000875E" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title pcalibre1" id="P70004970270000000000000000471D1" data-uri="chapter12.xhtml#P70004970270000000000000000471D1" epub:type="title"><span class="pcalibre label pcalibre1">Solutions to Practice Problems </span></h1></header>
<section id="P7000497027000000000000000008760" data-uri="chapter12.xhtml#P7000497027000000000000000008760" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P70004970270000000000000000471D2" data-uri="chapter12.xhtml#P70004970270000000000000000471D2" epub:type="title"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP7000497027000000000000000008097.xhtml#P70004970270000000000000000080C3"><span class="pcalibre label pcalibre1">Solution to Problem </span><span class="pcalibre label pcalibre1">12.1 </span></a>(page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP7000497027000000000000000008097.xhtml#P70004970270000000000000000080B7">975</a>)</h1></header> 
<p id="P70004970270000000000000000471D3" data-uri="chapter12.xhtml#P70004970270000000000000000471D3" class="pcalibre1 pcalibre calibre2">When the parent forks the child, it gets a copy of the connected descriptor, and the reference count for the associated file table is incremented from 1 to 2. When the parent closes its copy of the descriptor, the reference count is decremented from 2 to 1. Since the kernel will not close a file until the reference counter in its file table goes to 0, the child's end of the connection stays open.</p>
</section>
<section id="P7000497027000000000000000008763" data-uri="chapter12.xhtml#P7000497027000000000000000008763" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P70004970270000000000000000471D4" data-uri="chapter12.xhtml#P70004970270000000000000000471D4" epub:type="title"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP7000497027000000000000000008097.xhtml#P70004970270000000000000000080C9"><span class="pcalibre label pcalibre1">Solution to Problem </span><span class="pcalibre label pcalibre1">12.2 </span></a>(page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP7000497027000000000000000008097.xhtml#P70004970270000000000000000080B7">975</a>)</h1></header>
<p id="P70004970270000000000000000471D5" data-uri="chapter12.xhtml#P70004970270000000000000000471D5" class="pcalibre1 pcalibre calibre2">When a process terminates for any reason, the kernel closes all open descriptors. Thus, the child's copy of the connected file descriptor will be closed automatically when the child exits.</p>
</section>
<section id="P7000497027000000000000000008766" data-uri="chapter12.xhtml#P7000497027000000000000000008766" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P70004970270000000000000000471D6" data-uri="chapter12.xhtml#P70004970270000000000000000471D6" epub:type="title"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP70004970270000000000000000080DE.xhtml#P700049702700000000000000000811E"><span class="pcalibre label pcalibre1">Solution to Problem </span><span class="pcalibre label pcalibre1">12.3 </span></a>(page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP70004970270000000000000000080DE.xhtml#P7000497027000000000000000008115">980</a>)</h1></header> 
<p id="P70004970270000000000000000471D7" data-uri="chapter12.xhtml#P70004970270000000000000000471D7" class="pcalibre1 pcalibre calibre2">Recall that a descriptor is ready for reading if a request to read 1 byte from that descriptor would not block. If EOF becomes true on a descriptor, then the descriptor is ready for reading because the read operation will return immediately with a zero return code indicating EOF. Thus, typing Ctrl+D causes the <code id="P70004970270000000000000000471D8" data-uri="chapter12.xhtml#P70004970270000000000000000471D8" class="pcalibre1 calibre8 pcalibre">select</code> function to return with descriptor 0 in the ready set.</p>
</section>
<section id="P700049702700000000000000000876A" data-uri="chapter12.xhtml#P700049702700000000000000000876A" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P70004970270000000000000000471D9" data-uri="chapter12.xhtml#P70004970270000000000000000471D9" epub:type="title"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP70004970270000000000000000080DE.xhtml#P700049702700000000000000000816C"><span class="pcalibre label pcalibre1">Solution to Problem </span><span class="pcalibre label pcalibre1">12.4 </span></a>(page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP70004970270000000000000000080DE.xhtml#P7000497027000000000000000008160">984</a>)</h1></header> 
<p id="P70004970270000000000000000471DA" data-uri="chapter12.xhtml#P70004970270000000000000000471DA" class="pcalibre1 pcalibre calibre2">We reinitialize the <code id="P70004970270000000000000000471DB" data-uri="chapter12.xhtml#P70004970270000000000000000471DB" class="pcalibre1 calibre8 pcalibre">pool.ready_set</code> variable before every call to <code id="P70004970270000000000000000471DC" data-uri="chapter12.xhtml#P70004970270000000000000000471DC" class="pcalibre1 calibre8 pcalibre">select</code> because it serves as both an input and output argument. On input, it contains the read set. On output, it contains the ready set.</p>
</section>
<section id="P700049702700000000000000000876F" data-uri="chapter12.xhtml#P700049702700000000000000000876F" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P70004970270000000000000000471DD" data-uri="chapter12.xhtml#P70004970270000000000000000471DD" epub:type="title"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP700049702700000000000000000817D.xhtml#P7000497027000000000000000008217"><span class="pcalibre label pcalibre1">Solution to Problem </span><span class="pcalibre label pcalibre1">12.5 </span></a>(page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP700049702700000000000000000817D.xhtml#P7000497027000000000000000008208">992</a>)</h1></header> 
<p id="P70004970270000000000000000471DE" data-uri="chapter12.xhtml#P70004970270000000000000000471DE" class="pcalibre1 pcalibre calibre2">Since threads run in the same process, they all share the same descriptor table. No matter how many threads use the connected descriptor, the reference count for the connected descriptor's file table is equal to 1. Thus, a single <code id="P70004970270000000000000000471DF" data-uri="chapter12.xhtml#P70004970270000000000000000471DF" class="pcalibre1 calibre8 pcalibre">close</code> operation is sufficient to free the memory resources associated with the connected descriptor when we are through with it.</p>
</section>
<section id="P7000497027000000000000000008773" data-uri="chapter12.xhtml#P7000497027000000000000000008773" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P70004970270000000000000000471E0" data-uri="chapter12.xhtml#P70004970270000000000000000471E0" epub:type="title"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP700049702700000000000000000821D.xhtml#P700049702700000000000000000824E"><span class="pcalibre label pcalibre1">Solution to Problem </span><span class="pcalibre label pcalibre1">12.6 </span></a>(page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP700049702700000000000000000821D.xhtml#P7000497027000000000000000008245">995</a>)</h1></header>
<p id="P70004970270000000000000000471E1" data-uri="chapter12.xhtml#P70004970270000000000000000471E1" class="pcalibre1 pcalibre calibre2">The main idea here is that stack variables are private, whereas global and static variables are shared. Static variables such as <code id="P70004970270000000000000000471E2" data-uri="chapter12.xhtml#P70004970270000000000000000471E2" class="pcalibre1 calibre8 pcalibre">cnt</code> are a little tricky because the sharing is limited to the functions within their scope—in this case, the thread routine.</p>

<ol class="pcalibre ol_upper-alpha pcalibre1" id="P70004970270000000000000000471E3" data-uri="chapter12.xhtml#P70004970270000000000000000471E3">
<li class="calibre12 pcalibre pcalibre1" id="P70004970270000000000000000471E4" data-uri="chapter12.xhtml#P70004970270000000000000000471E4"><p id="P70004970270000000000000000471E5" data-uri="chapter12.xhtml#P70004970270000000000000000471E5" class="pcalibre calibre3 pcalibre1"><span class="pcalibre pagebreak pcalibre1" id="P700049702700000000000000000877A" title="1037" data-uri="chapter12.xhtml#P700049702700000000000000000877A" epub:type="pagebreak"></span>Here is the table:</p>
<table id="P70004970270000000000000000471E6" data-uri="chapter12.xhtml#P70004970270000000000000000471E6" class="pcalibre largetable pcalibre1">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th rowspan="2" id="P70004970270000000000000000471E7" data-uri="chapter12.xhtml#P70004970270000000000000000471E7" class="calibre18 pcalibre pcalibre1">Variable instance</th>
<th colspan="3" id="P70004970270000000000000000471E8" data-uri="chapter12.xhtml#P70004970270000000000000000471E8" class="calibre18 pcalibre pcalibre1">Referenced by</th>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<th id="P70004970270000000000000000471E9" data-uri="chapter12.xhtml#P70004970270000000000000000471E9" class="calibre18 pcalibre pcalibre1">main thread?</th>
<th id="P70004970270000000000000000471EA" data-uri="chapter12.xhtml#P70004970270000000000000000471EA" class="calibre18 pcalibre pcalibre1">peer thread 0?</th>
<th id="P70004970270000000000000000471EB" data-uri="chapter12.xhtml#P70004970270000000000000000471EB" class="calibre18 pcalibre pcalibre1">peer thread 1?</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000471EC" data-uri="chapter12.xhtml#P70004970270000000000000000471EC" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000471ED" data-uri="chapter12.xhtml#P70004970270000000000000000471ED" class="calibre10 pcalibre pcalibre1">ptr</code></td>
<td id="P70004970270000000000000000471EE" data-uri="chapter12.xhtml#P70004970270000000000000000471EE" class="calibre20 pcalibre pcalibre1">yes</td>
<td id="P70004970270000000000000000471EF" data-uri="chapter12.xhtml#P70004970270000000000000000471EF" class="calibre20 pcalibre pcalibre1">yes</td>
<td id="P70004970270000000000000000471F0" data-uri="chapter12.xhtml#P70004970270000000000000000471F0" class="calibre20 pcalibre pcalibre1">yes</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000471F1" data-uri="chapter12.xhtml#P70004970270000000000000000471F1" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000471F2" data-uri="chapter12.xhtml#P70004970270000000000000000471F2" class="calibre10 pcalibre pcalibre1">cnt</code></td>
<td id="P70004970270000000000000000471F3" data-uri="chapter12.xhtml#P70004970270000000000000000471F3" class="calibre20 pcalibre pcalibre1">no</td>
<td id="P70004970270000000000000000471F4" data-uri="chapter12.xhtml#P70004970270000000000000000471F4" class="calibre20 pcalibre pcalibre1">yes</td>
<td id="P70004970270000000000000000471F5" data-uri="chapter12.xhtml#P70004970270000000000000000471F5" class="calibre20 pcalibre pcalibre1">yes</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000471F6" data-uri="chapter12.xhtml#P70004970270000000000000000471F6" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000471F7" data-uri="chapter12.xhtml#P70004970270000000000000000471F7" class="calibre10 pcalibre pcalibre1">i.m</code></td>
<td id="P70004970270000000000000000471F8" data-uri="chapter12.xhtml#P70004970270000000000000000471F8" class="calibre20 pcalibre pcalibre1">yes</td>
<td id="P70004970270000000000000000471F9" data-uri="chapter12.xhtml#P70004970270000000000000000471F9" class="calibre20 pcalibre pcalibre1">no</td>
<td id="P70004970270000000000000000471FA" data-uri="chapter12.xhtml#P70004970270000000000000000471FA" class="calibre20 pcalibre pcalibre1">no</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000471FB" data-uri="chapter12.xhtml#P70004970270000000000000000471FB" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000471FC" data-uri="chapter12.xhtml#P70004970270000000000000000471FC" class="calibre10 pcalibre pcalibre1">msgs.m</code></td>
<td id="P70004970270000000000000000471FD" data-uri="chapter12.xhtml#P70004970270000000000000000471FD" class="calibre20 pcalibre pcalibre1">yes</td>
<td id="P70004970270000000000000000471FE" data-uri="chapter12.xhtml#P70004970270000000000000000471FE" class="calibre20 pcalibre pcalibre1">yes</td>
<td id="P70004970270000000000000000471FF" data-uri="chapter12.xhtml#P70004970270000000000000000471FF" class="calibre20 pcalibre pcalibre1">yes</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000047200" data-uri="chapter12.xhtml#P7000497027000000000000000047200" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000047201" data-uri="chapter12.xhtml#P7000497027000000000000000047201" class="calibre10 pcalibre pcalibre1">myid.p0</code></td>
<td id="P7000497027000000000000000047202" data-uri="chapter12.xhtml#P7000497027000000000000000047202" class="calibre20 pcalibre pcalibre1">no</td>
<td id="P7000497027000000000000000047203" data-uri="chapter12.xhtml#P7000497027000000000000000047203" class="calibre20 pcalibre pcalibre1">yes</td>
<td id="P7000497027000000000000000047204" data-uri="chapter12.xhtml#P7000497027000000000000000047204" class="calibre20 pcalibre pcalibre1">no</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000047205" data-uri="chapter12.xhtml#P7000497027000000000000000047205" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000047206" data-uri="chapter12.xhtml#P7000497027000000000000000047206" class="calibre10 pcalibre pcalibre1">myid.p1</code></td>
<td id="P7000497027000000000000000047207" data-uri="chapter12.xhtml#P7000497027000000000000000047207" class="calibre20 pcalibre pcalibre1">no</td>
<td id="P7000497027000000000000000047208" data-uri="chapter12.xhtml#P7000497027000000000000000047208" class="calibre20 pcalibre pcalibre1">no</td>
<td id="P7000497027000000000000000047209" data-uri="chapter12.xhtml#P7000497027000000000000000047209" class="calibre20 pcalibre pcalibre1">yes</td>
</tr>
</tbody>
</table>
<p id="P700049702700000000000000004720A" data-uri="chapter12.xhtml#P700049702700000000000000004720A" class="pcalibre calibre3 pcalibre1">Notes:</p>
<ul class="pcalibre ul_none pcalibre1" id="P700049702700000000000000004720B" data-uri="chapter12.xhtml#P700049702700000000000000004720B">
<li id="P700049702700000000000000004720C" data-uri="chapter12.xhtml#P700049702700000000000000004720C" class="calibre12 pcalibre pcalibre1"><p id="P700049702700000000000000004720D" data-uri="chapter12.xhtml#P700049702700000000000000004720D" class="calibre13 pcalibre pcalibre1"><code id="P700049702700000000000000004720E" data-uri="chapter12.xhtml#P700049702700000000000000004720E" class="pcalibre1 calibre8 pcalibre">ptr</code> A global variable that is written by the main thread and read by the peer threads.</p></li>
<li id="P700049702700000000000000004720F" data-uri="chapter12.xhtml#P700049702700000000000000004720F" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000047210" data-uri="chapter12.xhtml#P7000497027000000000000000047210" class="calibre13 pcalibre pcalibre1"><code id="P7000497027000000000000000047211" data-uri="chapter12.xhtml#P7000497027000000000000000047211" class="pcalibre1 calibre8 pcalibre">cnt</code> A static variable with only one instance in memory that is read and written by the two peer threads.</p></li>
<li id="P7000497027000000000000000047212" data-uri="chapter12.xhtml#P7000497027000000000000000047212" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000047213" data-uri="chapter12.xhtml#P7000497027000000000000000047213" class="calibre13 pcalibre pcalibre1"><code id="P7000497027000000000000000047214" data-uri="chapter12.xhtml#P7000497027000000000000000047214" class="pcalibre1 calibre8 pcalibre">i.m</code> A local automatic variable stored on the stack of the main thread. Even though its value is passed to the peer threads, the peer threads never reference it on the stack, and thus it is not shared.</p></li>
<li id="P7000497027000000000000000047215" data-uri="chapter12.xhtml#P7000497027000000000000000047215" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000047216" data-uri="chapter12.xhtml#P7000497027000000000000000047216" class="calibre13 pcalibre pcalibre1"><code id="P7000497027000000000000000047217" data-uri="chapter12.xhtml#P7000497027000000000000000047217" class="pcalibre1 calibre8 pcalibre">msgs.m</code> A local automatic variable stored on the main thread's stack and referenced indirectly through <code id="P7000497027000000000000000047218" data-uri="chapter12.xhtml#P7000497027000000000000000047218" class="pcalibre1 calibre8 pcalibre">ptr</code> by both peer threads.</p></li>
<li id="P7000497027000000000000000047219" data-uri="chapter12.xhtml#P7000497027000000000000000047219" class="calibre12 pcalibre pcalibre1"><p id="P700049702700000000000000004721A" data-uri="chapter12.xhtml#P700049702700000000000000004721A" class="calibre13 pcalibre pcalibre1"><code id="P700049702700000000000000004721B" data-uri="chapter12.xhtml#P700049702700000000000000004721B" class="pcalibre1 calibre8 pcalibre">myid.p0</code> and <code id="P700049702700000000000000004721C" data-uri="chapter12.xhtml#P700049702700000000000000004721C" class="pcalibre1 calibre8 pcalibre">myid.p1</code> Instances of a local automatic variable residing on the stacks of peer threads 0 and 1, respectively.</p></li>
</ul></li>
<li class="calibre12 pcalibre pcalibre1" id="P700049702700000000000000004721D" data-uri="chapter12.xhtml#P700049702700000000000000004721D"><p id="P700049702700000000000000004721E" data-uri="chapter12.xhtml#P700049702700000000000000004721E" class="pcalibre calibre3 pcalibre1">Variables <code id="P700049702700000000000000004721F" data-uri="chapter12.xhtml#P700049702700000000000000004721F" class="pcalibre1 calibre8 pcalibre">ptr, cnt</code>, and <code id="P7000497027000000000000000047220" data-uri="chapter12.xhtml#P7000497027000000000000000047220" class="pcalibre1 calibre8 pcalibre">msgs</code> are referenced by more than one thread and thus are shared.</p></li>
</ol>
</section>
<section id="P70004970270000000000000000087B6" data-uri="chapter12.xhtml#P70004970270000000000000000087B6" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P7000497027000000000000000047221" data-uri="chapter12.xhtml#P7000497027000000000000000047221" epub:type="title"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP700049702700000000000000000827E.xhtml#P7000497027000000000000000008342"><span class="pcalibre label pcalibre1">Solution to Problem </span><span class="pcalibre label pcalibre1">12.7 </span></a>(page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP700049702700000000000000000827E.xhtml#P70004970270000000000000000082AB">998</a>)</h1></header> 
<p id="P7000497027000000000000000047222" data-uri="chapter12.xhtml#P7000497027000000000000000047222" class="pcalibre1 pcalibre calibre2">The important idea here is that you cannot make any assumptions about the ordering that the kernel chooses when it schedules your threads.</p>
<table id="P7000497027000000000000000047223" data-uri="chapter12.xhtml#P7000497027000000000000000047223" class="pcalibre largetable pcalibre1">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P7000497027000000000000000047224" data-uri="chapter12.xhtml#P7000497027000000000000000047224" class="calibre18 pcalibre pcalibre1">Step</th>
<th id="P7000497027000000000000000047225" data-uri="chapter12.xhtml#P7000497027000000000000000047225" class="calibre18 pcalibre pcalibre1">Thread</th>
<th id="P7000497027000000000000000047226" data-uri="chapter12.xhtml#P7000497027000000000000000047226" class="calibre18 pcalibre pcalibre1">Instr.</th>
<th id="P7000497027000000000000000047227" data-uri="chapter12.xhtml#P7000497027000000000000000047227" class="calibre18 pcalibre pcalibre1"><code id="P7000497027000000000000000047228" data-uri="chapter12.xhtml#P7000497027000000000000000047228" class="calibre10 pcalibre pcalibre1">%rdx</code><sub class="calibre59 pcalibre pcalibre1">1</sub></th>
<th id="P7000497027000000000000000047229" data-uri="chapter12.xhtml#P7000497027000000000000000047229" class="calibre18 pcalibre pcalibre1"><code id="P700049702700000000000000004722A" data-uri="chapter12.xhtml#P700049702700000000000000004722A" class="calibre10 pcalibre pcalibre1">%rdx</code><sub class="calibre59 pcalibre pcalibre1">2</sub></th>
<th id="P700049702700000000000000004722B" data-uri="chapter12.xhtml#P700049702700000000000000004722B" class="calibre18 pcalibre pcalibre1"><code id="P700049702700000000000000004722C" data-uri="chapter12.xhtml#P700049702700000000000000004722C" class="calibre10 pcalibre pcalibre1">cnt</code></th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P700049702700000000000000004722D" data-uri="chapter12.xhtml#P700049702700000000000000004722D" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P700049702700000000000000004722E" data-uri="chapter12.xhtml#P700049702700000000000000004722E" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P700049702700000000000000004722F" data-uri="chapter12.xhtml#P700049702700000000000000004722F" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">H</var><sub class="calibre59 pcalibre pcalibre1">1</sub></td>
<td id="P7000497027000000000000000047230" data-uri="chapter12.xhtml#P7000497027000000000000000047230" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000047231" data-uri="chapter12.xhtml#P7000497027000000000000000047231" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000047232" data-uri="chapter12.xhtml#P7000497027000000000000000047232" class="calibre20 pcalibre pcalibre1">0</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000047233" data-uri="chapter12.xhtml#P7000497027000000000000000047233" class="calibre20 pcalibre pcalibre1">2</td>
<td id="P7000497027000000000000000047234" data-uri="chapter12.xhtml#P7000497027000000000000000047234" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000047235" data-uri="chapter12.xhtml#P7000497027000000000000000047235" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">L</var><sub class="calibre59 pcalibre pcalibre1">1</sub></td>
<td id="P7000497027000000000000000047236" data-uri="chapter12.xhtml#P7000497027000000000000000047236" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000047237" data-uri="chapter12.xhtml#P7000497027000000000000000047237" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000047238" data-uri="chapter12.xhtml#P7000497027000000000000000047238" class="calibre20 pcalibre pcalibre1">0</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000047239" data-uri="chapter12.xhtml#P7000497027000000000000000047239" class="calibre20 pcalibre pcalibre1">3</td>
<td id="P700049702700000000000000004723A" data-uri="chapter12.xhtml#P700049702700000000000000004723A" class="calibre20 pcalibre pcalibre1">2</td>
<td id="P700049702700000000000000004723B" data-uri="chapter12.xhtml#P700049702700000000000000004723B" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">H</var><sub class="calibre59 pcalibre pcalibre1">2</sub></td>
<td id="P700049702700000000000000004723C" data-uri="chapter12.xhtml#P700049702700000000000000004723C" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P700049702700000000000000004723D" data-uri="chapter12.xhtml#P700049702700000000000000004723D" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P700049702700000000000000004723E" data-uri="chapter12.xhtml#P700049702700000000000000004723E" class="calibre20 pcalibre pcalibre1">0</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P700049702700000000000000004723F" data-uri="chapter12.xhtml#P700049702700000000000000004723F" class="calibre20 pcalibre pcalibre1">4</td>
<td id="P7000497027000000000000000047240" data-uri="chapter12.xhtml#P7000497027000000000000000047240" class="calibre20 pcalibre pcalibre1">2</td>
<td id="P7000497027000000000000000047241" data-uri="chapter12.xhtml#P7000497027000000000000000047241" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">L</var><sub class="calibre59 pcalibre pcalibre1">2</sub></td>
<td id="P7000497027000000000000000047242" data-uri="chapter12.xhtml#P7000497027000000000000000047242" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000047243" data-uri="chapter12.xhtml#P7000497027000000000000000047243" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000047244" data-uri="chapter12.xhtml#P7000497027000000000000000047244" class="calibre20 pcalibre pcalibre1">0</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000047245" data-uri="chapter12.xhtml#P7000497027000000000000000047245" class="calibre20 pcalibre pcalibre1">5</td>
<td id="P7000497027000000000000000047246" data-uri="chapter12.xhtml#P7000497027000000000000000047246" class="calibre20 pcalibre pcalibre1">2</td>
<td id="P7000497027000000000000000047247" data-uri="chapter12.xhtml#P7000497027000000000000000047247" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">U</var><sub class="calibre59 pcalibre pcalibre1">2</sub></td>
<td id="P7000497027000000000000000047248" data-uri="chapter12.xhtml#P7000497027000000000000000047248" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000047249" data-uri="chapter12.xhtml#P7000497027000000000000000047249" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P700049702700000000000000004724A" data-uri="chapter12.xhtml#P700049702700000000000000004724A" class="calibre20 pcalibre pcalibre1">0</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P700049702700000000000000004724B" data-uri="chapter12.xhtml#P700049702700000000000000004724B" class="calibre20 pcalibre pcalibre1">6</td>
<td id="P700049702700000000000000004724C" data-uri="chapter12.xhtml#P700049702700000000000000004724C" class="calibre20 pcalibre pcalibre1">2</td>
<td id="P700049702700000000000000004724D" data-uri="chapter12.xhtml#P700049702700000000000000004724D" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">S</var><sub class="calibre59 pcalibre pcalibre1">2</sub></td>
<td id="P700049702700000000000000004724E" data-uri="chapter12.xhtml#P700049702700000000000000004724E" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P700049702700000000000000004724F" data-uri="chapter12.xhtml#P700049702700000000000000004724F" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000047250" data-uri="chapter12.xhtml#P7000497027000000000000000047250" class="calibre20 pcalibre pcalibre1">1</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000047251" data-uri="chapter12.xhtml#P7000497027000000000000000047251" class="calibre20 pcalibre pcalibre1">7</td>
<td id="P7000497027000000000000000047252" data-uri="chapter12.xhtml#P7000497027000000000000000047252" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000047253" data-uri="chapter12.xhtml#P7000497027000000000000000047253" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">U</var><sub class="calibre59 pcalibre pcalibre1">1</sub></td>
<td id="P7000497027000000000000000047254" data-uri="chapter12.xhtml#P7000497027000000000000000047254" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000047255" data-uri="chapter12.xhtml#P7000497027000000000000000047255" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000047256" data-uri="chapter12.xhtml#P7000497027000000000000000047256" class="calibre20 pcalibre pcalibre1">1</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000047257" data-uri="chapter12.xhtml#P7000497027000000000000000047257" class="calibre20 pcalibre pcalibre1">8</td>
<td id="P7000497027000000000000000047258" data-uri="chapter12.xhtml#P7000497027000000000000000047258" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000047259" data-uri="chapter12.xhtml#P7000497027000000000000000047259" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">S</var><sub class="calibre59 pcalibre pcalibre1">1</sub></td>
<td id="P700049702700000000000000004725A" data-uri="chapter12.xhtml#P700049702700000000000000004725A" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P700049702700000000000000004725B" data-uri="chapter12.xhtml#P700049702700000000000000004725B" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P700049702700000000000000004725C" data-uri="chapter12.xhtml#P700049702700000000000000004725C" class="calibre20 pcalibre pcalibre1">1</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P700049702700000000000000004725D" data-uri="chapter12.xhtml#P700049702700000000000000004725D" class="calibre20 pcalibre pcalibre1">9</td>
<td id="P700049702700000000000000004725E" data-uri="chapter12.xhtml#P700049702700000000000000004725E" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P700049702700000000000000004725F" data-uri="chapter12.xhtml#P700049702700000000000000004725F" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">T</var><sub class="calibre59 pcalibre pcalibre1">1</sub></td>
<td id="P7000497027000000000000000047260" data-uri="chapter12.xhtml#P7000497027000000000000000047260" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000047261" data-uri="chapter12.xhtml#P7000497027000000000000000047261" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000047262" data-uri="chapter12.xhtml#P7000497027000000000000000047262" class="calibre20 pcalibre pcalibre1">1</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000047263" data-uri="chapter12.xhtml#P7000497027000000000000000047263" class="calibre20 pcalibre pcalibre1">10</td>
<td id="P7000497027000000000000000047264" data-uri="chapter12.xhtml#P7000497027000000000000000047264" class="calibre20 pcalibre pcalibre1">2</td>
<td id="P7000497027000000000000000047265" data-uri="chapter12.xhtml#P7000497027000000000000000047265" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">T</var><sub class="calibre59 pcalibre pcalibre1">2</sub></td>
<td id="P7000497027000000000000000047266" data-uri="chapter12.xhtml#P7000497027000000000000000047266" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000047267" data-uri="chapter12.xhtml#P7000497027000000000000000047267" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000047268" data-uri="chapter12.xhtml#P7000497027000000000000000047268" class="calibre20 pcalibre pcalibre1">1</td>
</tr>
</tbody>
</table>
<p id="P7000497027000000000000000047269" data-uri="chapter12.xhtml#P7000497027000000000000000047269" class="pcalibre1 pcalibre calibre2">Variable <code id="P700049702700000000000000004726A" data-uri="chapter12.xhtml#P700049702700000000000000004726A" class="pcalibre1 calibre8 pcalibre">cnt</code> has a final incorrect value of 1.</p>
</section>
<section id="P7000497027000000000000000008801" data-uri="chapter12.xhtml#P7000497027000000000000000008801" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P700049702700000000000000004726B" data-uri="chapter12.xhtml#P700049702700000000000000004726B" epub:type="title"><span class="pcalibre pagebreak pcalibre1" id="P7000497027000000000000000008803" title="1038" data-uri="chapter12.xhtml#P7000497027000000000000000008803" epub:type="pagebreak"></span><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP700049702700000000000000000827E.xhtml#P70004970270000000000000000083BC"><span class="pcalibre label pcalibre1">Solution to Problem </span><span class="pcalibre label pcalibre1">12.8 </span></a>(page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP700049702700000000000000000827E.xhtml#P70004970270000000000000000083B6">1001</a>)</h1></header> 
<p id="P700049702700000000000000004726C" data-uri="chapter12.xhtml#P700049702700000000000000004726C" class="pcalibre1 pcalibre calibre2">This problem is a simple test of your understanding of safe and unsafe trajectories in progress graphs. Trajectories such as A and C that skirt the critical region are safe and will produce correct results.</p>
<ol class="pcalibre ol_upper-alpha pcalibre1" id="P700049702700000000000000004726D" data-uri="chapter12.xhtml#P700049702700000000000000004726D">
<li class="calibre12 pcalibre pcalibre1" id="P700049702700000000000000004726E" data-uri="chapter12.xhtml#P700049702700000000000000004726E"><p id="P700049702700000000000000004726F" data-uri="chapter12.xhtml#P700049702700000000000000004726F" class="pcalibre calibre3 pcalibre1"><var class="calibre5 pcalibre pcalibre1">H</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">L</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">U</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">S</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">H</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">L</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">U</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">S</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">T</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">T</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>: safe</p></li>
<li class="calibre12 pcalibre pcalibre1" id="P7000497027000000000000000047270" data-uri="chapter12.xhtml#P7000497027000000000000000047270"><p id="P7000497027000000000000000047271" data-uri="chapter12.xhtml#P7000497027000000000000000047271" class="pcalibre calibre3 pcalibre1"><var class="calibre5 pcalibre pcalibre1">H</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">L</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">H</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">L</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">U</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">S</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">T</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">U</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">S</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">T</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>: unsafe</p></li>
<li class="calibre12 pcalibre pcalibre1" id="P7000497027000000000000000047272" data-uri="chapter12.xhtml#P7000497027000000000000000047272"><p id="P7000497027000000000000000047273" data-uri="chapter12.xhtml#P7000497027000000000000000047273" class="pcalibre calibre3 pcalibre1"><var class="calibre5 pcalibre pcalibre1">H</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">H</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">L</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">U</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">S</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">L</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">U</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">S</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">T</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">T</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>: safe</p></li>
</ol>
</section>
<section id="P700049702700000000000000000880C" data-uri="chapter12.xhtml#P700049702700000000000000000880C" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P7000497027000000000000000047274" data-uri="chapter12.xhtml#P7000497027000000000000000047274" epub:type="title"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP700049702700000000000000000827E.xhtml#P700049702700000000000000000842B"><span class="pcalibre label pcalibre1">Solution to Problem </span><span class="pcalibre label pcalibre1">12.9 </span></a>(page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP700049702700000000000000000827E.xhtml#P700049702700000000000000000841B">1006</a>)</h1></header>
<ol class="pcalibre ol_upper-alpha pcalibre1" id="P7000497027000000000000000047275" data-uri="chapter12.xhtml#P7000497027000000000000000047275">
<li class="calibre12 pcalibre pcalibre1" id="P7000497027000000000000000047276" data-uri="chapter12.xhtml#P7000497027000000000000000047276"><p id="P7000497027000000000000000047277" data-uri="chapter12.xhtml#P7000497027000000000000000047277" class="pcalibre calibre3 pcalibre1"><var class="calibre5 pcalibre pcalibre1">p</var> = 1, <var class="calibre5 pcalibre pcalibre1">c</var> = 1, <var class="calibre5 pcalibre pcalibre1">n</var> &gt; 1: Yes, the mutex semaphore is necessary because the producer and consumer can concurrently access the buffer.</p></li>
<li class="calibre12 pcalibre pcalibre1" id="P7000497027000000000000000047278" data-uri="chapter12.xhtml#P7000497027000000000000000047278"><p id="P7000497027000000000000000047279" data-uri="chapter12.xhtml#P7000497027000000000000000047279" class="pcalibre calibre3 pcalibre1"><var class="calibre5 pcalibre pcalibre1">p</var> = 1, <var class="calibre5 pcalibre pcalibre1">c</var> = 1, <var class="calibre5 pcalibre pcalibre1">n</var> = 1: No, the mutex semaphore is not necessary in this case, because a nonempty buffer is equivalent to a full buffer. When the buffer contains an item, the producer is blocked. When the buffer is empty, the consumer is blocked. So at any point in time, only a single thread can access the buffer, and thus mutual exclusion is guaranteed without using the mutex.</p></li>
<li class="calibre12 pcalibre pcalibre1" id="P700049702700000000000000004727A" data-uri="chapter12.xhtml#P700049702700000000000000004727A"><p id="P700049702700000000000000004727B" data-uri="chapter12.xhtml#P700049702700000000000000004727B" class="pcalibre calibre3 pcalibre1"><var class="calibre5 pcalibre pcalibre1">p</var> &gt; 1, <var class="calibre5 pcalibre pcalibre1">c</var> &gt; 1, <var class="calibre5 pcalibre pcalibre1">n</var> = 1: No, the mutex semaphore is not necessary in this case either, by the same argument as the previous case.</p></li>
</ol>
</section>
<section id="P7000497027000000000000000008815" data-uri="chapter12.xhtml#P7000497027000000000000000008815" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P700049702700000000000000004727C" data-uri="chapter12.xhtml#P700049702700000000000000004727C" epub:type="title"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP700049702700000000000000000827E.xhtml#P7000497027000000000000000008450"><span class="pcalibre label pcalibre1">Solution to Problem </span><span class="pcalibre label pcalibre1">12.10 </span></a>(page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP700049702700000000000000000827E.xhtml#P7000497027000000000000000008447">1008</a>)</h1></header>
<p id="P700049702700000000000000004727D" data-uri="chapter12.xhtml#P700049702700000000000000004727D" class="pcalibre1 pcalibre calibre2">Suppose that a particular semaphore implementation uses a LIFO stack of threads for each semaphore. When a thread blocks on a semaphore in a <var class="calibre5 pcalibre pcalibre1">P</var> operation, its ID is pushed onto the stack. Similarly, the <var class="calibre5 pcalibre pcalibre1">V</var> operation pops the top thread ID from the stack and restarts that thread. Given this stack implementation, an adversarial writer in its critical section could simply wait until another writer blocks on the semaphore before releasing the semaphore. In this scenario, a waiting reader might wait forever as two writers passed control back and forth.</p>
<p id="P700049702700000000000000004727E" data-uri="chapter12.xhtml#P700049702700000000000000004727E" class="pcalibre1 pcalibre calibre2">Notice that although it might seem more intuitive to use a FIFO queue rather than a LIFO stack, using such a stack is not incorrect and does not violate the semantics of the <var class="calibre5 pcalibre pcalibre1">P</var> and <var class="calibre5 pcalibre pcalibre1">V</var> operations.</p>
</section>
<section id="P7000497027000000000000000008819" data-uri="chapter12.xhtml#P7000497027000000000000000008819" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P700049702700000000000000004727F" data-uri="chapter12.xhtml#P700049702700000000000000004727F" epub:type="title"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP700049702700000000000000000849B.xhtml#P700049702700000000000000000855F"><span class="pcalibre label pcalibre1">Solution to Problem </span><span class="pcalibre label pcalibre1">12.11 </span></a>(page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP700049702700000000000000000849B.xhtml#P700049702700000000000000000855E">1020</a>)</h1></header> 
<p id="P7000497027000000000000000047280" data-uri="chapter12.xhtml#P7000497027000000000000000047280" class="pcalibre1 pcalibre calibre2">This problem is a simple sanity check of your understanding of speedup and parallel efficiency:</p>
<table id="P7000497027000000000000000047281" data-uri="chapter12.xhtml#P7000497027000000000000000047281" class="pcalibre largetable pcalibre1">
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000047282" data-uri="chapter12.xhtml#P7000497027000000000000000047282" class="calibre20 pcalibre pcalibre1">Threads (<var class="calibre5 pcalibre pcalibre1">t</var>)</td>
<td id="P7000497027000000000000000047283" data-uri="chapter12.xhtml#P7000497027000000000000000047283" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000047284" data-uri="chapter12.xhtml#P7000497027000000000000000047284" class="calibre20 pcalibre pcalibre1">2</td>
<td id="P7000497027000000000000000047285" data-uri="chapter12.xhtml#P7000497027000000000000000047285" class="calibre20 pcalibre pcalibre1">4</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000047286" data-uri="chapter12.xhtml#P7000497027000000000000000047286" class="calibre20 pcalibre pcalibre1">Cores (<var class="calibre5 pcalibre pcalibre1">p</var>)</td>
<td id="P7000497027000000000000000047287" data-uri="chapter12.xhtml#P7000497027000000000000000047287" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000047288" data-uri="chapter12.xhtml#P7000497027000000000000000047288" class="calibre20 pcalibre pcalibre1">2</td>
<td id="P7000497027000000000000000047289" data-uri="chapter12.xhtml#P7000497027000000000000000047289" class="calibre20 pcalibre pcalibre1">4</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P700049702700000000000000004728A" data-uri="chapter12.xhtml#P700049702700000000000000004728A" class="calibre20 pcalibre pcalibre1">Running time (<i class="calibre5 pcalibre pcalibre1">T<sub class="calibre59 pcalibre pcalibre1">p</sub></i>)</td>
<td id="P700049702700000000000000004728B" data-uri="chapter12.xhtml#P700049702700000000000000004728B" class="calibre20 pcalibre pcalibre1">12</td>
<td id="P700049702700000000000000004728C" data-uri="chapter12.xhtml#P700049702700000000000000004728C" class="calibre20 pcalibre pcalibre1">8</td>
<td id="P700049702700000000000000004728D" data-uri="chapter12.xhtml#P700049702700000000000000004728D" class="calibre20 pcalibre pcalibre1">6</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P700049702700000000000000004728E" data-uri="chapter12.xhtml#P700049702700000000000000004728E" class="calibre20 pcalibre pcalibre1">Speedup (<i class="calibre5 pcalibre pcalibre1">S<sub class="calibre59 pcalibre pcalibre1">p</sub></i>)</td>
<td id="P700049702700000000000000004728F" data-uri="chapter12.xhtml#P700049702700000000000000004728F" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000047290" data-uri="chapter12.xhtml#P7000497027000000000000000047290" class="calibre20 pcalibre pcalibre1">1.5</td>
<td id="P7000497027000000000000000047291" data-uri="chapter12.xhtml#P7000497027000000000000000047291" class="calibre20 pcalibre pcalibre1">2</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000047292" data-uri="chapter12.xhtml#P7000497027000000000000000047292" class="calibre20 pcalibre pcalibre1">Efficiency (<i class="calibre5 pcalibre pcalibre1">E<sub class="calibre59 pcalibre pcalibre1">p</sub></i>)</td>
<td id="P7000497027000000000000000047293" data-uri="chapter12.xhtml#P7000497027000000000000000047293" class="calibre20 pcalibre pcalibre1">100%</td>
<td id="P7000497027000000000000000047294" data-uri="chapter12.xhtml#P7000497027000000000000000047294" class="calibre20 pcalibre pcalibre1">75%</td>
<td id="P7000497027000000000000000047295" data-uri="chapter12.xhtml#P7000497027000000000000000047295" class="calibre20 pcalibre pcalibre1">50%</td>
</tr>
</tbody>
</table>
</section>
<section id="P7000497027000000000000000008831" data-uri="chapter12.xhtml#P7000497027000000000000000008831" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P7000497027000000000000000047296" data-uri="chapter12.xhtml#P7000497027000000000000000047296" epub:type="title"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP7000497027000000000000000008577.xhtml#P70004970270000000000000000085C5"><span class="pcalibre label pcalibre1">Solution to Problem </span><span class="pcalibre label pcalibre1">12.12 </span></a>(page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP7000497027000000000000000008577.xhtml#P70004970270000000000000000085C2">1024</a>)</h1></header> 
<p id="P7000497027000000000000000047297" data-uri="chapter12.xhtml#P7000497027000000000000000047297" class="pcalibre1 pcalibre calibre2">The <code id="P7000497027000000000000000047298" data-uri="chapter12.xhtml#P7000497027000000000000000047298" class="pcalibre1 calibre8 pcalibre">ctime_ts</code> function is not reentrant, because each invocation shares the same <code id="P7000497027000000000000000047299" data-uri="chapter12.xhtml#P7000497027000000000000000047299" class="pcalibre1 calibre8 pcalibre">static</code> variable returned by the <code id="P700049702700000000000000004729A" data-uri="chapter12.xhtml#P700049702700000000000000004729A" class="pcalibre1 calibre8 pcalibre">ctime</code> function. However, it is thread-safe because <span class="pcalibre pagebreak pcalibre1" id="P7000497027000000000000000008837" title="1039" data-uri="chapter12.xhtml#P7000497027000000000000000008837" epub:type="pagebreak"></span>the accesses to the shared variable are protected by <var class="calibre5 pcalibre pcalibre1">P</var> and <var class="calibre5 pcalibre pcalibre1">V</var> operations, and thus are mutually exclusive.</p>
</section>
<section id="P7000497027000000000000000008838" data-uri="chapter12.xhtml#P7000497027000000000000000008838" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P700049702700000000000000004729B" data-uri="chapter12.xhtml#P700049702700000000000000004729B" epub:type="title"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP7000497027000000000000000008577.xhtml#P7000497027000000000000000008627"><span class="pcalibre label pcalibre1">Solution to Problem </span><span class="pcalibre label pcalibre1">12.13 </span></a>(page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP7000497027000000000000000008577.xhtml#P700049702700000000000000000861C">1026</a>)</h1></header>
<p id="P700049702700000000000000004729C" data-uri="chapter12.xhtml#P700049702700000000000000004729C" class="pcalibre1 pcalibre calibre2">If we free the block immediately after the call to <code id="P700049702700000000000000004729D" data-uri="chapter12.xhtml#P700049702700000000000000004729D" class="pcalibre1 calibre8 pcalibre">pthread_create</code> in line 14, then we will introduce a new race, this time between the call to <code id="P700049702700000000000000004729E" data-uri="chapter12.xhtml#P700049702700000000000000004729E" class="pcalibre1 calibre8 pcalibre">free</code> in the main thread and the assignment statement in line 24 of the thread routine.</p>
</section>
<section id="P700049702700000000000000000883D" data-uri="chapter12.xhtml#P700049702700000000000000000883D" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P700049702700000000000000004729F" data-uri="chapter12.xhtml#P700049702700000000000000004729F" epub:type="title"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP7000497027000000000000000008577.xhtml#P700049702700000000000000000862D"><span class="pcalibre label pcalibre1">Solution to Problem </span><span class="pcalibre label pcalibre1">12.14 </span></a>(page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP7000497027000000000000000008577.xhtml#P700049702700000000000000000861C">1026</a>)</h1></header>
<ol class="pcalibre ol_upper-alpha pcalibre1" id="P70004970270000000000000000472A0" data-uri="chapter12.xhtml#P70004970270000000000000000472A0">
<li class="calibre12 pcalibre pcalibre1" id="P70004970270000000000000000472A1" data-uri="chapter12.xhtml#P70004970270000000000000000472A1"><p id="P70004970270000000000000000472A2" data-uri="chapter12.xhtml#P70004970270000000000000000472A2" class="pcalibre calibre3 pcalibre1">Another approach is to pass the integer <code id="P70004970270000000000000000472A3" data-uri="chapter12.xhtml#P70004970270000000000000000472A3" class="pcalibre1 calibre8 pcalibre">i</code> directly, rather than passing a pointer to <code id="P70004970270000000000000000472A4" data-uri="chapter12.xhtml#P70004970270000000000000000472A4" class="pcalibre1 calibre8 pcalibre">i</code>:</p>
<pre id="P70004970270000000000000000472A5" data-uri="chapter12.xhtml#P70004970270000000000000000472A5" class="calibre9 pcalibre pcalibre1"><code id="P70004970270000000000000000472A6" data-uri="chapter12.xhtml#P70004970270000000000000000472A6" class="calibre10 pcalibre pcalibre1">for (i = 0; i &lt; N; i++)
	Pthread_create(&amp;tid[i], NULL, thread, (void *)i);</code></pre>
<p id="P70004970270000000000000000472A7" data-uri="chapter12.xhtml#P70004970270000000000000000472A7" class="pcalibre calibre3 pcalibre1">In the thread routine, we cast the argument back to an <code id="P70004970270000000000000000472A8" data-uri="chapter12.xhtml#P70004970270000000000000000472A8" class="pcalibre1 calibre8 pcalibre">int</code> and assign it to <code id="P70004970270000000000000000472A9" data-uri="chapter12.xhtml#P70004970270000000000000000472A9" class="pcalibre1 calibre8 pcalibre">myid</code>:</p>
<pre id="P70004970270000000000000000472AA" data-uri="chapter12.xhtml#P70004970270000000000000000472AA" class="calibre9 pcalibre pcalibre1"><code id="P70004970270000000000000000472AB" data-uri="chapter12.xhtml#P70004970270000000000000000472AB" class="calibre10 pcalibre pcalibre1">int myid = (int) vargp;</code></pre></li>
<li class="calibre12 pcalibre pcalibre1" id="P70004970270000000000000000472AC" data-uri="chapter12.xhtml#P70004970270000000000000000472AC"><p id="P70004970270000000000000000472AD" data-uri="chapter12.xhtml#P70004970270000000000000000472AD" class="pcalibre calibre3 pcalibre1">The advantage is that it reduces overhead by eliminating the calls to <code id="P70004970270000000000000000472AE" data-uri="chapter12.xhtml#P70004970270000000000000000472AE" class="pcalibre1 calibre8 pcalibre">malloc</code> and <code id="P70004970270000000000000000472AF" data-uri="chapter12.xhtml#P70004970270000000000000000472AF" class="pcalibre1 calibre8 pcalibre">free</code>. A significant disadvantage is that it assumes that pointers are at least as large as <code id="P70004970270000000000000000472B0" data-uri="chapter12.xhtml#P70004970270000000000000000472B0" class="pcalibre1 calibre8 pcalibre">ints</code>. While this assumption is true for all modern systems, it might not be true for legacy or future systems.</p></li>
</ol>
</section>
<section id="P7000497027000000000000000008850" data-uri="chapter12.xhtml#P7000497027000000000000000008850" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P70004970270000000000000000472B1" data-uri="chapter12.xhtml#P70004970270000000000000000472B1" epub:type="title"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP7000497027000000000000000008577.xhtml#P700049702700000000000000000865C"><span class="pcalibre label pcalibre1">Solution to Problem </span><span class="pcalibre label pcalibre1">12.15 </span></a>(page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP7000497027000000000000000008577.xhtml#P7000497027000000000000000008654">1029</a>)</h1></header>
<ol class="pcalibre ol_upper-alpha pcalibre1" id="P70004970270000000000000000472B2" data-uri="chapter12.xhtml#P70004970270000000000000000472B2">
<li class="calibre12 pcalibre pcalibre1" id="P70004970270000000000000000472B3" data-uri="chapter12.xhtml#P70004970270000000000000000472B3"><p id="P70004970270000000000000000472B4" data-uri="chapter12.xhtml#P70004970270000000000000000472B4" class="pcalibre calibre3 pcalibre1">The progress graph for the original program is shown in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P700049702700000000000000000885C"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">12.48</span></a> on the next page.</p></li>
<li class="calibre12 pcalibre pcalibre1" id="P70004970270000000000000000472B5" data-uri="chapter12.xhtml#P70004970270000000000000000472B5"><p id="P70004970270000000000000000472B6" data-uri="chapter12.xhtml#P70004970270000000000000000472B6" class="pcalibre calibre3 pcalibre1">The program always deadlocks, since any feasible trajectory is eventually trapped in a deadlock state.</p></li>
<li class="calibre12 pcalibre pcalibre1" id="P70004970270000000000000000472B7" data-uri="chapter12.xhtml#P70004970270000000000000000472B7"><p id="P70004970270000000000000000472B8" data-uri="chapter12.xhtml#P70004970270000000000000000472B8" class="pcalibre calibre3 pcalibre1">To eliminate the deadlock potential, initialize the binary semaphore <code id="P70004970270000000000000000472B9" data-uri="chapter12.xhtml#P70004970270000000000000000472B9" class="pcalibre1 calibre8 pcalibre">t</code> to 1 instead of 0.</p></li>
<li class="calibre12 pcalibre pcalibre1" id="P70004970270000000000000000472BA" data-uri="chapter12.xhtml#P70004970270000000000000000472BA"><p id="P70004970270000000000000000472BB" data-uri="chapter12.xhtml#P70004970270000000000000000472BB" class="pcalibre calibre3 pcalibre1">The progress graph for the corrected program is shown in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000008861"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">12.49</span></a>.</p></li>
</ol>
<figure class="pcalibre5 figure pcalibre" id="P700049702700000000000000000885C" data-uri="chapter12.xhtml#P700049702700000000000000000885C">
<span class="pcalibre pagebreak pcalibre1" id="P700049702700000000000000000885D" title="1040" data-uri="chapter12.xhtml#P700049702700000000000000000885D" epub:type="pagebreak"></span>
<img alt="A graph shows regions for a program that deadlocks." id="P70004970270000000000000000472BC" data-uri="P700049702700000000000000000B69E" src="../images/p1040-1.png" class="calibre348 pcalibre pcalibre1"/>
<figcaption id="P70004970270000000000000000472BD" data-uri="chapter12.xhtml#P70004970270000000000000000472BD" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P70004970270000000000000000472BE" data-uri="chapter12.xhtml#P70004970270000000000000000472BE" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">12.48 </span>Progress graph for a program that deadlocks.</h1></header>
<details class="longdesc pcalibre pcalibre1" id="P7000497027000000000000000027631" data-uri="chapter12.xhtml#P7000497027000000000000000027631">
<summary class="pcalibre6 pcalibre1 pcalibre calibre30"><span class="number pcalibre pcalibre1">Description</span></summary>
<p id="P70004970270000000000000000472BF" data-uri="chapter12.xhtml#P70004970270000000000000000472BF" class="pcalibre calibre3 pcalibre1">A graph of thread 2 versus thread 1 shows P(s), V(s), P(t), and V(t) on each axis (initially s = 1 and t = 0). Regions include a forbidden region for s from P(s) to V(s) on each axis and forbidden regions for t from P(t) spanning from between P(t) and V(t) on each axis.</p>
</details>
</figcaption>
</figure>
<figure class="pcalibre5 figure pcalibre" id="P7000497027000000000000000008861" data-uri="chapter12.xhtml#P7000497027000000000000000008861">
<img alt="A graph shows regions for a corrected deadlock-free program." id="P70004970270000000000000000472C0" data-uri="P700049702700000000000000000B69F" src="../images/p1040-2.png" class="calibre348 pcalibre pcalibre1"/>
<figcaption id="P70004970270000000000000000472C1" data-uri="chapter12.xhtml#P70004970270000000000000000472C1" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P70004970270000000000000000472C2" data-uri="chapter12.xhtml#P70004970270000000000000000472C2" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">12.49 </span>Progress graph for the corrected deadlock-free program.</h1></header>
<details class="longdesc pcalibre pcalibre1" id="P7000497027000000000000000027636" data-uri="chapter12.xhtml#P7000497027000000000000000027636">
<summary class="pcalibre6 pcalibre1 pcalibre calibre30"><span class="number pcalibre pcalibre1">Description</span></summary>
<p id="P70004970270000000000000000472C3" data-uri="chapter12.xhtml#P70004970270000000000000000472C3" class="pcalibre calibre3 pcalibre1">A graph of thread 2 versus thread 1 shows P(s), V(s), P(t), and V(t) on each axis (initially s = 1 and t = 1). Regions include a forbidden region for s from P(s) to V(s) on each axis and a forbidden region for t from P(t) to V(t) on each axis.</p>
</details>
</figcaption>
</figure>
</section>
</section></body></html>
