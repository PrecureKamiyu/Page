<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Practice Exercises</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part78.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part80.htm">下一个 &gt;</a></p><p class="s45" style="padding-top: 8pt;padding-left: 36pt;text-indent: 0pt;text-align: left;">Practice Exercises</p><p class="s46" style="padding-top: 11pt;padding-left: 119pt;text-indent: -24pt;text-align: justify;">2.1 <span class="p">Consider the employee database of Figure 2.17. What are the appropriate pri- mary keys?</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_246.png"/></span></p><p style="padding-top: 6pt;padding-left: 119pt;text-indent: -25pt;text-align: justify;"><b>2.2 </b>Consider the foreign-key constraint from the <i>dept name </i>attribute of <i>instructor </i>to the <i>department </i>relation. Give examples of inserts and deletes to these relations that can cause a violation of the foreign-key constraint.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_247.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_248.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_249.png"/></span></p><p style="padding-top: 6pt;padding-left: 119pt;text-indent: -25pt;text-align: justify;"><b>2.3  </b>Consider the <i>time slot </i>relation. Given that a particular time slot can meet more than once in a week, explain why <i>day </i>and <i>start time </i>are part of the primary key of this relation, while <i>end time </i>is not.</p><p style="padding-top: 6pt;padding-left: 119pt;text-indent: -25pt;text-align: justify;"><b>2.4  </b>In the instance of <i>instructor </i>shown in Figure 2.1, no two instructors have the same name. From this, can we conclude that <i>name </i>can be used as a superkey (or primary key) of <i>instructor</i>?</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_250.png"/></span></p><p style="padding-top: 6pt;padding-left: 119pt;text-indent: -25pt;text-align: justify;"><b>2.5  </b>What is the result of ﬁrst performing the Cartesian product of <i>student </i>and <i>advi- sor</i>, and then performing a selection operation on the result with the predicate <i>s id </i>= <span class="s44">ID</span>? (Using the symbolic notation of relational algebra, this query can be written as <span class="s15">σ</span><i>s</i><i> </i><i>id</i><span class="s137">=</span><i>ID</i>(<i>student </i><span class="s15">× </span><i>advisor</i>).)</p><p style="padding-left: 172pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="3" height="0" alt="image" src="Image_251.png"/></span></p><p class="s46" style="padding-top: 4pt;padding-left: 119pt;text-indent: -25pt;text-align: justify;">2.6  <span class="p">Consider the employee database of Figure 2.17. Give an expression in the rela- tional algebra to express each of the following queries:</span></p><p style="padding-top: 9pt;padding-left: 126pt;text-indent: 0pt;text-align: left;">a.  Find the name of each employee who lives in city “Miami”.</p><p style="padding-top: 6pt;padding-left: 126pt;text-indent: 0pt;text-align: left;">b.  Find the name of each employee whose salary is greater than $100000.</p><p style="padding-top: 6pt;padding-left: 145pt;text-indent: -18pt;text-align: left;">c.  Find the name of each employee who lives in “Miami” and whose salary is greater than $100000.</p><p class="s46" style="padding-top: 9pt;padding-left: 119pt;text-indent: -25pt;text-align: justify;">2.7  <span class="p">Consider the bank database of Figure 2.18. Give an expression in the relational algebra for each of the following queries:</span></p><p style="padding-top: 9pt;padding-left: 126pt;text-indent: 0pt;text-align: left;">a. Find the name of each branch located in “Chicago”.</p><p style="padding-top: 6pt;padding-left: 126pt;text-indent: 0pt;text-align: left;">b.  Find the <span class="s44">ID </span>of each borrower who has a loan in branch “Downtown”.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="494" height="1" alt="image" src="Image_252.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_253.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_254.png"/></span></p><p class="s13" style="padding-top: 4pt;padding-left: 179pt;text-indent: 0pt;text-align: left;">branch<span class="p">(</span>branch name<span class="p">, </span>branch city, assets<span class="p">)</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_255.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_256.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_257.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_258.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_259.png"/></span></p><p style="padding-left: 179pt;text-indent: 0pt;text-align: left;"><i>customer </i>(<span class="s69">ID</span>, <i>customer name</i>, <i>customer street, customer city</i>) <i>loan </i>(<i>loan number</i>, <i>branch name, amount</i>)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_260.png"/></span></p><p style="padding-left: 179pt;text-indent: 0pt;text-align: left;"><i>borrower </i>(<span class="s69">ID</span>, <i>loan number</i>)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_261.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_262.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_263.png"/></span></p><p style="padding-left: 179pt;text-indent: 0pt;text-align: left;"><i>account </i>(<i>account number</i>, <i>branch name, balance</i>) <i>depositor </i>(<span class="s69">ID</span>, <i>account number</i>)</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="494" height="1" alt="image" src="Image_264.png"/></span></p><p class="s73" style="padding-top: 8pt;padding-left: 243pt;text-indent: 0pt;text-align: left;">Figure 2.18 <span class="s74">Bank database.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s46" style="padding-left: 150pt;text-indent: -25pt;text-align: justify;">2.8  <span class="p">Consider the employee database of Figure 2.17. Give an expression in the rela- tional algebra to express each of the following queries:</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 157pt;text-indent: 0pt;text-align: left;">a.  Find the <span class="s44">ID </span>and name of each employee who does not work for “BigBank”.</p><p style="padding-top: 6pt;padding-left: 176pt;text-indent: -19pt;text-align: justify;">b.  Find the <span class="s44">ID </span>and name of each employee who earns at least as much as every employee in the database.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 150pt;text-indent: -25pt;line-height: 76%;text-align: justify;"><b>2.9  </b>The <span class="s63">division operator </span>of relational algebra, “<span class="s15">÷</span>”, is deﬁned as follows. Let <i>r</i>(<i>R</i>) and <i>s</i>(<i>S</i>) be relations, and let <i>S </i><span class="s83">⊆ </span><i>R</i>; that is, every attribute of schema <i>S </i>is also in schema <i>R</i>. Given a tuple <i>t</i>, let <i>t</i>[<i>S</i>] denote the projection of tuple <i>t </i>on</p><p class="s13" style="padding-left: 150pt;text-indent: 0pt;text-align: justify;"><span class="p">the attributes in </span>S<span class="p">. Then </span>r <span class="s15">÷ </span>s <span class="p">is a relation on schema </span>R <span class="s15">− </span>S <span class="p">(that is, on the schema containing all attributes of schema </span>R <span class="p">that are not in schema </span>S<span class="p">). A tuple </span>t <span class="p">is in </span>r <span class="s15">÷ </span>s <span class="p">if and only if both of two conditions hold:</span></p><p style="padding-top: 6pt;padding-left: 154pt;text-indent: 0pt;text-align: left;"><span class="s39">• </span><i>t </i>is in <span class="s15">Π</span><i>R</i><span class="s137">−</span><i>S</i>(<i>r</i>)</p><p class="s13" style="padding-top: 1pt;padding-left: 154pt;text-indent: 0pt;text-align: left;"><span class="s39">• </span><span class="s40">For every tuple </span>t<span class="s97">s </span><span class="p">in </span>s<span class="p">, there is a tuple </span>t<span class="s97">r </span><span class="p">in </span>r <span class="p">satisfying both of the following:</span></p><p style="padding-top: 6pt;padding-left: 175pt;text-indent: 0pt;text-align: left;">a. <i>t</i><span class="s97">r </span>[<i>S</i>] <span class="s15">= </span><i>t</i><span class="s97">s</span>[<i>S</i>]</p><p class="s13" style="padding-top: 4pt;padding-left: 175pt;text-indent: 0pt;text-align: left;"><span class="p">b. </span>t<span class="s145">r </span><span class="p">[</span>R <span class="s15">− </span>S<span class="p">] </span><span class="s15">= </span>t</p><p style="padding-top: 10pt;padding-left: 150pt;text-indent: 0pt;text-align: justify;">Given the above deﬁnition:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_265.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_266.png"/></span></p><p style="padding-left: 176pt;text-indent: -18pt;text-align: justify;">a.  Write a relational algebra expression using the division operator to ﬁnd the <span class="s44">ID</span>s of all students who have taken all Comp. Sci. courses. (Hint: project <i>takes </i>to just <span class="s44">ID </span>and <i>course id</i>, and generate the set of all Comp. Sci. <i>course id</i>s using a select expression, before doing the division.)</p><p style="padding-top: 6pt;padding-left: 176pt;text-indent: -19pt;text-align: justify;">b. Show how to write the above query in relational algebra, without using division. (By doing so, you would have shown how to deﬁne the division operation using the other relational algebra operations.)</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part78.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part80.htm">下一个 &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
