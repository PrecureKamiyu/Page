<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>2.3   Keys</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part72.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part74.htm">下一个 &gt;</a></p><p class="s65" style="padding-left: 72pt;text-indent: 0pt;text-align: left;">2.3   <span style=" color: #00AEEF;">Keys</span></p><p style="padding-top: 12pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">We must have a way to specify how tuples within a given relation are distinguished. This is expressed in terms of their attributes. That is, the values of the attribute values of a tuple must be such that they can <i>uniquely identify </i>the tuple. In other words, no two tuples in a relation are allowed to have exactly the same value for all attributes.<span class="s76">1</span></p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">A <span class="s63">superkey </span>is a set of one or more attributes that, taken collectively, allow us to identify uniquely a tuple in the relation. For example, the <span class="s69">ID </span>attribute of the relation <i>instructor </i>is suﬃcient to distinguish one instructor tuple from another. Thus, <span class="s69">ID </span>is a superkey. The <i>name </i>attribute of <i>instructor</i>, on the other hand, is not a superkey, because several instructors might have the same name.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">Formally, let <i>R </i>denote the set of attributes in the schema of relation <i>r</i>. If we say that a subset <i>K </i>of <i>R </i>is a <i>superkey </i>for <i>r</i>, we are restricting consideration to instances of relations <i>r </i>in which no two distinct tuples have the same values on all attributes in <i>K</i>.</p><p class="s13" style="padding-left: 119pt;text-indent: 0pt;line-height: 19pt;text-align: justify;"><span class="p">That is, if </span>t<span class="s93">1 </span><span class="s94">and </span>t<span class="s93">2 </span><span class="s94">are in </span>r <span class="p">and </span>t<span class="s93">1 </span><span class="s86">≠ </span>t<span class="s93">2</span><span class="s94">, then </span>t<span class="s93">1</span><span class="s83">.</span>K <span class="s86">≠ </span>t<span class="s93">2</span><span class="s83">.</span>K<span class="p">.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="96" height="1" alt="image" src="Image_103.png"/></span></p><p class="s77" style="padding-top: 3pt;padding-left: 119pt;text-indent: 0pt;text-align: left;">1<span class="s78">Commercial database systems relax the requirement that a relation is a set and instead allow duplicate tuples. This is discussed further in Chapter 3.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 4pt;padding-left: 88pt;text-indent: 17pt;text-align: justify;">A superkey may contain extraneous attributes. For example, the combination of <span class="s69">ID </span>and <i>name </i>is a superkey for the relation <i>instructor</i>. If <i>K </i>is a superkey, then so is any superset of <i>K</i>. We are often interested in superkeys for which no proper subset is a superkey. Such minimal superkeys are called <span class="s63">candidate keys</span>.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_104.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_105.png"/></span></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">It is possible that several distinct sets of attributes could serve as a candidate key. Suppose that a combination of <i>name </i>and <i>dept name </i>is suﬃcient to distinguish among members of the <i>instructor </i>relation. Then, both <span class="s95">{</span><span class="s69">ID</span><span class="s95">} </span>and <span class="s95">{</span><i>name</i>, <i>dept name</i><span class="s95">} </span>are candidate keys. Although the attributes <span class="s69">ID </span>and <i>name </i>together can distinguish <i>instructor </i>tuples, their combination, <span class="s95">{</span><span class="s69">ID</span>, <i>name</i><span class="s95">}</span>, does not form a candidate key, since the attribute <span class="s69">ID </span>alone is a candidate key.</p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">We shall use the term <span class="s63">primary key </span>to denote a candidate key that is chosen by the database designer as the principal means of identifying tuples within a relation. A key (whether primary, candidate, or super) is a property of the entire relation, rather than of the individual tuples. Any two individual tuples in the relation are prohibited from having the same value on the key attributes at the same time. The designation of a key represents a constraint in the real-world enterprise being modeled. Thus, primary keys are also referred to as <span class="s63">primary key constraints</span>.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_106.png"/></span></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">It is customary to list the primary key attributes of a relation schema before the other attributes; for example, the <i>dept name </i>attribute of <i>department </i>is listed ﬁrst, since it is the primary key. Primary key attributes are also underlined.</p><p style="padding-left: 106pt;text-indent: 0pt;text-align: justify;">Consider the <i>classroom </i>relation:</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_107.png"/></span></p><p style="padding-top: 10pt;padding-bottom: 1pt;padding-left: 64pt;text-indent: 0pt;text-align: center;"><i>classroom </i>(<i>building</i>, <u><i>room number</i></u>, <i>capacity</i>)</p><p style="padding-left: 230pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="46" height="1" alt="image" src="Image_108.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_109.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_110.png"/></span></p><p style="padding-top: 7pt;padding-left: 88pt;text-indent: 0pt;text-align: justify;">Here the primary key consists of two attributes, <i>building </i>and <i>room number</i>, which are underlined to indicate they are part of the primary key. Neither attribute by itself can uniquely identify a classroom, although together they uniquely identify a classroom. Also consider the <i>time slot </i>relation:</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_111.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_112.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_113.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_114.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_115.png"/></span></p><p style="padding-top: 10pt;padding-bottom: 1pt;padding-left: 64pt;text-indent: 0pt;text-align: center;"><i>time slot </i>(<u><i>time slot id</i></u>, <i>day</i>, <u><i>start time</i></u>, <i>end time</i>)</p><p style="padding-left: 270pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="20" height="1" alt="image" src="Image_116.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_117.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_118.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_119.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_120.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_121.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_122.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_123.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_124.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_125.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_126.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_127.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_128.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_129.png"/></span></p><p style="padding-top: 7pt;padding-left: 88pt;text-indent: 0pt;text-align: justify;">Each section has an associated <i>time slot id</i>. The <i>time slot </i>relation provides information on which days of the week, and at what times, a particular <i>time slot id </i>meets. For ex- ample, <i>time slot id </i>&#39;A&#39; may meet from 8.00 <span class="s44">AM </span>to 8.50 <span class="s44">AM </span>on Mondays, Wednesdays, and Fridays. It is possible for a time slot to have multiple sessions within a single day, at diﬀerent times, so the <i>time slot id </i>and <i>day </i>together do not uniquely identify the tuple. The primary key of the <i>time slot </i>relation thus consists of the attributes <i>time slot id</i>, <i>day</i>, and <i>start time</i>, since these three attributes together uniquely identify a time slot for a course.</p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">Primary keys must be chosen with care. As we noted, the name of a person is insuﬃ- cient, because there may be many people with the same name. In the United States, the social security number attribute of a person would be a candidate key. Since non-U.S. residents usually do not have social security numbers, international enterprises must</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 4pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">generate their own unique identiﬁers. An alternative is to use some unique combination of other attributes as a key.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">The primary key should be chosen such that its attribute values are never, or are very rarely, changed. For instance, the address ﬁeld of a person should not be part of the primary key, since it is likely to change. Social security numbers, on the other hand, are guaranteed never to change. Unique identiﬁers generated by enterprises generally do not change, except if two enterprises merge; in such a case the same identiﬁer may have been issued by both enterprises, and a reallocation of identiﬁers may be required to make sure they are unique.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">Figure 2.8 shows the complete set of relations that we use in our sample university schema, with primary-key attributes underlined.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_130.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_131.png"/></span></p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">Next, we consider another type of constraint on the contents of relations, called foreign-key constraints. Consider the attribute <i>dept name </i>of the <i>instructor </i>relation. It would not make sense for a tuple in <i>instructor </i>to have a value for <i>dept name </i>that does not correspond to a department in the <i>department </i>relation. Thus, in any database instance, given any tuple, say <i>t</i><span class="s97">a</span>, from the <i>instructor </i>relation, there must be some tuple, say <i>t</i><span class="s97">b</span>, in</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_132.png"/></span></p><p style="padding-left: 119pt;text-indent: 0pt;line-height: 79%;text-align: justify;">the <i>department </i>relation such that the value of the <i>dept name </i>attribute of <i>t</i><span class="s97">a </span>is the same</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_133.png"/></span></p><p style="padding-left: 119pt;text-indent: 0pt;line-height: 13pt;text-align: justify;">as the value of the primary key, <i>dept name</i>, of <i>t</i><span class="s97">b</span>.</p><p style="padding-left: 137pt;text-indent: 0pt;line-height: 12pt;text-align: justify;">A <span class="s63">foreign-key constraint </span>from attribute(s) <i>A </i>of relation <i>r</i><span class="s98">1</span> to the primary-key <i>B </i>of</p><p style="padding-left: 119pt;text-indent: 0pt;text-align: justify;">relation <i>r</i><span class="s98">2</span> states that on any database instance, the value of <i>A </i>for each tuple in <i>r</i><span class="s98">1</span> must also be the value of <i>B </i>for some tuple in <i>r</i><span class="s98">2</span>. Attribute set <i>A </i>is called a <span class="s63">foreign key </span>from <i>r</i><span class="s98">1</span>, referencing <i>r</i><span class="s98">2</span>. The relation <i>r</i><span class="s98">1</span> is also called the <span class="s63">referencing relation </span>of the foreign-key constraint, and <i>r</i><span class="s98">2</span> is called the <span class="s63">referenced relation</span>.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_134.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_135.png"/></span></p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">For example, the attribute <i>dept name </i>in <i>instructor </i>is a foreign key from <i>instructor</i>, referencing <i>department</i>; note that <i>dept name </i>is the primary key of <i>department</i>. Similarly,</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="494" height="1" alt="image" src="Image_136.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="46" height="1" alt="image" src="Image_137.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_138.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_139.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="59" height="1" alt="image" src="Image_140.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_141.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_142.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_143.png"/></span></p><p style="padding-top: 4pt;padding-left: 146pt;text-indent: 0pt;line-height: 111%;text-align: left;"><i>classroom</i>(<i>building</i>, <u><i>room number</i></u>, <i>capacity</i>) <i>department</i>(<i>dept name</i>, <i>building</i>, <i>budget</i>) <i>course</i>(<u><i>course id</i></u>, <i>title</i>, <i>dept name</i>, <i>credits</i>) <i>instructor</i>(<span class="s99">ID</span>, <i>name</i>, <i>dept name</i>, <i>salary</i>)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_144.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_145.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_146.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_147.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_148.png"/></span></p><p style="padding-bottom: 1pt;padding-left: 146pt;text-indent: 0pt;line-height: 11pt;text-align: left;"><i>section</i>(<u><i>course id</i></u>, <u><i>sec id</i></u>, <u><i>semester</i></u>, <i>year</i>, <i>building</i>, <i>room number</i>, <i>time slot id</i>)</p><p style="padding-left: 292pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="24" height="1" alt="image" src="Image_149.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_150.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_151.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="24" height="1" alt="image" src="Image_152.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_153.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_154.png"/></span></p><p style="padding-left: 146pt;text-indent: 0pt;line-height: 114%;text-align: left;"><i>teaches</i>(<span class="s99">ID</span>, <u><i>course id</i></u>, <u><i>sec id</i></u>, <u><i>semester</i></u>, <i>year</i>) <i>student</i>(<span class="s99">ID</span>, <i>name</i>, <i>dept name</i>, <i>tot cred</i>)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_155.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_156.png"/></span></p><p style="padding-left: 146pt;text-indent: 0pt;line-height: 11pt;text-align: left;"><i>takes</i>(<span class="s99">ID</span>, <u><i>course id</i></u>, <u><i>sec id</i></u>, <u><i>semester</i></u>, <i>year</i>, <i>grade</i>)</p><p style="padding-left: 301pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="24" height="1" alt="image" src="Image_157.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_158.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_159.png"/></span></p><p style="padding-left: 146pt;text-indent: 0pt;text-align: left;"><i>advisor</i>(<u><i>s </i></u><span class="s100">ID</span>, <i>i </i><span class="s101">ID</span>)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_160.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_161.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_162.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="20" height="1" alt="image" src="Image_163.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_164.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_165.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_166.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_167.png"/></span></p><p style="padding-left: 146pt;text-indent: 0pt;line-height: 113%;text-align: left;"><i>time slot</i>(<u><i>time slot id</i></u>, <i>day</i>, <u><i>start time</i></u>, <i>end time</i>) <i>prereq</i>(<u><i>course id</i></u>, <i>prereq id</i>)</p><p style="padding-left: 219pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="48" height="0" alt="image" src="Image_168.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="494" height="1" alt="image" src="Image_169.png"/></span></p><p class="s73" style="padding-top: 8pt;padding-left: 202pt;text-indent: 0pt;text-align: left;">Figure 2.8 <span class="s74">Schema of the university database.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_170.png"/></span></p><p style="padding-top: 4pt;padding-left: 88pt;text-indent: 0pt;text-align: justify;"><a name="bookmark38">the attributes </a><i>building </i>and <i>room number </i>of the <i>section </i>relation together form a foreign key referencing the <i>classroom </i>relation.<a name="bookmark81">&zwnj;</a></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">Note that in a foreign-key constraint, the referenced attribute(s) must be the pri- mary key of the referenced relation. The more general case, a referential-integrity con- straint, relaxes the requirement that the referenced attributes form the primary key of the referenced relation.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_171.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_172.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_173.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_174.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_175.png"/></span></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">As an example, consider the values in the <i>time slot id </i>attribute of the <i>section </i>re- lation. We require that these values must exist in the <i>time slot id </i>attribute of the <i>time slot </i>relation. Such a requirement is an example of a referential integrity constraint. In general, a <span class="s63">referential integrity constraint </span>requires that the values appearing in speciﬁed attributes of any tuple in the referencing relation also appear in speciﬁed attributes of at least one tuple in the referenced relation.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_176.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_177.png"/></span></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">Note that <i>time slot </i>does not form a primary key of the <i>time slot </i>relation, although it is a part of the primary key; thus, we cannot use a foreign-key constraint to enforce the above constraint. In fact, foreign-key constraints are a <i>special case </i>of referential integrity constraints, where the referenced attributes form the primary key of the referenced relation. Database systems today typically support foreign-key constraints, but they do not support referential integrity constraints where the referenced attribute is not a primary key.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part72.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part74.htm">下一个 &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
