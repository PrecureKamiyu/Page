<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>15.4  Sorting</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part282.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part284.htm">下一个 &gt;</a></p><p class="s65" style="padding-top: 4pt;padding-left: 72pt;text-indent: 0pt;text-align: left;"><a name="bookmark327">15.4  </a><span style=" color: #00AEEF;">Sorting</span><a name="bookmark348">&zwnj;</a></p><p style="padding-top: 11pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">Sorting of data plays an important role in database systems for two reasons. First, <span class="s44">SQL </span>queries can specify that the output be sorted. Second, and equally important for query processing, several of the relational operations, such as joins, can be implemented ef- ﬁciently if the input relations are ﬁrst sorted. Thus, we discuss sorting here before discussing the join operation in Section 15.5.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">We can sort a relation by building an index on the sort key and then using that index to read the relation in sorted order. However, such a process orders the relation only <i>logically</i>, through an index, rather than <i>physically</i>. Hence, the reading of tuples in the sorted order may lead to a disk access (disk seek plus block transfer) for each record, which can be very expensive, since the number of records can be much larger than the number of blocks. For this reason, it may be desirable to order the records physically.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">The problem of sorting has been studied extensively, both for relations that ﬁt entirely in main memory and for relations that are bigger than memory. In the ﬁrst case, standard sorting techniques such as quick-sort can be used. Here, we discuss how to handle the second case.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s68" style="padding-left: 119pt;text-indent: 0pt;text-align: left;">15.4.1 External Sort-Merge Algorithm</p><p style="padding-top: 6pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">Sorting of relations that do not ﬁt in memory is called <span class="s63">external sorting</span>. The most com- monly used technique for external sorting is the <span class="s63">external sort–merge </span>algorithm. We describe the external sort–merge algorithm next. Let <i>M </i>denote the number of blocks in the main memory buﬀer available for sorting, that is, the number of disk blocks whose contents can be buﬀered in available main memory.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s63" style="padding-left: 145pt;text-indent: -16pt;text-align: justify;">1. <span class="p">In the ﬁrst stage, a number of sorted </span>runs <span class="p">are created; each run is sorted but contains only some of the records of the relation.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="padding-left: 186pt;text-indent: 0pt;text-align: left;">i <span class="p">= 0;</span></p><p class="s46" style="padding-left: 186pt;text-indent: 0pt;text-align: left;">repeat</p><p style="padding-left: 228pt;text-indent: -21pt;text-align: left;">read <i>M </i>blocks of the relation, or the rest of the relation, whichever is smaller;</p><p style="padding-left: 207pt;text-indent: 0pt;text-align: left;">sort the in-memory part of the relation; write the sorted data to run ﬁle <i>R</i><span class="s145">i</span>;</p><p class="s13" style="padding-left: 207pt;text-indent: 0pt;line-height: 11pt;text-align: left;">i <span class="s15">= </span>i <span class="p">+ 1;</span></p><p class="s46" style="padding-left: 186pt;text-indent: 0pt;text-align: left;">until <span class="p">the end of the relation</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 145pt;text-indent: -17pt;text-align: justify;"><span class="s63">2. </span>In the second stage, the runs are <i>merged</i>. Suppose, for now, that the total number of runs, <i>N</i>, is less than <i>M</i>, so that we can allocate one block to each run and have space left to hold one block of output. The merge stage operates as follows:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 4pt;padding-left: 134pt;text-indent: 0pt;line-height: 14pt;text-align: left;">read one block of each of the <i>N </i>ﬁles <i>R</i><span class="s97">i </span>into a buﬀer block in memory;</p><p class="s46" style="padding-left: 134pt;text-indent: 0pt;line-height: 12pt;text-align: left;">repeat</p><p style="padding-left: 155pt;text-indent: 0pt;text-align: left;">choose the ﬁrst tuple (in sort order) among all buﬀer blocks; write the tuple to the output, and delete it from the buﬀer block; <b>if </b>the buﬀer block of any run <i>R</i><span class="s145">i </span>is empty <b>and not </b>end-of-ﬁle(<i>R</i><span class="s145">i</span>)</p><p style="padding-left: 176pt;text-indent: 0pt;line-height: 12pt;text-align: left;"><b>then </b>read the next block of <i>R</i><span class="s145">i </span>into the buﬀer block;</p><p class="s46" style="padding-left: 134pt;text-indent: 0pt;line-height: 12pt;text-align: left;">until <span class="p">all input buﬀer blocks are empty</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">The output of the merge stage is the sorted relation. The output ﬁle is buﬀered to reduce the number of disk write operations. The preceding merge operation is a gener- alization of the two-way merge used by the standard in-memory sort–merge algorithm; it merges <i>N </i>runs, so it is called an <span class="s63">N-way merge</span>.</p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">In general, if the relation is much larger than memory, there may be <i>M </i>or more runs generated in the ﬁrst stage, and it is not possible to allocate a block for each run during the merge stage. In this case, the merge operation proceeds in multiple passes. Since there is enough memory for <i>M </i><span class="s15">−</span>1 input buﬀer blocks, each merge can take <i>M </i><span class="s15">−</span>1 runs as input.</p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">The initial <i>pass </i>functions in this way: It merges the ﬁrst <i>M </i><span class="s15">− </span>1 runs (as described in item 2 above) to get a single run for the next pass. Then, it merges the next <i>M </i><span class="s15">− </span>1 runs similarly, and so on, until it has processed all the initial runs. At this point, the number of runs has been reduced by a factor of <i>M </i><span class="s15">− </span>1. If this reduced number of runs is still greater than or equal to <i>M </i>, another pass is made, with the runs created by the ﬁrst pass as input. Each pass reduces the number of runs by a factor of <i>M </i><span class="s15">− </span>1. The passes repeat as many times as required, until the number of runs is less than <i>M </i>; a ﬁnal pass then generates the sorted output.</p><p style="padding-left: 88pt;text-indent: 17pt;line-height: 13pt;text-align: justify;">Figure 15.4 illustrates the steps of the external sort–merge for an example relation. For illustration purposes, we assume that only one tuple ﬁts in a block (<i>f</i><span class="s97">r </span><span class="s15">= </span>1), and we assume that memory holds at most three blocks. During the merge stage, two blocks are used for input and one for output.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s68" style="padding-left: 88pt;text-indent: 0pt;text-align: left;">15.4.2 Cost Analysis of External Sort-Merge</p><p class="s15" style="text-indent: 0pt;text-align: left;">∕<span class="s13">M</span></p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-top: 6pt;padding-left: 88pt;text-indent: 0pt;line-height: 94%;text-align: justify;">We compute the disk-access cost for the external sort–merge in this way: Let <i>b</i><span class="s97">r </span>denote the number of blocks containing records of relation <i>r</i>. The ﬁrst stage reads every block of the relation and writes them out again, giving a total of 2<i>b</i><span class="s145">r </span>block</p><p style="text-indent: 0pt;text-align: left;">each run one block at a time leads to a large number of seeks; to reduce the number of seeks, a larger number of blocks, denoted <i>b</i><span class="s97">b</span>, are read or written at a time, requiring <i>b</i><span class="s97">b</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s15" style="padding-left: 59pt;text-indent: 0pt;line-height: 13pt;text-align: center;"><span class="p">transfers. The initial number of runs is </span>⌈<span class="s13">b</span><span class="s145">r  </span>⌉<span class="p">. During the merge pass, reading in</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s15" style="text-indent: 0pt;text-align: left;">⌋</p><p style="text-indent: 0pt;text-align: left;"/><p class="s15" style="padding-top: 12pt;padding-left: 119pt;text-indent: 0pt;line-height: 8pt;text-align: right;">∕<span class="s13">b</span><span class="s97">b </span>−<span class="p">1</span></p><p style="padding-left: 23pt;text-indent: 0pt;line-height: 5pt;text-align: center;">buﬀer blocks to be allocated to each input run and to the output run. Then, <span class="s15">⌊</span><i>M</i></p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;">runs can be merged in each merge pass, decreasing the number of runs by a factor of</p><p style="padding-left: 88pt;text-indent: 0pt;text-align: left;"/><p class="s118" style="text-indent: 0pt;text-align: left;">∕<span class="s109">b </span>−<span class="s119">1</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s15" style="text-indent: 0pt;text-align: left;">∕<span class="s13">b</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s15" style="text-indent: 0pt;text-align: left;">− <span class="p">1. The total number of merge passes required is</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s15" style="text-indent: 0pt;text-align: left;">log</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="text-indent: 0pt;text-align: left;"><span class="p">(</span>b <span class="s15">∕</span>M <span class="p">)</span></p><p style="text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;line-height: 12pt;text-align: left;">. Each</p><p style="text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;">of these passes reads every block of the relation once and writes it out once, with two exceptions. First, the ﬁnal pass can produce the sorted output without writing its result</p><p style="text-indent: 0pt;text-align: left;"/><p class="s15" style="padding-left: 119pt;text-indent: 0pt;line-height: 15pt;text-align: right;">⌊<span class="s13">M </span><span class="s97">b</span>⌋</p><p class="s109" style="padding-left: 88pt;text-indent: 0pt;line-height: 16pt;text-align: left;"><span class="s117">⌈  </span><span class="s370">⌊</span>M  <span class="s144">b</span><span class="s118">⌋   </span>r   <span class="s117">⌉</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="40" height="74" alt="image" src="Image_2764.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="40" height="74" alt="image" src="Image_2765.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="53" height="148" alt="image" src="Image_2766.png"/></span></p><table style="border-collapse:collapse" cellspacing="0"><tr style="height:16pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">a</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">19</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 4pt;text-indent: 0pt;line-height: 11pt;text-align: left;">d</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 2pt;text-indent: 0pt;line-height: 11pt;text-align: left;">31</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 4pt;text-indent: 0pt;line-height: 12pt;text-align: left;">g</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 2pt;text-indent: 0pt;line-height: 12pt;text-align: left;">24</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><table style="border-collapse:collapse" cellspacing="0"><tr style="height:16pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 4pt;text-indent: 0pt;text-align: right;">a</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="text-indent: 0pt;text-align: center;">19</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 4pt;text-indent: 0pt;line-height: 11pt;text-align: right;">b</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="text-indent: 0pt;line-height: 11pt;text-align: center;">14</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 4pt;text-indent: 0pt;line-height: 12pt;text-align: right;">c</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="text-indent: 0pt;line-height: 12pt;text-align: center;">33</p></td></tr><tr style="height:14pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 4pt;text-indent: 0pt;line-height: 12pt;text-align: right;">d</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="text-indent: 0pt;line-height: 12pt;text-align: center;">31</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;padding-right: 4pt;text-indent: 0pt;text-align: right;">e</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">16</p></td></tr><tr style="height:16pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;padding-right: 4pt;text-indent: 0pt;text-align: right;">g</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: center;">24</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><table style="border-collapse:collapse" cellspacing="0"><tr style="height:16pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">g</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;padding-right: 3pt;text-indent: 0pt;text-align: right;">24</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 3pt;text-indent: 0pt;line-height: 11pt;text-align: left;">a</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 4pt;text-indent: 0pt;text-align: right;">19</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 3pt;text-indent: 0pt;line-height: 12pt;text-align: left;">d</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 3pt;text-indent: 0pt;line-height: 12pt;text-align: right;">31</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 3pt;text-indent: 0pt;line-height: 12pt;text-align: left;">c</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 3pt;text-indent: 0pt;line-height: 12pt;text-align: right;">33</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">b</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 4pt;text-indent: 0pt;text-align: right;">14</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">e</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 4pt;text-indent: 0pt;text-align: right;">16</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">r</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 4pt;text-indent: 0pt;text-align: right;">16</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">d</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 3pt;text-indent: 0pt;text-align: right;">21</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">m</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;padding-right: 4pt;text-indent: 0pt;text-align: right;">3</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">p</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;padding-right: 4pt;text-indent: 0pt;text-align: right;">2</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">d</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;padding-right: 4pt;text-indent: 0pt;text-align: right;">7</p></td></tr><tr style="height:16pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">a</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;padding-right: 4pt;text-indent: 0pt;text-align: right;">14</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><table style="border-collapse:collapse" cellspacing="0"><tr style="height:16pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="text-indent: 0pt;text-align: center;">a</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 2pt;text-indent: 0pt;text-align: right;">14</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="text-indent: 0pt;line-height: 11pt;text-align: center;">a</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 2pt;text-indent: 0pt;line-height: 11pt;text-align: right;">19</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="text-indent: 0pt;line-height: 12pt;text-align: center;">b</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 2pt;text-indent: 0pt;line-height: 12pt;text-align: right;">14</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="text-indent: 0pt;line-height: 12pt;text-align: center;">c</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 2pt;text-indent: 0pt;line-height: 12pt;text-align: right;">33</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="text-indent: 0pt;text-align: center;">d</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 2pt;text-indent: 0pt;text-align: right;">7</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="text-indent: 0pt;text-align: center;">d</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 1pt;text-indent: 0pt;text-align: right;">21</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="text-indent: 0pt;text-align: center;">d</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 2pt;text-indent: 0pt;text-align: right;">31</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="text-indent: 0pt;text-align: center;">e</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 2pt;text-indent: 0pt;text-align: right;">16</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">g</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;padding-right: 1pt;text-indent: 0pt;text-align: right;">24</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;padding-left: 3pt;text-indent: 0pt;text-align: center;">m</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;padding-right: 2pt;text-indent: 0pt;text-align: right;">3</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">p</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;padding-right: 2pt;text-indent: 0pt;text-align: right;">2</p></td></tr><tr style="height:16pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">r</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;padding-right: 2pt;text-indent: 0pt;text-align: right;">16</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><table style="border-collapse:collapse" cellspacing="0"><tr style="height:16pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">b</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 2pt;text-indent: 0pt;text-align: left;">14</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 4pt;text-indent: 0pt;line-height: 11pt;text-align: left;">c</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 2pt;text-indent: 0pt;line-height: 11pt;text-align: left;">33</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 4pt;text-indent: 0pt;line-height: 12pt;text-align: left;">e</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 2pt;text-indent: 0pt;line-height: 12pt;text-align: left;">16</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><table style="border-collapse:collapse" cellspacing="0"><tr style="height:16pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="text-indent: 0pt;text-align: center;">d</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 2pt;text-indent: 0pt;text-align: right;">21</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 1pt;text-indent: 0pt;line-height: 11pt;text-align: center;">m</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 3pt;text-indent: 0pt;line-height: 11pt;text-align: right;">3</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 2pt;text-indent: 0pt;line-height: 12pt;text-align: center;">r</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 3pt;text-indent: 0pt;line-height: 12pt;text-align: right;">16</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><p class="s185" style="padding-top: 4pt;padding-left: 195pt;text-indent: 4pt;line-height: 89%;text-align: left;">initial relation</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s185" style="padding-left: 5pt;text-indent: -2pt;line-height: 89%;text-align: left;">create runs</p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse" cellspacing="0"><tr style="height:16pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">a</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 2pt;text-indent: 0pt;text-align: center;">14</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">d</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 4pt;text-indent: 0pt;line-height: 11pt;text-align: center;">7</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">d</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="text-indent: 0pt;line-height: 12pt;text-align: center;">21</p></td></tr><tr style="height:14pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">m</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 4pt;text-indent: 0pt;line-height: 12pt;text-align: center;">3</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">p</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;padding-left: 4pt;text-indent: 0pt;text-align: center;">2</p></td></tr><tr style="height:16pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">r</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-top: 1pt;padding-right: 2pt;text-indent: 0pt;text-align: center;">16</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><table style="border-collapse:collapse" cellspacing="0"><tr style="height:16pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">a</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 3pt;text-indent: 0pt;text-align: right;">14</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 4pt;text-indent: 0pt;line-height: 11pt;text-align: left;">d</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 4pt;text-indent: 0pt;line-height: 11pt;text-align: right;">7</p></td></tr><tr style="height:15pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-left: 4pt;text-indent: 0pt;line-height: 12pt;text-align: left;">p</p></td><td style="width:16pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#C7EAFB"><p class="s373" style="padding-right: 4pt;text-indent: 0pt;line-height: 12pt;text-align: right;">2</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><p class="s185" style="padding-left: 44pt;text-indent: 0pt;line-height: 11pt;text-align: center;">runs     runs</p><p class="s185" style="padding-left: 27pt;text-indent: 0pt;line-height: 89%;text-align: center;">merge pass–1</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s185" style="padding-left: 12pt;text-indent: 0pt;line-height: 89%;text-align: left;">merge pass–2</p><p class="s185" style="padding-top: 5pt;text-indent: 0pt;line-height: 89%;text-align: left;">sorted output</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s73" style="padding-top: 4pt;padding-left: 84pt;text-indent: 0pt;text-align: center;">Figure 15.4 <span class="s74">External sorting using sort–merge.</span></p><p style="padding-top: 8pt;padding-left: 84pt;text-indent: 0pt;line-height: 12pt;text-align: center;">to disk. Second, there may be runs that are not read in or written out during a pass</p><p class="s15" style="text-indent: 0pt;text-align: left;">⌋</p><p style="text-indent: 0pt;text-align: left;"/><p class="s15" style="text-indent: 0pt;text-align: left;">⌋</p><p style="text-indent: 0pt;text-align: left;"/><p class="s15" style="padding-left: 249pt;text-indent: 0pt;line-height: 7pt;text-align: left;">∕<span class="s13">b</span><span class="s145">b </span><span class="p">runs to be merged in a pass, </span>⌊<span class="s13">M </span>∕<span class="s13">b</span><span class="s145">b </span>− <span class="p">1 are read</span></p><p style="padding-left: 119pt;text-indent: 0pt;line-height: 6pt;text-align: left;">— for example, if there are <span class="s15">⌊</span><i>M</i></p><p class="s118" style="text-indent: 0pt;text-align: left;">∕<span class="s109">b </span>−<span class="s119">1</span></p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-left: 119pt;text-indent: 0pt;text-align: justify;">in and merged, and one run is not accessed during the pass. Ignoring the (relatively small) savings due to the latter eﬀect, the total number of block transfers for external sorting of the relation is:</p><p class="s15" style="padding-top: 1pt;padding-left: 119pt;text-indent: 0pt;line-height: 0pt;text-align: right;">log</p><p class="s13" style="padding-top: 1pt;padding-left: 32pt;text-indent: 0pt;line-height: 0pt;text-align: left;"><span class="p">(</span>b <span class="s15">∕</span>M <span class="p">)</span></p><p class="s15" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 0pt;text-align: left;">+ <span class="p">1)</span></p><p class="s13" style="padding-left: 119pt;text-indent: 0pt;text-align: right;">b<span class="s97">r </span><span class="p">(2</span><span class="s15">⌈</span></p><p class="s118" style="padding-left: 12pt;text-indent: 0pt;line-height: 17pt;text-align: left;">⌊<span class="s109">M </span><span class="s144">b</span>⌋   <span class="s109">r   </span><span class="s117">⌉</span></p><p style="padding-top: 5pt;padding-left: 119pt;text-indent: 0pt;line-height: 93%;text-align: justify;">Applying this equation to the example in Figure 15.4, with <i>b</i><span class="s97">b </span>set to 1, we get a total of 12 <span class="s15">∗ </span>(4 <span class="s15">+ </span>1) <span class="s15">= </span>60 block transfers, as you can verify from the ﬁgure. Note that these above numbers do not include the cost of writing out the ﬁnal result.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">We also need to add the disk-seek costs. Run generation requires seeks for reading data for each of the runs as well as for writing the runs. Each merge pass requires</p><p style="padding-left: 119pt;text-indent: 0pt;line-height: 0pt;text-align: left;">around <i>b </i><span class="s15">∕</span><i>b </i>seeks for reading data.<span class="s76">6</span> Although the output is written sequentially, if</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;">it is on the same disk as the input runs, the head may have moved away between writes</p><p style="text-indent: 0pt;text-align: left;"/><p class="s123" style="padding-left: 153pt;text-indent: 0pt;text-align: left;"><span class="s15">⌈ </span>r<span class="s13"> </span>b<span class="s15">⌉</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s15" style="text-indent: 0pt;text-align: left;">⌉</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-top: 5pt;padding-left: 119pt;text-indent: 0pt;text-align: left;">of consecutive blocks. Thus we would have to add a total of 2<span class="s15">⌈</span><i>b</i><span class="s97">r</span></p><p class="s15" style="padding-top: 5pt;text-indent: 0pt;text-align: left;">∕<span class="s13">b</span><span class="s97">b</span></p><p style="padding-top: 5pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">seeks for each</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="96" height="1" alt="image" src="Image_2767.png"/></span></p><p style="text-indent: 0pt;text-align: left;">merge pass, except the ﬁnal pass (since we assume the ﬁnal result is not written back to disk).</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="padding-top: 4pt;padding-left: 119pt;text-indent: 0pt;line-height: 88%;text-align: left;">6<span class="s78">To be more precise, since we read each run separately and may get fewer than </span><span class="s111">b</span><i>b </i><span class="s80">blocks when reading the end of a run, we may require an extra seek for each run. We ignore this detail for simplicity.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s15" style="padding-top: 5pt;padding-left: 119pt;text-indent: 0pt;line-height: 0pt;text-align: right;"><a name="bookmark328">∕</a><span class="s13">M </span>+<a name="bookmark349">&zwnj;</a></p><p class="s13" style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;line-height: 0pt;text-align: left;">b <span class="s15">∕</span>b</p><p style="padding-top: 5pt;padding-left: 7pt;text-indent: 0pt;line-height: 0pt;text-align: left;">(2 <span class="s15">log</span></p><p class="s13" style="padding-top: 5pt;padding-left: 32pt;text-indent: 0pt;line-height: 0pt;text-align: left;"><span class="p">(</span>b <span class="s15">∕</span>M <span class="p">)</span></p><p class="s15" style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;line-height: 0pt;text-align: left;">− <span class="p">1)</span></p><p style="padding-left: 119pt;text-indent: 0pt;text-align: right;">2<span class="s15">⌈</span><i>b</i><span class="s97">r</span></p><p class="s15" style="padding-left: 14pt;text-indent: 0pt;text-align: left;">⌉  ⌈ <span class="s123">r</span></p><p class="s123" style="padding-left: 9pt;text-indent: 0pt;text-align: left;">b<span class="s15">⌉ ⌈</span></p><p class="s118" style="padding-left: 12pt;text-indent: 0pt;line-height: 16pt;text-align: left;">⌊<span class="s109">M </span><span class="s144">b</span>⌋   <span class="s109">r   </span><span class="s117">⌉</span></p><p class="s118" style="text-indent: 0pt;text-align: left;">∕<span class="s109">b </span>−<span class="s119">1</span></p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-top: 4pt;padding-left: 88pt;text-indent: 0pt;text-align: justify;">Applying this equation to the example in Figure 15.4, we get a total of 8 <span class="s15">+ </span>12 <span class="s15">∗ </span>(2 <span class="s15">∗</span></p><p style="padding-left: 88pt;text-indent: 0pt;text-align: justify;">2 <span class="s15">− </span>1) <span class="s15">= </span>44 disk seeks if we set the number of buﬀer blocks per run <i>b</i><span class="s97">b </span>to 1.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part282.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part284.htm">下一个 &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
