<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>42.4 Solution #3: Other Approaches</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part474.htm">&lt; 上一个</a><span> | </span><a href="../ostep.html">内容</a><span> | </span><a href="part476.htm">下一个 &gt;</a></p><p class="s40" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">42.4 Solution #3: Other Approaches</p><p style="padding-top: 7pt;padding-left: 41pt;text-indent: 11pt;line-height: 89%;text-align: justify;">We’ve thus far described two options in keeping file system metadata consistent: a lazy approach based on <span class="s41">fsck</span>, and a more active approach known as journaling. However, these are not the only two approaches. One such approach, known as Soft Updates [GP94], was introduced by Ganger and Patt. This approach carefully orders all writes to the file sys- tem to ensure that the on-disk structures are never left in an inconsis- tent state. For example, by writing a pointed-to data block to disk <i>before </i>the inode that points to it, we can ensure that the inode never points to garbage; similar rules can be derived for all the structures of the file sys- tem. Implementing Soft Updates can be a challenge, however; whereas the journaling layer described above can be implemented with relatively little knowledge of the exact file system structures, Soft Updates requires intricate knowledge of each file system data structure and thus adds a fair amount of complexity to the system.</p><p style="padding-left: 41pt;text-indent: 11pt;line-height: 89%;text-align: justify;">Another approach is known as <b>copy-on-write </b>(yes, <b>COW</b>), and is used in a number of popular file systems, including Sun’s ZFS [B07]. This tech- nique never overwrites files or directories in place; rather, it places new updates to previously unused locations on disk. After a number of up- dates are completed, COW file systems flip the root structure of the file system to include pointers to the newly updated structures. Doing so makes keeping the file system consistent straightforward. We’ll be learn- ing more about this technique when we discuss the log-structured file system (LFS) in a future chapter; LFS is an early example of a COW.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 68pt;text-indent: 12pt;line-height: 89%;text-align: justify;">Another approach is one we just developed here at Wisconsin. In this technique, entitled <b>backpointer-based consistency </b>(or <b>BBC</b>), no ordering is enforced between writes. To achieve consistency, an additional <b>back pointer </b>is added to every block in the system; for example, each data block has a reference to the inode to which it belongs. When accessing a file, the file system can determine if the file is consistent by checking if the forward pointer (e.g., the address in the inode or direct block) points to a block that refers back to it. If so, everything must have safely reached disk and thus the file is consistent; if not, the file is inconsistent, and an error is returned. By adding back pointers to the file system, a new form of lazy crash consistency can be attained [C+12].</p><p style="padding-left: 68pt;text-indent: 12pt;line-height: 89%;text-align: justify;">Finally, we also have explored techniques to reduce the number of times a journal protocol has to wait for disk writes to complete. Entitled <b>optimistic crash consistency </b>[C+13], this new approach issues as many writes to disk as possible and uses a generalized form of the <b>transaction checksum </b>[P+05], as well as a few other techniques, to detect inconsisten- cies should they arise. For some workloads, these optimistic techniques can improve performance by an order of magnitude. However, to truly function well, a slightly different disk interface is required [C+13].</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part474.htm">&lt; 上一个</a><span> | </span><a href="../ostep.html">内容</a><span> | </span><a href="part476.htm">下一个 &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
