<?xml version='1.0' encoding='utf-8'?>
<html xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:svg="http://www.w3.org/2000/svg" xmlns:epub="http://www.idpf.org/2007/ops" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" epub:prefix="index: http://www.index.com/">
  <head>
    <meta name="dcterms.conformsTo" content="PXE Basic 1.0"/>
    <meta name="generator" content="PXE Tools version 1.39.52"/>
    <!--Created by pxe.pl for standard version PXE Basic 1.0,data-profile-product=standard by PXE Tools 1.39.52, partial=false-->
    <title>3.4 Accessing Information</title>
    <link rel="alternate stylesheet" type="text/css" title="night" href="../css/theme/night.css"/>
    <link rel="alternate stylesheet" type="text/css" title="sepia" href="../css/theme/sepia.css"/>
    <script src="js/format_lg_obj.js"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="../../stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="../../page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body epub:type="bodymatter" class="calibre pcalibre pcalibre1">
<section id="P7000497027000000000000000001F3C" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title pcalibre1" id="P7000497027000000000000000040198" data-uri="chapter03.xhtml#P7000497027000000000000000040198" epub:type="title"><span class="pcalibre label pcalibre1">3.4 </span>Accessing Information</h1></header>
<p id="P7000497027000000000000000040199" data-uri="chapter03.xhtml#P7000497027000000000000000040199" class="pcalibre1 pcalibre calibre2">An x86-64 central processing unit (CPU) contains a set of 16 <i class="calibre5 pcalibre pcalibre1">general-purpose registers</i> storing 64-bit values. These registers are used to store integer data as well as pointers. <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000001F4C"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">3.2</span></a> diagrams the 16 registers. Their names all begin with <code id="P700049702700000000000000004019A" data-uri="chapter03.xhtml#P700049702700000000000000004019A" class="pcalibre1 calibre8 pcalibre">%r</code>, but otherwise follow multiple different naming conventions, owing to the historical evolution of the instruction set. The original 8086 had eight 16-bit registers, shown in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000001F4C"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">3.2</span></a> as registers <code id="P700049702700000000000000004019B" data-uri="chapter03.xhtml#P700049702700000000000000004019B" class="pcalibre1 calibre8 pcalibre">%ax</code> through <code id="P700049702700000000000000004019C" data-uri="chapter03.xhtml#P700049702700000000000000004019C" class="pcalibre1 calibre8 pcalibre">%bp</code>. Each had a specific purpose, and hence they were given names that reflected how they were to be used. With the extension to IA32, these registers were expanded to 32-bit registers, labeled <code id="P700049702700000000000000004019D" data-uri="chapter03.xhtml#P700049702700000000000000004019D" class="pcalibre1 calibre8 pcalibre">%eax</code> through <code id="P700049702700000000000000004019E" data-uri="chapter03.xhtml#P700049702700000000000000004019E" class="pcalibre1 calibre8 pcalibre">%ebp</code>. In the extension to x86-64, the original eight registers were expanded to 64 bits, labeled <code id="P700049702700000000000000004019F" data-uri="chapter03.xhtml#P700049702700000000000000004019F" class="pcalibre1 calibre8 pcalibre">%rax</code> through <code id="P70004970270000000000000000401A0" data-uri="chapter03.xhtml#P70004970270000000000000000401A0" class="pcalibre1 calibre8 pcalibre">%rbp</code>. In addition, eight new registers were added, and these were given labels according to a new naming convention: <code id="P70004970270000000000000000401A1" data-uri="chapter03.xhtml#P70004970270000000000000000401A1" class="pcalibre1 calibre8 pcalibre">%r8</code> through <code id="P70004970270000000000000000401A2" data-uri="chapter03.xhtml#P70004970270000000000000000401A2" class="pcalibre1 calibre8 pcalibre">%r15</code>.</p>
<p id="P70004970270000000000000000401A3" data-uri="chapter03.xhtml#P70004970270000000000000000401A3" class="pcalibre1 pcalibre calibre2">As the nested boxes in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000001F4C"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">3.2</span></a> indicate, instructions can operate on data of different sizes stored in the low-order bytes of the 16 registers. Byte-level operations can access the least significant byte, 16-bit operations can access the least significant 2 bytes, 32-bit operations can access the least significant 4 bytes, and 64-bit operations can access entire registers.</p>
<p id="P70004970270000000000000000401A4" data-uri="chapter03.xhtml#P70004970270000000000000000401A4" class="pcalibre1 pcalibre calibre2">In later sections, we will present a number of instructions for copying and generating 1-, 2-, 4-, and 8-byte values. When these instructions have registers as destinations, two conventions arise for what happens to the remaining bytes in the register for instructions that generate less than 8 bytes: Those that generate 1-or 2-byte quantities leave the remaining bytes unchanged. Those that generate 4-byte quantities set the upper 4 bytes of the register to zero. The latter convention was adopted as part of the expansion from IA32 to x86-64.</p>
<p id="P70004970270000000000000000401A5" data-uri="chapter03.xhtml#P70004970270000000000000000401A5" class="pcalibre1 pcalibre calibre2">As the annotations along the right-hand side of <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000001F4C"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">3.2</span></a> indicate, different registers serve different roles in typical programs. Most unique among them is the stack pointer, <code id="P70004970270000000000000000401A6" data-uri="chapter03.xhtml#P70004970270000000000000000401A6" class="pcalibre1 calibre8 pcalibre">%rsp</code>, used to indicate the end position in the run-time stack. Some instructions specifically read and write this register. The other 15 registers have more flexibility in their uses. A small number of instructions make specific use of certain registers. More importantly, a set of standard programming conventions governs how the registers are to be used for managing the stack, passing function</p>
<figure id="P7000497027000000000000000001F4C" class="pcalibre5 figure pcalibre" data-uri="chapter03.xhtml#P7000497027000000000000000001F4C">
<span class="pcalibre pagebreak pcalibre1" id="P7000497027000000000000000001F4D" title="180" data-uri="chapter03.xhtml#P7000497027000000000000000001F4D" epub:type="pagebreak"></span>
<img alt="A diagram lists 16 integer registers." id="P70004970270000000000000000401A7" data-uri="P700049702700000000000000000B6B1" src="../images/p180-1.png" class="calibre84 pcalibre pcalibre1"/>
<figcaption id="P70004970270000000000000000401A8" data-uri="chapter03.xhtml#P70004970270000000000000000401A8" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P70004970270000000000000000401A9" data-uri="chapter03.xhtml#P70004970270000000000000000401A9" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">3.2 </span>Integer registers.</h1></header><div class="edition pcalibre pcalibre1" id="P70004970270000000000000000401AA" data-uri="chapter03.xhtml#P70004970270000000000000000401AA"><p id="P70004970270000000000000000401AB" data-uri="chapter03.xhtml#P70004970270000000000000000401AB" class="pcalibre calibre3 pcalibre1">The low-order portions of all 16 registers can be accessed as byte, word (16-bit), double word (32-bit), and quad word (64-bit) quantities.</p></div>
<details class="longdesc pcalibre pcalibre1" id="P7000497027000000000000000020490" data-uri="chapter03.xhtml#P7000497027000000000000000020490">
<summary class="pcalibre6 pcalibre1 pcalibre calibre30"><span class="number pcalibre pcalibre1">Description</span></summary>
<p id="P70004970270000000000000000401AC" data-uri="chapter03.xhtml#P70004970270000000000000000401AC" class="pcalibre1 pcalibre calibre2">A diagram lists 16 registers, each with concentric values within 63, 31, 16, and 7, as summarized in the following table.</p>
<table class="pcalibre largetable pcalibre1" id="P70004970270000000000000000401AD" data-uri="chapter03.xhtml#P70004970270000000000000000401AD">
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000401AE" data-uri="chapter03.xhtml#P70004970270000000000000000401AE" class="calibre20 pcalibre pcalibre1">Register</td>
<td id="P70004970270000000000000000401AF" data-uri="chapter03.xhtml#P70004970270000000000000000401AF" class="calibre20 pcalibre pcalibre1">7</td>
<td id="P70004970270000000000000000401B0" data-uri="chapter03.xhtml#P70004970270000000000000000401B0" class="calibre20 pcalibre pcalibre1">16</td>
<td id="P70004970270000000000000000401B1" data-uri="chapter03.xhtml#P70004970270000000000000000401B1" class="calibre20 pcalibre pcalibre1">31</td>
<td id="P70004970270000000000000000401B2" data-uri="chapter03.xhtml#P70004970270000000000000000401B2" class="calibre20 pcalibre pcalibre1">63</td></tr><tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000401B3" data-uri="chapter03.xhtml#P70004970270000000000000000401B3" class="calibre20 pcalibre pcalibre1">Return value</td>
<td id="P70004970270000000000000000401B4" data-uri="chapter03.xhtml#P70004970270000000000000000401B4" class="calibre20 pcalibre pcalibre1">%al</td>
<td id="P70004970270000000000000000401B5" data-uri="chapter03.xhtml#P70004970270000000000000000401B5" class="calibre20 pcalibre pcalibre1">%ax</td>
<td id="P70004970270000000000000000401B6" data-uri="chapter03.xhtml#P70004970270000000000000000401B6" class="calibre20 pcalibre pcalibre1">%eax</td>
<td id="P70004970270000000000000000401B7" data-uri="chapter03.xhtml#P70004970270000000000000000401B7" class="calibre20 pcalibre pcalibre1">%rax</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000401B8" data-uri="chapter03.xhtml#P70004970270000000000000000401B8" class="calibre20 pcalibre pcalibre1">Callee saved</td>
<td id="P70004970270000000000000000401B9" data-uri="chapter03.xhtml#P70004970270000000000000000401B9" class="calibre20 pcalibre pcalibre1">%bl</td>
<td id="P70004970270000000000000000401BA" data-uri="chapter03.xhtml#P70004970270000000000000000401BA" class="calibre20 pcalibre pcalibre1">%bx</td>
<td id="P70004970270000000000000000401BB" data-uri="chapter03.xhtml#P70004970270000000000000000401BB" class="calibre20 pcalibre pcalibre1">%ebx</td>
<td id="P70004970270000000000000000401BC" data-uri="chapter03.xhtml#P70004970270000000000000000401BC" class="calibre20 pcalibre pcalibre1">%rbx</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000401BD" data-uri="chapter03.xhtml#P70004970270000000000000000401BD" class="calibre20 pcalibre pcalibre1">4th argument</td>
<td id="P70004970270000000000000000401BE" data-uri="chapter03.xhtml#P70004970270000000000000000401BE" class="calibre20 pcalibre pcalibre1">%cl</td>
<td id="P70004970270000000000000000401BF" data-uri="chapter03.xhtml#P70004970270000000000000000401BF" class="calibre20 pcalibre pcalibre1">%cx</td>
<td id="P70004970270000000000000000401C0" data-uri="chapter03.xhtml#P70004970270000000000000000401C0" class="calibre20 pcalibre pcalibre1">%ecx</td>
<td id="P70004970270000000000000000401C1" data-uri="chapter03.xhtml#P70004970270000000000000000401C1" class="calibre20 pcalibre pcalibre1">%rcx</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000401C2" data-uri="chapter03.xhtml#P70004970270000000000000000401C2" class="calibre20 pcalibre pcalibre1">3rd argument</td>
<td id="P70004970270000000000000000401C3" data-uri="chapter03.xhtml#P70004970270000000000000000401C3" class="calibre20 pcalibre pcalibre1">%dl</td>
<td id="P70004970270000000000000000401C4" data-uri="chapter03.xhtml#P70004970270000000000000000401C4" class="calibre20 pcalibre pcalibre1">%dx</td>
<td id="P70004970270000000000000000401C5" data-uri="chapter03.xhtml#P70004970270000000000000000401C5" class="calibre20 pcalibre pcalibre1">%edx</td>
<td id="P70004970270000000000000000401C6" data-uri="chapter03.xhtml#P70004970270000000000000000401C6" class="calibre20 pcalibre pcalibre1">%rdx</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000401C7" data-uri="chapter03.xhtml#P70004970270000000000000000401C7" class="calibre20 pcalibre pcalibre1">2nd argument</td>
<td id="P70004970270000000000000000401C8" data-uri="chapter03.xhtml#P70004970270000000000000000401C8" class="calibre20 pcalibre pcalibre1">%sil</td>
<td id="P70004970270000000000000000401C9" data-uri="chapter03.xhtml#P70004970270000000000000000401C9" class="calibre20 pcalibre pcalibre1">%si</td>
<td id="P70004970270000000000000000401CA" data-uri="chapter03.xhtml#P70004970270000000000000000401CA" class="calibre20 pcalibre pcalibre1">%esi</td>
<td id="P70004970270000000000000000401CB" data-uri="chapter03.xhtml#P70004970270000000000000000401CB" class="calibre20 pcalibre pcalibre1">%rsi</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000401CC" data-uri="chapter03.xhtml#P70004970270000000000000000401CC" class="calibre20 pcalibre pcalibre1">1st argument</td>
<td id="P70004970270000000000000000401CD" data-uri="chapter03.xhtml#P70004970270000000000000000401CD" class="calibre20 pcalibre pcalibre1">%dil</td>
<td id="P70004970270000000000000000401CE" data-uri="chapter03.xhtml#P70004970270000000000000000401CE" class="calibre20 pcalibre pcalibre1">%di</td>
<td id="P70004970270000000000000000401CF" data-uri="chapter03.xhtml#P70004970270000000000000000401CF" class="calibre20 pcalibre pcalibre1">%edi</td>
<td id="P70004970270000000000000000401D0" data-uri="chapter03.xhtml#P70004970270000000000000000401D0" class="calibre20 pcalibre pcalibre1">%rdi</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000401D1" data-uri="chapter03.xhtml#P70004970270000000000000000401D1" class="calibre20 pcalibre pcalibre1">Callee saved</td>
<td id="P70004970270000000000000000401D2" data-uri="chapter03.xhtml#P70004970270000000000000000401D2" class="calibre20 pcalibre pcalibre1">%bpl</td>
<td id="P70004970270000000000000000401D3" data-uri="chapter03.xhtml#P70004970270000000000000000401D3" class="calibre20 pcalibre pcalibre1">%bp</td>
<td id="P70004970270000000000000000401D4" data-uri="chapter03.xhtml#P70004970270000000000000000401D4" class="calibre20 pcalibre pcalibre1">%ebp</td>
<td id="P70004970270000000000000000401D5" data-uri="chapter03.xhtml#P70004970270000000000000000401D5" class="calibre20 pcalibre pcalibre1">%rbp</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000401D6" data-uri="chapter03.xhtml#P70004970270000000000000000401D6" class="calibre20 pcalibre pcalibre1">Stack pointer</td>
<td id="P70004970270000000000000000401D7" data-uri="chapter03.xhtml#P70004970270000000000000000401D7" class="calibre20 pcalibre pcalibre1">%spl</td>
<td id="P70004970270000000000000000401D8" data-uri="chapter03.xhtml#P70004970270000000000000000401D8" class="calibre20 pcalibre pcalibre1">%sp</td>
<td id="P70004970270000000000000000401D9" data-uri="chapter03.xhtml#P70004970270000000000000000401D9" class="calibre20 pcalibre pcalibre1">%esp</td>
<td id="P70004970270000000000000000401DA" data-uri="chapter03.xhtml#P70004970270000000000000000401DA" class="calibre20 pcalibre pcalibre1">%rsp</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000401DB" data-uri="chapter03.xhtml#P70004970270000000000000000401DB" class="calibre20 pcalibre pcalibre1">5th argument</td>
<td id="P70004970270000000000000000401DC" data-uri="chapter03.xhtml#P70004970270000000000000000401DC" class="calibre20 pcalibre pcalibre1">%r8b</td>
<td id="P70004970270000000000000000401DD" data-uri="chapter03.xhtml#P70004970270000000000000000401DD" class="calibre20 pcalibre pcalibre1">%r8w</td>
<td id="P70004970270000000000000000401DE" data-uri="chapter03.xhtml#P70004970270000000000000000401DE" class="calibre20 pcalibre pcalibre1">%r8d</td>
<td id="P70004970270000000000000000401DF" data-uri="chapter03.xhtml#P70004970270000000000000000401DF" class="calibre20 pcalibre pcalibre1">%r8</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000401E0" data-uri="chapter03.xhtml#P70004970270000000000000000401E0" class="calibre20 pcalibre pcalibre1">6th argument</td>
<td id="P70004970270000000000000000401E1" data-uri="chapter03.xhtml#P70004970270000000000000000401E1" class="calibre20 pcalibre pcalibre1">%r9b</td>
<td id="P70004970270000000000000000401E2" data-uri="chapter03.xhtml#P70004970270000000000000000401E2" class="calibre20 pcalibre pcalibre1">%r9w</td>
<td id="P70004970270000000000000000401E3" data-uri="chapter03.xhtml#P70004970270000000000000000401E3" class="calibre20 pcalibre pcalibre1">%r9d</td>
<td id="P70004970270000000000000000401E4" data-uri="chapter03.xhtml#P70004970270000000000000000401E4" class="calibre20 pcalibre pcalibre1">%r9</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000401E5" data-uri="chapter03.xhtml#P70004970270000000000000000401E5" class="calibre20 pcalibre pcalibre1">Caller saved</td>
<td id="P70004970270000000000000000401E6" data-uri="chapter03.xhtml#P70004970270000000000000000401E6" class="calibre20 pcalibre pcalibre1">%r10b</td>
<td id="P70004970270000000000000000401E7" data-uri="chapter03.xhtml#P70004970270000000000000000401E7" class="calibre20 pcalibre pcalibre1">%r10w</td>
<td id="P70004970270000000000000000401E8" data-uri="chapter03.xhtml#P70004970270000000000000000401E8" class="calibre20 pcalibre pcalibre1">%r10d</td>
<td id="P70004970270000000000000000401E9" data-uri="chapter03.xhtml#P70004970270000000000000000401E9" class="calibre20 pcalibre pcalibre1">%r10</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000401EA" data-uri="chapter03.xhtml#P70004970270000000000000000401EA" class="calibre20 pcalibre pcalibre1">Caller saved</td>
<td id="P70004970270000000000000000401EB" data-uri="chapter03.xhtml#P70004970270000000000000000401EB" class="calibre20 pcalibre pcalibre1">%r11b</td>
<td id="P70004970270000000000000000401EC" data-uri="chapter03.xhtml#P70004970270000000000000000401EC" class="calibre20 pcalibre pcalibre1">%r11w</td>
<td id="P70004970270000000000000000401ED" data-uri="chapter03.xhtml#P70004970270000000000000000401ED" class="calibre20 pcalibre pcalibre1">%r11d</td>
<td id="P70004970270000000000000000401EE" data-uri="chapter03.xhtml#P70004970270000000000000000401EE" class="calibre20 pcalibre pcalibre1">%r11</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000401EF" data-uri="chapter03.xhtml#P70004970270000000000000000401EF" class="calibre20 pcalibre pcalibre1">Callee saved</td>
<td id="P70004970270000000000000000401F0" data-uri="chapter03.xhtml#P70004970270000000000000000401F0" class="calibre20 pcalibre pcalibre1">%r12b</td>
<td id="P70004970270000000000000000401F1" data-uri="chapter03.xhtml#P70004970270000000000000000401F1" class="calibre20 pcalibre pcalibre1">%r12w</td>
<td id="P70004970270000000000000000401F2" data-uri="chapter03.xhtml#P70004970270000000000000000401F2" class="calibre20 pcalibre pcalibre1">%r12d</td>
<td id="P70004970270000000000000000401F3" data-uri="chapter03.xhtml#P70004970270000000000000000401F3" class="calibre20 pcalibre pcalibre1">%r12</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000401F4" data-uri="chapter03.xhtml#P70004970270000000000000000401F4" class="calibre20 pcalibre pcalibre1">Callee saved</td>
<td id="P70004970270000000000000000401F5" data-uri="chapter03.xhtml#P70004970270000000000000000401F5" class="calibre20 pcalibre pcalibre1">%r13b</td>
<td id="P70004970270000000000000000401F6" data-uri="chapter03.xhtml#P70004970270000000000000000401F6" class="calibre20 pcalibre pcalibre1">%r13w</td>
<td id="P70004970270000000000000000401F7" data-uri="chapter03.xhtml#P70004970270000000000000000401F7" class="calibre20 pcalibre pcalibre1">%r13d</td>
<td id="P70004970270000000000000000401F8" data-uri="chapter03.xhtml#P70004970270000000000000000401F8" class="calibre20 pcalibre pcalibre1">%r13</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000401F9" data-uri="chapter03.xhtml#P70004970270000000000000000401F9" class="calibre20 pcalibre pcalibre1">Callee saved</td>
<td id="P70004970270000000000000000401FA" data-uri="chapter03.xhtml#P70004970270000000000000000401FA" class="calibre20 pcalibre pcalibre1">%r14b</td>
<td id="P70004970270000000000000000401FB" data-uri="chapter03.xhtml#P70004970270000000000000000401FB" class="calibre20 pcalibre pcalibre1">%r14w</td>
<td id="P70004970270000000000000000401FC" data-uri="chapter03.xhtml#P70004970270000000000000000401FC" class="calibre20 pcalibre pcalibre1">%r14d</td>
<td id="P70004970270000000000000000401FD" data-uri="chapter03.xhtml#P70004970270000000000000000401FD" class="calibre20 pcalibre pcalibre1">%r14</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000401FE" data-uri="chapter03.xhtml#P70004970270000000000000000401FE" class="calibre20 pcalibre pcalibre1">Callee saved</td>
<td id="P70004970270000000000000000401FF" data-uri="chapter03.xhtml#P70004970270000000000000000401FF" class="calibre20 pcalibre pcalibre1">%r15b</td>
<td id="P7000497027000000000000000040200" data-uri="chapter03.xhtml#P7000497027000000000000000040200" class="calibre20 pcalibre pcalibre1">%r15w</td>
<td id="P7000497027000000000000000040201" data-uri="chapter03.xhtml#P7000497027000000000000000040201" class="calibre20 pcalibre pcalibre1">%r15d</td>
<td id="P7000497027000000000000000040202" data-uri="chapter03.xhtml#P7000497027000000000000000040202" class="calibre20 pcalibre pcalibre1">%r15</td>
</tr>
</tbody>
</table>
</details>
</figcaption>
</figure>
<p class="pcalibre1 pcalibre calibre2" id="P7000497027000000000000000040203" data-uri="chapter03.xhtml#P7000497027000000000000000040203">arguments, returning values from functions, and storing local and temporary data. We will cover these conventions in our presentation, especially in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP700049702700000000000000000281F.xhtml#P700049702700000000000000000281F"><span class="pcalibre label pcalibre1">Section </span><span class="pcalibre label pcalibre1">3.7</span></a>, where we describe the implementation of procedures.</p>
<section id="P7000497027000000000000000001F54" data-uri="chapter03.xhtml#P7000497027000000000000000001F54" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P7000497027000000000000000040204" data-uri="chapter03.xhtml#P7000497027000000000000000040204" epub:type="title"><span class="pcalibre label pcalibre1">3.4.1 </span>Operand Specifiers</h1></header>
<p id="P7000497027000000000000000040205" data-uri="chapter03.xhtml#P7000497027000000000000000040205" class="pcalibre1 pcalibre calibre2">Most instructions have one or more <i class="calibre5 pcalibre pcalibre1">operands</i> specifying the source values to use in performing an operation and the destination location into which to place the</p>
<figure class="pcalibre5 figure pcalibre" id="P7000497027000000000000000001F57" data-uri="chapter03.xhtml#P7000497027000000000000000001F57">
<span class="pcalibre pagebreak pcalibre1" id="P7000497027000000000000000001F58" title="181" data-uri="chapter03.xhtml#P7000497027000000000000000001F58" epub:type="pagebreak"></span>
<table class="pcalibre largetable pcalibre1" id="P7000497027000000000000000040206" data-uri="chapter03.xhtml#P7000497027000000000000000040206">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P7000497027000000000000000040207" data-uri="chapter03.xhtml#P7000497027000000000000000040207" class="calibre18 pcalibre pcalibre1">Type</th>
<th id="P7000497027000000000000000040208" data-uri="chapter03.xhtml#P7000497027000000000000000040208" class="calibre18 pcalibre pcalibre1">Form</th>
<th id="P7000497027000000000000000040209" data-uri="chapter03.xhtml#P7000497027000000000000000040209" class="calibre18 pcalibre pcalibre1">Operand value</th>
<th id="P700049702700000000000000004020A" data-uri="chapter03.xhtml#P700049702700000000000000004020A" class="calibre18 pcalibre pcalibre1">Name</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P700049702700000000000000004020B" data-uri="chapter03.xhtml#P700049702700000000000000004020B" class="calibre20 pcalibre pcalibre1">Immediate</td>
<td id="P700049702700000000000000004020C" data-uri="chapter03.xhtml#P700049702700000000000000004020C" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004020D" data-uri="chapter03.xhtml#P700049702700000000000000004020D" class="calibre10 pcalibre pcalibre1">$</code><i class="calibre5 pcalibre pcalibre1">Imm</i></td>
<td id="P700049702700000000000000004020E" data-uri="chapter03.xhtml#P700049702700000000000000004020E" class="calibre20 pcalibre pcalibre1"><i class="calibre5 pcalibre pcalibre1">Imm</i></td>
<td id="P700049702700000000000000004020F" data-uri="chapter03.xhtml#P700049702700000000000000004020F" class="calibre20 pcalibre pcalibre1">Immediate</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000040210" data-uri="chapter03.xhtml#P7000497027000000000000000040210" class="calibre20 pcalibre pcalibre1">Register</td>
<td id="P7000497027000000000000000040211" data-uri="chapter03.xhtml#P7000497027000000000000000040211" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000040212" data-uri="chapter03.xhtml#P7000497027000000000000000040212" class="calibre10 pcalibre pcalibre1">r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">a</var></sub></code></td>
<td id="P7000497027000000000000000040213" data-uri="chapter03.xhtml#P7000497027000000000000000040213" class="calibre20 pcalibre pcalibre1">R[<code id="P7000497027000000000000000040214" data-uri="chapter03.xhtml#P7000497027000000000000000040214" class="calibre10 pcalibre pcalibre1">r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">a</var></sub></code>]</td>
<td id="P7000497027000000000000000040215" data-uri="chapter03.xhtml#P7000497027000000000000000040215" class="calibre20 pcalibre pcalibre1">Register</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000040216" data-uri="chapter03.xhtml#P7000497027000000000000000040216" class="calibre20 pcalibre pcalibre1">Memory</td>
<td id="P7000497027000000000000000040217" data-uri="chapter03.xhtml#P7000497027000000000000000040217" class="calibre20 pcalibre pcalibre1"><i class="calibre5 pcalibre pcalibre1">Imm</i></td>
<td id="P7000497027000000000000000040218" data-uri="chapter03.xhtml#P7000497027000000000000000040218" class="calibre20 pcalibre pcalibre1">M[<i class="calibre5 pcalibre pcalibre1">Imm</i>]</td>
<td id="P7000497027000000000000000040219" data-uri="chapter03.xhtml#P7000497027000000000000000040219" class="calibre20 pcalibre pcalibre1">Absolute</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P700049702700000000000000004021A" data-uri="chapter03.xhtml#P700049702700000000000000004021A" class="calibre20 pcalibre pcalibre1">Memory</td>
<td id="P700049702700000000000000004021B" data-uri="chapter03.xhtml#P700049702700000000000000004021B" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004021C" data-uri="chapter03.xhtml#P700049702700000000000000004021C" class="calibre10 pcalibre pcalibre1">(r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">a</var></sub>)</code></td>
<td id="P700049702700000000000000004021D" data-uri="chapter03.xhtml#P700049702700000000000000004021D" class="calibre20 pcalibre pcalibre1">M[R[<code id="P700049702700000000000000004021E" data-uri="chapter03.xhtml#P700049702700000000000000004021E" class="calibre10 pcalibre pcalibre1">r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">a</var></sub></code>]]</td>
<td id="P700049702700000000000000004021F" data-uri="chapter03.xhtml#P700049702700000000000000004021F" class="calibre20 pcalibre pcalibre1">Indirect</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000040220" data-uri="chapter03.xhtml#P7000497027000000000000000040220" class="calibre20 pcalibre pcalibre1">Memory</td>
<td id="P7000497027000000000000000040221" data-uri="chapter03.xhtml#P7000497027000000000000000040221" class="calibre20 pcalibre pcalibre1"><i class="calibre5 pcalibre pcalibre1">Imm</i> <code id="P7000497027000000000000000040222" data-uri="chapter03.xhtml#P7000497027000000000000000040222" class="calibre10 pcalibre pcalibre1">(r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">b</var></sub>)</code></td>
<td id="P7000497027000000000000000040223" data-uri="chapter03.xhtml#P7000497027000000000000000040223" class="calibre20 pcalibre pcalibre1">M[<i class="calibre5 pcalibre pcalibre1">Imm</i> + R[<code id="P7000497027000000000000000040224" data-uri="chapter03.xhtml#P7000497027000000000000000040224" class="calibre10 pcalibre pcalibre1">r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">b</var></sub></code>]]</td>
<td id="P7000497027000000000000000040225" data-uri="chapter03.xhtml#P7000497027000000000000000040225" class="calibre20 pcalibre pcalibre1">Base + displacement</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000040226" data-uri="chapter03.xhtml#P7000497027000000000000000040226" class="calibre20 pcalibre pcalibre1">Memory</td>
<td id="P7000497027000000000000000040227" data-uri="chapter03.xhtml#P7000497027000000000000000040227" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000040228" data-uri="chapter03.xhtml#P7000497027000000000000000040228" class="calibre10 pcalibre pcalibre1">(r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">b</var></sub>,r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">i</var></sub>)</code></td>
<td id="P7000497027000000000000000040229" data-uri="chapter03.xhtml#P7000497027000000000000000040229" class="calibre20 pcalibre pcalibre1">M[R[<code id="P700049702700000000000000004022A" data-uri="chapter03.xhtml#P700049702700000000000000004022A" class="calibre10 pcalibre pcalibre1">r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">b</var></sub></code>] + R[<code id="P700049702700000000000000004022B" data-uri="chapter03.xhtml#P700049702700000000000000004022B" class="calibre10 pcalibre pcalibre1">r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">i</var></sub>]</code>]</td>
<td id="P700049702700000000000000004022C" data-uri="chapter03.xhtml#P700049702700000000000000004022C" class="calibre20 pcalibre pcalibre1">Indexed</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P700049702700000000000000004022D" data-uri="chapter03.xhtml#P700049702700000000000000004022D" class="calibre20 pcalibre pcalibre1">Memory</td>
<td id="P700049702700000000000000004022E" data-uri="chapter03.xhtml#P700049702700000000000000004022E" class="calibre20 pcalibre pcalibre1"><i class="calibre5 pcalibre pcalibre1">Imm</i><code id="P700049702700000000000000004022F" data-uri="chapter03.xhtml#P700049702700000000000000004022F" class="calibre10 pcalibre pcalibre1">(r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">b</var></sub>,r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">i</var></sub>)</code></td>
<td id="P7000497027000000000000000040230" data-uri="chapter03.xhtml#P7000497027000000000000000040230" class="calibre20 pcalibre pcalibre1">M[<i class="calibre5 pcalibre pcalibre1">Imm</i> + R[<code id="P7000497027000000000000000040231" data-uri="chapter03.xhtml#P7000497027000000000000000040231" class="calibre10 pcalibre pcalibre1">r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">b</var></sub></code>] + R[<code id="P7000497027000000000000000040232" data-uri="chapter03.xhtml#P7000497027000000000000000040232" class="calibre10 pcalibre pcalibre1">r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">i</var></sub></code>]]</td>
<td id="P7000497027000000000000000040233" data-uri="chapter03.xhtml#P7000497027000000000000000040233" class="calibre20 pcalibre pcalibre1">Indexed</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000040234" data-uri="chapter03.xhtml#P7000497027000000000000000040234" class="calibre20 pcalibre pcalibre1">Memory</td>
<td id="P7000497027000000000000000040235" data-uri="chapter03.xhtml#P7000497027000000000000000040235" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000040236" data-uri="chapter03.xhtml#P7000497027000000000000000040236" class="calibre10 pcalibre pcalibre1">(,r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">i</var></sub>,<var class="calibre5 pcalibre pcalibre1">s</var>)</code></td>
<td id="P7000497027000000000000000040237" data-uri="chapter03.xhtml#P7000497027000000000000000040237" class="calibre20 pcalibre pcalibre1">M[R[<code id="P7000497027000000000000000040238" data-uri="chapter03.xhtml#P7000497027000000000000000040238" class="calibre10 pcalibre pcalibre1">r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">i</var></sub></code>] <code id="P7000497027000000000000000040239" data-uri="chapter03.xhtml#P7000497027000000000000000040239" class="calibre10 pcalibre pcalibre1">· <var class="calibre5 pcalibre pcalibre1">s</var></code>]</td>
<td id="P700049702700000000000000004023A" data-uri="chapter03.xhtml#P700049702700000000000000004023A" class="calibre20 pcalibre pcalibre1">Scaled indexed</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P700049702700000000000000004023B" data-uri="chapter03.xhtml#P700049702700000000000000004023B" class="calibre20 pcalibre pcalibre1">Memory</td>
<td id="P700049702700000000000000004023C" data-uri="chapter03.xhtml#P700049702700000000000000004023C" class="calibre20 pcalibre pcalibre1"><i class="calibre5 pcalibre pcalibre1">Imm</i> <code id="P700049702700000000000000004023D" data-uri="chapter03.xhtml#P700049702700000000000000004023D" class="calibre10 pcalibre pcalibre1">(,r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">i</var></sub>,<var class="calibre5 pcalibre pcalibre1">s</var>)</code></td>
<td id="P700049702700000000000000004023E" data-uri="chapter03.xhtml#P700049702700000000000000004023E" class="calibre20 pcalibre pcalibre1">M[<i class="calibre5 pcalibre pcalibre1">Imm</i> + R[<code id="P700049702700000000000000004023F" data-uri="chapter03.xhtml#P700049702700000000000000004023F" class="calibre10 pcalibre pcalibre1">r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">i</var></sub></code>] <code id="P7000497027000000000000000040240" data-uri="chapter03.xhtml#P7000497027000000000000000040240" class="calibre10 pcalibre pcalibre1">· <var class="calibre5 pcalibre pcalibre1">s</var></code>]</td>
<td id="P7000497027000000000000000040241" data-uri="chapter03.xhtml#P7000497027000000000000000040241" class="calibre20 pcalibre pcalibre1">Scaled indexed</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000040242" data-uri="chapter03.xhtml#P7000497027000000000000000040242" class="calibre20 pcalibre pcalibre1">Memory</td>
<td id="P7000497027000000000000000040243" data-uri="chapter03.xhtml#P7000497027000000000000000040243" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000040244" data-uri="chapter03.xhtml#P7000497027000000000000000040244" class="calibre10 pcalibre pcalibre1">(r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">b</var></sub>,r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">i</var></sub>,<var class="calibre5 pcalibre pcalibre1">s</var>)</code></td>
<td id="P7000497027000000000000000040245" data-uri="chapter03.xhtml#P7000497027000000000000000040245" class="calibre20 pcalibre pcalibre1">M[R[<code id="P7000497027000000000000000040246" data-uri="chapter03.xhtml#P7000497027000000000000000040246" class="calibre10 pcalibre pcalibre1">r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">b</var></sub></code>] + R[<code id="P7000497027000000000000000040247" data-uri="chapter03.xhtml#P7000497027000000000000000040247" class="calibre10 pcalibre pcalibre1">r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">i</var></sub></code>] <code id="P7000497027000000000000000040248" data-uri="chapter03.xhtml#P7000497027000000000000000040248" class="calibre10 pcalibre pcalibre1">· <var class="calibre5 pcalibre pcalibre1">s</var></code>]</td>
<td id="P7000497027000000000000000040249" data-uri="chapter03.xhtml#P7000497027000000000000000040249" class="calibre20 pcalibre pcalibre1">Scaled indexed</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P700049702700000000000000004024A" data-uri="chapter03.xhtml#P700049702700000000000000004024A" class="calibre20 pcalibre pcalibre1">Memory</td>
<td id="P700049702700000000000000004024B" data-uri="chapter03.xhtml#P700049702700000000000000004024B" class="calibre20 pcalibre pcalibre1"><i class="calibre5 pcalibre pcalibre1">Imm</i> <code id="P700049702700000000000000004024C" data-uri="chapter03.xhtml#P700049702700000000000000004024C" class="calibre10 pcalibre pcalibre1">(r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">b</var></sub>,r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">i</var></sub>,<var class="calibre5 pcalibre pcalibre1">s</var>)</code></td>
<td id="P700049702700000000000000004024D" data-uri="chapter03.xhtml#P700049702700000000000000004024D" class="calibre20 pcalibre pcalibre1">M[<i class="calibre5 pcalibre pcalibre1">Imm</i> + R[<code id="P700049702700000000000000004024E" data-uri="chapter03.xhtml#P700049702700000000000000004024E" class="calibre10 pcalibre pcalibre1">r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">b</var></sub></code>] + R[<code id="P700049702700000000000000004024F" data-uri="chapter03.xhtml#P700049702700000000000000004024F" class="calibre10 pcalibre pcalibre1">r<sub class="calibre85 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">i</var></sub></code>] <code id="P7000497027000000000000000040250" data-uri="chapter03.xhtml#P7000497027000000000000000040250" class="calibre10 pcalibre pcalibre1">· <var class="calibre5 pcalibre pcalibre1">s</var></code>]</td>
<td id="P7000497027000000000000000040251" data-uri="chapter03.xhtml#P7000497027000000000000000040251" class="calibre20 pcalibre pcalibre1">Scaled indexed</td>
</tr>
</tbody>
</table>
<figcaption id="P7000497027000000000000000040252" data-uri="chapter03.xhtml#P7000497027000000000000000040252" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P7000497027000000000000000040253" data-uri="chapter03.xhtml#P7000497027000000000000000040253" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">3.3 </span>Operand forms.</h1></header><div class="caption pcalibre pcalibre1" id="P7000497027000000000000000040254" data-uri="chapter03.xhtml#P7000497027000000000000000040254"><p id="P7000497027000000000000000040255" data-uri="chapter03.xhtml#P7000497027000000000000000040255" class="pcalibre calibre3 pcalibre1">Operands can denote immediate (constant) values, register values, or values from memory. The scaling factor <var class="calibre5 pcalibre pcalibre1">s</var> must be either 1, 2, 4, or 8.</p></div></figcaption>
</figure>
<p class="pcalibre1 pcalibre calibre2" id="P7000497027000000000000000040256" data-uri="chapter03.xhtml#P7000497027000000000000000040256">result. x86-64 supports a number of operand forms (see <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000001F57"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">3.3</span></a>). Source values can be given as constants or read from registers or memory. Results can be stored in either registers or memory. Thus, the different operand possibilities can be classified into three types. The first type, <i class="calibre5 pcalibre pcalibre1">immediate</i>, is for constant values. In ATT-format assembly code, these are written with a `$' followed by an integer using standard C notation—for example, $-577 or <code id="P7000497027000000000000000040257" data-uri="chapter03.xhtml#P7000497027000000000000000040257" class="pcalibre1 calibre8 pcalibre">$0x1F</code>. Different instructions allow different ranges of immediate values; the assembler will automatically select the most compact way of encoding a value. The second type, <i class="calibre5 pcalibre pcalibre1">register</i>, denotes the contents of a register, one of the sixteen 8-, 4-, 2-, or 1-byte low-order portions of the registers for operands having 64, 32, 16, or 8 bits, respectively. In <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000001F57"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">3.3</span></a>, we use the notation <code id="P7000497027000000000000000040258" data-uri="chapter03.xhtml#P7000497027000000000000000040258" class="pcalibre1 calibre8 pcalibre">r<sub class="calibre59 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">a</var></sub></code> to denote an arbitrary register <var class="calibre5 pcalibre pcalibre1">a</var> and indicate its value with the reference <code id="P7000497027000000000000000040259" data-uri="chapter03.xhtml#P7000497027000000000000000040259" class="pcalibre1 calibre8 pcalibre">R[r<sub class="calibre59 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">a</var></sub>]</code>, viewing the set of registers as an array R indexed by register identifiers.</p>
<p id="P700049702700000000000000004025A" data-uri="chapter03.xhtml#P700049702700000000000000004025A" class="pcalibre1 pcalibre calibre2">The third type of operand is a <i class="calibre5 pcalibre pcalibre1">memory</i> reference, in which we access some memory location according to a computed address, often called the <i class="calibre5 pcalibre pcalibre1">effective address</i>. Since we view the memory as a large array of bytes, we use the notation M<sub class="pcalibre1 calibre47 pcalibre"><var class="calibre5 pcalibre pcalibre1">b</var></sub>[<i class="calibre5 pcalibre pcalibre1">Addr</i>] to denote a reference to the <var class="calibre5 pcalibre pcalibre1">b</var>-byte value stored in memory starting at address <i class="calibre5 pcalibre pcalibre1">Addr</i>. To simplify things, we will generally drop the subscript <var class="calibre5 pcalibre pcalibre1">b</var>.</p>
<p id="P700049702700000000000000004025B" data-uri="chapter03.xhtml#P700049702700000000000000004025B" class="pcalibre1 pcalibre calibre2">As <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000001F57"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">3.3</span></a> shows, there are many different <i class="calibre5 pcalibre pcalibre1">addressing modes</i> allowing different forms of memory references. The most general form is shown at the bottom of the table with syntax <i class="calibre5 pcalibre pcalibre1">Imm</i>(<code id="P700049702700000000000000004025C" data-uri="chapter03.xhtml#P700049702700000000000000004025C" class="pcalibre1 calibre8 pcalibre">r<sub class="calibre59 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">b</var></sub>,r<sub class="calibre59 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">i</var></sub>,<var class="calibre5 pcalibre pcalibre1">s</var></code>). Such a reference has four components: an immediate offset <i class="calibre5 pcalibre pcalibre1">Imm</i>, a base register <code id="P700049702700000000000000004025D" data-uri="chapter03.xhtml#P700049702700000000000000004025D" class="pcalibre1 calibre8 pcalibre">r<sub class="calibre59 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">b</var></sub></code>, an index register <code id="P700049702700000000000000004025E" data-uri="chapter03.xhtml#P700049702700000000000000004025E" class="pcalibre1 calibre8 pcalibre">r<sub class="calibre59 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">i</var></sub></code>, and a scale factor <var class="calibre5 pcalibre pcalibre1">s</var>, where <var class="calibre5 pcalibre pcalibre1">s</var> must be 1, 2, 4, or 8. Both the base and index must be 64-bit registers. The effective address is computed as <i class="calibre5 pcalibre pcalibre1">Imm</i> + <code id="P700049702700000000000000004025F" data-uri="chapter03.xhtml#P700049702700000000000000004025F" class="pcalibre1 calibre8 pcalibre">R[r<sub class="calibre59 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">b</var></sub>]+ R[r<sub class="calibre59 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">i</var></sub>] · <i class="calibre5 pcalibre pcalibre1">s.</i></code> This general form is often seen when referencing elements of arrays. The other forms are simply special cases of this general form where some of the components are omitted. As we <span class="pcalibre pagebreak pcalibre1" id="P7000497027000000000000000001FB3" title="182" data-uri="chapter03.xhtml#P7000497027000000000000000001FB3" epub:type="pagebreak"></span>will see, the more complex addressing modes are useful when referencing array and structure elements.</p>

<section id="P7000497027000000000000000001FB4" data-uri="chapter03.xhtml#P7000497027000000000000000001FB4" epub:type="practice" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title5 pcalibre pcalibre1" id="P7000497027000000000000000040260" data-uri="chapter03.xhtml#P7000497027000000000000000040260" epub:type="title"><span class="pcalibre label pcalibre1">Practice Problem </span><span class="pcalibre label pcalibre1">3.1 </span>(solution page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP70004970270000000000000000032E1.xhtml#P7000497027000000000000000003443">325</a>)</h1></header>
<div class="edition pcalibre pcalibre1" id="P7000497027000000000000000040261" data-uri="chapter03.xhtml#P7000497027000000000000000040261">
<p id="P7000497027000000000000000040262" data-uri="chapter03.xhtml#P7000497027000000000000000040262" class="pcalibre1 pcalibre calibre2">Assume the following values are stored at the indicated memory addresses and registers:</p>
<table id="P7000497027000000000000000040263" data-uri="chapter03.xhtml#P7000497027000000000000000040263" class="pcalibre largetable pcalibre1">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P7000497027000000000000000040264" data-uri="chapter03.xhtml#P7000497027000000000000000040264" class="calibre18 pcalibre pcalibre1">Address</th>
<th id="P7000497027000000000000000040265" data-uri="chapter03.xhtml#P7000497027000000000000000040265" class="calibre18 pcalibre pcalibre1">Value</th>
<th id="P7000497027000000000000000040266" data-uri="chapter03.xhtml#P7000497027000000000000000040266" class="calibre18 pcalibre pcalibre1">Register</th>
<th id="P7000497027000000000000000040267" data-uri="chapter03.xhtml#P7000497027000000000000000040267" class="calibre18 pcalibre pcalibre1">Value</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000040268" data-uri="chapter03.xhtml#P7000497027000000000000000040268" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000040269" data-uri="chapter03.xhtml#P7000497027000000000000000040269" class="calibre10 pcalibre pcalibre1">0x100</code></td>
<td id="P700049702700000000000000004026A" data-uri="chapter03.xhtml#P700049702700000000000000004026A" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004026B" data-uri="chapter03.xhtml#P700049702700000000000000004026B" class="calibre10 pcalibre pcalibre1">0xFF</code></td>
<td id="P700049702700000000000000004026C" data-uri="chapter03.xhtml#P700049702700000000000000004026C" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004026D" data-uri="chapter03.xhtml#P700049702700000000000000004026D" class="calibre10 pcalibre pcalibre1">%rax</code></td>
<td id="P700049702700000000000000004026E" data-uri="chapter03.xhtml#P700049702700000000000000004026E" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004026F" data-uri="chapter03.xhtml#P700049702700000000000000004026F" class="calibre10 pcalibre pcalibre1">0x100</code></td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000040270" data-uri="chapter03.xhtml#P7000497027000000000000000040270" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000040271" data-uri="chapter03.xhtml#P7000497027000000000000000040271" class="calibre10 pcalibre pcalibre1">0x104</code></td>
<td id="P7000497027000000000000000040272" data-uri="chapter03.xhtml#P7000497027000000000000000040272" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000040273" data-uri="chapter03.xhtml#P7000497027000000000000000040273" class="calibre10 pcalibre pcalibre1">0xAB</code></td>
<td id="P7000497027000000000000000040274" data-uri="chapter03.xhtml#P7000497027000000000000000040274" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000040275" data-uri="chapter03.xhtml#P7000497027000000000000000040275" class="calibre10 pcalibre pcalibre1">%rcx</code></td>
<td id="P7000497027000000000000000040276" data-uri="chapter03.xhtml#P7000497027000000000000000040276" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000040277" data-uri="chapter03.xhtml#P7000497027000000000000000040277" class="calibre10 pcalibre pcalibre1">0x1</code></td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000040278" data-uri="chapter03.xhtml#P7000497027000000000000000040278" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000040279" data-uri="chapter03.xhtml#P7000497027000000000000000040279" class="calibre10 pcalibre pcalibre1">0x108</code></td>
<td id="P700049702700000000000000004027A" data-uri="chapter03.xhtml#P700049702700000000000000004027A" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004027B" data-uri="chapter03.xhtml#P700049702700000000000000004027B" class="calibre10 pcalibre pcalibre1">0x13</code></td>
<td id="P700049702700000000000000004027C" data-uri="chapter03.xhtml#P700049702700000000000000004027C" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004027D" data-uri="chapter03.xhtml#P700049702700000000000000004027D" class="calibre10 pcalibre pcalibre1">%rdx</code></td>
<td id="P700049702700000000000000004027E" data-uri="chapter03.xhtml#P700049702700000000000000004027E" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004027F" data-uri="chapter03.xhtml#P700049702700000000000000004027F" class="calibre10 pcalibre pcalibre1">0x3</code></td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000040280" data-uri="chapter03.xhtml#P7000497027000000000000000040280" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000040281" data-uri="chapter03.xhtml#P7000497027000000000000000040281" class="calibre10 pcalibre pcalibre1">0x10C</code></td>
<td id="P7000497027000000000000000040282" data-uri="chapter03.xhtml#P7000497027000000000000000040282" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000040283" data-uri="chapter03.xhtml#P7000497027000000000000000040283" class="calibre10 pcalibre pcalibre1">0x11</code></td>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
</tr>
</tbody>
</table>
</div>
<ol class="practicelist pcalibre pcalibre1" id="P7000497027000000000000000040284" data-uri="chapter03.xhtml#P7000497027000000000000000040284">
<li class="general-problem pcalibre pcalibre1" id="P7000497027000000000000000040285" data-uri="chapter03.xhtml#P7000497027000000000000000040285">
<div class="edition pcalibre pcalibre1" id="P7000497027000000000000000040286" data-uri="chapter03.xhtml#P7000497027000000000000000040286"><p id="P7000497027000000000000000040287" data-uri="chapter03.xhtml#P7000497027000000000000000040287" class="pcalibre calibre3 pcalibre1">Fill in the following table showing the values for the indicated operands:</p></div>
<table id="P7000497027000000000000000040288" data-uri="chapter03.xhtml#P7000497027000000000000000040288" class="pcalibre largetable pcalibre1">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P7000497027000000000000000040289" data-uri="chapter03.xhtml#P7000497027000000000000000040289" class="calibre18 pcalibre pcalibre1">Operand</th>
<th id="P700049702700000000000000004028A" data-uri="chapter03.xhtml#P700049702700000000000000004028A" class="calibre18 pcalibre pcalibre1">Value</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P700049702700000000000000004028B" data-uri="chapter03.xhtml#P700049702700000000000000004028B" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004028C" data-uri="chapter03.xhtml#P700049702700000000000000004028C" class="calibre10 pcalibre pcalibre1">%rax</code></td>
<td id="P700049702700000000000000004028D" data-uri="chapter03.xhtml#P700049702700000000000000004028D" class="calibre20 pcalibre pcalibre1">__________</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P700049702700000000000000004028E" data-uri="chapter03.xhtml#P700049702700000000000000004028E" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004028F" data-uri="chapter03.xhtml#P700049702700000000000000004028F" class="calibre10 pcalibre pcalibre1">0x104</code></td>
<td id="P7000497027000000000000000040290" data-uri="chapter03.xhtml#P7000497027000000000000000040290" class="calibre20 pcalibre pcalibre1">__________</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000040291" data-uri="chapter03.xhtml#P7000497027000000000000000040291" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000040292" data-uri="chapter03.xhtml#P7000497027000000000000000040292" class="calibre10 pcalibre pcalibre1">$0x108</code></td>
<td id="P7000497027000000000000000040293" data-uri="chapter03.xhtml#P7000497027000000000000000040293" class="calibre20 pcalibre pcalibre1">__________</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000040294" data-uri="chapter03.xhtml#P7000497027000000000000000040294" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000040295" data-uri="chapter03.xhtml#P7000497027000000000000000040295" class="calibre10 pcalibre pcalibre1">(%rax)</code></td>
<td id="P7000497027000000000000000040296" data-uri="chapter03.xhtml#P7000497027000000000000000040296" class="calibre20 pcalibre pcalibre1">__________</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000040297" data-uri="chapter03.xhtml#P7000497027000000000000000040297" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000040298" data-uri="chapter03.xhtml#P7000497027000000000000000040298" class="calibre10 pcalibre pcalibre1">4(%rax)</code></td>
<td id="P7000497027000000000000000040299" data-uri="chapter03.xhtml#P7000497027000000000000000040299" class="calibre20 pcalibre pcalibre1">__________</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P700049702700000000000000004029A" data-uri="chapter03.xhtml#P700049702700000000000000004029A" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004029B" data-uri="chapter03.xhtml#P700049702700000000000000004029B" class="calibre10 pcalibre pcalibre1">9(%rax,%rdx)</code></td>
<td id="P700049702700000000000000004029C" data-uri="chapter03.xhtml#P700049702700000000000000004029C" class="calibre20 pcalibre pcalibre1">__________</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P700049702700000000000000004029D" data-uri="chapter03.xhtml#P700049702700000000000000004029D" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004029E" data-uri="chapter03.xhtml#P700049702700000000000000004029E" class="calibre10 pcalibre pcalibre1">260(%rcx,%rdx)</code></td>
<td id="P700049702700000000000000004029F" data-uri="chapter03.xhtml#P700049702700000000000000004029F" class="calibre20 pcalibre pcalibre1">__________</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000402A0" data-uri="chapter03.xhtml#P70004970270000000000000000402A0" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000402A1" data-uri="chapter03.xhtml#P70004970270000000000000000402A1" class="calibre10 pcalibre pcalibre1">0xFC(,%rcx,4)</code></td>
<td id="P70004970270000000000000000402A2" data-uri="chapter03.xhtml#P70004970270000000000000000402A2" class="calibre20 pcalibre pcalibre1">__________</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000402A3" data-uri="chapter03.xhtml#P70004970270000000000000000402A3" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000402A4" data-uri="chapter03.xhtml#P70004970270000000000000000402A4" class="calibre10 pcalibre pcalibre1">(%rax,%rdx,4)</code></td>
<td id="P70004970270000000000000000402A5" data-uri="chapter03.xhtml#P70004970270000000000000000402A5" class="calibre20 pcalibre pcalibre1">__________</td>
</tr>
</tbody>
</table>
</li>
</ol>
</section>
</section>
<section id="P7000497027000000000000000001FFB" data-uri="chapter03.xhtml#P7000497027000000000000000001FFB" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P70004970270000000000000000402A6" data-uri="chapter03.xhtml#P70004970270000000000000000402A6" epub:type="title"><span class="pcalibre label pcalibre1">3.4.2 </span>Data Movement Instructions</h1></header>
<p id="P70004970270000000000000000402A7" data-uri="chapter03.xhtml#P70004970270000000000000000402A7" class="pcalibre1 pcalibre calibre2">Among the most heavily used instructions are those that copy data from one location to another. The generality of the operand notation allows a simple data movement instruction to express a range of possibilities that in many machines would require a number of different instructions. We present a number of different data movement instructions, differing in their source and destination types, what conversions they perform, and other side effects they may have. In our presentation, we group the many different instructions into <i class="calibre5 pcalibre pcalibre1">instruction classes</i>, where the instructions in a class perform the same operation but with different operand sizes.</p>
<p id="P70004970270000000000000000402A8" data-uri="chapter03.xhtml#P70004970270000000000000000402A8" class="pcalibre1 pcalibre calibre2"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000002001"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">3.4</span></a> lists the simplest form of data movement instructions—<span class="smallcaps pcalibre pcalibre1">mov </span>class. These instructions copy data from a source location to a destination location, without any transformation. The class consists of four instructions: <code id="P70004970270000000000000000402A9" data-uri="chapter03.xhtml#P70004970270000000000000000402A9" class="pcalibre1 calibre8 pcalibre">movb, movw, movl</code>, and <code id="P70004970270000000000000000402AA" data-uri="chapter03.xhtml#P70004970270000000000000000402AA" class="pcalibre1 calibre8 pcalibre">movq</code>. All four of these instructions have similar effects; they differ primarily in that they operate on data of different sizes: 1, 2, 4, and 8 bytes, respectively.</p>
<figure id="P7000497027000000000000000002001" class="pcalibre5 figure pcalibre" data-uri="chapter03.xhtml#P7000497027000000000000000002001">
<table id="P70004970270000000000000000402AB" data-uri="chapter03.xhtml#P70004970270000000000000000402AB" class="pcalibre largetable pcalibre1">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P70004970270000000000000000402AC" data-uri="chapter03.xhtml#P70004970270000000000000000402AC" class="calibre18 pcalibre pcalibre1"><span class="pcalibre pagebreak1 pcalibre1" id="P7000497027000000000000000002004" title="183" data-uri="chapter03.xhtml#P7000497027000000000000000002004" epub:type="pagebreak"></span>Instruction</th>
<th id="P70004970270000000000000000402AD" data-uri="chapter03.xhtml#P70004970270000000000000000402AD" class="calibre18 pcalibre pcalibre1"/>
<th id="P70004970270000000000000000402AE" data-uri="chapter03.xhtml#P70004970270000000000000000402AE" class="calibre18 pcalibre pcalibre1">Effect</th>
<th id="P70004970270000000000000000402AF" data-uri="chapter03.xhtml#P70004970270000000000000000402AF" class="calibre18 pcalibre pcalibre1">Description</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000402B0" data-uri="chapter03.xhtml#P70004970270000000000000000402B0" class="calibre20 pcalibre pcalibre1"><span class="smallcaps1 pcalibre pcalibre1">mov</span></td>
<td id="P70004970270000000000000000402B1" data-uri="chapter03.xhtml#P70004970270000000000000000402B1" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">S</var>, <var class="calibre5 pcalibre pcalibre1">D</var></td>
<td id="P70004970270000000000000000402B2" data-uri="chapter03.xhtml#P70004970270000000000000000402B2" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">D</var> ← <var class="calibre5 pcalibre pcalibre1">S</var></td>
<td id="P70004970270000000000000000402B3" data-uri="chapter03.xhtml#P70004970270000000000000000402B3" class="calibre20 pcalibre pcalibre1">Move</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000402B4" data-uri="chapter03.xhtml#P70004970270000000000000000402B4" class="calibre20 pcalibre pcalibre1"> <code id="P70004970270000000000000000402B5" data-uri="chapter03.xhtml#P70004970270000000000000000402B5" class="calibre10 pcalibre pcalibre1">movb</code></td>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
<td id="P70004970270000000000000000402B6" data-uri="chapter03.xhtml#P70004970270000000000000000402B6" class="calibre20 pcalibre pcalibre1">Move byte</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000402B7" data-uri="chapter03.xhtml#P70004970270000000000000000402B7" class="calibre20 pcalibre pcalibre1"> <code id="P70004970270000000000000000402B8" data-uri="chapter03.xhtml#P70004970270000000000000000402B8" class="calibre10 pcalibre pcalibre1">movw</code></td>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
<td id="P70004970270000000000000000402B9" data-uri="chapter03.xhtml#P70004970270000000000000000402B9" class="calibre20 pcalibre pcalibre1">Move word</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000402BA" data-uri="chapter03.xhtml#P70004970270000000000000000402BA" class="calibre20 pcalibre pcalibre1"> <code id="P70004970270000000000000000402BB" data-uri="chapter03.xhtml#P70004970270000000000000000402BB" class="calibre10 pcalibre pcalibre1">movl</code></td>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
<td id="P70004970270000000000000000402BC" data-uri="chapter03.xhtml#P70004970270000000000000000402BC" class="calibre20 pcalibre pcalibre1">Move double word</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000402BD" data-uri="chapter03.xhtml#P70004970270000000000000000402BD" class="calibre20 pcalibre pcalibre1"> <code id="P70004970270000000000000000402BE" data-uri="chapter03.xhtml#P70004970270000000000000000402BE" class="calibre10 pcalibre pcalibre1">moivq</code></td>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
<td id="P70004970270000000000000000402BF" data-uri="chapter03.xhtml#P70004970270000000000000000402BF" class="calibre20 pcalibre pcalibre1">Move quad word</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000402C0" data-uri="chapter03.xhtml#P70004970270000000000000000402C0" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000402C1" data-uri="chapter03.xhtml#P70004970270000000000000000402C1" class="calibre10 pcalibre pcalibre1">movabsq</code></td>
<td id="P70004970270000000000000000402C2" data-uri="chapter03.xhtml#P70004970270000000000000000402C2" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">I</var>, <var class="calibre5 pcalibre pcalibre1">R</var></td>
<td id="P70004970270000000000000000402C3" data-uri="chapter03.xhtml#P70004970270000000000000000402C3" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">R</var> ← <var class="calibre5 pcalibre pcalibre1">I</var></td>
<td id="P70004970270000000000000000402C4" data-uri="chapter03.xhtml#P70004970270000000000000000402C4" class="calibre20 pcalibre pcalibre1">Move absolute quad word</td>
</tr>
</tbody>
</table>
<figcaption id="P70004970270000000000000000402C5" data-uri="chapter03.xhtml#P70004970270000000000000000402C5" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P70004970270000000000000000402C6" data-uri="chapter03.xhtml#P70004970270000000000000000402C6" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">3.4 </span>Simple data movement instructions.</h1></header></figcaption>
</figure>
<p id="P70004970270000000000000000402C7" data-uri="chapter03.xhtml#P70004970270000000000000000402C7" class="pcalibre1 pcalibre calibre2">The source operand designates a value that is immediate, stored in a register, or stored in memory. The destination operand designates a location that is either a register or a memory address. x86-64 imposes the restriction that a move instruction cannot have both operands refer to memory locations. Copying a value from one memory location to another requires two instructions—the first to load the source value into a register, and the second to write this register value to the destination. Referring to <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000001F4C"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">3.2</span></a>, register operands for these instructions can be the labeled portions of any of the 16 registers, where the size of the register must match the size designated by the last character of the instruction (<code id="P70004970270000000000000000402C8" data-uri="chapter03.xhtml#P70004970270000000000000000402C8" class="pcalibre1 calibre8 pcalibre">'b', `w', `l'</code>, or <code id="P70004970270000000000000000402C9" data-uri="chapter03.xhtml#P70004970270000000000000000402C9" class="pcalibre1 calibre8 pcalibre">`q'</code>). For most cases, the <span class="smallcaps pcalibre pcalibre1">mov </span>instructions will only update the specific register bytes or memory locations indicated by the destination operand. The only exception is that when <code id="P70004970270000000000000000402CA" data-uri="chapter03.xhtml#P70004970270000000000000000402CA" class="pcalibre1 calibre8 pcalibre">movl</code> has a register as the destination, it will also set the high-order 4 bytes of the register to 0. This exception arises from the convention, adopted in x86-64, that any instruction that generates a 32-bit value for a register also sets the high-order portion of the register to 0.</p>
<p id="P70004970270000000000000000402CB" data-uri="chapter03.xhtml#P70004970270000000000000000402CB" class="pcalibre1 pcalibre calibre2">The following <span class="smallcaps pcalibre pcalibre1">mov </span>instruction examples show the five possible combinations of source and destination types. Recall that the source operand comes first and the destination second.</p>
<pre id="P70004970270000000000000000402CC" data-uri="chapter03.xhtml#P70004970270000000000000000402CC" class="calibre9 pcalibre pcalibre1"><code id="P70004970270000000000000000402CD" data-uri="chapter03.xhtml#P70004970270000000000000000402CD" class="calibre10 pcalibre pcalibre1">
1	movl $0x4050,%eax	<i class="calibre5 pcalibre pcalibre1">Immediate--Register, 4 bytes</i>
2	movw %bp,%sp		<i class="calibre5 pcalibre pcalibre1">Register--Register, 2 bytes</i>
3	movb (%rdi,%rcx),%al	<i class="calibre5 pcalibre pcalibre1">Memory--Register, 1 byte</i>
4	movb $-17,( %esp)	<i class="calibre5 pcalibre pcalibre1">Immediate--Memory, 1 byte</i>
5	movq %rax,–12(%rbp)	<i class="calibre5 pcalibre pcalibre1">Register--Memory, 8 bytes</i>
</code></pre>
<p id="P70004970270000000000000000402CE" data-uri="chapter03.xhtml#P70004970270000000000000000402CE" class="pcalibre1 pcalibre calibre2">A final instruction documented in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000002001"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">3.4</span></a> is for dealing with 64-bit immediate data. The regular <code id="P70004970270000000000000000402CF" data-uri="chapter03.xhtml#P70004970270000000000000000402CF" class="pcalibre1 calibre8 pcalibre">movq</code> instruction can only have immediate source operands that can be represented as 32-bit two's-complement numbers. This value is then sign extended to produce the 64-bit value for the destination. The <code id="P70004970270000000000000000402D0" data-uri="chapter03.xhtml#P70004970270000000000000000402D0" class="pcalibre1 calibre8 pcalibre">movabsq</code> instruction can have an arbitrary 64-bit immediate value as its source operand and can only have a register as a destination.</p>
<p id="P70004970270000000000000000402D1" data-uri="chapter03.xhtml#P70004970270000000000000000402D1" class="pcalibre1 pcalibre calibre2"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P700049702700000000000000000203C"><span class="pcalibre label pcalibre1">Figures </span><span class="pcalibre label pcalibre1">3.5</span></a> and <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P700049702700000000000000000203C"><span class="pcalibre label pcalibre1">3.6</span></a> document two classes of data movement instructions for use when copying a smaller source value to a larger destination. All of these instructions copy data from a source, which can be either a register or stored</p>

<aside class="sidebar pcalibre5 pcalibre" id="P700049702700000000000000000202A" data-uri="chapter03.xhtml#P700049702700000000000000000202A"><header class="pcalibre halftitlepage pcalibre1"><h1 class="pcalibre1 title2 pcalibre" id="P70004970270000000000000000402D2" data-uri="chapter03.xhtml#P70004970270000000000000000402D2" epub:type="title"><span class="pcalibre pagebreak pcalibre1" id="P700049702700000000000000000202C" title="184" data-uri="chapter03.xhtml#P700049702700000000000000000202C" epub:type="pagebreak"></span><span class="pcalibre label1 pcalibre1">Aside </span>Understanding how data movement changes a destination register</h1></header>
<p id="P70004970270000000000000000402D3" data-uri="chapter03.xhtml#P70004970270000000000000000402D3" class="calibre13 pcalibre pcalibre1">As described, there are two different conventions regarding whether and how data movement instructions modify the upper bytes of a destination register. This distinction is illustrated by the following code sequence:</p>
<pre id="P70004970270000000000000000402D4" data-uri="chapter03.xhtml#P70004970270000000000000000402D4" class="calibre9 pcalibre pcalibre1"><code id="P70004970270000000000000000402D5" data-uri="chapter03.xhtml#P70004970270000000000000000402D5" class="calibre10 pcalibre pcalibre1">
1	movabsq	$0x0011223344556677, %rax	<i class="calibre5 pcalibre pcalibre1">%rax = 0011223344556677</i>
2	movb	$-1, %al			<i class="calibre5 pcalibre pcalibre1">%rax = 00112233445566FF</i>
3	movw	$-1, %ax			<i class="calibre5 pcalibre pcalibre1">%rax = 001122334455FFFF</i>
4	movl	$-1, %eax			<i class="calibre5 pcalibre pcalibre1">%rax = 00000000FFFFFFFF</i>
5	movq	$-1, %rax			<i class="calibre5 pcalibre pcalibre1">%rax = FFFFFFFFFFFFFFFF</i>
</code></pre>
<p id="P70004970270000000000000000402D6" data-uri="chapter03.xhtml#P70004970270000000000000000402D6" class="pcalibre calibre3 pcalibre1">In the following discussion, we use hexadecimal notation. In the example, the instruction on line 1 initializes register <code id="P70004970270000000000000000402D7" data-uri="chapter03.xhtml#P70004970270000000000000000402D7" class="pcalibre1 calibre8 pcalibre">%rax</code> to the pattern <code id="P70004970270000000000000000402D8" data-uri="chapter03.xhtml#P70004970270000000000000000402D8" class="pcalibre1 calibre8 pcalibre">0011223344556677</code>. The remaining instructions have immediate value –1 as their source values. Recall that the hexadecimal representation of –1 is of the form <code id="P70004970270000000000000000402D9" data-uri="chapter03.xhtml#P70004970270000000000000000402D9" class="pcalibre1 calibre8 pcalibre">FF···F</code>, where the number of <span class="smallcaps pcalibre pcalibre1">f's </span>is twice the number of bytes in the representation. The <code id="P70004970270000000000000000402DA" data-uri="chapter03.xhtml#P70004970270000000000000000402DA" class="pcalibre1 calibre8 pcalibre">movb</code> instruction (line 2) therefore sets the low-order byte of <code id="P70004970270000000000000000402DB" data-uri="chapter03.xhtml#P70004970270000000000000000402DB" class="pcalibre1 calibre8 pcalibre">%rax</code> to <span class="smallcaps pcalibre pcalibre1">ff</span>, while the <code id="P70004970270000000000000000402DC" data-uri="chapter03.xhtml#P70004970270000000000000000402DC" class="pcalibre1 calibre8 pcalibre">movw</code> instruction (line 3) sets the low-order 2 bytes to <span class="smallcaps pcalibre pcalibre1">ffff</span>, with the remaining bytes unchanged. The <code id="P70004970270000000000000000402DD" data-uri="chapter03.xhtml#P70004970270000000000000000402DD" class="pcalibre1 calibre8 pcalibre">movl</code> instruction (line 4) sets the low-order 4 bytes to <code id="P70004970270000000000000000402DE" data-uri="chapter03.xhtml#P70004970270000000000000000402DE" class="pcalibre1 calibre8 pcalibre">FFFFFFFF</code>, but it also sets the high-order 4 bytes to <code id="P70004970270000000000000000402DF" data-uri="chapter03.xhtml#P70004970270000000000000000402DF" class="pcalibre1 calibre8 pcalibre">00000000</code>. Finally, the <code id="P70004970270000000000000000402E0" data-uri="chapter03.xhtml#P70004970270000000000000000402E0" class="pcalibre1 calibre8 pcalibre">movq</code> instruction (line 5) sets the complete register to <code id="P70004970270000000000000000402E1" data-uri="chapter03.xhtml#P70004970270000000000000000402E1" class="pcalibre1 calibre8 pcalibre">FFFFFFFFFFFFFFFF</code>.</p>
</aside>
<figure class="pcalibre5 figure pcalibre" id="P700049702700000000000000000203C" data-uri="chapter03.xhtml#P700049702700000000000000000203C">
<table id="P70004970270000000000000000402E2" data-uri="chapter03.xhtml#P70004970270000000000000000402E2" class="pcalibre largetable pcalibre1">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P70004970270000000000000000402E3" data-uri="chapter03.xhtml#P70004970270000000000000000402E3" class="calibre18 pcalibre pcalibre1">Instruction</th>
<th id="P70004970270000000000000000402E4" data-uri="chapter03.xhtml#P70004970270000000000000000402E4" class="calibre18 pcalibre pcalibre1">Effect</th>
<th id="P70004970270000000000000000402E5" data-uri="chapter03.xhtml#P70004970270000000000000000402E5" class="calibre18 pcalibre pcalibre1">Description</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000402E6" data-uri="chapter03.xhtml#P70004970270000000000000000402E6" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000402E7" data-uri="chapter03.xhtml#P70004970270000000000000000402E7" class="calibre10 pcalibre pcalibre1"><span class="smallcaps pcalibre pcalibre1">movz </span><var class="calibre5 pcalibre pcalibre1">S</var>,<var class="calibre5 pcalibre pcalibre1">R</var></code></td>
<td id="P70004970270000000000000000402E8" data-uri="chapter03.xhtml#P70004970270000000000000000402E8" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">R</var> ← ZeroExtend<i class="calibre5 pcalibre pcalibre1">(S)</i></td>
<td id="P70004970270000000000000000402E9" data-uri="chapter03.xhtml#P70004970270000000000000000402E9" class="calibre20 pcalibre pcalibre1">Move with zero extension</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000402EA" data-uri="chapter03.xhtml#P70004970270000000000000000402EA" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000402EB" data-uri="chapter03.xhtml#P70004970270000000000000000402EB" class="calibre10 pcalibre pcalibre1">movzbw</code></td>
<td class="calibre20 pcalibre pcalibre1"/>
<td id="P70004970270000000000000000402EC" data-uri="chapter03.xhtml#P70004970270000000000000000402EC" class="calibre20 pcalibre pcalibre1">Move zero-extended byte to word</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000402ED" data-uri="chapter03.xhtml#P70004970270000000000000000402ED" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000402EE" data-uri="chapter03.xhtml#P70004970270000000000000000402EE" class="calibre10 pcalibre pcalibre1">movzbl</code></td>
<td class="calibre20 pcalibre pcalibre1"/>
<td id="P70004970270000000000000000402EF" data-uri="chapter03.xhtml#P70004970270000000000000000402EF" class="calibre20 pcalibre pcalibre1">Move zero-extended byte to double word</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000402F0" data-uri="chapter03.xhtml#P70004970270000000000000000402F0" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000402F1" data-uri="chapter03.xhtml#P70004970270000000000000000402F1" class="calibre10 pcalibre pcalibre1">movzwl</code></td>
<td class="calibre20 pcalibre pcalibre1"/>
<td id="P70004970270000000000000000402F2" data-uri="chapter03.xhtml#P70004970270000000000000000402F2" class="calibre20 pcalibre pcalibre1">Move zero-extended word to double word</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000402F3" data-uri="chapter03.xhtml#P70004970270000000000000000402F3" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000402F4" data-uri="chapter03.xhtml#P70004970270000000000000000402F4" class="calibre10 pcalibre pcalibre1">movzbq</code></td>
<td class="calibre20 pcalibre pcalibre1"/>
<td id="P70004970270000000000000000402F5" data-uri="chapter03.xhtml#P70004970270000000000000000402F5" class="calibre20 pcalibre pcalibre1">Move zero-extended byte to quad word</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000402F6" data-uri="chapter03.xhtml#P70004970270000000000000000402F6" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000402F7" data-uri="chapter03.xhtml#P70004970270000000000000000402F7" class="calibre10 pcalibre pcalibre1">movzwq</code></td>
<td class="calibre20 pcalibre pcalibre1"/>
<td id="P70004970270000000000000000402F8" data-uri="chapter03.xhtml#P70004970270000000000000000402F8" class="calibre20 pcalibre pcalibre1">Move zero-extended word to quad word</td>
</tr>
</tbody>
</table>
<figcaption id="P70004970270000000000000000402F9" data-uri="chapter03.xhtml#P70004970270000000000000000402F9" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P70004970270000000000000000402FA" data-uri="chapter03.xhtml#P70004970270000000000000000402FA" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">3.5 </span>Zero-extending data movement instructions.</h1></header><div class="caption pcalibre pcalibre1" id="P70004970270000000000000000402FB" data-uri="chapter03.xhtml#P70004970270000000000000000402FB"><p id="P70004970270000000000000000402FC" data-uri="chapter03.xhtml#P70004970270000000000000000402FC" class="pcalibre calibre3 pcalibre1">These instructions have a register or memory location as the source and a register as the destination.</p></div></figcaption>
</figure>
<p class="pcalibre1 pcalibre calibre2" id="P70004970270000000000000000402FD" data-uri="chapter03.xhtml#P70004970270000000000000000402FD">in memory, to a register destination. Instructions in the <span class="smallcaps pcalibre pcalibre1">movz </span>class fill out the remaining bytes of the destination with zeros, while those in the <span class="smallcaps pcalibre pcalibre1">movs </span>class fill them out by sign extension, replicating copies of the most significant bit of the source operand. Observe that each instruction name has size designators as its final two characters—the first specifying the source size, and the second specifying the destination size. As can be seen, there are three instructions in each of these classes, covering all cases of 1-and 2-byte source sizes and 2- and 4-byte destination sizes, considering only cases where the destination is larger than the source, of course.</p>
<figure class="pcalibre5 figure pcalibre" id="P7000497027000000000000000002059" data-uri="chapter03.xhtml#P7000497027000000000000000002059">
<table id="P70004970270000000000000000402FE" data-uri="chapter03.xhtml#P70004970270000000000000000402FE" class="pcalibre largetable pcalibre1">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P70004970270000000000000000402FF" data-uri="chapter03.xhtml#P70004970270000000000000000402FF" class="calibre18 pcalibre pcalibre1"><span class="pcalibre pagebreak1 pcalibre1" id="P700049702700000000000000000205C" title="185" data-uri="chapter03.xhtml#P700049702700000000000000000205C" epub:type="pagebreak"></span>Instruction</th>
<th id="P7000497027000000000000000040300" data-uri="chapter03.xhtml#P7000497027000000000000000040300" class="calibre18 pcalibre pcalibre1">Effect</th>
<th id="P7000497027000000000000000040301" data-uri="chapter03.xhtml#P7000497027000000000000000040301" class="calibre18 pcalibre pcalibre1">Description</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000040302" data-uri="chapter03.xhtml#P7000497027000000000000000040302" class="calibre20 pcalibre pcalibre1"><span class="smallcaps pcalibre pcalibre1">movs </span><var class="calibre5 pcalibre pcalibre1">S</var>,<var class="calibre5 pcalibre pcalibre1">R</var></td>
<td id="P7000497027000000000000000040303" data-uri="chapter03.xhtml#P7000497027000000000000000040303" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">R</var> ← SignExtend<i class="calibre5 pcalibre pcalibre1">(S)</i></td>
<td id="P7000497027000000000000000040304" data-uri="chapter03.xhtml#P7000497027000000000000000040304" class="calibre20 pcalibre pcalibre1">Move with sign extension</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000040305" data-uri="chapter03.xhtml#P7000497027000000000000000040305" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000040306" data-uri="chapter03.xhtml#P7000497027000000000000000040306" class="calibre10 pcalibre pcalibre1">movsbw</code></td>
<td class="calibre20 pcalibre pcalibre1"/>
<td id="P7000497027000000000000000040307" data-uri="chapter03.xhtml#P7000497027000000000000000040307" class="calibre20 pcalibre pcalibre1">Move sign-extended byte to word</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000040308" data-uri="chapter03.xhtml#P7000497027000000000000000040308" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000040309" data-uri="chapter03.xhtml#P7000497027000000000000000040309" class="calibre10 pcalibre pcalibre1">movsbl</code></td>
<td class="calibre20 pcalibre pcalibre1"/>
<td id="P700049702700000000000000004030A" data-uri="chapter03.xhtml#P700049702700000000000000004030A" class="calibre20 pcalibre pcalibre1">Move sign-extended byte to double word</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P700049702700000000000000004030B" data-uri="chapter03.xhtml#P700049702700000000000000004030B" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004030C" data-uri="chapter03.xhtml#P700049702700000000000000004030C" class="calibre10 pcalibre pcalibre1">movswl</code></td>
<td class="calibre20 pcalibre pcalibre1"/>
<td id="P700049702700000000000000004030D" data-uri="chapter03.xhtml#P700049702700000000000000004030D" class="calibre20 pcalibre pcalibre1">Move sign-extended word to double word</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P700049702700000000000000004030E" data-uri="chapter03.xhtml#P700049702700000000000000004030E" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004030F" data-uri="chapter03.xhtml#P700049702700000000000000004030F" class="calibre10 pcalibre pcalibre1">movsbq</code></td>
<td class="calibre20 pcalibre pcalibre1"/>
<td id="P7000497027000000000000000040310" data-uri="chapter03.xhtml#P7000497027000000000000000040310" class="calibre20 pcalibre pcalibre1">Move sign-extended byte to quad word</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000040311" data-uri="chapter03.xhtml#P7000497027000000000000000040311" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000040312" data-uri="chapter03.xhtml#P7000497027000000000000000040312" class="calibre10 pcalibre pcalibre1">movswq</code></td>
<td class="calibre20 pcalibre pcalibre1"/>
<td id="P7000497027000000000000000040313" data-uri="chapter03.xhtml#P7000497027000000000000000040313" class="calibre20 pcalibre pcalibre1">Move sign-extended word to quad word</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000040314" data-uri="chapter03.xhtml#P7000497027000000000000000040314" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000040315" data-uri="chapter03.xhtml#P7000497027000000000000000040315" class="calibre10 pcalibre pcalibre1">movslq</code></td>
<td class="calibre20 pcalibre pcalibre1"/>
<td id="P7000497027000000000000000040316" data-uri="chapter03.xhtml#P7000497027000000000000000040316" class="calibre20 pcalibre pcalibre1">Move sign-extended double word to quad word</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000040317" data-uri="chapter03.xhtml#P7000497027000000000000000040317" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000040318" data-uri="chapter03.xhtml#P7000497027000000000000000040318" class="calibre10 pcalibre pcalibre1">cltq</code></td>
<td id="P7000497027000000000000000040319" data-uri="chapter03.xhtml#P7000497027000000000000000040319" class="calibre20 pcalibre pcalibre1">%rax ← SignExtend(%eax)</td>
<td id="P700049702700000000000000004031A" data-uri="chapter03.xhtml#P700049702700000000000000004031A" class="calibre20 pcalibre pcalibre1">Sign-extend %eax to %rax</td>
</tr>
</tbody>
</table>
<figcaption id="P700049702700000000000000004031B" data-uri="chapter03.xhtml#P700049702700000000000000004031B" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P700049702700000000000000004031C" data-uri="chapter03.xhtml#P700049702700000000000000004031C" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">3.6 </span>Sign-extending data movement instructions.</h1></header><div class="caption pcalibre pcalibre1" id="P700049702700000000000000004031D" data-uri="chapter03.xhtml#P700049702700000000000000004031D"><p id="P700049702700000000000000004031E" data-uri="chapter03.xhtml#P700049702700000000000000004031E" class="pcalibre calibre3 pcalibre1">The <span class="smallcaps pcalibre pcalibre1">movs </span>instructions have a register or memory location as the source and a register as the destination. The <code id="P700049702700000000000000004031F" data-uri="chapter03.xhtml#P700049702700000000000000004031F" class="pcalibre1 calibre8 pcalibre">cltq</code> instruction is specific to registers <code id="P7000497027000000000000000040320" data-uri="chapter03.xhtml#P7000497027000000000000000040320" class="pcalibre1 calibre8 pcalibre">%eax</code> and <code id="P7000497027000000000000000040321" data-uri="chapter03.xhtml#P7000497027000000000000000040321" class="pcalibre1 calibre8 pcalibre">%rax</code>.</p></div></figcaption>
</figure>
<p id="P7000497027000000000000000040322" data-uri="chapter03.xhtml#P7000497027000000000000000040322" class="pcalibre1 pcalibre calibre2">Note the absence of an explicit instruction to zero-extend a 4-byte source value to an 8-byte destination in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P700049702700000000000000000203C"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">3.5</span></a>. Such an instruction would logically be named <code id="P7000497027000000000000000040323" data-uri="chapter03.xhtml#P7000497027000000000000000040323" class="pcalibre1 calibre8 pcalibre">movzlq</code>, but this instruction does not exist. Instead, this type of data movement can be implemented using a <code id="P7000497027000000000000000040324" data-uri="chapter03.xhtml#P7000497027000000000000000040324" class="pcalibre1 calibre8 pcalibre">movl</code> instruction having a register as the destination. This technique takes advantage of the property that an instruction generating a 4-byte value with a register as the destination will fill the upper 4 bytes with zeros. Otherwise, for 64-bit destinations, moving with sign extension is supported for all three source types, and moving with zero extension is supported for the two smaller source types.</p>
<p id="P7000497027000000000000000040325" data-uri="chapter03.xhtml#P7000497027000000000000000040325" class="pcalibre1 pcalibre calibre2"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000002059"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">3.6</span></a> also documents the <code id="P7000497027000000000000000040326" data-uri="chapter03.xhtml#P7000497027000000000000000040326" class="pcalibre1 calibre8 pcalibre">cltq</code> instruction. This instruction has no operands—it always uses register <code id="P7000497027000000000000000040327" data-uri="chapter03.xhtml#P7000497027000000000000000040327" class="pcalibre1 calibre8 pcalibre">%eax</code> as its source and <code id="P7000497027000000000000000040328" data-uri="chapter03.xhtml#P7000497027000000000000000040328" class="pcalibre1 calibre8 pcalibre">%rax</code> as the destination for the sign-extended result. It therefore has the exact same effect as the instruction <code id="P7000497027000000000000000040329" data-uri="chapter03.xhtml#P7000497027000000000000000040329" class="pcalibre1 calibre8 pcalibre">movslq %eax, %rax</code>, but it has a more compact encoding.</p>
<section id="P7000497027000000000000000002087" data-uri="chapter03.xhtml#P7000497027000000000000000002087" epub:type="practice" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title5 pcalibre pcalibre1" id="P700049702700000000000000004032A" data-uri="chapter03.xhtml#P700049702700000000000000004032A" epub:type="title"><span class="pcalibre label pcalibre1">Practice Problem </span><span class="pcalibre label pcalibre1">3.2 </span>(solution page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP70004970270000000000000000032E1.xhtml#P7000497027000000000000000003443">325</a>)</h1></header>
<ol class="practicelist pcalibre pcalibre1" id="P700049702700000000000000004032B" data-uri="chapter03.xhtml#P700049702700000000000000004032B">
<li class="general-problem pcalibre pcalibre1" id="P700049702700000000000000004032C" data-uri="chapter03.xhtml#P700049702700000000000000004032C">
<div class="edition pcalibre pcalibre1" id="P700049702700000000000000004032D" data-uri="chapter03.xhtml#P700049702700000000000000004032D"><p id="P700049702700000000000000004032E" data-uri="chapter03.xhtml#P700049702700000000000000004032E" class="pcalibre calibre3 pcalibre1">For each of the following lines of assembly language, determine the appropriate instruction suffix based on the operands. (For example, <code id="P700049702700000000000000004032F" data-uri="chapter03.xhtml#P700049702700000000000000004032F" class="pcalibre1 calibre8 pcalibre">mov</code> can be rewritten as <code id="P7000497027000000000000000040330" data-uri="chapter03.xhtml#P7000497027000000000000000040330" class="pcalibre1 calibre8 pcalibre">movb, movw, movl, or movq.</code>)</p>
<pre id="P7000497027000000000000000040331" data-uri="chapter03.xhtml#P7000497027000000000000000040331" class="calibre9 pcalibre pcalibre1"><code id="P7000497027000000000000000040332" data-uri="chapter03.xhtml#P7000497027000000000000000040332" class="calibre10 pcalibre pcalibre1">
mov___	%eax, (%rsp)
mov___	(%rax), %dx
mov___	$0xFF, %bl
mov___	(%rsp,%rdx,4), %dl
mov___	(%rdx), %rax
mov___	%dx, (%rax)
</code></pre>
</div>
</li></ol>
</section>
<aside class="sidebar pcalibre5 pcalibre" id="P7000497027000000000000000002091" data-uri="chapter03.xhtml#P7000497027000000000000000002091"><header class="pcalibre halftitlepage pcalibre1"><h1 class="pcalibre1 title2 pcalibre" id="P7000497027000000000000000040333" data-uri="chapter03.xhtml#P7000497027000000000000000040333" epub:type="title"><span class="pcalibre pagebreak pcalibre1" id="P7000497027000000000000000002093" title="186" data-uri="chapter03.xhtml#P7000497027000000000000000002093" epub:type="pagebreak"></span><span class="pcalibre label1 pcalibre1">Aside </span>Comparing byte movement instructions</h1></header>
<p id="P7000497027000000000000000040334" data-uri="chapter03.xhtml#P7000497027000000000000000040334" class="calibre13 pcalibre pcalibre1">The following example illustrates how different data movement instructions either do or do not change the high-order bytes of the destination. Observe that the three byte-movement instructions <code id="P7000497027000000000000000040335" data-uri="chapter03.xhtml#P7000497027000000000000000040335" class="pcalibre1 calibre8 pcalibre">movb, movsbq</code>, and <code id="P7000497027000000000000000040336" data-uri="chapter03.xhtml#P7000497027000000000000000040336" class="pcalibre1 calibre8 pcalibre">movzbq</code> differ from each other in subtle ways. Here is an example:</p>
<pre id="P7000497027000000000000000040337" data-uri="chapter03.xhtml#P7000497027000000000000000040337" class="calibre9 pcalibre pcalibre1"><code id="P7000497027000000000000000040338" data-uri="chapter03.xhtml#P7000497027000000000000000040338" class="calibre10 pcalibre pcalibre1">
1	movabsq $0x0011223344556677, %rax	<i class="calibre5 pcalibre pcalibre1">%rax = 0011223344556677</i>
2	movb $0xAA, %dl				<i class="calibre5 pcalibre pcalibre1">%dl = AA</i>
3	movb %dl,%al				<i class="calibre5 pcalibre pcalibre1">%rax = 00112233445566AA</i>
4	movsbq %dl,%rax				<i class="calibre5 pcalibre pcalibre1">%rax = FFFFFFFFFFFFFFAA</i>
5	movzbq %dl,%rax				<i class="calibre5 pcalibre pcalibre1">%rax = 00000000000000AA</i>
</code></pre>
<p id="P7000497027000000000000000040339" data-uri="chapter03.xhtml#P7000497027000000000000000040339" class="pcalibre calibre3 pcalibre1">In the following discussion, we use hexadecimal notation for all of the values. The first two lines of the code initialize registers <code id="P700049702700000000000000004033A" data-uri="chapter03.xhtml#P700049702700000000000000004033A" class="pcalibre1 calibre8 pcalibre">%rax</code> and <code id="P700049702700000000000000004033B" data-uri="chapter03.xhtml#P700049702700000000000000004033B" class="pcalibre1 calibre8 pcalibre">%dl</code> to <code id="P700049702700000000000000004033C" data-uri="chapter03.xhtml#P700049702700000000000000004033C" class="pcalibre1 calibre8 pcalibre">0011223344556677</code> and AA, respectively. The remaining instructions all copy the low-order byte of <code id="P700049702700000000000000004033D" data-uri="chapter03.xhtml#P700049702700000000000000004033D" class="pcalibre1 calibre8 pcalibre">%rdx</code> to the low-order byte of <code id="P700049702700000000000000004033E" data-uri="chapter03.xhtml#P700049702700000000000000004033E" class="pcalibre1 calibre8 pcalibre">%rax</code>. The <code id="P700049702700000000000000004033F" data-uri="chapter03.xhtml#P700049702700000000000000004033F" class="pcalibre1 calibre8 pcalibre">movb</code> instruction (line 3) does not change the other bytes. The <code id="P7000497027000000000000000040340" data-uri="chapter03.xhtml#P7000497027000000000000000040340" class="pcalibre1 calibre8 pcalibre">movsbq</code> instruction (line 4) sets the other 7 bytes to either all ones or all zeros depending on the high-order bit of the source byte. Since hexadecimal A represents binary value <code id="P7000497027000000000000000040341" data-uri="chapter03.xhtml#P7000497027000000000000000040341" class="pcalibre1 calibre8 pcalibre">1010</code>, sign extension causes the higher-order bytes to each be set to FF. The <code id="P7000497027000000000000000040342" data-uri="chapter03.xhtml#P7000497027000000000000000040342" class="pcalibre1 calibre8 pcalibre">movzbq</code> instruction (line 5) always sets the other 7 bytes to zero.</p>
</aside>
<section id="P70004970270000000000000000020A3" data-uri="chapter03.xhtml#P70004970270000000000000000020A3" epub:type="practice" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title5 pcalibre pcalibre1" id="P7000497027000000000000000040343" data-uri="chapter03.xhtml#P7000497027000000000000000040343" epub:type="title"><span class="pcalibre label pcalibre1">Practice Problem </span><span class="pcalibre label pcalibre1">3.3 </span>(solution page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP700049702700000000000000000344D_split_000.xhtml#P7000497027000000000000000003490">326</a>)</h1></header>
<ol class="practicelist pcalibre pcalibre1" id="P7000497027000000000000000040344" data-uri="chapter03.xhtml#P7000497027000000000000000040344">
<li class="general-problem pcalibre pcalibre1" id="P7000497027000000000000000040345" data-uri="chapter03.xhtml#P7000497027000000000000000040345">
<div class="edition pcalibre pcalibre1" id="P7000497027000000000000000040346" data-uri="chapter03.xhtml#P7000497027000000000000000040346"><p id="P7000497027000000000000000040347" data-uri="chapter03.xhtml#P7000497027000000000000000040347" class="pcalibre calibre3 pcalibre1">Each of the following lines of code generates an error message when we invoke the assembler. Explain what is wrong with each line.</p>
<pre id="P7000497027000000000000000040348" data-uri="chapter03.xhtml#P7000497027000000000000000040348" class="calibre9 pcalibre pcalibre1"><code id="P7000497027000000000000000040349" data-uri="chapter03.xhtml#P7000497027000000000000000040349" class="calibre10 pcalibre pcalibre1">
movb $0xF, (%ebx)
movl %rax, (%rsp)
movw (%rax),4(%rsp)
movb %al,%sl
movq %rax,$0x123
movl %eax,%rdx
movb %si, 8(%rbp)
</code></pre>
</div></li></ol>
</section>
</section>
<section id="P70004970270000000000000000020AB" data-uri="chapter03.xhtml#P70004970270000000000000000020AB" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P700049702700000000000000004034A" data-uri="chapter03.xhtml#P700049702700000000000000004034A" epub:type="title"><span class="pcalibre label pcalibre1">3.4.3 </span>Data Movement Example</h1></header>
<p id="P700049702700000000000000004034B" data-uri="chapter03.xhtml#P700049702700000000000000004034B" class="pcalibre1 pcalibre calibre2">As an example of code that uses data movement instructions, consider the data exchange routine shown in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P70004970270000000000000000020B2"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">3.7</span></a>, both as C code and as assembly code generated by <span class="smallcaps pcalibre pcalibre1">gcc</span>.</p>
<p id="P700049702700000000000000004034C" data-uri="chapter03.xhtml#P700049702700000000000000004034C" class="pcalibre1 pcalibre calibre2">As <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P70004970270000000000000000020B2"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">3.7(b)</span></a> shows, function exchange is implemented with just three instructions: two data movements (<code id="P700049702700000000000000004034D" data-uri="chapter03.xhtml#P700049702700000000000000004034D" class="pcalibre1 calibre8 pcalibre">movq</code>) plus an instruction to return back to the point from which the function was called (<code id="P700049702700000000000000004034E" data-uri="chapter03.xhtml#P700049702700000000000000004034E" class="pcalibre1 calibre8 pcalibre">ret</code>). We will cover the details of function call and return in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP700049702700000000000000000281F.xhtml#P700049702700000000000000000281F"><span class="pcalibre label pcalibre1">Section </span><span class="pcalibre label pcalibre1">3.7</span></a>. Until then, it suffices to say that arguments are passed to functions in registers. Our annotated assembly code documents these. A function returns a value by storing it in register <code id="P700049702700000000000000004034F" data-uri="chapter03.xhtml#P700049702700000000000000004034F" class="pcalibre1 calibre8 pcalibre">%rax</code>, or in one of the low-order portions of this register.</p>
<figure class="pcalibre5 figure pcalibre" id="P70004970270000000000000000020B2" data-uri="chapter03.xhtml#P70004970270000000000000000020B2">
<ol class="pcalibre1 ol_lower-alpha pcalibre" id="P7000497027000000000000000040350" data-uri="chapter03.xhtml#P7000497027000000000000000040350">
<li id="P7000497027000000000000000040351" data-uri="chapter03.xhtml#P7000497027000000000000000040351" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000040352" data-uri="chapter03.xhtml#P7000497027000000000000000040352" class="pcalibre calibre3 pcalibre1"><span class="pcalibre pagebreak1 pcalibre1" id="P70004970270000000000000000020B6" title="187" data-uri="chapter03.xhtml#P70004970270000000000000000020B6" epub:type="pagebreak"></span>C code</p>
<pre id="P7000497027000000000000000040353" data-uri="chapter03.xhtml#P7000497027000000000000000040353" class="calibre86 pcalibre pcalibre1"><code id="P7000497027000000000000000040354" data-uri="chapter03.xhtml#P7000497027000000000000000040354" class="calibre10 pcalibre pcalibre1">
long exchange(long *xp, long y)
{
	long x = *xp;
	*xp = y;
	return x;
}
</code></pre>
</li>
<li id="P7000497027000000000000000040355" data-uri="chapter03.xhtml#P7000497027000000000000000040355" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000040356" data-uri="chapter03.xhtml#P7000497027000000000000000040356" class="pcalibre calibre3 pcalibre1">Assembly code</p>
<pre id="P7000497027000000000000000040357" data-uri="chapter03.xhtml#P7000497027000000000000000040357" class="calibre86 pcalibre pcalibre1"><code id="P7000497027000000000000000040358" data-uri="chapter03.xhtml#P7000497027000000000000000040358" class="calibre10 pcalibre pcalibre1">
<i class="calibre5 pcalibre pcalibre1">long exchange(long *xp, long y)</i>
<i class="calibre5 pcalibre pcalibre1">xp in %rdi, y in %rsi</i>
1	exchange:
2	movq	(%rdi), %rax	<i class="calibre5 pcalibre pcalibre1">Get x at xp. Set as return value.</i>
3	movq	%rsi, (%rdi)	<i class="calibre5 pcalibre pcalibre1">Store y at xp.</i>
4	ret			<i class="calibre5 pcalibre pcalibre1">Return.</i>
</code></pre>
</li></ol>
<figcaption id="P7000497027000000000000000040359" data-uri="chapter03.xhtml#P7000497027000000000000000040359" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P700049702700000000000000004035A" data-uri="chapter03.xhtml#P700049702700000000000000004035A" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">3.7 </span>C and assembly code for exchange routine.</h1></header><div class="caption pcalibre pcalibre1" id="P700049702700000000000000004035B" data-uri="chapter03.xhtml#P700049702700000000000000004035B"><p id="P700049702700000000000000004035C" data-uri="chapter03.xhtml#P700049702700000000000000004035C" class="pcalibre calibre3 pcalibre1">Registers <code id="P700049702700000000000000004035D" data-uri="chapter03.xhtml#P700049702700000000000000004035D" class="pcalibre1 calibre8 pcalibre">%rdi</code> and <code id="P700049702700000000000000004035E" data-uri="chapter03.xhtml#P700049702700000000000000004035E" class="pcalibre1 calibre8 pcalibre">%rsi</code> hold parameters <code id="P700049702700000000000000004035F" data-uri="chapter03.xhtml#P700049702700000000000000004035F" class="pcalibre1 calibre8 pcalibre">xp</code> and <code id="P7000497027000000000000000040360" data-uri="chapter03.xhtml#P7000497027000000000000000040360" class="pcalibre1 calibre8 pcalibre">y</code>, respectively.</p></div></figcaption>
</figure>
<p id="P7000497027000000000000000040361" data-uri="chapter03.xhtml#P7000497027000000000000000040361" class="pcalibre1 pcalibre calibre2">When the procedure begins execution, procedure parameters <code id="P7000497027000000000000000040362" data-uri="chapter03.xhtml#P7000497027000000000000000040362" class="pcalibre1 calibre8 pcalibre">xp</code> and <code id="P7000497027000000000000000040363" data-uri="chapter03.xhtml#P7000497027000000000000000040363" class="pcalibre1 calibre8 pcalibre">y</code> are stored in registers <code id="P7000497027000000000000000040364" data-uri="chapter03.xhtml#P7000497027000000000000000040364" class="pcalibre1 calibre8 pcalibre">%rdi</code> and <code id="P7000497027000000000000000040365" data-uri="chapter03.xhtml#P7000497027000000000000000040365" class="pcalibre1 calibre8 pcalibre">%rsi</code>, respectively. Instruction 2 then reads <code id="P7000497027000000000000000040366" data-uri="chapter03.xhtml#P7000497027000000000000000040366" class="pcalibre1 calibre8 pcalibre">x</code> from memory and stores the value in register <code id="P7000497027000000000000000040367" data-uri="chapter03.xhtml#P7000497027000000000000000040367" class="pcalibre1 calibre8 pcalibre">%rax</code>, a direct implementation of the operation <code id="P7000497027000000000000000040368" data-uri="chapter03.xhtml#P7000497027000000000000000040368" class="pcalibre1 calibre8 pcalibre">x = *xp</code> in the C program. Later, register <code id="P7000497027000000000000000040369" data-uri="chapter03.xhtml#P7000497027000000000000000040369" class="pcalibre1 calibre8 pcalibre">%rax</code> will be used to return a value from the function, and so the return value will be <code id="P700049702700000000000000004036A" data-uri="chapter03.xhtml#P700049702700000000000000004036A" class="pcalibre1 calibre8 pcalibre">x</code>. Instruction 3 writes <code id="P700049702700000000000000004036B" data-uri="chapter03.xhtml#P700049702700000000000000004036B" class="pcalibre1 calibre8 pcalibre">y</code> to the memory location designated by <code id="P700049702700000000000000004036C" data-uri="chapter03.xhtml#P700049702700000000000000004036C" class="pcalibre1 calibre8 pcalibre">xp</code> in register <code id="P700049702700000000000000004036D" data-uri="chapter03.xhtml#P700049702700000000000000004036D" class="pcalibre1 calibre8 pcalibre">%rdi</code>, a direct implementation of the operation <code id="P700049702700000000000000004036E" data-uri="chapter03.xhtml#P700049702700000000000000004036E" class="pcalibre1 calibre8 pcalibre">*xp = y</code>. This example illustrates how the <span class="smallcaps pcalibre pcalibre1">mov </span>instructions can be used to read from memory to a register (line 2), and to write from a register to memory (line 3).</p>
<p id="P700049702700000000000000004036F" data-uri="chapter03.xhtml#P700049702700000000000000004036F" class="pcalibre1 pcalibre calibre2">Two features about this assembly code are worth noting. First, we see that what we call "pointers" in C are simply addresses. Dereferencing a pointer involves copying that pointer into a register, and then using this register in a memory reference. Second, local variables such as <code id="P7000497027000000000000000040370" data-uri="chapter03.xhtml#P7000497027000000000000000040370" class="pcalibre1 calibre8 pcalibre">x</code> are often kept in registers rather than stored in memory locations. Register access is much faster than memory access.</p>
<section id="P70004970270000000000000000020D5" data-uri="chapter03.xhtml#P70004970270000000000000000020D5" epub:type="practice" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title5 pcalibre pcalibre1" id="P7000497027000000000000000040371" data-uri="chapter03.xhtml#P7000497027000000000000000040371" epub:type="title"><span class="pcalibre label pcalibre1">Practice Problem </span><span class="pcalibre label pcalibre1">3.4 </span>(solution page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP700049702700000000000000000344D_split_000.xhtml#P7000497027000000000000000003490">326</a>)</h1></header>
<ol class="practicelist pcalibre pcalibre1" id="P7000497027000000000000000040372" data-uri="chapter03.xhtml#P7000497027000000000000000040372">
<li class="general-problem pcalibre pcalibre1" id="P7000497027000000000000000040373" data-uri="chapter03.xhtml#P7000497027000000000000000040373">
<div class="edition pcalibre pcalibre1" id="P7000497027000000000000000040374" data-uri="chapter03.xhtml#P7000497027000000000000000040374"><p id="P7000497027000000000000000040375" data-uri="chapter03.xhtml#P7000497027000000000000000040375" class="pcalibre calibre3 pcalibre1">Assume variables sp and dp are declared with types</p>
<pre id="P7000497027000000000000000040376" data-uri="chapter03.xhtml#P7000497027000000000000000040376" class="calibre9 pcalibre pcalibre1"><code id="P7000497027000000000000000040377" data-uri="chapter03.xhtml#P7000497027000000000000000040377" class="calibre10 pcalibre pcalibre1">
src_t *sp;
dest_t *dp;
</code></pre>
<p class="pcalibre calibre3 pcalibre1" id="P7000497027000000000000000040378" data-uri="chapter03.xhtml#P7000497027000000000000000040378">where <code id="P7000497027000000000000000040379" data-uri="chapter03.xhtml#P7000497027000000000000000040379" class="pcalibre1 calibre8 pcalibre">src_t</code> and <code id="P700049702700000000000000004037A" data-uri="chapter03.xhtml#P700049702700000000000000004037A" class="pcalibre1 calibre8 pcalibre">dest_t</code> are data types declared with <code id="P700049702700000000000000004037B" data-uri="chapter03.xhtml#P700049702700000000000000004037B" class="pcalibre1 calibre8 pcalibre">typedef</code>. We wish to use the appropriate pair of data movement instructions to implement the operation</p>
<pre id="P700049702700000000000000004037C" data-uri="chapter03.xhtml#P700049702700000000000000004037C" class="calibre9 pcalibre pcalibre1"><code id="P700049702700000000000000004037D" data-uri="chapter03.xhtml#P700049702700000000000000004037D" class="calibre10 pcalibre pcalibre1">
*dp = (dest_t) *sp;
</code></pre>
</div>
</li>
</ol>
</section>
<aside class="sidebar pcalibre5 pcalibre" id="P70004970270000000000000000020E3" data-uri="chapter03.xhtml#P70004970270000000000000000020E3"><header class="pcalibre halftitlepage pcalibre1"><h1 class="pcalibre1 title2 pcalibre" id="P700049702700000000000000004037E" data-uri="chapter03.xhtml#P700049702700000000000000004037E" epub:type="title"><span class="pcalibre pagebreak pcalibre1" id="P70004970270000000000000000020E5" title="188" data-uri="chapter03.xhtml#P70004970270000000000000000020E5" epub:type="pagebreak"></span><span class="pcalibre label1 pcalibre1">New to C? </span>Some examples of pointers</h1></header>
<p id="P700049702700000000000000004037F" data-uri="chapter03.xhtml#P700049702700000000000000004037F" class="calibre13 pcalibre pcalibre1">Function exchange (<a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P70004970270000000000000000020B2"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">3.7(a)</span></a>) provides a good illustration of the use of pointers in C. Argument <code id="P7000497027000000000000000040380" data-uri="chapter03.xhtml#P7000497027000000000000000040380" class="pcalibre1 calibre8 pcalibre">xp</code> is a pointer to a long integer, while <code id="P7000497027000000000000000040381" data-uri="chapter03.xhtml#P7000497027000000000000000040381" class="pcalibre1 calibre8 pcalibre">y</code> is a long integer itself. The statement</p>
<pre id="P7000497027000000000000000040382" data-uri="chapter03.xhtml#P7000497027000000000000000040382" class="calibre9 pcalibre pcalibre1"><code id="P7000497027000000000000000040383" data-uri="chapter03.xhtml#P7000497027000000000000000040383" class="calibre10 pcalibre pcalibre1">
long x = *xp;
</code></pre>
<p class="calibre13 pcalibre pcalibre1" id="P7000497027000000000000000040384" data-uri="chapter03.xhtml#P7000497027000000000000000040384">indicates that we should read the value stored in the location designated by <code id="P7000497027000000000000000040385" data-uri="chapter03.xhtml#P7000497027000000000000000040385" class="pcalibre1 calibre8 pcalibre">xp</code> and store it as a local variable named <code id="P7000497027000000000000000040386" data-uri="chapter03.xhtml#P7000497027000000000000000040386" class="pcalibre1 calibre8 pcalibre">x</code>. This read operation is known as pointer <i class="calibre5 pcalibre pcalibre1">dereferencing</i>. The C operator `*' performs pointer dereferencing. The statement</p>
<pre id="P7000497027000000000000000040387" data-uri="chapter03.xhtml#P7000497027000000000000000040387" class="calibre9 pcalibre pcalibre1"><code id="P7000497027000000000000000040388" data-uri="chapter03.xhtml#P7000497027000000000000000040388" class="calibre10 pcalibre pcalibre1">
*xp = y;
</code></pre>
<p class="calibre13 pcalibre pcalibre1" id="P7000497027000000000000000040389" data-uri="chapter03.xhtml#P7000497027000000000000000040389">does the reverse—it writes the value of parameter <code id="P700049702700000000000000004038A" data-uri="chapter03.xhtml#P700049702700000000000000004038A" class="pcalibre1 calibre8 pcalibre">y</code> at the location designated by <code id="P700049702700000000000000004038B" data-uri="chapter03.xhtml#P700049702700000000000000004038B" class="pcalibre1 calibre8 pcalibre">xp</code>. This is also a form of pointer dereferencing (and hence the operator *), but it indicates a write operation since it is on the left-hand side of the assignment.</p>
<p id="P700049702700000000000000004038C" data-uri="chapter03.xhtml#P700049702700000000000000004038C" class="calibre13 pcalibre pcalibre1">The following is an example of exchange in action:</p>
<pre id="P700049702700000000000000004038D" data-uri="chapter03.xhtml#P700049702700000000000000004038D" class="calibre9 pcalibre pcalibre1"><code id="P700049702700000000000000004038E" data-uri="chapter03.xhtml#P700049702700000000000000004038E" class="calibre10 pcalibre pcalibre1">
long a = 4;
long b = exchange(&amp;a, 3);
printf("a = %ld, b = %ld\verb@\@n", a, b);
</code></pre>
<p id="P700049702700000000000000004038F" data-uri="chapter03.xhtml#P700049702700000000000000004038F" class="calibre13 pcalibre pcalibre1">This code will print</p>
<pre id="P7000497027000000000000000040390" data-uri="chapter03.xhtml#P7000497027000000000000000040390" class="calibre9 pcalibre pcalibre1"><code id="P7000497027000000000000000040391" data-uri="chapter03.xhtml#P7000497027000000000000000040391" class="calibre10 pcalibre pcalibre1">
a = 3, b = 4
</code></pre>
<p id="P7000497027000000000000000040392" data-uri="chapter03.xhtml#P7000497027000000000000000040392" class="pcalibre calibre3 pcalibre1">The C operator `&amp;' (called the "address of" operator) <i class="calibre5 pcalibre pcalibre1">creates</i> a pointer, in this case to the location holding local variable a. Function exchange overwrites the value stored in a with 3 but returns the previous value, 4, as the function value. Observe how by passing a pointer to exchange, it could modify data held at some remote location.</p>
</aside>
<p id="P7000497027000000000000000040393" data-uri="chapter03.xhtml#P7000497027000000000000000040393" class="pcalibre1 pcalibre calibre2">Assume that the values of <code id="P7000497027000000000000000040394" data-uri="chapter03.xhtml#P7000497027000000000000000040394" class="pcalibre1 calibre8 pcalibre">sp</code> and <code id="P7000497027000000000000000040395" data-uri="chapter03.xhtml#P7000497027000000000000000040395" class="pcalibre1 calibre8 pcalibre">dp</code> are stored in registers <code id="P7000497027000000000000000040396" data-uri="chapter03.xhtml#P7000497027000000000000000040396" class="pcalibre1 calibre8 pcalibre">%rdi</code> and <code id="P7000497027000000000000000040397" data-uri="chapter03.xhtml#P7000497027000000000000000040397" class="pcalibre1 calibre8 pcalibre">%rsi</code>, respectively. For each entry in the table, show the two instructions that implement the specified data movement. The first instruction in the sequence should read from memory, do the appropriate conversion, and set the appropriate portion of register <code id="P7000497027000000000000000040398" data-uri="chapter03.xhtml#P7000497027000000000000000040398" class="pcalibre1 calibre8 pcalibre">%rax</code>. The second instruction should then write the appropriate portion of <code id="P7000497027000000000000000040399" data-uri="chapter03.xhtml#P7000497027000000000000000040399" class="pcalibre1 calibre8 pcalibre">%rax</code> to memory. In both cases, the portions may be <code id="P700049702700000000000000004039A" data-uri="chapter03.xhtml#P700049702700000000000000004039A" class="pcalibre1 calibre8 pcalibre">%rax</code>, <code id="P700049702700000000000000004039B" data-uri="chapter03.xhtml#P700049702700000000000000004039B" class="pcalibre1 calibre8 pcalibre">%eax</code>, <code id="P700049702700000000000000004039C" data-uri="chapter03.xhtml#P700049702700000000000000004039C" class="pcalibre1 calibre8 pcalibre">%ax</code>, or <code id="P700049702700000000000000004039D" data-uri="chapter03.xhtml#P700049702700000000000000004039D" class="pcalibre1 calibre8 pcalibre">%al</code>, and they may differ from one another.</p>
<p id="P700049702700000000000000004039E" data-uri="chapter03.xhtml#P700049702700000000000000004039E" class="pcalibre1 pcalibre calibre2">Recall that when performing a cast that involves both a size change and a change of "signedness" in C, the operation should change the size first (<a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP700049702700000000000000000077D_split_001.xhtml#P7000497027000000000000000000BAC"><span class="pcalibre label pcalibre1">Section </span><span class="pcalibre label pcalibre1">2.2.6</span></a>).</p>
<table id="P700049702700000000000000004039F" data-uri="chapter03.xhtml#P700049702700000000000000004039F" class="pcalibre largetable pcalibre1">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P70004970270000000000000000403A0" data-uri="chapter03.xhtml#P70004970270000000000000000403A0" class="calibre18 pcalibre pcalibre1"><code id="P70004970270000000000000000403A1" data-uri="chapter03.xhtml#P70004970270000000000000000403A1" class="calibre10 pcalibre pcalibre1">src_t</code></th>
<th id="P70004970270000000000000000403A2" data-uri="chapter03.xhtml#P70004970270000000000000000403A2" class="calibre18 pcalibre pcalibre1"><code id="P70004970270000000000000000403A3" data-uri="chapter03.xhtml#P70004970270000000000000000403A3" class="calibre10 pcalibre pcalibre1">dest_t</code></th>
<th id="P70004970270000000000000000403A4" data-uri="chapter03.xhtml#P70004970270000000000000000403A4" class="calibre18 pcalibre pcalibre1">Instruction</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000403A5" data-uri="chapter03.xhtml#P70004970270000000000000000403A5" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000403A6" data-uri="chapter03.xhtml#P70004970270000000000000000403A6" class="calibre10 pcalibre pcalibre1">long</code></td>
<td id="P70004970270000000000000000403A7" data-uri="chapter03.xhtml#P70004970270000000000000000403A7" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000403A8" data-uri="chapter03.xhtml#P70004970270000000000000000403A8" class="calibre10 pcalibre pcalibre1">long</code></td>
<td id="P70004970270000000000000000403A9" data-uri="chapter03.xhtml#P70004970270000000000000000403A9" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000403AA" data-uri="chapter03.xhtml#P70004970270000000000000000403AA" class="calibre10 pcalibre pcalibre1">movq (%rdi), %rax movq %rax, (%rsi)</code></td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000403AB" data-uri="chapter03.xhtml#P70004970270000000000000000403AB" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000403AC" data-uri="chapter03.xhtml#P70004970270000000000000000403AC" class="calibre10 pcalibre pcalibre1">char</code></td>
<td id="P70004970270000000000000000403AD" data-uri="chapter03.xhtml#P70004970270000000000000000403AD" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000403AE" data-uri="chapter03.xhtml#P70004970270000000000000000403AE" class="calibre10 pcalibre pcalibre1">int</code></td>
<td id="P70004970270000000000000000403AF" data-uri="chapter03.xhtml#P70004970270000000000000000403AF" class="calibre20 pcalibre pcalibre1">__________<br class="edition pcalibre pcalibre1"/>__________</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000403B0" data-uri="chapter03.xhtml#P70004970270000000000000000403B0" class="calibre20 pcalibre pcalibre1"><span class="pcalibre pagebreak pcalibre1" id="P7000497027000000000000000002118" title="189" data-uri="chapter03.xhtml#P7000497027000000000000000002118" epub:type="pagebreak"></span><code id="P70004970270000000000000000403B1" data-uri="chapter03.xhtml#P70004970270000000000000000403B1" class="calibre10 pcalibre pcalibre1">char</code></td>
<td id="P70004970270000000000000000403B2" data-uri="chapter03.xhtml#P70004970270000000000000000403B2" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000403B3" data-uri="chapter03.xhtml#P70004970270000000000000000403B3" class="calibre10 pcalibre pcalibre1">unsigned</code></td>
<td id="P70004970270000000000000000403B4" data-uri="chapter03.xhtml#P70004970270000000000000000403B4" class="calibre20 pcalibre pcalibre1">__________<br class="edition pcalibre pcalibre1"/>__________</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000403B5" data-uri="chapter03.xhtml#P70004970270000000000000000403B5" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000403B6" data-uri="chapter03.xhtml#P70004970270000000000000000403B6" class="calibre10 pcalibre pcalibre1">unsigned char</code></td>
<td id="P70004970270000000000000000403B7" data-uri="chapter03.xhtml#P70004970270000000000000000403B7" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000403B8" data-uri="chapter03.xhtml#P70004970270000000000000000403B8" class="calibre10 pcalibre pcalibre1">long</code></td>
<td id="P70004970270000000000000000403B9" data-uri="chapter03.xhtml#P70004970270000000000000000403B9" class="calibre20 pcalibre pcalibre1">__________<br class="edition pcalibre pcalibre1"/>__________</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000403BA" data-uri="chapter03.xhtml#P70004970270000000000000000403BA" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000403BB" data-uri="chapter03.xhtml#P70004970270000000000000000403BB" class="calibre10 pcalibre pcalibre1">int</code></td>
<td id="P70004970270000000000000000403BC" data-uri="chapter03.xhtml#P70004970270000000000000000403BC" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000403BD" data-uri="chapter03.xhtml#P70004970270000000000000000403BD" class="calibre10 pcalibre pcalibre1">char</code></td>
<td id="P70004970270000000000000000403BE" data-uri="chapter03.xhtml#P70004970270000000000000000403BE" class="calibre20 pcalibre pcalibre1">__________<br class="edition pcalibre pcalibre1"/>__________</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000403BF" data-uri="chapter03.xhtml#P70004970270000000000000000403BF" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000403C0" data-uri="chapter03.xhtml#P70004970270000000000000000403C0" class="calibre10 pcalibre pcalibre1">unsigned</code></td>
<td id="P70004970270000000000000000403C1" data-uri="chapter03.xhtml#P70004970270000000000000000403C1" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000403C2" data-uri="chapter03.xhtml#P70004970270000000000000000403C2" class="calibre10 pcalibre pcalibre1">unsigned char</code></td>
<td id="P70004970270000000000000000403C3" data-uri="chapter03.xhtml#P70004970270000000000000000403C3" class="calibre20 pcalibre pcalibre1">__________<br class="edition pcalibre pcalibre1"/>__________</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000403C4" data-uri="chapter03.xhtml#P70004970270000000000000000403C4" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000403C5" data-uri="chapter03.xhtml#P70004970270000000000000000403C5" class="calibre10 pcalibre pcalibre1">char</code></td>
<td id="P70004970270000000000000000403C6" data-uri="chapter03.xhtml#P70004970270000000000000000403C6" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000403C7" data-uri="chapter03.xhtml#P70004970270000000000000000403C7" class="calibre10 pcalibre pcalibre1">short</code></td>
<td id="P70004970270000000000000000403C8" data-uri="chapter03.xhtml#P70004970270000000000000000403C8" class="calibre20 pcalibre pcalibre1">__________<br class="edition pcalibre pcalibre1"/>__________</td>
</tr>
</tbody>
</table>
<section id="P7000497027000000000000000002131" data-uri="chapter03.xhtml#P7000497027000000000000000002131" epub:type="practice" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title5 pcalibre pcalibre1" id="P70004970270000000000000000403C9" data-uri="chapter03.xhtml#P70004970270000000000000000403C9" epub:type="title"><span class="pcalibre label pcalibre1">Practice Problem </span><span class="pcalibre label pcalibre1">3.5 </span>(solution page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP700049702700000000000000000344D_split_000.xhtml#P70004970270000000000000000034D2">327</a>)</h1></header>
<ol class="practicelist pcalibre pcalibre1" id="P70004970270000000000000000403CA" data-uri="chapter03.xhtml#P70004970270000000000000000403CA">
<li class="general-problem pcalibre pcalibre1" id="P70004970270000000000000000403CB" data-uri="chapter03.xhtml#P70004970270000000000000000403CB">
<div class="edition pcalibre pcalibre1" id="P70004970270000000000000000403CC" data-uri="chapter03.xhtml#P70004970270000000000000000403CC"><p id="P70004970270000000000000000403CD" data-uri="chapter03.xhtml#P70004970270000000000000000403CD" class="pcalibre calibre3 pcalibre1">You are given the following information. A function with prototype</p>
<pre id="P70004970270000000000000000403CE" data-uri="chapter03.xhtml#P70004970270000000000000000403CE" class="calibre9 pcalibre pcalibre1"><code id="P70004970270000000000000000403CF" data-uri="chapter03.xhtml#P70004970270000000000000000403CF" class="calibre10 pcalibre pcalibre1">
void decode1(long *xp, long *yp, long *zp);
</code></pre>
<p class="pcalibre calibre3 pcalibre1" id="P70004970270000000000000000403D0" data-uri="chapter03.xhtml#P70004970270000000000000000403D0">is compiled into assembly code, yielding the following:</p>
<pre id="P70004970270000000000000000403D1" data-uri="chapter03.xhtml#P70004970270000000000000000403D1" class="calibre9 pcalibre pcalibre1"><code id="P70004970270000000000000000403D2" data-uri="chapter03.xhtml#P70004970270000000000000000403D2" class="calibre10 pcalibre pcalibre1">
  <i class="calibre5 pcalibre pcalibre1">void decode1(long *xp, long *yp, long *zp)</i>
  <i class="calibre5 pcalibre pcalibre1">xp in %rdi, yp in %rsi, zp in %rdx</i>
decode1:
  movq	(%rdi), %r8
  movq	(%rsi), %rcx
  movq	(%rdx), %rax
  movq	%r8, (%rsi)
  movq	%rcx, (%rdx)
  movq	%rax, (%rdi)
  ret
</code></pre>
<p class="pcalibre calibre3 pcalibre1" id="P70004970270000000000000000403D3" data-uri="chapter03.xhtml#P70004970270000000000000000403D3">Parameters <code id="P70004970270000000000000000403D4" data-uri="chapter03.xhtml#P70004970270000000000000000403D4" class="pcalibre1 calibre8 pcalibre">xp, yp</code>, and <code id="P70004970270000000000000000403D5" data-uri="chapter03.xhtml#P70004970270000000000000000403D5" class="pcalibre1 calibre8 pcalibre">zp</code> are stored in registers <code id="P70004970270000000000000000403D6" data-uri="chapter03.xhtml#P70004970270000000000000000403D6" class="pcalibre1 calibre8 pcalibre">%rdi, %rsi</code>, and <code id="P70004970270000000000000000403D7" data-uri="chapter03.xhtml#P70004970270000000000000000403D7" class="pcalibre1 calibre8 pcalibre">%rdx</code>, respectively.</p>
<p id="P70004970270000000000000000403D8" data-uri="chapter03.xhtml#P70004970270000000000000000403D8" class="pcalibre calibre3 pcalibre1">Write C code for <code id="P70004970270000000000000000403D9" data-uri="chapter03.xhtml#P70004970270000000000000000403D9" class="pcalibre1 calibre8 pcalibre">decode1</code> that will have an effect equivalent to the assembly code shown.</p>
</div>
</li></ol>
</section>
</section>
<section id="P7000497027000000000000000002143" data-uri="chapter03.xhtml#P7000497027000000000000000002143" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P70004970270000000000000000403DA" data-uri="chapter03.xhtml#P70004970270000000000000000403DA" epub:type="title"><span class="pcalibre label pcalibre1">3.4.4 </span>Pushing and Popping Stack Data</h1></header>
<p id="P70004970270000000000000000403DB" data-uri="chapter03.xhtml#P70004970270000000000000000403DB" class="pcalibre1 pcalibre calibre2">The final two data movement operations are used to push data onto and pop data from the program stack, as documented in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000002146"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">3.8</span></a>. As we will see, the stack plays a vital role in the handling of procedure calls. By way of background, a stack is a data structure where values can be added or deleted, but only according to a "last-in, first-out" discipline. We add data to a stack via a <i class="calibre5 pcalibre pcalibre1">push</i> operation and remove it via a <i class="calibre5 pcalibre pcalibre1">pop</i> operation, with the property that the value popped will always be the value that was most recently pushed and is still on the stack. A stack can be implemented as an array, where we always insert and remove elements from one</p>
<figure class="pcalibre5 figure pcalibre" id="P7000497027000000000000000002146" data-uri="chapter03.xhtml#P7000497027000000000000000002146">
<table id="P70004970270000000000000000403DC" data-uri="chapter03.xhtml#P70004970270000000000000000403DC" class="pcalibre largetable pcalibre1">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P70004970270000000000000000403DD" data-uri="chapter03.xhtml#P70004970270000000000000000403DD" class="calibre18 pcalibre pcalibre1"><span class="pcalibre pagebreak1 pcalibre1" id="P7000497027000000000000000002149" title="190" data-uri="chapter03.xhtml#P7000497027000000000000000002149" epub:type="pagebreak"></span>Instruction</th>
<th id="P70004970270000000000000000403DE" data-uri="chapter03.xhtml#P70004970270000000000000000403DE" class="calibre18 pcalibre pcalibre1">Effect</th>
<th id="P70004970270000000000000000403DF" data-uri="chapter03.xhtml#P70004970270000000000000000403DF" class="calibre18 pcalibre pcalibre1">Description</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000403E0" data-uri="chapter03.xhtml#P70004970270000000000000000403E0" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000403E1" data-uri="chapter03.xhtml#P70004970270000000000000000403E1" class="calibre10 pcalibre pcalibre1">pushq</code> <var class="calibre5 pcalibre pcalibre1">S</var></td>
<td id="P70004970270000000000000000403E2" data-uri="chapter03.xhtml#P70004970270000000000000000403E2" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000403E3" data-uri="chapter03.xhtml#P70004970270000000000000000403E3" class="calibre10 pcalibre pcalibre1">R[%rsp] ← R[%rsp] –8;<br class="edition pcalibre pcalibre1"/>M[R[%rsp]] ← <var class="calibre5 pcalibre pcalibre1">S</var></code></td>
<td id="P70004970270000000000000000403E4" data-uri="chapter03.xhtml#P70004970270000000000000000403E4" class="calibre20 pcalibre pcalibre1">Push quad word</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P70004970270000000000000000403E5" data-uri="chapter03.xhtml#P70004970270000000000000000403E5" class="calibre20 pcalibre pcalibre1"><code id="P70004970270000000000000000403E6" data-uri="chapter03.xhtml#P70004970270000000000000000403E6" class="calibre10 pcalibre pcalibre1">popq</code> <var class="calibre5 pcalibre pcalibre1">D</var></td>
<td id="P70004970270000000000000000403E7" data-uri="chapter03.xhtml#P70004970270000000000000000403E7" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">D</var> ← <code id="P70004970270000000000000000403E8" data-uri="chapter03.xhtml#P70004970270000000000000000403E8" class="calibre10 pcalibre pcalibre1">M[R[%rsp]];<br class="caption pcalibre pcalibre1"/>R[%rsp] ← R[%rsp] + 8</code></td>
<td id="P70004970270000000000000000403E9" data-uri="chapter03.xhtml#P70004970270000000000000000403E9" class="calibre20 pcalibre pcalibre1">Pop quad word</td>
</tr>
</tbody>
</table>
<figcaption id="P70004970270000000000000000403EA" data-uri="chapter03.xhtml#P70004970270000000000000000403EA" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P70004970270000000000000000403EB" data-uri="chapter03.xhtml#P70004970270000000000000000403EB" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">3.8 </span>Push and pop instructions.</h1></header></figcaption>
</figure>
<figure class="pcalibre5 figure pcalibre" id="P7000497027000000000000000002158" data-uri="chapter03.xhtml#P7000497027000000000000000002158">
<img alt="A diagram illustrates stacks." id="P70004970270000000000000000403EC" data-uri="P700049702700000000000000000B6B2" src="../images/p190-1.png" class="calibre87 pcalibre pcalibre1"/>
<figcaption id="P70004970270000000000000000403ED" data-uri="chapter03.xhtml#P70004970270000000000000000403ED" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P70004970270000000000000000403EE" data-uri="chapter03.xhtml#P70004970270000000000000000403EE" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">3.9 </span>Illustration of stack operation.</h1></header><div class="edition pcalibre pcalibre1" id="P70004970270000000000000000403EF" data-uri="chapter03.xhtml#P70004970270000000000000000403EF"><p id="P70004970270000000000000000403F0" data-uri="chapter03.xhtml#P70004970270000000000000000403F0" class="pcalibre calibre3 pcalibre1">By convention, we draw stacks upside down, so that the "top" of the stack is shown at the bottom. With x86-64, stacks grow toward lower addresses, so pushing involves decrementing the stack pointer (register <code id="P70004970270000000000000000403F1" data-uri="chapter03.xhtml#P70004970270000000000000000403F1" class="pcalibre1 calibre8 pcalibre">%rsp</code>) and storing to memory, while popping involves reading from memory and incrementing the stack pointer.</p></div>
<details class="longdesc pcalibre pcalibre1" id="P70004970270000000000000000206D7" data-uri="chapter03.xhtml#P70004970270000000000000000206D7">
<summary class="pcalibre6 pcalibre1 pcalibre calibre30"><span class="number pcalibre pcalibre1">Description</span></summary>
<p id="P70004970270000000000000000403F2" data-uri="chapter03.xhtml#P70004970270000000000000000403F2" class="pcalibre1 pcalibre calibre2">A diagram shows tables above illustrations of stacks, which has increasing address from stack “top” on bottom to stack “bottom” on top. The three illustrations are summarized below.</p>
<ul class="ul_none1 pcalibre pcalibre1" id="P70004970270000000000000000403F3" data-uri="chapter03.xhtml#P70004970270000000000000000403F3">
<li id="P70004970270000000000000000403F4" data-uri="chapter03.xhtml#P70004970270000000000000000403F4" class="calibre12 pcalibre pcalibre1"><p id="P70004970270000000000000000403F5" data-uri="chapter03.xhtml#P70004970270000000000000000403F5" class="calibre13 pcalibre pcalibre1">Initially:</p>
<ul class="ul_none1 pcalibre pcalibre1" id="P70004970270000000000000000403F6" data-uri="chapter03.xhtml#P70004970270000000000000000403F6">
<li id="P70004970270000000000000000403F7" data-uri="chapter03.xhtml#P70004970270000000000000000403F7" class="calibre12 pcalibre pcalibre1"><p id="P70004970270000000000000000403F8" data-uri="chapter03.xhtml#P70004970270000000000000000403F8" class="calibre13 pcalibre pcalibre1">%rax: 0x123</p></li>
<li id="P70004970270000000000000000403F9" data-uri="chapter03.xhtml#P70004970270000000000000000403F9" class="calibre12 pcalibre pcalibre1"><p id="P70004970270000000000000000403FA" data-uri="chapter03.xhtml#P70004970270000000000000000403FA" class="calibre13 pcalibre pcalibre1">%rdx: 0</p></li>
<li id="P70004970270000000000000000403FB" data-uri="chapter03.xhtml#P70004970270000000000000000403FB" class="calibre12 pcalibre pcalibre1"><p id="P70004970270000000000000000403FC" data-uri="chapter03.xhtml#P70004970270000000000000000403FC" class="calibre13 pcalibre pcalibre1">%rsp: 0x108</p></li>
</ul></li>
<li id="P70004970270000000000000000403FD" data-uri="chapter03.xhtml#P70004970270000000000000000403FD" class="calibre12 pcalibre pcalibre1"><p id="P70004970270000000000000000403FE" data-uri="chapter03.xhtml#P70004970270000000000000000403FE" class="calibre13 pcalibre pcalibre1">Illustration has 0x108 at stack “top”</p>
<ul class="ul_none1 pcalibre pcalibre1" id="P70004970270000000000000000403FF" data-uri="chapter03.xhtml#P70004970270000000000000000403FF">
<li id="P7000497027000000000000000040400" data-uri="chapter03.xhtml#P7000497027000000000000000040400" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000040401" data-uri="chapter03.xhtml#P7000497027000000000000000040401" class="calibre13 pcalibre pcalibre1">Pushq %rax:</p></li>
<li id="P7000497027000000000000000040402" data-uri="chapter03.xhtml#P7000497027000000000000000040402" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000040403" data-uri="chapter03.xhtml#P7000497027000000000000000040403" class="calibre13 pcalibre pcalibre1">%rax: 0x123</p></li>
<li id="P7000497027000000000000000040404" data-uri="chapter03.xhtml#P7000497027000000000000000040404" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000040405" data-uri="chapter03.xhtml#P7000497027000000000000000040405" class="calibre13 pcalibre pcalibre1">%rdx: 0</p></li>
<li id="P7000497027000000000000000040406" data-uri="chapter03.xhtml#P7000497027000000000000000040406" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000040407" data-uri="chapter03.xhtml#P7000497027000000000000000040407" class="calibre13 pcalibre pcalibre1">%rsp: 0x100</p></li>
</ul></li>
<li id="P7000497027000000000000000040408" data-uri="chapter03.xhtml#P7000497027000000000000000040408" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000040409" data-uri="chapter03.xhtml#P7000497027000000000000000040409" class="calibre13 pcalibre pcalibre1">Illustration has 0x123 below 0x108 and above stack “top” 0x100</p>
<ul class="ul_none1 pcalibre pcalibre1" id="P700049702700000000000000004040A" data-uri="chapter03.xhtml#P700049702700000000000000004040A">
<li id="P700049702700000000000000004040B" data-uri="chapter03.xhtml#P700049702700000000000000004040B" class="calibre12 pcalibre pcalibre1"><p id="P700049702700000000000000004040C" data-uri="chapter03.xhtml#P700049702700000000000000004040C" class="calibre13 pcalibre pcalibre1">Popq %rdx:</p></li>
<li id="P700049702700000000000000004040D" data-uri="chapter03.xhtml#P700049702700000000000000004040D" class="calibre12 pcalibre pcalibre1"><p id="P700049702700000000000000004040E" data-uri="chapter03.xhtml#P700049702700000000000000004040E" class="calibre13 pcalibre pcalibre1">%rax: 0x123</p></li>
<li id="P700049702700000000000000004040F" data-uri="chapter03.xhtml#P700049702700000000000000004040F" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000040410" data-uri="chapter03.xhtml#P7000497027000000000000000040410" class="calibre13 pcalibre pcalibre1">%rdx: 0x123</p></li>
<li id="P7000497027000000000000000040411" data-uri="chapter03.xhtml#P7000497027000000000000000040411" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000040412" data-uri="chapter03.xhtml#P7000497027000000000000000040412" class="calibre13 pcalibre pcalibre1">%rsp: 0x108</p></li>
</ul></li>
<li id="P7000497027000000000000000040413" data-uri="chapter03.xhtml#P7000497027000000000000000040413" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000040414" data-uri="chapter03.xhtml#P7000497027000000000000000040414" class="calibre13 pcalibre pcalibre1">Illustration has 0x123 below stack “top” 0x108</p></li>
</ul>
</details>
</figcaption>
</figure>
<p class="pcalibre1 pcalibre calibre2" id="P7000497027000000000000000040415" data-uri="chapter03.xhtml#P7000497027000000000000000040415">end of the array. This end is called the <i class="calibre5 pcalibre pcalibre1">top</i> of the stack. With x86-64, the program stack is stored in some region of memory. As illustrated in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000002158"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">3.9</span></a>, the stack grows downward such that the top element of the stack has the lowest address of all stack elements. (By convention, we draw stacks upside down, with the stack "top" shown at the bottom of the figure.) The stack pointer <code id="P7000497027000000000000000040416" data-uri="chapter03.xhtml#P7000497027000000000000000040416" class="pcalibre1 calibre8 pcalibre">%rsp</code> holds the address of the top stack element.</p>
<p id="P7000497027000000000000000040417" data-uri="chapter03.xhtml#P7000497027000000000000000040417" class="pcalibre1 pcalibre calibre2">The <code id="P7000497027000000000000000040418" data-uri="chapter03.xhtml#P7000497027000000000000000040418" class="pcalibre1 calibre8 pcalibre">pushq</code> instruction provides the ability to push data onto the stack, while the <code id="P7000497027000000000000000040419" data-uri="chapter03.xhtml#P7000497027000000000000000040419" class="pcalibre1 calibre8 pcalibre">popq</code> instruction pops it. Each of these instructions takes a single operand—the data source for pushing and the data destination for popping.</p>
<p id="P700049702700000000000000004041A" data-uri="chapter03.xhtml#P700049702700000000000000004041A" class="pcalibre1 pcalibre calibre2">Pushing a quad word value onto the stack involves first decrementing the stack pointer by 8 and then writing the value at the new top-of-stack address. <span class="pcalibre pagebreak pcalibre1" id="P7000497027000000000000000002165" title="191" data-uri="chapter03.xhtml#P7000497027000000000000000002165" epub:type="pagebreak"></span>Therefore, the behavior of the instruction <code id="P700049702700000000000000004041B" data-uri="chapter03.xhtml#P700049702700000000000000004041B" class="pcalibre1 calibre8 pcalibre">pushq %rbp</code> is equivalent to that of the pair of instructions</p>
<pre id="P700049702700000000000000004041C" data-uri="chapter03.xhtml#P700049702700000000000000004041C" class="calibre9 pcalibre pcalibre1"><code id="P700049702700000000000000004041D" data-uri="chapter03.xhtml#P700049702700000000000000004041D" class="calibre10 pcalibre pcalibre1">
subq $8,%rsp		<i class="calibre5 pcalibre pcalibre1">Decrement stack pointer</i>
movq %rbp,( %rsp)	<i class="calibre5 pcalibre pcalibre1">Store %rbp on stack</i>
</code></pre>
<p class="pcalibre1 pcalibre calibre2" id="P700049702700000000000000004041E" data-uri="chapter03.xhtml#P700049702700000000000000004041E">except that the <code id="P700049702700000000000000004041F" data-uri="chapter03.xhtml#P700049702700000000000000004041F" class="pcalibre1 calibre8 pcalibre">pushq</code> instruction is encoded in the machine code as a single byte, whereas the pair of instructions shown above requires a total of 8 bytes. The first two columns in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000002158"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">3.9</span></a> illustrate the effect of executing the instruction <code id="P7000497027000000000000000040420" data-uri="chapter03.xhtml#P7000497027000000000000000040420" class="pcalibre1 calibre8 pcalibre">pushq %rax</code> when <code id="P7000497027000000000000000040421" data-uri="chapter03.xhtml#P7000497027000000000000000040421" class="pcalibre1 calibre8 pcalibre">%rsp</code> is <code id="P7000497027000000000000000040422" data-uri="chapter03.xhtml#P7000497027000000000000000040422" class="pcalibre1 calibre8 pcalibre">0x108</code> and <code id="P7000497027000000000000000040423" data-uri="chapter03.xhtml#P7000497027000000000000000040423" class="pcalibre1 calibre8 pcalibre">%rax</code> is <code id="P7000497027000000000000000040424" data-uri="chapter03.xhtml#P7000497027000000000000000040424" class="pcalibre1 calibre8 pcalibre">0x123</code>. First <code id="P7000497027000000000000000040425" data-uri="chapter03.xhtml#P7000497027000000000000000040425" class="pcalibre1 calibre8 pcalibre">%rsp</code> is decremented by 8, giving <code id="P7000497027000000000000000040426" data-uri="chapter03.xhtml#P7000497027000000000000000040426" class="pcalibre1 calibre8 pcalibre">0x100</code>, and then <code id="P7000497027000000000000000040427" data-uri="chapter03.xhtml#P7000497027000000000000000040427" class="pcalibre1 calibre8 pcalibre">0x123</code> is stored at memory address <code id="P7000497027000000000000000040428" data-uri="chapter03.xhtml#P7000497027000000000000000040428" class="pcalibre1 calibre8 pcalibre">0x100</code>.</p>
<p id="P7000497027000000000000000040429" data-uri="chapter03.xhtml#P7000497027000000000000000040429" class="pcalibre1 pcalibre calibre2">Popping a quad word involves reading from the top-of-stack location and then incrementing the stack pointer by 8. Therefore, the instruction <code id="P700049702700000000000000004042A" data-uri="chapter03.xhtml#P700049702700000000000000004042A" class="pcalibre1 calibre8 pcalibre">popq %rax</code> is equivalent to the following pair of instructions:</p>
<pre id="P700049702700000000000000004042B" data-uri="chapter03.xhtml#P700049702700000000000000004042B" class="calibre9 pcalibre pcalibre1"><code id="P700049702700000000000000004042C" data-uri="chapter03.xhtml#P700049702700000000000000004042C" class="calibre10 pcalibre pcalibre1">
movq (%rsp),%rax	<b class="calibre4 pcalibre pcalibre1"><i class="calibre5 pcalibre pcalibre1">Read %rax from stack</i></b>
addq $8,%rsp		<b class="calibre4 pcalibre pcalibre1"><i class="calibre5 pcalibre pcalibre1">Increment stack pointer</i></b>
</code></pre>
<p id="P700049702700000000000000004042D" data-uri="chapter03.xhtml#P700049702700000000000000004042D" class="pcalibre1 pcalibre calibre2">The third column of <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000002158"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">3.9</span></a> illustrates the effect of executing the instruction <code id="P700049702700000000000000004042E" data-uri="chapter03.xhtml#P700049702700000000000000004042E" class="pcalibre1 calibre8 pcalibre">popq %edx</code> immediately after executing the <code id="P700049702700000000000000004042F" data-uri="chapter03.xhtml#P700049702700000000000000004042F" class="pcalibre1 calibre8 pcalibre">pushq</code>. Value <code id="P7000497027000000000000000040430" data-uri="chapter03.xhtml#P7000497027000000000000000040430" class="pcalibre1 calibre8 pcalibre">0x123</code> is read from memory and written to register <code id="P7000497027000000000000000040431" data-uri="chapter03.xhtml#P7000497027000000000000000040431" class="pcalibre1 calibre8 pcalibre">%rdx</code>. Register <code id="P7000497027000000000000000040432" data-uri="chapter03.xhtml#P7000497027000000000000000040432" class="pcalibre1 calibre8 pcalibre">%rspis</code> incremented back to <code id="P7000497027000000000000000040433" data-uri="chapter03.xhtml#P7000497027000000000000000040433" class="pcalibre1 calibre8 pcalibre">0x108</code>. As shown in the figure, the value <code id="P7000497027000000000000000040434" data-uri="chapter03.xhtml#P7000497027000000000000000040434" class="pcalibre1 calibre8 pcalibre">0x123</code> remains at memory location <code id="P7000497027000000000000000040435" data-uri="chapter03.xhtml#P7000497027000000000000000040435" class="pcalibre1 calibre8 pcalibre">0x104</code> until it is overwritten (e.g., by another push operation). However, the stack top is always considered to be the address indicated by <code id="P7000497027000000000000000040436" data-uri="chapter03.xhtml#P7000497027000000000000000040436" class="pcalibre1 calibre8 pcalibre">%rsp</code>.</p>
<p id="P7000497027000000000000000040437" data-uri="chapter03.xhtml#P7000497027000000000000000040437" class="pcalibre1 pcalibre calibre2">Since the stack is contained in the same memory as the program code and other forms of program data, programs can access arbitrary positions within the stack using the standard memory addressing methods. For example, assuming the topmost element of the stack is a quad word, the instruction <code id="P7000497027000000000000000040438" data-uri="chapter03.xhtml#P7000497027000000000000000040438" class="pcalibre1 calibre8 pcalibre">movq 8(%rsp), %rdx</code> will copy the second quad word from the stack to register <code id="P7000497027000000000000000040439" data-uri="chapter03.xhtml#P7000497027000000000000000040439" class="pcalibre1 calibre8 pcalibre">%rdx</code>.</p>
</section>
</section></body></html>
