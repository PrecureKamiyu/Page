<?xml version='1.0' encoding='utf-8'?>
<html xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:svg="http://www.w3.org/2000/svg" xmlns:epub="http://www.idpf.org/2007/ops" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" epub:prefix="index: http://www.index.com/">
  <head>
    <meta name="dcterms.conformsTo" content="PXE Basic 1.0"/>
    <meta name="generator" content="PXE Tools version 1.39.52"/>
    <!--Created by pxe.pl for standard version PXE Basic 1.0,data-profile-product=standard by PXE Tools 1.39.52, partial=false-->
    <title>11.2 Networks</title>
    <link rel="alternate stylesheet" type="text/css" title="night" href="../css/theme/night.css"/>
    <link rel="alternate stylesheet" type="text/css" title="sepia" href="../css/theme/sepia.css"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="../../stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="../../page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body epub:type="bodymatter" class="calibre pcalibre pcalibre1">
<section id="P7000497027000000000000000007BB0" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title pcalibre1" id="P70004970270000000000000000466BC" data-uri="chapter11.xhtml#P70004970270000000000000000466BC" epub:type="title"><span class="pcalibre label pcalibre1">11.2 </span>Networks</h1></header>
<p id="P70004970270000000000000000466BD" data-uri="chapter11.xhtml#P70004970270000000000000000466BD" class="pcalibre1 pcalibre calibre2">Clients and servers often run on separate hosts and communicate using the hardware and software resources of a <i class="calibre5 pcalibre pcalibre1">computer network</i>. Networks are sophisticated systems, and we can only hope to scratch the surface here. Our aim is to give you a workable mental model from a programmer's perspective.</p>
<p id="P70004970270000000000000000466BE" data-uri="chapter11.xhtml#P70004970270000000000000000466BE" class="pcalibre1 pcalibre calibre2">To a host, a network is just another I/O device that serves as a source and sink for data, as shown in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000007BB4"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">11.2</span></a>.</p>
<figure class="pcalibre5 figure pcalibre" id="P7000497027000000000000000007BB4" data-uri="chapter11.xhtml#P7000497027000000000000000007BB4">
<img alt="A diagram illustrates hardware organization of a network host." id="P70004970270000000000000000466BF" data-uri="P700049702700000000000000000B7BB" src="../images/p919-1.png" class="calibre316 pcalibre pcalibre1"/>
<figcaption id="P70004970270000000000000000466C0" data-uri="chapter11.xhtml#P70004970270000000000000000466C0" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P70004970270000000000000000466C1" data-uri="chapter11.xhtml#P70004970270000000000000000466C1" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">11.2 </span>Hardware organization of a network host.</h1></header>
<details class="longdesc pcalibre pcalibre1" id="P7000497027000000000000000026A28" data-uri="chapter11.xhtml#P7000497027000000000000000026A28">
<summary class="pcalibre6 pcalibre1 pcalibre calibre30"><span class="number pcalibre pcalibre1">Description</span></summary>
<p id="P70004970270000000000000000466C2" data-uri="chapter11.xhtml#P70004970270000000000000000466C2" class="pcalibre calibre3 pcalibre1">Within a hardware organization, a network adapter interacts with a network and with one of the expansion slots of the I/O bus. The I/O bus interacts with USB controller (mouse and keyboard), graphics adapter (monitor), disk controller, and I/O bridge. The I/O bridge interacts with the main memory (via memory bus) and Bus interface (via system bus). Within the CPU chip, the bus interface interacts with the register file, which interacts with ALU.</p>
</details>
</figcaption>
</figure>
<figure class="pcalibre5 figure pcalibre" id="P7000497027000000000000000007BB8" data-uri="chapter11.xhtml#P7000497027000000000000000007BB8">
<span class="pcalibre pagebreak pcalibre1" id="P7000497027000000000000000007BB9" title="920" data-uri="chapter11.xhtml#P7000497027000000000000000007BB9" epub:type="pagebreak"></span>
<img alt="A diagram illustrates three hosts connected to a hub, with connections 100 Mb/s." id="P70004970270000000000000000466C3" data-uri="P700049702700000000000000000B7BC" src="../images/p920-1.png" class="calibre317 pcalibre pcalibre1"/>
<figcaption id="P70004970270000000000000000466C4" data-uri="chapter11.xhtml#P70004970270000000000000000466C4" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P70004970270000000000000000466C5" data-uri="chapter11.xhtml#P70004970270000000000000000466C5" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">11.3 </span>Ethernet segment.</h1></header>
</figcaption>
</figure>
<p id="P70004970270000000000000000466C6" data-uri="chapter11.xhtml#P70004970270000000000000000466C6" class="pcalibre1 pcalibre calibre2">An adapter plugged into an expansion slot on the I/O bus provides the physical interface to the network. Data received from the network are copied from the adapter across the I/O and memory buses into memory, typically by a DMA transfer. Similarly, data can also be copied from memory to the network.</p>
<p id="P70004970270000000000000000466C7" data-uri="chapter11.xhtml#P70004970270000000000000000466C7" class="pcalibre1 pcalibre calibre2">Physically, a network is a hierarchical system that is organized by geographical proximity. At the lowest level is a LAN (local area network) that spans a building or a campus. The most popular LAN technology by far is <i class="calibre5 pcalibre pcalibre1">Ethernet</i>, which was developed in the mid-1970s at Xerox PARC. Ethernet has proven to be remarkably resilient, evolving from 3 Mb/s to 10 Gb/s.</p>
<p id="P70004970270000000000000000466C8" data-uri="chapter11.xhtml#P70004970270000000000000000466C8" class="pcalibre1 pcalibre calibre2">An <i class="calibre5 pcalibre pcalibre1">Ethernet segment</i> consists of some wires (usually twisted pairs of wires) and a small box called a <i class="calibre5 pcalibre pcalibre1">hub</i>, as shown in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000007BB8"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">11.3</span></a>. Ethernet segments typically span small areas, such as a room or a floor in a building. Each wire has the same maximum bit bandwidth, typically 100 Mb/s or 1 Gb/s. One end is attached to an adapter on a host, and the other end is attached to a <i class="calibre5 pcalibre pcalibre1">port</i> on the hub. A hub slavishly copies every bit that it receives on each port to every other port. Thus, every host sees every bit.</p>
<p id="P70004970270000000000000000466C9" data-uri="chapter11.xhtml#P70004970270000000000000000466C9" class="pcalibre1 pcalibre calibre2">Each Ethernet adapter has a globally unique 48-bit address that is stored in a nonvolatile memory on the adapter. A host can send a chunk of bits called a <i class="calibre5 pcalibre pcalibre1">frame</i> to any other host on the segment. Each frame includes some fixed number of <i class="calibre5 pcalibre pcalibre1">header</i> bits that identify the source and destination of the frame and the frame length, followed by a <i class="calibre5 pcalibre pcalibre1">payload</i> of data bits. Every host adapter sees the frame, but only the destination host actually reads it.</p>
<p id="P70004970270000000000000000466CA" data-uri="chapter11.xhtml#P70004970270000000000000000466CA" class="pcalibre1 pcalibre calibre2">Multiple Ethernet segments can be connected into larger LANs, called <i class="calibre5 pcalibre pcalibre1">bridged Ethernets</i>, using a set of wires and small boxes called <i class="calibre5 pcalibre pcalibre1">bridges</i>, as shown in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000007BC7"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">11.4</span></a>. Bridged Ethernets can span entire buildings or campuses. In a bridged Ethernet, some wires connect bridges to bridges, and others connect bridges to hubs. The bandwidths of the wires can be different. In our example, the bridge-bridge wire has a 1 Gb/s bandwidth, while the four hub-bridge wires have bandwidths of 100 Mb/s.</p>
<p id="P70004970270000000000000000466CB" data-uri="chapter11.xhtml#P70004970270000000000000000466CB" class="pcalibre1 pcalibre calibre2">Bridges make better use of the available wire bandwidth than hubs. Using a clever distributed algorithm, they automatically learn over time which hosts are reachable from which ports and then selectively copy frames from one port to another only when it is necessary. For example, if host A sends a frame to host B, which is on the segment, then bridge X will throw away the frame when it arrives at its input port, thus saving bandwidth on the other segments. However, if host A sends a frame to host C on a different segment, then bridge X will copy the frame only to the port connected to bridge Y, which will copy the frame only to the port connected to host C's segment.</p>
<aside class="sidebar pcalibre5 pcalibre" id="P7000497027000000000000000007BC3" data-uri="chapter11.xhtml#P7000497027000000000000000007BC3"><header class="pcalibre halftitlepage pcalibre1"><h1 class="pcalibre1 title2 pcalibre" id="P70004970270000000000000000466CC" data-uri="chapter11.xhtml#P70004970270000000000000000466CC" epub:type="title"><span class="pcalibre pagebreak pcalibre1" id="P7000497027000000000000000007BC5" title="921" data-uri="chapter11.xhtml#P7000497027000000000000000007BC5" epub:type="pagebreak"></span><span class="pcalibre label1 pcalibre1">Aside </span>Internet versus internet</h1></header>
<p id="P70004970270000000000000000466CD" data-uri="chapter11.xhtml#P70004970270000000000000000466CD" class="pcalibre calibre3 pcalibre1">We will always use lowercase <i class="calibre5 pcalibre pcalibre1">internet</i> to denote the general concept, and uppercase <i class="calibre5 pcalibre pcalibre1">Internet</i> to denote a specific implementation—namely, the global IP Internet.</p>
</aside>
<figure class="pcalibre5 figure pcalibre" id="P7000497027000000000000000007BC7" data-uri="chapter11.xhtml#P7000497027000000000000000007BC7">
<img alt="A diagram illustrates bridged Ethernet segments." id="P70004970270000000000000000466CE" data-uri="P700049702700000000000000000B7BD" src="../images/p921-1.png" class="pcalibre1 pcalibre calibre318"/>
<figcaption id="P70004970270000000000000000466CF" data-uri="chapter11.xhtml#P70004970270000000000000000466CF" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P70004970270000000000000000466D0" data-uri="chapter11.xhtml#P70004970270000000000000000466D0" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">11.4 </span>Bridged Ethernet segments.</h1></header>
<details class="longdesc pcalibre pcalibre1" id="P7000497027000000000000000026A38" data-uri="chapter11.xhtml#P7000497027000000000000000026A38">
<summary class="pcalibre6 pcalibre1 pcalibre calibre30"><span class="number pcalibre pcalibre1">Description</span></summary>
<p id="P70004970270000000000000000466D1" data-uri="chapter11.xhtml#P70004970270000000000000000466D1" class="pcalibre calibre3 pcalibre1">A diagram shows bridges X and Y connected by 1 Gb/s connection. Bridge X is connected to two hubs via 100 Mb/s connections; one hub connected to three hosts, including A and B, and the other connected to two hosts. Bridge Y is connected to two hubs via 100 Mb/s connections; one hub connected to five hosts, including C, and the other connected to two hosts.</p>
</details>
</figcaption>
</figure>
<figure class="pcalibre5 figure pcalibre" id="P7000497027000000000000000007BCB" data-uri="chapter11.xhtml#P7000497027000000000000000007BCB">
<img alt="A diagram shows hosts connected to a common line." id="P70004970270000000000000000466D2" data-uri="P700049702700000000000000000B7BE" src="../images/p921-2.png" class="pcalibre calibre319 pcalibre1"/>
<figcaption id="P70004970270000000000000000466D3" data-uri="chapter11.xhtml#P70004970270000000000000000466D3" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P70004970270000000000000000466D4" data-uri="chapter11.xhtml#P70004970270000000000000000466D4" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">11.5 </span>Conceptual view of a LAN.</h1></header>
</figcaption>
</figure>
<p id="P70004970270000000000000000466D5" data-uri="chapter11.xhtml#P70004970270000000000000000466D5" class="pcalibre1 pcalibre calibre2">To simplify our pictures of LANs, we will draw the hubs and bridges and the wires that connect them as a single horizontal line, as shown in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000007BCB"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">11.5</span></a>.</p>
<p id="P70004970270000000000000000466D6" data-uri="chapter11.xhtml#P70004970270000000000000000466D6" class="pcalibre1 pcalibre calibre2">At a higher level in the hierarchy, multiple incompatible LANs can be connected by specialized computers called <i class="calibre5 pcalibre pcalibre1">routers</i> to form an <i class="calibre5 pcalibre pcalibre1">internet</i> (interconnected network). Each router has an adapter (port) for each network that it is connected to. Routers can also connect high-speed point-to-point phone connections, which are examples of networks known as WANs (wide area networks), so called because they span larger geographical areas than LANs. In general, routers can be used to build internets from arbitrary collections of LANs and WANs. For example, <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000007BD1"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">11.6</span></a> shows an example internet with a pair of LANs and WANs connected by three routers.</p>
<figure class="pcalibre5 figure pcalibre" id="P7000497027000000000000000007BD1" data-uri="chapter11.xhtml#P7000497027000000000000000007BD1">
<span class="pcalibre pagebreak pcalibre1" id="P7000497027000000000000000007BD2" title="922" data-uri="chapter11.xhtml#P7000497027000000000000000007BD2" epub:type="pagebreak"></span>
<img alt="A diagram shows two LAN connected to separate hosts and separate routers. The routers are connected to a third via WAN." id="P70004970270000000000000000466D7" data-uri="P700049702700000000000000000B7BF" src="../images/p922-1.png" class="calibre320 pcalibre pcalibre1"/>
<figcaption id="P70004970270000000000000000466D8" data-uri="chapter11.xhtml#P70004970270000000000000000466D8" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P70004970270000000000000000466D9" data-uri="chapter11.xhtml#P70004970270000000000000000466D9" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">11.6 </span>A small internet.</h1></header>
<div class="caption pcalibre pcalibre1" id="P70004970270000000000000000466DA" data-uri="chapter11.xhtml#P70004970270000000000000000466DA"><p id="P70004970270000000000000000466DB" data-uri="chapter11.xhtml#P70004970270000000000000000466DB" class="pcalibre calibre3 pcalibre1">Two LANs and two WANs are connected by three routers.</p></div>
</figcaption>
</figure>
<p id="P70004970270000000000000000466DC" data-uri="chapter11.xhtml#P70004970270000000000000000466DC" class="pcalibre1 pcalibre calibre2">The crucial property of an internet is that it can consist of different LANs and WANs with radically different and incompatible technologies. Each host is physically connected to every other host, but how is it possible for some <i class="calibre5 pcalibre pcalibre1">source host</i> to send data bits to another <i class="calibre5 pcalibre pcalibre1">destination host</i> across all of these incompatible networks?</p>
<p id="P70004970270000000000000000466DD" data-uri="chapter11.xhtml#P70004970270000000000000000466DD" class="pcalibre1 pcalibre calibre2">The solution is a layer of <i class="calibre5 pcalibre pcalibre1">protocol software</i> running on each host and router that smoothes out the differences between the different networks. This software implements a <i class="calibre5 pcalibre pcalibre1">protocol</i> that governs how hosts and routers cooperate in order to transfer data. The protocol must provide two basic capabilities:</p>
<ul class="pcalibre ul_none pcalibre1" id="P70004970270000000000000000466DE" data-uri="chapter11.xhtml#P70004970270000000000000000466DE">
<li id="P70004970270000000000000000466DF" data-uri="chapter11.xhtml#P70004970270000000000000000466DF" class="calibre12 pcalibre pcalibre1"><p id="P70004970270000000000000000466E0" data-uri="chapter11.xhtml#P70004970270000000000000000466E0" class="calibre13 pcalibre pcalibre1"><span class="pcalibre leadin pcalibre1">Naming scheme. </span>Different LAN technologies have different and incompatible ways of assigning addresses to hosts. The internet protocol smoothes these differences by defining a uniform format for host addresses. Each host is then assigned at least one of these <i class="calibre5 pcalibre pcalibre1">internet addresses</i> that uniquely identifies it.</p></li>
<li id="P70004970270000000000000000466E1" data-uri="chapter11.xhtml#P70004970270000000000000000466E1" class="calibre12 pcalibre pcalibre1"><p id="P70004970270000000000000000466E2" data-uri="chapter11.xhtml#P70004970270000000000000000466E2" class="calibre13 pcalibre pcalibre1"><span class="pcalibre leadin pcalibre1">Delivery mechanism. </span>Different networking technologies have different and incompatible ways of encoding bits on wires and of packaging these bits into frames. The internet protocol smoothes these differences by defining a uniform way to bundle up data bits into discrete chunks called <i class="calibre5 pcalibre pcalibre1">packets</i>. A packet consists of a <i class="calibre5 pcalibre pcalibre1">header</i>, which contains the packet size and addresses of the source and destination hosts, and a <i class="calibre5 pcalibre pcalibre1">payload</i>, which contains data bits sent from the source host.</p></li>
</ul>
<p id="P70004970270000000000000000466E3" data-uri="chapter11.xhtml#P70004970270000000000000000466E3" class="pcalibre1 pcalibre calibre2"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000007BE5"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">11.7</span></a> shows an example of how hosts and routers use the internet protocol to transfer data across incompatible LANs. The example internet consists of two LANs connected by a router. A client running on host A, which is attached to LAN1, sends a sequence of data bytes to a server running on host B, which is attached to LAN2. There are eight basic steps:</p>
<ol id="P70004970270000000000000000466E4" data-uri="chapter11.xhtml#P70004970270000000000000000466E4" class="calibre72 pcalibre pcalibre1">
<li id="P70004970270000000000000000466E5" data-uri="chapter11.xhtml#P70004970270000000000000000466E5" class="calibre12 pcalibre pcalibre1"><p id="P70004970270000000000000000466E6" data-uri="chapter11.xhtml#P70004970270000000000000000466E6" class="pcalibre calibre3 pcalibre1">The client on host A invokes a system call that copies the data from the client's virtual address space into a kernel buffer.</p></li>
<li id="P70004970270000000000000000466E7" data-uri="chapter11.xhtml#P70004970270000000000000000466E7" class="calibre12 pcalibre pcalibre1"><p id="P70004970270000000000000000466E8" data-uri="chapter11.xhtml#P70004970270000000000000000466E8" class="pcalibre calibre3 pcalibre1">The protocol software on host A creates a LAN1 frame by appending an internet header and a LAN1 frame header to the data. The internet header is addressed to internet host B. The LAN1 frame header is addressed to the router. It then passes the frame to the adapter. Notice that the payload of the LAN1 frame is an internet packet, whose payload is the actual user data. This kind of <i class="calibre5 pcalibre pcalibre1">encapsulation</i> is one of the fundamental insights of internetworking.</p>
<figure class="pcalibre5 figure pcalibre" id="P7000497027000000000000000007BE5" data-uri="chapter11.xhtml#P7000497027000000000000000007BE5">
<span class="pcalibre pagebreak pcalibre1" id="P7000497027000000000000000007BE6" title="923" data-uri="chapter11.xhtml#P7000497027000000000000000007BE6" epub:type="pagebreak"></span>
<img alt="A diagram illustrates how data travel from one host to another on an Internet." id="P70004970270000000000000000466E9" data-uri="P700049702700000000000000000B7C0" src="../images/p923-1.png" class="calibre321 pcalibre pcalibre1"/>
<figcaption id="P70004970270000000000000000466EA" data-uri="chapter11.xhtml#P70004970270000000000000000466EA" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P70004970270000000000000000466EB" data-uri="chapter11.xhtml#P70004970270000000000000000466EB" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">11.7 </span>How data travel from one host to another on an internet.</h1></header>
<div class="edition pcalibre pcalibre1" id="P70004970270000000000000000466EC" data-uri="chapter11.xhtml#P70004970270000000000000000466EC"><p id="P70004970270000000000000000466ED" data-uri="chapter11.xhtml#P70004970270000000000000000466ED" class="pcalibre calibre3 pcalibre1">PH: internet packet header; FH1: frame header for LAN1; FH2: frame header for LAN2.</p></div>
<details class="longdesc pcalibre pcalibre1" id="P7000497027000000000000000026A56" data-uri="chapter11.xhtml#P7000497027000000000000000026A56">
<summary class="pcalibre6 pcalibre1 pcalibre calibre30"><span class="number pcalibre pcalibre1">Description</span></summary>
<p id="P70004970270000000000000000466EE" data-uri="chapter11.xhtml#P70004970270000000000000000466EE" class="pcalibre calibre3 pcalibre1">A diagram shows a path form Host A client to Host B server, via the steps summarized below.</p>
<ol id="P70004970270000000000000000466EF" data-uri="chapter11.xhtml#P70004970270000000000000000466EF" class="pcalibre1 pcalibre calibre45">
<li id="P70004970270000000000000000466F0" data-uri="chapter11.xhtml#P70004970270000000000000000466F0" class="calibre12 pcalibre pcalibre1"><p id="P70004970270000000000000000466F1" data-uri="chapter11.xhtml#P70004970270000000000000000466F1" class="pcalibre calibre3 pcalibre1">Data from client (Host A) to protocol software</p></li>
<li id="P70004970270000000000000000466F2" data-uri="chapter11.xhtml#P70004970270000000000000000466F2" class="calibre12 pcalibre pcalibre1"><p id="P70004970270000000000000000466F3" data-uri="chapter11.xhtml#P70004970270000000000000000466F3" class="pcalibre calibre3 pcalibre1">LAN1 frame including Internet packet (Data and PH) and FH1 to LAN1 adapter</p></li>
<li id="P70004970270000000000000000466F4" data-uri="chapter11.xhtml#P70004970270000000000000000466F4" class="calibre12 pcalibre pcalibre1"><p id="P70004970270000000000000000466F5" data-uri="chapter11.xhtml#P70004970270000000000000000466F5" class="pcalibre calibre3 pcalibre1">LAN1 frame to LAN1 adapter within router</p></li>
<li id="P70004970270000000000000000466F6" data-uri="chapter11.xhtml#P70004970270000000000000000466F6" class="calibre12 pcalibre pcalibre1"><p id="P70004970270000000000000000466F7" data-uri="chapter11.xhtml#P70004970270000000000000000466F7" class="pcalibre calibre3 pcalibre1">LAN1 frame to protocol software in router</p></li>
<li id="P70004970270000000000000000466F8" data-uri="chapter11.xhtml#P70004970270000000000000000466F8" class="calibre12 pcalibre pcalibre1"><p id="P70004970270000000000000000466F9" data-uri="chapter11.xhtml#P70004970270000000000000000466F9" class="pcalibre calibre3 pcalibre1">LAN2 frame (now with FH2 instead of FH1) to LAN2 adapter in router</p></li>
<li id="P70004970270000000000000000466FA" data-uri="chapter11.xhtml#P70004970270000000000000000466FA" class="calibre12 pcalibre pcalibre1"><p id="P70004970270000000000000000466FB" data-uri="chapter11.xhtml#P70004970270000000000000000466FB" class="pcalibre calibre3 pcalibre1">LAN2 frame to LAN2 adapter under server (Host B)</p></li>
<li id="P70004970270000000000000000466FC" data-uri="chapter11.xhtml#P70004970270000000000000000466FC" class="calibre12 pcalibre pcalibre1"><p id="P70004970270000000000000000466FD" data-uri="chapter11.xhtml#P70004970270000000000000000466FD" class="pcalibre calibre3 pcalibre1">LAN2 frame to protocol software</p></li>
<li id="P70004970270000000000000000466FE" data-uri="chapter11.xhtml#P70004970270000000000000000466FE" class="calibre12 pcalibre pcalibre1"><p id="P70004970270000000000000000466FF" data-uri="chapter11.xhtml#P70004970270000000000000000466FF" class="pcalibre calibre3 pcalibre1">Data to server</p></li>
</ol>
</details>
</figcaption>
</figure></li>
<li id="P7000497027000000000000000046700" data-uri="chapter11.xhtml#P7000497027000000000000000046700" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000046701" data-uri="chapter11.xhtml#P7000497027000000000000000046701" class="pcalibre calibre3 pcalibre1">The LAN1 adapter copies the frame to the network.</p></li>
<li id="P7000497027000000000000000046702" data-uri="chapter11.xhtml#P7000497027000000000000000046702" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000046703" data-uri="chapter11.xhtml#P7000497027000000000000000046703" class="pcalibre calibre3 pcalibre1">When the frame reaches the router, the router's LAN1 adapter reads it from the wire and passes it to the protocol software.</p></li>
<li id="P7000497027000000000000000046704" data-uri="chapter11.xhtml#P7000497027000000000000000046704" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000046705" data-uri="chapter11.xhtml#P7000497027000000000000000046705" class="pcalibre calibre3 pcalibre1">The router fetches the destination internet address from the internet packet header and uses this as an index into a routing table to determine where to forward the packet, which in this case is LAN2. The router then strips off the old LAN1 frame header, prepends a new LAN2 frame header addressed to host B, and passes the resulting frame to the adapter.</p></li>
<li id="P7000497027000000000000000046706" data-uri="chapter11.xhtml#P7000497027000000000000000046706" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000046707" data-uri="chapter11.xhtml#P7000497027000000000000000046707" class="pcalibre calibre3 pcalibre1">The router's LAN2 adapter copies the frame to the network.</p></li>
<li id="P7000497027000000000000000046708" data-uri="chapter11.xhtml#P7000497027000000000000000046708" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000046709" data-uri="chapter11.xhtml#P7000497027000000000000000046709" class="pcalibre calibre3 pcalibre1">When the frame reaches host B, its adapter reads the frame from the wire and passes it to the protocol software.</p></li>
<li id="P700049702700000000000000004670A" data-uri="chapter11.xhtml#P700049702700000000000000004670A" class="calibre12 pcalibre pcalibre1"><p id="P700049702700000000000000004670B" data-uri="chapter11.xhtml#P700049702700000000000000004670B" class="pcalibre calibre3 pcalibre1">Finally, the protocol software on host B strips off the packet header and frame header. The protocol software will eventually copy the resulting data into the server's virtual address space when the server invokes a system call that reads the data.</p></li>
</ol>
<p id="P700049702700000000000000004670C" data-uri="chapter11.xhtml#P700049702700000000000000004670C" class="pcalibre1 pcalibre calibre2">Of course, we are glossing over many difficult issues here. What if different networks have different maximum frame sizes? How do routers know where to forward frames? How are routers informed when the network topology changes? What if a packet gets lost? Nonetheless, our example captures the essence of the internet idea, and encapsulation is the key.</p>
<figure class="pcalibre5 figure pcalibre" id="P7000497027000000000000000007BF9" data-uri="chapter11.xhtml#P7000497027000000000000000007BF9">
<span class="pcalibre pagebreak pcalibre1" id="P7000497027000000000000000007BFA" title="924" data-uri="chapter11.xhtml#P7000497027000000000000000007BFA" epub:type="pagebreak"></span>
<img alt="A diagram illustrates hardware and software organization of an Internet application." id="P700049702700000000000000004670D" data-uri="P700049702700000000000000000B7C1" src="../images/p924-1.png" class="calibre322 pcalibre pcalibre1"/>
<figcaption id="P700049702700000000000000004670E" data-uri="chapter11.xhtml#P700049702700000000000000004670E" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P700049702700000000000000004670F" data-uri="chapter11.xhtml#P700049702700000000000000004670F" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">11.8 </span>Hardware and software organization of an Internet application.</h1></header>
<details class="longdesc pcalibre pcalibre1" id="P7000497027000000000000000026A79" data-uri="chapter11.xhtml#P7000497027000000000000000026A79">
<summary class="pcalibre6 pcalibre1 pcalibre calibre30"><span class="number pcalibre pcalibre1">Description</span></summary>
<p id="P7000497027000000000000000046710" data-uri="chapter11.xhtml#P7000497027000000000000000046710" class="pcalibre1 pcalibre calibre2">A diagram shows an Internet client host and Internet server host each interacting with Global IP Internet via TCP/IP and Network adapter. The organization of the Internet client host is summarized below.</p>
<ul id="P7000497027000000000000000046711" data-uri="chapter11.xhtml#P7000497027000000000000000046711" class="pcalibre calibre31 pcalibre1">
<li id="P7000497027000000000000000046712" data-uri="chapter11.xhtml#P7000497027000000000000000046712" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000046713" data-uri="chapter11.xhtml#P7000497027000000000000000046713" class="pcalibre calibre3 pcalibre1">Client (user code)</p></li>
<li id="P7000497027000000000000000046714" data-uri="chapter11.xhtml#P7000497027000000000000000046714" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000046715" data-uri="chapter11.xhtml#P7000497027000000000000000046715" class="pcalibre calibre3 pcalibre1">Sockets interface (system calls)</p></li>
<li id="P7000497027000000000000000046716" data-uri="chapter11.xhtml#P7000497027000000000000000046716" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000046717" data-uri="chapter11.xhtml#P7000497027000000000000000046717" class="pcalibre calibre3 pcalibre1">TCP/IP (kernel code)</p></li>
<li id="P7000497027000000000000000046718" data-uri="chapter11.xhtml#P7000497027000000000000000046718" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000046719" data-uri="chapter11.xhtml#P7000497027000000000000000046719" class="pcalibre calibre3 pcalibre1">Hardware interface (interrupts)</p></li>
<li id="P700049702700000000000000004671A" data-uri="chapter11.xhtml#P700049702700000000000000004671A" class="calibre12 pcalibre pcalibre1"><p id="P700049702700000000000000004671B" data-uri="chapter11.xhtml#P700049702700000000000000004671B" class="pcalibre calibre3 pcalibre1">Network adapter (hardware)</p></li>
</ul>
</details>
</figcaption>
</figure>
</section></body></html>
