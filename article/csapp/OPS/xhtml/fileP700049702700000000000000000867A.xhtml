<?xml version='1.0' encoding='utf-8'?>
<html xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:svg="http://www.w3.org/2000/svg" xmlns:epub="http://www.idpf.org/2007/ops" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" epub:prefix="index: http://www.index.com/">
  <head>
    <meta name="dcterms.conformsTo" content="PXE Basic 1.0"/>
    <meta name="generator" content="PXE Tools version 1.39.52"/>
    <!--Created by pxe.pl for standard version PXE Basic 1.0,data-profile-product=standard by PXE Tools 1.39.52, partial=false-->
    <title>Homework Problems </title>
    <link rel="alternate stylesheet" type="text/css" title="night" href="../css/theme/night.css"/>
    <link rel="alternate stylesheet" type="text/css" title="sepia" href="../css/theme/sepia.css"/>
    <script src="js/format_lg_obj.js"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="../../stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="../../page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body epub:type="bodymatter" class="calibre pcalibre pcalibre1">
<section id="P700049702700000000000000000867A" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title pcalibre1" id="P700049702700000000000000004710B" data-uri="chapter12.xhtml#P700049702700000000000000004710B" epub:type="title"><span class="pcalibre label pcalibre1">Homework Problems </span></h1></header>
<section id="P700049702700000000000000000867C" data-uri="chapter12.xhtml#P700049702700000000000000000867C" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P700049702700000000000000004710C" data-uri="chapter12.xhtml#P700049702700000000000000004710C" epub:type="title"><span class="pcalibre label pcalibre1">12.16 </span>♦</h1></header>
<p id="P700049702700000000000000004710D" data-uri="chapter12.xhtml#P700049702700000000000000004710D" class="pcalibre1 pcalibre calibre2">Write a version of <code id="P700049702700000000000000004710E" data-uri="chapter12.xhtml#P700049702700000000000000004710E" class="pcalibre1 calibre8 pcalibre">hello.c</code> (<a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP700049702700000000000000000817D.xhtml#P7000497027000000000000000008195"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">12.13</span></a>) that creates and reaps <var class="calibre5 pcalibre pcalibre1">n</var> joinable peer threads, where <var class="calibre5 pcalibre pcalibre1">n</var> is a command-line argument.</p>
</section>
<section id="P7000497027000000000000000008680" data-uri="chapter12.xhtml#P7000497027000000000000000008680" epub:type="practice" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P700049702700000000000000004710F" data-uri="chapter12.xhtml#P700049702700000000000000004710F" epub:type="title"><span class="pcalibre label pcalibre1">12.17 </span>♦</h1></header>
<ol class="practicelist1 pcalibre pcalibre1" id="P7000497027000000000000000047110" data-uri="chapter12.xhtml#P7000497027000000000000000047110">
<li class="general-problem pcalibre pcalibre1" id="P7000497027000000000000000047111" data-uri="chapter12.xhtml#P7000497027000000000000000047111">
<div class="edition pcalibre pcalibre1" id="P7000497027000000000000000047112" data-uri="chapter12.xhtml#P7000497027000000000000000047112"><p id="P7000497027000000000000000047113" data-uri="chapter12.xhtml#P7000497027000000000000000047113" class="pcalibre calibre3 pcalibre1">The program in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000008687"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">12.46</span></a> has a bug. The thread is supposed to sleep for 1 second and then print a string. However, when we run it on our system, nothing prints. Why?</p></div></li>
<li class="general-problem pcalibre pcalibre1" id="P7000497027000000000000000047114" data-uri="chapter12.xhtml#P7000497027000000000000000047114">
<div class="edition pcalibre pcalibre1" id="P7000497027000000000000000047115" data-uri="chapter12.xhtml#P7000497027000000000000000047115"><p id="P7000497027000000000000000047116" data-uri="chapter12.xhtml#P7000497027000000000000000047116" class="pcalibre calibre3 pcalibre1">You can fix this bug by replacing the exit function in line 10 with one of two different Pthreads function calls. Which ones?</p></div></li>
</ol>
<figure class="pcalibre5 figure pcalibre" id="P7000497027000000000000000008687" data-uri="chapter12.xhtml#P7000497027000000000000000008687">
<p id="P7000497027000000000000000047117" data-uri="chapter12.xhtml#P7000497027000000000000000047117" class="pcalibre1 pcalibre calibre2">-------------------------------------------<i class="calibre5 pcalibre pcalibre1">code/conc/hellobug.c</i></p>
<pre id="P7000497027000000000000000047118" data-uri="chapter12.xhtml#P7000497027000000000000000047118" class="calibre9 pcalibre pcalibre1"><code id="P7000497027000000000000000047119" data-uri="chapter12.xhtml#P7000497027000000000000000047119" class="calibre10 pcalibre pcalibre1">
1	/* WARNING: This code is buggy! */
2	#include "csapp.h"
3	void *thread(void *vargp);
4
5	int main()
6	{
7		pthread_t tid;
8
9		Pthread_create(&amp;tid, NULL, thread, NULL);
10		exit(0);
11	}
12
13	/* Thread routine */
14	void *thread(void *vargp)
15	{
16		Sleep(1);
17		printf("Hello, world!\n");
18		return NULL;
19	}
</code></pre>
<p id="P700049702700000000000000004711A" data-uri="chapter12.xhtml#P700049702700000000000000004711A" class="pcalibre1 pcalibre calibre2">-------------------------------------------<i class="calibre5 pcalibre pcalibre1">code/conc/hellobug.c</i></p>
<figcaption id="P700049702700000000000000004711B" data-uri="chapter12.xhtml#P700049702700000000000000004711B" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P700049702700000000000000004711C" data-uri="chapter12.xhtml#P700049702700000000000000004711C" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="pcalibre label pcalibre1">12.46 </span>Buggy program for <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000008680"><span class="pcalibre1 label2 pcalibre">Problem </span><span class="number pcalibre pcalibre1">12.17</span></a>.</h1></header>
<div class="caption pcalibre pcalibre1" id="P700049702700000000000000004711D" data-uri="chapter12.xhtml#P700049702700000000000000004711D"><p id="P700049702700000000000000004711E" data-uri="chapter12.xhtml#P700049702700000000000000004711E" class="pcalibre calibre3 pcalibre1"></p></div></figcaption>
</figure>
</section>
<section id="P7000497027000000000000000008690" data-uri="chapter12.xhtml#P7000497027000000000000000008690" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P700049702700000000000000004711F" data-uri="chapter12.xhtml#P700049702700000000000000004711F" epub:type="title"><span class="pcalibre pagebreak pcalibre1" id="P7000497027000000000000000008692" title="1032" data-uri="chapter12.xhtml#P7000497027000000000000000008692" epub:type="pagebreak"></span><span class="pcalibre label pcalibre1">12.18 </span></h1></header>
<p id="P7000497027000000000000000047120" data-uri="chapter12.xhtml#P7000497027000000000000000047120" class="pcalibre1 pcalibre calibre2">Using the progress graph in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP700049702700000000000000000827E.xhtml#P70004970270000000000000000083B5"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">12.21</span></a>, classify the following trajectories as either safe or unsafe.</p>
<ol class="pcalibre ol_upper-alpha pcalibre1" id="P7000497027000000000000000047121" data-uri="chapter12.xhtml#P7000497027000000000000000047121">
<li id="P7000497027000000000000000047122" data-uri="chapter12.xhtml#P7000497027000000000000000047122" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000047123" data-uri="chapter12.xhtml#P7000497027000000000000000047123" class="pcalibre calibre3 pcalibre1"><var class="calibre5 pcalibre pcalibre1">H</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">L</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">U</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">H</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">L</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">S</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">U</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">S</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">T</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">T</var><sub class="pcalibre1 calibre47 pcalibre">2</sub></p></li>
<li id="P7000497027000000000000000047124" data-uri="chapter12.xhtml#P7000497027000000000000000047124" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000047125" data-uri="chapter12.xhtml#P7000497027000000000000000047125" class="pcalibre calibre3 pcalibre1"><var class="calibre5 pcalibre pcalibre1">H</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">H</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">L</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">U</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">S</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">L</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">T</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">U</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">S</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">T</var><sub class="pcalibre1 calibre47 pcalibre">2</sub></p></li>
<li id="P7000497027000000000000000047126" data-uri="chapter12.xhtml#P7000497027000000000000000047126" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000047127" data-uri="chapter12.xhtml#P7000497027000000000000000047127" class="pcalibre calibre3 pcalibre1"><var class="calibre5 pcalibre pcalibre1">H</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">L</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">H</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">L</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">U</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">S</var><sub class="pcalibre1 calibre47 pcalibre">2</sub>, <var class="calibre5 pcalibre pcalibre1">U</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">S</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">T</var><sub class="pcalibre1 calibre47 pcalibre">1</sub>, <var class="calibre5 pcalibre pcalibre1">T</var><sub class="pcalibre1 calibre47 pcalibre">2</sub></p></li>
</ol>
</section>
<section id="P700049702700000000000000000869B" data-uri="chapter12.xhtml#P700049702700000000000000000869B" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P7000497027000000000000000047128" data-uri="chapter12.xhtml#P7000497027000000000000000047128" epub:type="title"><span class="pcalibre label pcalibre1">12.19 </span>♦♦</h1></header>
<p id="P7000497027000000000000000047129" data-uri="chapter12.xhtml#P7000497027000000000000000047129" class="pcalibre1 pcalibre calibre2">The solution to the first readers-writers problem in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP700049702700000000000000000827E.xhtml#P7000497027000000000000000008459"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">12.26</span></a> gives a somewhat weak priority to readers because a writer leaving its critical section might restart a waiting writer instead of a waiting reader. Derive a solution that gives stronger priority to readers, where a writer leaving its critical section will always restart a waiting reader if one exists.</p>
</section>
<section id="P700049702700000000000000000869E" data-uri="chapter12.xhtml#P700049702700000000000000000869E" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P700049702700000000000000004712A" data-uri="chapter12.xhtml#P700049702700000000000000004712A" epub:type="title"><span class="pcalibre label pcalibre1">12.20  </span>♦♦♦</h1></header>
<p id="P700049702700000000000000004712B" data-uri="chapter12.xhtml#P700049702700000000000000004712B" class="pcalibre1 pcalibre calibre2">Consider a simpler variant of the readers-writers problem where there are at most <var class="calibre5 pcalibre pcalibre1">N</var> readers. Derive a solution that gives equal priority to readers and writers, in the sense that pending readers and writers have an equal chance of being granted access to the resource. <i class="calibre5 pcalibre pcalibre1">Hint:</i> You can solve this problem using a single counting semaphore and a single mutex.</p>
</section>
<section id="P70004970270000000000000000086A1" data-uri="chapter12.xhtml#P70004970270000000000000000086A1" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P700049702700000000000000004712C" data-uri="chapter12.xhtml#P700049702700000000000000004712C" epub:type="title"><span class="pcalibre label pcalibre1">12.21  </span>♦♦♦♦</h1></header>
<p id="P700049702700000000000000004712D" data-uri="chapter12.xhtml#P700049702700000000000000004712D" class="pcalibre1 pcalibre calibre2">Derive a solution to the second readers-writers problem, which favors writers instead of readers.</p>
</section>
<section id="P70004970270000000000000000086A4" data-uri="chapter12.xhtml#P70004970270000000000000000086A4" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P700049702700000000000000004712E" data-uri="chapter12.xhtml#P700049702700000000000000004712E" epub:type="title"><span class="pcalibre label pcalibre1">12.22 </span>♦♦</h1></header>
<p id="P700049702700000000000000004712F" data-uri="chapter12.xhtml#P700049702700000000000000004712F" class="pcalibre1 pcalibre calibre2">Test your understanding of the <code id="P7000497027000000000000000047130" data-uri="chapter12.xhtml#P7000497027000000000000000047130" class="pcalibre1 calibre8 pcalibre">select</code> function by modifying the server in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP70004970270000000000000000080DE.xhtml#P7000497027000000000000000008109"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">12.6</span></a> so that it echoes at most one text line per iteration of the main server loop.</p>
</section>
<section id="P70004970270000000000000000086A8" data-uri="chapter12.xhtml#P70004970270000000000000000086A8" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P7000497027000000000000000047131" data-uri="chapter12.xhtml#P7000497027000000000000000047131" epub:type="title"><span class="pcalibre label pcalibre1">12.23 </span>♦♦</h1></header>
<p id="P7000497027000000000000000047132" data-uri="chapter12.xhtml#P7000497027000000000000000047132" class="pcalibre1 pcalibre calibre2">The event-driven concurrent echo server in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP70004970270000000000000000080DE.xhtml#P7000497027000000000000000008144"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">12.8</span></a> is flawed because a malicious client can deny service to other clients by sending a partial text line. Write an improved version of the server that can handle these partial text lines without blocking.</p>
</section>
<section id="P70004970270000000000000000086AB" data-uri="chapter12.xhtml#P70004970270000000000000000086AB" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P7000497027000000000000000047133" data-uri="chapter12.xhtml#P7000497027000000000000000047133" epub:type="title"><span class="pcalibre label pcalibre1">12.24 </span>♦</h1></header>
<p id="P7000497027000000000000000047134" data-uri="chapter12.xhtml#P7000497027000000000000000047134" class="pcalibre1 pcalibre calibre2">The functions in the R<span class="smallcaps pcalibre pcalibre1">io </span>I/O package (<a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP7000497027000000000000000007975.xhtml#P7000497027000000000000000007975"><span class="pcalibre label pcalibre1">Section </span><span class="pcalibre label pcalibre1">10.5</span></a>) are thread-safe. Are they reentrant as well?</p>
</section>
<section id="P70004970270000000000000000086AE" data-uri="chapter12.xhtml#P70004970270000000000000000086AE" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P7000497027000000000000000047135" data-uri="chapter12.xhtml#P7000497027000000000000000047135" epub:type="title"><span class="pcalibre label pcalibre1">12.25 </span>♦</h1></header>
<p id="P7000497027000000000000000047136" data-uri="chapter12.xhtml#P7000497027000000000000000047136" class="pcalibre1 pcalibre calibre2">In the prethreaded concurrent echo server in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP700049702700000000000000000827E.xhtml#P7000497027000000000000000008478"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">12.28</span></a>, each thread calls the <code id="P7000497027000000000000000047137" data-uri="chapter12.xhtml#P7000497027000000000000000047137" class="pcalibre1 calibre8 pcalibre">echo_cnt</code> function (<a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP700049702700000000000000000827E.xhtml#P7000497027000000000000000008482"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">12.29</span></a>). Is <code id="P7000497027000000000000000047138" data-uri="chapter12.xhtml#P7000497027000000000000000047138" class="pcalibre1 calibre8 pcalibre">echo_cnt</code> thread-safe? Is it reentrant? Why or why not?</p>
</section>
<section id="P70004970270000000000000000086B3" data-uri="chapter12.xhtml#P70004970270000000000000000086B3" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P7000497027000000000000000047139" data-uri="chapter12.xhtml#P7000497027000000000000000047139" epub:type="title"><span class="pcalibre pagebreak pcalibre1" id="P70004970270000000000000000086B5" title="1033" data-uri="chapter12.xhtml#P70004970270000000000000000086B5" epub:type="pagebreak"></span><span class="pcalibre label pcalibre1">12.26  </span>♦♦♦</h1></header>
<p id="P700049702700000000000000004713A" data-uri="chapter12.xhtml#P700049702700000000000000004713A" class="pcalibre1 pcalibre calibre2">Use the lock-and-copy technique to implement a thread-safe non-reentrant version of <code id="P700049702700000000000000004713B" data-uri="chapter12.xhtml#P700049702700000000000000004713B" class="pcalibre1 calibre8 pcalibre">gethostbyname</code> called <code id="P700049702700000000000000004713C" data-uri="chapter12.xhtml#P700049702700000000000000004713C" class="pcalibre1 calibre8 pcalibre">gethostbyname_ts</code>. A correct solution will use a deep copy of the <code id="P700049702700000000000000004713D" data-uri="chapter12.xhtml#P700049702700000000000000004713D" class="pcalibre1 calibre8 pcalibre">hostent</code> structure protected by a mutex.</p>
</section>
<section id="P70004970270000000000000000086BA" data-uri="chapter12.xhtml#P70004970270000000000000000086BA" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P700049702700000000000000004713E" data-uri="chapter12.xhtml#P700049702700000000000000004713E" epub:type="title"><span class="pcalibre label pcalibre1">12.27 </span>♦♦</h1></header>
<p id="P700049702700000000000000004713F" data-uri="chapter12.xhtml#P700049702700000000000000004713F" class="pcalibre1 pcalibre calibre2">Some network programming texts suggest the following approach for reading and writing sockets: Before interacting with the client, open two standard I/O streams on the same open connected socket descriptor, one for reading and one for writing:</p>
<pre id="P7000497027000000000000000047140" data-uri="chapter12.xhtml#P7000497027000000000000000047140" class="calibre9 pcalibre pcalibre1"><code id="P7000497027000000000000000047141" data-uri="chapter12.xhtml#P7000497027000000000000000047141" class="calibre10 pcalibre pcalibre1">FILE *fpin, *fpout;</code></pre>
<pre id="P7000497027000000000000000047142" data-uri="chapter12.xhtml#P7000497027000000000000000047142" class="calibre9 pcalibre pcalibre1"><code id="P7000497027000000000000000047143" data-uri="chapter12.xhtml#P7000497027000000000000000047143" class="calibre10 pcalibre pcalibre1">
fpin = fdopen(sockfd, "r");
fpout = fdopen(sockfd, "w");</code></pre>
<p class="pcalibre1 pcalibre calibre2" id="P7000497027000000000000000047144" data-uri="chapter12.xhtml#P7000497027000000000000000047144">When the server finishes interacting with the client, close both streams as follows:</p>
<pre id="P7000497027000000000000000047145" data-uri="chapter12.xhtml#P7000497027000000000000000047145" class="calibre9 pcalibre pcalibre1"><code id="P7000497027000000000000000047146" data-uri="chapter12.xhtml#P7000497027000000000000000047146" class="calibre10 pcalibre pcalibre1">fclose(fpin);
fclose(fpout);</code></pre>
<p id="P7000497027000000000000000047147" data-uri="chapter12.xhtml#P7000497027000000000000000047147" class="pcalibre1 pcalibre calibre2">However, if you try this approach in a concurrent server based on threads, you will create a deadly race condition. Explain.</p>
</section>
<section id="P70004970270000000000000000086C5" data-uri="chapter12.xhtml#P70004970270000000000000000086C5" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P7000497027000000000000000047148" data-uri="chapter12.xhtml#P7000497027000000000000000047148" epub:type="title"><span class="pcalibre label pcalibre1">12.28 </span>♦</h1></header>
<p id="P7000497027000000000000000047149" data-uri="chapter12.xhtml#P7000497027000000000000000047149" class="pcalibre1 pcalibre calibre2">In <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP7000497027000000000000000008577.xhtml#P7000497027000000000000000008653"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">12.45</span></a>, does swapping the order of the two <var class="calibre5 pcalibre pcalibre1">V</var> operations have any effect on whether or not the program deadlocks? Justify your answer by drawing the progress graphs for the four possible cases:</p>
<table class="informaltable pcalibre pcalibre1" id="P700049702700000000000000004714A" data-uri="chapter12.xhtml#P700049702700000000000000004714A">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th colspan="2" id="P700049702700000000000000004714B" data-uri="chapter12.xhtml#P700049702700000000000000004714B" class="calibre18 pcalibre pcalibre1">Case1</th>
<th colspan="2" id="P700049702700000000000000004714C" data-uri="chapter12.xhtml#P700049702700000000000000004714C" class="calibre18 pcalibre pcalibre1">Case2</th>
<th colspan="2" id="P700049702700000000000000004714D" data-uri="chapter12.xhtml#P700049702700000000000000004714D" class="calibre18 pcalibre pcalibre1">Case3</th>
<th colspan="2" id="P700049702700000000000000004714E" data-uri="chapter12.xhtml#P700049702700000000000000004714E" class="calibre18 pcalibre pcalibre1">Case 4</th>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<th id="P700049702700000000000000004714F" data-uri="chapter12.xhtml#P700049702700000000000000004714F" class="calibre18 pcalibre pcalibre1">Thread 1</th>
<th id="P7000497027000000000000000047150" data-uri="chapter12.xhtml#P7000497027000000000000000047150" class="calibre18 pcalibre pcalibre1">Thread 2</th>
<th id="P7000497027000000000000000047151" data-uri="chapter12.xhtml#P7000497027000000000000000047151" class="calibre18 pcalibre pcalibre1">Thread 1</th>
<th id="P7000497027000000000000000047152" data-uri="chapter12.xhtml#P7000497027000000000000000047152" class="calibre18 pcalibre pcalibre1">Thread 2</th>
<th id="P7000497027000000000000000047153" data-uri="chapter12.xhtml#P7000497027000000000000000047153" class="calibre18 pcalibre pcalibre1">Thread 1</th>
<th id="P7000497027000000000000000047154" data-uri="chapter12.xhtml#P7000497027000000000000000047154" class="calibre18 pcalibre pcalibre1">Thread 2</th>
<th id="P7000497027000000000000000047155" data-uri="chapter12.xhtml#P7000497027000000000000000047155" class="calibre18 pcalibre pcalibre1">Thread 1</th>
<th id="P7000497027000000000000000047156" data-uri="chapter12.xhtml#P7000497027000000000000000047156" class="calibre18 pcalibre pcalibre1">Thread 2</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000047157" data-uri="chapter12.xhtml#P7000497027000000000000000047157" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000047158" data-uri="chapter12.xhtml#P7000497027000000000000000047158" class="calibre10 pcalibre pcalibre1">P(s)</code></td>
<td id="P7000497027000000000000000047159" data-uri="chapter12.xhtml#P7000497027000000000000000047159" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004715A" data-uri="chapter12.xhtml#P700049702700000000000000004715A" class="calibre10 pcalibre pcalibre1">P(s)</code></td>
<td id="P700049702700000000000000004715B" data-uri="chapter12.xhtml#P700049702700000000000000004715B" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004715C" data-uri="chapter12.xhtml#P700049702700000000000000004715C" class="calibre10 pcalibre pcalibre1">P(s)</code></td>
<td id="P700049702700000000000000004715D" data-uri="chapter12.xhtml#P700049702700000000000000004715D" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004715E" data-uri="chapter12.xhtml#P700049702700000000000000004715E" class="calibre10 pcalibre pcalibre1">P(s)</code></td>
<td id="P700049702700000000000000004715F" data-uri="chapter12.xhtml#P700049702700000000000000004715F" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000047160" data-uri="chapter12.xhtml#P7000497027000000000000000047160" class="calibre10 pcalibre pcalibre1">P(s)</code></td>
<td id="P7000497027000000000000000047161" data-uri="chapter12.xhtml#P7000497027000000000000000047161" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000047162" data-uri="chapter12.xhtml#P7000497027000000000000000047162" class="calibre10 pcalibre pcalibre1">P(s)</code></td>
<td id="P7000497027000000000000000047163" data-uri="chapter12.xhtml#P7000497027000000000000000047163" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000047164" data-uri="chapter12.xhtml#P7000497027000000000000000047164" class="calibre10 pcalibre pcalibre1">P(s)</code></td>
<td id="P7000497027000000000000000047165" data-uri="chapter12.xhtml#P7000497027000000000000000047165" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000047166" data-uri="chapter12.xhtml#P7000497027000000000000000047166" class="calibre10 pcalibre pcalibre1">P(s)</code></td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000047167" data-uri="chapter12.xhtml#P7000497027000000000000000047167" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000047168" data-uri="chapter12.xhtml#P7000497027000000000000000047168" class="calibre10 pcalibre pcalibre1">P(t)</code></td>
<td id="P7000497027000000000000000047169" data-uri="chapter12.xhtml#P7000497027000000000000000047169" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004716A" data-uri="chapter12.xhtml#P700049702700000000000000004716A" class="calibre10 pcalibre pcalibre1">P(t)</code></td>
<td id="P700049702700000000000000004716B" data-uri="chapter12.xhtml#P700049702700000000000000004716B" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004716C" data-uri="chapter12.xhtml#P700049702700000000000000004716C" class="calibre10 pcalibre pcalibre1">P(t)</code></td>
<td id="P700049702700000000000000004716D" data-uri="chapter12.xhtml#P700049702700000000000000004716D" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004716E" data-uri="chapter12.xhtml#P700049702700000000000000004716E" class="calibre10 pcalibre pcalibre1">P(t)</code></td>
<td id="P700049702700000000000000004716F" data-uri="chapter12.xhtml#P700049702700000000000000004716F" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000047170" data-uri="chapter12.xhtml#P7000497027000000000000000047170" class="calibre10 pcalibre pcalibre1">P(t)</code></td>
<td id="P7000497027000000000000000047171" data-uri="chapter12.xhtml#P7000497027000000000000000047171" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000047172" data-uri="chapter12.xhtml#P7000497027000000000000000047172" class="calibre10 pcalibre pcalibre1">P(t)</code></td>
<td id="P7000497027000000000000000047173" data-uri="chapter12.xhtml#P7000497027000000000000000047173" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000047174" data-uri="chapter12.xhtml#P7000497027000000000000000047174" class="calibre10 pcalibre pcalibre1">P(t)</code></td>
<td id="P7000497027000000000000000047175" data-uri="chapter12.xhtml#P7000497027000000000000000047175" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000047176" data-uri="chapter12.xhtml#P7000497027000000000000000047176" class="calibre10 pcalibre pcalibre1">P(t)</code></td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000047177" data-uri="chapter12.xhtml#P7000497027000000000000000047177" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000047178" data-uri="chapter12.xhtml#P7000497027000000000000000047178" class="calibre10 pcalibre pcalibre1">V(s)</code></td>
<td id="P7000497027000000000000000047179" data-uri="chapter12.xhtml#P7000497027000000000000000047179" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004717A" data-uri="chapter12.xhtml#P700049702700000000000000004717A" class="calibre10 pcalibre pcalibre1">V(s)</code></td>
<td id="P700049702700000000000000004717B" data-uri="chapter12.xhtml#P700049702700000000000000004717B" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004717C" data-uri="chapter12.xhtml#P700049702700000000000000004717C" class="calibre10 pcalibre pcalibre1">V(s)</code></td>
<td id="P700049702700000000000000004717D" data-uri="chapter12.xhtml#P700049702700000000000000004717D" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004717E" data-uri="chapter12.xhtml#P700049702700000000000000004717E" class="calibre10 pcalibre pcalibre1">V(t)</code></td>
<td id="P700049702700000000000000004717F" data-uri="chapter12.xhtml#P700049702700000000000000004717F" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000047180" data-uri="chapter12.xhtml#P7000497027000000000000000047180" class="calibre10 pcalibre pcalibre1">V(t)</code></td>
<td id="P7000497027000000000000000047181" data-uri="chapter12.xhtml#P7000497027000000000000000047181" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000047182" data-uri="chapter12.xhtml#P7000497027000000000000000047182" class="calibre10 pcalibre pcalibre1">V(s)</code></td>
<td id="P7000497027000000000000000047183" data-uri="chapter12.xhtml#P7000497027000000000000000047183" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000047184" data-uri="chapter12.xhtml#P7000497027000000000000000047184" class="calibre10 pcalibre pcalibre1">V(t)</code></td>
<td id="P7000497027000000000000000047185" data-uri="chapter12.xhtml#P7000497027000000000000000047185" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000047186" data-uri="chapter12.xhtml#P7000497027000000000000000047186" class="calibre10 pcalibre pcalibre1">V(t)</code></td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000047187" data-uri="chapter12.xhtml#P7000497027000000000000000047187" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000047188" data-uri="chapter12.xhtml#P7000497027000000000000000047188" class="calibre10 pcalibre pcalibre1">V(t)</code></td>
<td id="P7000497027000000000000000047189" data-uri="chapter12.xhtml#P7000497027000000000000000047189" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004718A" data-uri="chapter12.xhtml#P700049702700000000000000004718A" class="calibre10 pcalibre pcalibre1">V(t)</code></td>
<td id="P700049702700000000000000004718B" data-uri="chapter12.xhtml#P700049702700000000000000004718B" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004718C" data-uri="chapter12.xhtml#P700049702700000000000000004718C" class="calibre10 pcalibre pcalibre1">V(t)</code></td>
<td id="P700049702700000000000000004718D" data-uri="chapter12.xhtml#P700049702700000000000000004718D" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004718E" data-uri="chapter12.xhtml#P700049702700000000000000004718E" class="calibre10 pcalibre pcalibre1">V(s)</code></td>
<td id="P700049702700000000000000004718F" data-uri="chapter12.xhtml#P700049702700000000000000004718F" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000047190" data-uri="chapter12.xhtml#P7000497027000000000000000047190" class="calibre10 pcalibre pcalibre1">V(s)</code></td>
<td id="P7000497027000000000000000047191" data-uri="chapter12.xhtml#P7000497027000000000000000047191" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000047192" data-uri="chapter12.xhtml#P7000497027000000000000000047192" class="calibre10 pcalibre pcalibre1">V(t)</code></td>
<td id="P7000497027000000000000000047193" data-uri="chapter12.xhtml#P7000497027000000000000000047193" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000047194" data-uri="chapter12.xhtml#P7000497027000000000000000047194" class="calibre10 pcalibre pcalibre1">V(s)</code></td>
<td id="P7000497027000000000000000047195" data-uri="chapter12.xhtml#P7000497027000000000000000047195" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000047196" data-uri="chapter12.xhtml#P7000497027000000000000000047196" class="calibre10 pcalibre pcalibre1">V(s)</code></td>
</tr>
</tbody>
</table>
</section>
<section id="P7000497027000000000000000008715" data-uri="chapter12.xhtml#P7000497027000000000000000008715" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P7000497027000000000000000047197" data-uri="chapter12.xhtml#P7000497027000000000000000047197" epub:type="title"><span class="pcalibre label pcalibre1">12.29 </span>♦</h1></header>
<p id="P7000497027000000000000000047198" data-uri="chapter12.xhtml#P7000497027000000000000000047198" class="pcalibre1 pcalibre calibre2">Can the following program deadlock? Why or why not?</p>
<pre id="P7000497027000000000000000047199" data-uri="chapter12.xhtml#P7000497027000000000000000047199" class="calibre9 pcalibre pcalibre1"><code id="P700049702700000000000000004719A" data-uri="chapter12.xhtml#P700049702700000000000000004719A" class="calibre10 pcalibre pcalibre1">Initially: a = 1, b = 1, c = 1.</code></pre>
<pre id="P700049702700000000000000004719B" data-uri="chapter12.xhtml#P700049702700000000000000004719B" class="calibre9 pcalibre pcalibre1"><code id="P700049702700000000000000004719C" data-uri="chapter12.xhtml#P700049702700000000000000004719C" class="calibre10 pcalibre pcalibre1">
     Thread 1:	     Thread 2:
	P(a);		P(c);
	P(b);		P(b);
	V(b);		V(b);
	P(c);		V(c);
	V(c);		
	V(a);		</code></pre>
</section>
<section id="P700049702700000000000000000871C" data-uri="chapter12.xhtml#P700049702700000000000000000871C" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P700049702700000000000000004719D" data-uri="chapter12.xhtml#P700049702700000000000000004719D" epub:type="title"><span class="pcalibre pagebreak pcalibre1" id="P700049702700000000000000000871E" title="1034" data-uri="chapter12.xhtml#P700049702700000000000000000871E" epub:type="pagebreak"></span><span class="pcalibre label pcalibre1">12.30 </span>♦</h1></header>
<p id="P700049702700000000000000004719E" data-uri="chapter12.xhtml#P700049702700000000000000004719E" class="pcalibre1 pcalibre calibre2">Consider the following program that deadlocks.</p>
<pre id="P700049702700000000000000004719F" data-uri="chapter12.xhtml#P700049702700000000000000004719F" class="calibre9 pcalibre pcalibre1"><code id="P70004970270000000000000000471A0" data-uri="chapter12.xhtml#P70004970270000000000000000471A0" class="calibre10 pcalibre pcalibre1">Initially: a = 1, b = 1, c = 1.</code></pre>
<pre id="P70004970270000000000000000471A1" data-uri="chapter12.xhtml#P70004970270000000000000000471A1" class="calibre9 pcalibre pcalibre1">
<code id="P70004970270000000000000000471A2" data-uri="chapter12.xhtml#P70004970270000000000000000471A2" class="calibre10 pcalibre pcalibre1">     Thread 1:	     Thread 2:	     Thread 3:
	P(a);		P(c);		P(c);
	P(b);		P(b);		V(c);
	V(b);		V(b);		P(b);
	P(c);		V(c);		P(a);
	V(c);		P(a);		V(a);
	V(a);		V(a);		V(b);</code></pre>
<ol class="pcalibre ol_upper-alpha pcalibre1" id="P70004970270000000000000000471A3" data-uri="chapter12.xhtml#P70004970270000000000000000471A3">
<li id="P70004970270000000000000000471A4" data-uri="chapter12.xhtml#P70004970270000000000000000471A4" class="calibre12 pcalibre pcalibre1"><p id="P70004970270000000000000000471A5" data-uri="chapter12.xhtml#P70004970270000000000000000471A5" class="pcalibre calibre3 pcalibre1">For each thread, list the pairs of mutexes that it holds simultaneously.</p></li>
<li id="P70004970270000000000000000471A6" data-uri="chapter12.xhtml#P70004970270000000000000000471A6" class="calibre12 pcalibre pcalibre1"><p id="P70004970270000000000000000471A7" data-uri="chapter12.xhtml#P70004970270000000000000000471A7" class="pcalibre calibre3 pcalibre1">If <i class="calibre5 pcalibre pcalibre1">a &lt; b &lt; c</i>, which threads violate the mutex lock ordering rule?</p></li>
<li id="P70004970270000000000000000471A8" data-uri="chapter12.xhtml#P70004970270000000000000000471A8" class="calibre12 pcalibre pcalibre1"><p id="P70004970270000000000000000471A9" data-uri="chapter12.xhtml#P70004970270000000000000000471A9" class="pcalibre calibre3 pcalibre1">For these threads, show a new lock ordering that guarantees freedom from deadlock.</p></li>
</ol>
</section>
<section id="P700049702700000000000000000872B" data-uri="chapter12.xhtml#P700049702700000000000000000872B" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P70004970270000000000000000471AA" data-uri="chapter12.xhtml#P70004970270000000000000000471AA" epub:type="title"><span class="pcalibre label pcalibre1">12.31  </span>♦♦♦</h1></header>
<p id="P70004970270000000000000000471AB" data-uri="chapter12.xhtml#P70004970270000000000000000471AB" class="pcalibre1 pcalibre calibre2">Implement a version of the standard I/O <code id="P70004970270000000000000000471AC" data-uri="chapter12.xhtml#P70004970270000000000000000471AC" class="pcalibre1 calibre8 pcalibre">fgets</code> function, called <code id="P70004970270000000000000000471AD" data-uri="chapter12.xhtml#P70004970270000000000000000471AD" class="pcalibre1 calibre8 pcalibre">tfgets</code>, that times out and returns <code id="P70004970270000000000000000471AE" data-uri="chapter12.xhtml#P70004970270000000000000000471AE" class="pcalibre1 calibre8 pcalibre">NULL</code> if it does not receive an input line on standard input within 5 seconds. Your function should be implemented in a package called <code id="P70004970270000000000000000471AF" data-uri="chapter12.xhtml#P70004970270000000000000000471AF" class="pcalibre1 calibre8 pcalibre">tfgets-proc.c</code> using processes, signals, and nonlocal jumps. It should not use the Linux alarm function. Test your solution using the driver program in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000008732"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">12.47</span></a>.</p>
<figure class="pcalibre5 figure pcalibre" id="P7000497027000000000000000008732" data-uri="chapter12.xhtml#P7000497027000000000000000008732">
<p id="P70004970270000000000000000471B0" data-uri="chapter12.xhtml#P70004970270000000000000000471B0" class="pcalibre1 pcalibre calibre2">-------------------------------------------<i class="calibre5 pcalibre pcalibre1">code/conc/tfgets-main.c</i></p>
<pre id="P70004970270000000000000000471B1" data-uri="chapter12.xhtml#P70004970270000000000000000471B1" class="calibre9 pcalibre pcalibre1"><code id="P70004970270000000000000000471B2" data-uri="chapter12.xhtml#P70004970270000000000000000471B2" class="calibre10 pcalibre pcalibre1">
1	#include "csapp.h"
2
3	char *tfgets(char *s, int size, FILE *stream);
4
5	int main()
6	{
7		char buf[MAXLINE];
8
9		if (tfgets(buf, MAXLINE, stdin) == NULL)
10			printf("BOOM!\n");
11		else
12			printf("%s", buf);
13
14		exit(0);
15	}
</code></pre>
<p id="P70004970270000000000000000471B3" data-uri="chapter12.xhtml#P70004970270000000000000000471B3" class="pcalibre1 pcalibre calibre2">-------------------------------------------<i class="calibre5 pcalibre pcalibre1">code/conc/tfgets-main.c</i></p>
<figcaption id="P70004970270000000000000000471B4" data-uri="chapter12.xhtml#P70004970270000000000000000471B4" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P70004970270000000000000000471B5" data-uri="chapter12.xhtml#P70004970270000000000000000471B5" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">12.47 </span>Driver program for Problems 12.31−12.33.</h1></header>
</figcaption>
</figure>
</section>
<section id="P7000497027000000000000000008739" data-uri="chapter12.xhtml#P7000497027000000000000000008739" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P70004970270000000000000000471B6" data-uri="chapter12.xhtml#P70004970270000000000000000471B6" epub:type="title"><span class="pcalibre pagebreak pcalibre1" id="P700049702700000000000000000873B" title="1035" data-uri="chapter12.xhtml#P700049702700000000000000000873B" epub:type="pagebreak"></span><span class="pcalibre label pcalibre1">12.32  </span>♦♦♦</h1></header>
<p id="P70004970270000000000000000471B7" data-uri="chapter12.xhtml#P70004970270000000000000000471B7" class="pcalibre1 pcalibre calibre2">Implement a version of the <code id="P70004970270000000000000000471B8" data-uri="chapter12.xhtml#P70004970270000000000000000471B8" class="pcalibre1 calibre8 pcalibre">tfgets</code> function from <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P700049702700000000000000000872B"><span class="pcalibre label pcalibre1">Problem </span><span class="pcalibre label pcalibre1">12.31</span></a> that uses the <code id="P70004970270000000000000000471B9" data-uri="chapter12.xhtml#P70004970270000000000000000471B9" class="pcalibre1 calibre8 pcalibre">select</code> function. Your function should be implemented in a package called <code id="P70004970270000000000000000471BA" data-uri="chapter12.xhtml#P70004970270000000000000000471BA" class="pcalibre1 calibre8 pcalibre">tfgets-select.c.</code> Test your solution using the driver program from <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P700049702700000000000000000872B"><span class="pcalibre label pcalibre1">Problem </span><span class="pcalibre label pcalibre1">12.31</span></a>. You may assume that standard input is assigned to descriptor 0.</p>
</section>
<section id="P7000497027000000000000000008740" data-uri="chapter12.xhtml#P7000497027000000000000000008740" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P70004970270000000000000000471BB" data-uri="chapter12.xhtml#P70004970270000000000000000471BB" epub:type="title"><span class="pcalibre label pcalibre1">12.33  </span>♦♦♦</h1></header>
<p id="P70004970270000000000000000471BC" data-uri="chapter12.xhtml#P70004970270000000000000000471BC" class="pcalibre1 pcalibre calibre2">Implement a threaded version of the <code id="P70004970270000000000000000471BD" data-uri="chapter12.xhtml#P70004970270000000000000000471BD" class="pcalibre1 calibre8 pcalibre">tfgets</code> function from <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P700049702700000000000000000872B"><span class="pcalibre label pcalibre1">Problem </span><span class="pcalibre label pcalibre1">12.31</span></a>. Your function should be implemented in a package called <code id="P70004970270000000000000000471BE" data-uri="chapter12.xhtml#P70004970270000000000000000471BE" class="pcalibre1 calibre8 pcalibre">tfgets-thread.c.</code> Test your solution using the driver program from <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P700049702700000000000000000872B"><span class="pcalibre label pcalibre1">Problem </span><span class="pcalibre label pcalibre1">12.31</span></a>.</p>
</section>
<section id="P7000497027000000000000000008745" data-uri="chapter12.xhtml#P7000497027000000000000000008745" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P70004970270000000000000000471BF" data-uri="chapter12.xhtml#P70004970270000000000000000471BF" epub:type="title"><span class="pcalibre label pcalibre1">12.34  </span>♦♦♦</h1></header>
<p id="P70004970270000000000000000471C0" data-uri="chapter12.xhtml#P70004970270000000000000000471C0" class="pcalibre1 pcalibre calibre2">Write a parallel threaded version of an <var class="calibre5 pcalibre pcalibre1">N</var> × <var class="calibre5 pcalibre pcalibre1">M</var> matrix multiplication kernel. Compare the performance to the sequential case.</p>
</section>
<section id="P7000497027000000000000000008748" data-uri="chapter12.xhtml#P7000497027000000000000000008748" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P70004970270000000000000000471C1" data-uri="chapter12.xhtml#P70004970270000000000000000471C1" epub:type="title"><span class="pcalibre label pcalibre1">12.35  </span>♦♦♦</h1></header>
<p id="P70004970270000000000000000471C2" data-uri="chapter12.xhtml#P70004970270000000000000000471C2" class="pcalibre1 pcalibre calibre2">Implement a concurrent version of the T<span class="smallcaps pcalibre pcalibre1">iny </span>Web server based on processes. Your solution should create a new child process for each new connection request. Test your solution using a real Web browser.</p>
</section>
<section id="P700049702700000000000000000874B" data-uri="chapter12.xhtml#P700049702700000000000000000874B" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P70004970270000000000000000471C3" data-uri="chapter12.xhtml#P70004970270000000000000000471C3" epub:type="title"><span class="pcalibre label pcalibre1">12.36  </span>♦♦♦</h1></header>
<p id="P70004970270000000000000000471C4" data-uri="chapter12.xhtml#P70004970270000000000000000471C4" class="pcalibre1 pcalibre calibre2">Implement a concurrent version of the T<span class="smallcaps pcalibre pcalibre1">iny </span>Web server based on I/O multiplexing. Test your solution using a real Web browser.</p>
</section>
<section id="P700049702700000000000000000874E" data-uri="chapter12.xhtml#P700049702700000000000000000874E" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P70004970270000000000000000471C5" data-uri="chapter12.xhtml#P70004970270000000000000000471C5" epub:type="title"><span class="pcalibre label pcalibre1">12.37  </span>♦♦♦</h1></header>
<p id="P70004970270000000000000000471C6" data-uri="chapter12.xhtml#P70004970270000000000000000471C6" class="pcalibre1 pcalibre calibre2">Implement a concurrent version of the T<span class="smallcaps pcalibre pcalibre1">iny </span>Web server based on threads. Your solution should create a new thread for each new connection request. Test your solution using a real Web browser.</p>
</section>
<section id="P7000497027000000000000000008751" data-uri="chapter12.xhtml#P7000497027000000000000000008751" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P70004970270000000000000000471C7" data-uri="chapter12.xhtml#P70004970270000000000000000471C7" epub:type="title"><span class="pcalibre label pcalibre1">12.38  </span>♦♦♦♦</h1></header>
<p id="P70004970270000000000000000471C8" data-uri="chapter12.xhtml#P70004970270000000000000000471C8" class="pcalibre1 pcalibre calibre2">Implement a concurrent prethreaded version of the T<span class="smallcaps pcalibre pcalibre1">iny </span>Web server. Your solution should dynamically increase or decrease the number of threads in response to the current load. One strategy is to double the number of threads when the buffer becomes full, and halve the number of threads when the buffer becomes empty. Test your solution using a real Web browser.</p>
</section>
<section id="P7000497027000000000000000008754" data-uri="chapter12.xhtml#P7000497027000000000000000008754" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P70004970270000000000000000471C9" data-uri="chapter12.xhtml#P70004970270000000000000000471C9" epub:type="title"><span class="pcalibre label pcalibre1">12.39  </span>♦♦♦♦</h1></header>
<p id="P70004970270000000000000000471CA" data-uri="chapter12.xhtml#P70004970270000000000000000471CA" class="pcalibre1 pcalibre calibre2">A Web proxy is a program that acts as a middleman between a Web server and browser. Instead of contacting the server directly to get a Web page, the browser contacts the proxy, which forwards the request to the server. When the server replies to the proxy, the proxy sends the reply to the browser. For this lab, you will write a simple Web proxy that filters and logs requests:</p>
<ol class="pcalibre ol_upper-alpha pcalibre1" id="P70004970270000000000000000471CB" data-uri="chapter12.xhtml#P70004970270000000000000000471CB">
<li id="P70004970270000000000000000471CC" data-uri="chapter12.xhtml#P70004970270000000000000000471CC" class="calibre12 pcalibre pcalibre1"><p id="P70004970270000000000000000471CD" data-uri="chapter12.xhtml#P70004970270000000000000000471CD" class="pcalibre calibre3 pcalibre1">In the first part of the lab, you will set up the proxy to accept requests, parse the HTTP, forward the requests to the server, and return the results to the browser. Your proxy should log the URLs of all requests in a log file on disk, and it should also block requests to any URL contained in a filter file on disk.</p></li>
<li id="P70004970270000000000000000471CE" data-uri="chapter12.xhtml#P70004970270000000000000000471CE" class="calibre12 pcalibre pcalibre1"><p id="P70004970270000000000000000471CF" data-uri="chapter12.xhtml#P70004970270000000000000000471CF" class="pcalibre calibre3 pcalibre1"><span class="pcalibre pagebreak pcalibre1" id="P700049702700000000000000000875C" title="1036" data-uri="chapter12.xhtml#P700049702700000000000000000875C" epub:type="pagebreak"></span>In the second part of the lab, you will upgrade your proxy to deal with multiple open connections at once by spawning a separate thread to handle each request. While your proxy is waiting for a remote server to respond to a request so that it can serve one browser, it should be working on a pending request from another browser.</p></li>
</ol>
<p id="P70004970270000000000000000471D0" data-uri="chapter12.xhtml#P70004970270000000000000000471D0" class="pcalibre1 pcalibre calibre2">Check your proxy solution using a real Web browser.</p>
</section>
</section></body></html>
