<?xml version='1.0' encoding='utf-8'?>
<html xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:svg="http://www.w3.org/2000/svg" xmlns:epub="http://www.idpf.org/2007/ops" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" epub:prefix="index: http://www.index.com/">
  <head>
    <meta name="dcterms.conformsTo" content="PXE Basic 1.0"/>
    <meta name="generator" content="PXE Tools version 1.39.52"/>
    <!--Created by pxe.pl for standard version PXE Basic 1.0,data-profile-product=standard by PXE Tools 1.39.52, partial=false-->
    <title>6.4 Cache Memories</title>
    <link rel="alternate stylesheet" type="text/css" title="night" href="../css/theme/night.css"/>
    <link rel="alternate stylesheet" type="text/css" title="sepia" href="../css/theme/sepia.css"/>
    <script src="js/format_lg_obj.js"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="../../stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="../../page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body epub:type="bodymatter" class="calibre pcalibre pcalibre1">
<section id="P700049702700000000000000000556F" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title pcalibre1" id="P7000497027000000000000000043CFA" data-uri="chapter06.xhtml#P7000497027000000000000000043CFA" epub:type="title"><span class="pcalibre label pcalibre1">6.4 </span>Cache Memories</h1></header>
<p id="P7000497027000000000000000043CFB" data-uri="chapter06.xhtml#P7000497027000000000000000043CFB" class="pcalibre1 pcalibre calibre2">The memory hierarchies of early computer systems consisted of only three levels: CPU registers, main memory, and disk storage. However, because of the increasing gap between CPU and main memory, system designers were compelled to insert</p>
<figure class="pcalibre5 figure pcalibre" id="P7000497027000000000000000005572" data-uri="chapter06.xhtml#P7000497027000000000000000005572">
<span class="pcalibre pagebreak pcalibre1" id="P7000497027000000000000000005573" title="615" data-uri="chapter06.xhtml#P7000497027000000000000000005573" epub:type="pagebreak"></span>
<img alt="A diagram of a typical bus structure shows bus interface interacting with both the register file and the cache memories within the CPU chip." id="P7000497027000000000000000043CFC" data-uri="P700049702700000000000000000B738" src="../images/p615-1.png" class="pcalibre1 calibre208 pcalibre"/>
<figcaption id="P7000497027000000000000000043CFD" data-uri="chapter06.xhtml#P7000497027000000000000000043CFD" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P7000497027000000000000000043CFE" data-uri="chapter06.xhtml#P7000497027000000000000000043CFE" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">6.24 </span>Typical bus structure for cache memories.</h1></header>
</figcaption>
</figure>
<p class="pcalibre1 pcalibre calibre2" id="P7000497027000000000000000043CFF" data-uri="chapter06.xhtml#P7000497027000000000000000043CFF">a small SRAM <i class="calibre5 pcalibre pcalibre1">cache memory</i>, called an <i class="calibre5 pcalibre pcalibre1">L1 cache</i> (level 1 cache) between the CPU register file and main memory, as shown in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000005572"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">6.24</span></a>. The L1 cache can be accessed nearly as fast as the registers, typically in about 4 clock cycles.</p>
<p id="P7000497027000000000000000043D00" data-uri="chapter06.xhtml#P7000497027000000000000000043D00" class="pcalibre1 pcalibre calibre2">As the performance gap between the CPU and main memory continued to increase, system designers responded by inserting an additional larger cache, called an <i class="calibre5 pcalibre pcalibre1">L2 cache</i>, between the L1 cache and main memory, that can be accessed in about 10 clock cycles. Many modern systems include an even larger cache, called an <i class="calibre5 pcalibre pcalibre1">L3 cache</i>, which sits between the L2 cache and main memory in the memory hierarchy and can be accessed in about 50 cycles. While there is considerable variety in the arrangements, the general principles are the same. For our discussion in the next section, we will assume a simple memory hierarchy with a single L1 cache between the CPU and main memory.</p>
<section id="P7000497027000000000000000005579" data-uri="chapter06.xhtml#P7000497027000000000000000005579" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P7000497027000000000000000043D01" data-uri="chapter06.xhtml#P7000497027000000000000000043D01" epub:type="title"><span class="pcalibre label pcalibre1">6.4.1 </span>Generic Cache Memory Organization</h1></header>
<p id="P7000497027000000000000000043D02" data-uri="chapter06.xhtml#P7000497027000000000000000043D02" class="pcalibre1 pcalibre calibre2">Consider a computer system where each memory address has <var class="calibre5 pcalibre pcalibre1">m</var> bits that form <var class="calibre5 pcalibre pcalibre1">M</var> = 2<sup class="calibre51 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">m</var></sup> unique addresses. As illustrated in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P700049702700000000000000000557F"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">6.25(a)</span></a>, a cache for such a machine is organized as an array of <var class="calibre5 pcalibre pcalibre1">S</var> = 2<sup class="calibre51 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">s</var></sup> <i class="calibre5 pcalibre pcalibre1">cache sets</i>. Each set consists of <i class="calibre5 pcalibre pcalibre1">E cache lines.</i> Each line consists of a data <i class="calibre5 pcalibre pcalibre1">block</i> of <var class="calibre5 pcalibre pcalibre1">B</var> = 2<sup class="calibre51 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">b</var></sup> bytes, a <i class="calibre5 pcalibre pcalibre1">valid bit</i> that indicates whether or not the line contains meaningful information, and <var class="calibre5 pcalibre pcalibre1">t</var> = <var class="calibre5 pcalibre pcalibre1">m</var> − (<var class="calibre5 pcalibre pcalibre1">b</var> + <var class="calibre5 pcalibre pcalibre1">s</var>) <i class="calibre5 pcalibre pcalibre1">tag bits</i> (a subset of the bits from the current block's memory address) that uniquely identify the block stored in the cache line.</p>
<p id="P7000497027000000000000000043D03" data-uri="chapter06.xhtml#P7000497027000000000000000043D03" class="pcalibre1 pcalibre calibre2">In general, a cache's organization can be characterized by the tuple (<i class="calibre5 pcalibre pcalibre1">S, E, B, m</i>). The size (or capacity) of a cache, <var class="calibre5 pcalibre pcalibre1">C</var>, is stated in terms of the aggregate size of all the blocks. The tag bits and valid bit are not included. Thus, <i class="calibre5 pcalibre pcalibre1">C = S</i> × <var class="calibre5 pcalibre pcalibre1">E</var> × <i class="calibre5 pcalibre pcalibre1">B.</i></p>
<p id="P7000497027000000000000000043D04" data-uri="chapter06.xhtml#P7000497027000000000000000043D04" class="pcalibre1 pcalibre calibre2">When the CPU is instructed by a load instruction to read a word from address <var class="calibre5 pcalibre pcalibre1">A</var> of main memory, it sends address <var class="calibre5 pcalibre pcalibre1">A</var> to the cache. If the cache is holding a copy of the word at address <var class="calibre5 pcalibre pcalibre1">A</var>, it sends the word immediately back to the CPU. So how does the cache know whether it contains a copy of the word at address <var class="calibre5 pcalibre pcalibre1">A</var>? The cache is organized so that it can find the requested word by simply inspecting the bits of the address, similar to a hash table with an extremely simple hash function. Here is how it works:</p>
<p id="P7000497027000000000000000043D05" data-uri="chapter06.xhtml#P7000497027000000000000000043D05" class="pcalibre1 pcalibre calibre2">The parameters <var class="calibre5 pcalibre pcalibre1">S</var> and <var class="calibre5 pcalibre pcalibre1">B</var> induce a partitioning of the <var class="calibre5 pcalibre pcalibre1">m</var> address bits into the three fields shown in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P700049702700000000000000000557F"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">6.25(b)</span></a>. The <i class="calibre5 pcalibre pcalibre1">s set index bits</i> in A form an index into</p>
<figure class="pcalibre5 figure pcalibre" id="P700049702700000000000000000557F" data-uri="chapter06.xhtml#P700049702700000000000000000557F">
<span class="pcalibre pagebreak pcalibre1" id="P7000497027000000000000000005580" title="616" data-uri="chapter06.xhtml#P7000497027000000000000000005580" epub:type="pagebreak"></span>
<img alt="Diagrams illustrate the general organization of cache." id="P7000497027000000000000000043D06" data-uri="P700049702700000000000000000B739" src="../images/p616-1.png" class="calibre209 pcalibre pcalibre1"/>
<figcaption id="P7000497027000000000000000043D07" data-uri="chapter06.xhtml#P7000497027000000000000000043D07" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P7000497027000000000000000043D08" data-uri="chapter06.xhtml#P7000497027000000000000000043D08" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="pcalibre label pcalibre1">6.25 </span>General organization of cache <i class="calibre5 pcalibre pcalibre1">(S, E, B, m).</i></h1></header>
<div class="edition pcalibre pcalibre1" id="P7000497027000000000000000043D09" data-uri="chapter06.xhtml#P7000497027000000000000000043D09"><p id="P7000497027000000000000000043D0A" data-uri="chapter06.xhtml#P7000497027000000000000000043D0A" class="pcalibre calibre3 pcalibre1">(a) A cache is an array of sets. Each set contains one or more lines. Each line contains a valid bit, some tag bits, and a block of data, (b) The cache organization induces a partition of the <var class="calibre5 pcalibre pcalibre1">m</var> address bits into <var class="calibre5 pcalibre pcalibre1">t</var> tag bits, <var class="calibre5 pcalibre pcalibre1">s</var> set index bits, and <var class="calibre5 pcalibre pcalibre1">b</var> block offset bits.</p></div>
<details class="longdesc pcalibre pcalibre1" id="P7000497027000000000000000024009" data-uri="chapter06.xhtml#P7000497027000000000000000024009">
<summary class="pcalibre6 pcalibre1 pcalibre calibre30"><span class="number pcalibre pcalibre1">Description</span></summary>
<ol class="pcalibre1 pcalibre ol_lower-alpha1" id="P7000497027000000000000000043D0B" data-uri="chapter06.xhtml#P7000497027000000000000000043D0B">
<li id="P7000497027000000000000000043D0C" data-uri="chapter06.xhtml#P7000497027000000000000000043D0C" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043D0D" data-uri="chapter06.xhtml#P7000497027000000000000000043D0D" class="pcalibre calibre3 pcalibre1">A diagram illustrates a cache size C = B times E times S data bytes. Sets 0, 1, and S minus 1 represent S = 2<sup class="calibre51 pcalibre pcalibre1">s</sup> sets. Each set includes E number of lines, each with three sets of bits: 1 valid bit per line, t tag bits per line, and B = 2<sup class="calibre51 pcalibre pcalibre1">b</sup> bytes per cache block (including 0, 1,…B minus 1).</p></li>
<li id="P7000497027000000000000000043D0E" data-uri="chapter06.xhtml#P7000497027000000000000000043D0E" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043D0F" data-uri="chapter06.xhtml#P7000497027000000000000000043D0F" class="pcalibre calibre3 pcalibre1">An address, from m minus 1 to 0, includes a tag, composed of t bits, a set index, composed of s bits, and block offset, composed of b bits.</p></li>
</ol>
</details>
</figcaption>
</figure>
<p class="pcalibre1 pcalibre calibre2" id="P7000497027000000000000000043D10" data-uri="chapter06.xhtml#P7000497027000000000000000043D10">the array of <var class="calibre5 pcalibre pcalibre1">S</var> sets. The first set is set 0, the second set is set 1, and so on. When interpreted as an unsigned integer, the set index bits tell us which set the word must be stored in. Once we know which set the word must be contained in, the <var class="calibre5 pcalibre pcalibre1">t</var> tag bits in <var class="calibre5 pcalibre pcalibre1">A</var> tell us which line (if any) in the set contains the word. A line in the set contains the word if and only if the valid bit is set and the tag bits in the line match the tag bits in the address <i class="calibre5 pcalibre pcalibre1">A.</i> Once we have located the line identified by the tag in the set identified by the set index, then the <i class="calibre5 pcalibre pcalibre1">b block offset bits</i> give us the offset of the word in the B-byte data block.</p>
<p id="P7000497027000000000000000043D11" data-uri="chapter06.xhtml#P7000497027000000000000000043D11" class="pcalibre1 pcalibre calibre2">As you may have noticed, descriptions of caches use a lot of symbols. <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P70004970270000000000000000055B3"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">6.26</span></a> summarizes these symbols for your reference.</p>
<section id="P7000497027000000000000000005588" data-uri="chapter06.xhtml#P7000497027000000000000000005588" epub:type="practice" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title5 pcalibre pcalibre1" id="P7000497027000000000000000043D12" data-uri="chapter06.xhtml#P7000497027000000000000000043D12" epub:type="title"><span class="pcalibre label pcalibre1">Practice Problem </span><span class="pcalibre label pcalibre1">6.9 </span>(solution page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP7000497027000000000000000005E52.xhtml#P7000497027000000000000000005EAC">663</a>)</h1></header>
<ol class="practicelist pcalibre pcalibre1" id="P7000497027000000000000000043D13" data-uri="chapter06.xhtml#P7000497027000000000000000043D13">
<li class="general-problem pcalibre pcalibre1" id="P7000497027000000000000000043D14" data-uri="chapter06.xhtml#P7000497027000000000000000043D14">
<div class="edition pcalibre pcalibre1" id="P7000497027000000000000000043D15" data-uri="chapter06.xhtml#P7000497027000000000000000043D15"><p id="P7000497027000000000000000043D16" data-uri="chapter06.xhtml#P7000497027000000000000000043D16" class="pcalibre calibre3 pcalibre1">The following table gives the parameters for a number of different caches. For each cache, determine the number of cache sets <i class="calibre5 pcalibre pcalibre1">(S)</i>, tag bits <i class="calibre5 pcalibre pcalibre1">(t)</i>, set index bits <i class="calibre5 pcalibre pcalibre1">(s)</i>, and block offset bits <i class="calibre5 pcalibre pcalibre1">(b).</i></p>
<table class="informaltable pcalibre pcalibre1" id="P7000497027000000000000000043D17" data-uri="chapter06.xhtml#P7000497027000000000000000043D17">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P7000497027000000000000000043D18" data-uri="chapter06.xhtml#P7000497027000000000000000043D18" class="calibre18 pcalibre pcalibre1">Cache</th>
<th id="P7000497027000000000000000043D19" data-uri="chapter06.xhtml#P7000497027000000000000000043D19" class="calibre18 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">m</var></th>
<th id="P7000497027000000000000000043D1A" data-uri="chapter06.xhtml#P7000497027000000000000000043D1A" class="calibre18 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">C</var></th>
<th id="P7000497027000000000000000043D1B" data-uri="chapter06.xhtml#P7000497027000000000000000043D1B" class="calibre18 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">B</var></th>
<th id="P7000497027000000000000000043D1C" data-uri="chapter06.xhtml#P7000497027000000000000000043D1C" class="calibre18 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">E</var></th>
<th id="P7000497027000000000000000043D1D" data-uri="chapter06.xhtml#P7000497027000000000000000043D1D" class="calibre18 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">S</var></th>
<th id="P7000497027000000000000000043D1E" data-uri="chapter06.xhtml#P7000497027000000000000000043D1E" class="calibre18 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">t</var></th>
<th id="P7000497027000000000000000043D1F" data-uri="chapter06.xhtml#P7000497027000000000000000043D1F" class="calibre18 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">s</var></th>
<th id="P7000497027000000000000000043D20" data-uri="chapter06.xhtml#P7000497027000000000000000043D20" class="calibre18 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">b</var></th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043D21" data-uri="chapter06.xhtml#P7000497027000000000000000043D21" class="calibre20 pcalibre pcalibre1">1.</td>
<td id="P7000497027000000000000000043D22" data-uri="chapter06.xhtml#P7000497027000000000000000043D22" class="calibre20 pcalibre pcalibre1">32</td>
<td id="P7000497027000000000000000043D23" data-uri="chapter06.xhtml#P7000497027000000000000000043D23" class="calibre20 pcalibre pcalibre1">1,024</td>
<td id="P7000497027000000000000000043D24" data-uri="chapter06.xhtml#P7000497027000000000000000043D24" class="calibre20 pcalibre pcalibre1">4</td>
<td id="P7000497027000000000000000043D25" data-uri="chapter06.xhtml#P7000497027000000000000000043D25" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043D26" data-uri="chapter06.xhtml#P7000497027000000000000000043D26" class="calibre20 pcalibre pcalibre1">_____</td>
<td id="P7000497027000000000000000043D27" data-uri="chapter06.xhtml#P7000497027000000000000000043D27" class="calibre20 pcalibre pcalibre1">_____</td>
<td id="P7000497027000000000000000043D28" data-uri="chapter06.xhtml#P7000497027000000000000000043D28" class="calibre20 pcalibre pcalibre1">_____</td>
<td id="P7000497027000000000000000043D29" data-uri="chapter06.xhtml#P7000497027000000000000000043D29" class="calibre20 pcalibre pcalibre1">_____</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043D2A" data-uri="chapter06.xhtml#P7000497027000000000000000043D2A" class="calibre20 pcalibre pcalibre1">2.</td>
<td id="P7000497027000000000000000043D2B" data-uri="chapter06.xhtml#P7000497027000000000000000043D2B" class="calibre20 pcalibre pcalibre1">32</td>
<td id="P7000497027000000000000000043D2C" data-uri="chapter06.xhtml#P7000497027000000000000000043D2C" class="calibre20 pcalibre pcalibre1">1,024</td>
<td id="P7000497027000000000000000043D2D" data-uri="chapter06.xhtml#P7000497027000000000000000043D2D" class="calibre20 pcalibre pcalibre1">8</td>
<td id="P7000497027000000000000000043D2E" data-uri="chapter06.xhtml#P7000497027000000000000000043D2E" class="calibre20 pcalibre pcalibre1">4</td>
<td id="P7000497027000000000000000043D2F" data-uri="chapter06.xhtml#P7000497027000000000000000043D2F" class="calibre20 pcalibre pcalibre1">_____</td>
<td id="P7000497027000000000000000043D30" data-uri="chapter06.xhtml#P7000497027000000000000000043D30" class="calibre20 pcalibre pcalibre1">_____</td>
<td id="P7000497027000000000000000043D31" data-uri="chapter06.xhtml#P7000497027000000000000000043D31" class="calibre20 pcalibre pcalibre1">_____</td>
<td id="P7000497027000000000000000043D32" data-uri="chapter06.xhtml#P7000497027000000000000000043D32" class="calibre20 pcalibre pcalibre1">_____</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043D33" data-uri="chapter06.xhtml#P7000497027000000000000000043D33" class="calibre20 pcalibre pcalibre1">3.</td>
<td id="P7000497027000000000000000043D34" data-uri="chapter06.xhtml#P7000497027000000000000000043D34" class="calibre20 pcalibre pcalibre1">32</td>
<td id="P7000497027000000000000000043D35" data-uri="chapter06.xhtml#P7000497027000000000000000043D35" class="calibre20 pcalibre pcalibre1">1,024</td>
<td id="P7000497027000000000000000043D36" data-uri="chapter06.xhtml#P7000497027000000000000000043D36" class="calibre20 pcalibre pcalibre1">32</td>
<td id="P7000497027000000000000000043D37" data-uri="chapter06.xhtml#P7000497027000000000000000043D37" class="calibre20 pcalibre pcalibre1">32</td>
<td id="P7000497027000000000000000043D38" data-uri="chapter06.xhtml#P7000497027000000000000000043D38" class="calibre20 pcalibre pcalibre1">_____</td>
<td id="P7000497027000000000000000043D39" data-uri="chapter06.xhtml#P7000497027000000000000000043D39" class="calibre20 pcalibre pcalibre1">_____</td>
<td id="P7000497027000000000000000043D3A" data-uri="chapter06.xhtml#P7000497027000000000000000043D3A" class="calibre20 pcalibre pcalibre1">_____</td>
<td id="P7000497027000000000000000043D3B" data-uri="chapter06.xhtml#P7000497027000000000000000043D3B" class="calibre20 pcalibre pcalibre1">_____</td>
</tr>
</tbody>
</table>
</div></li>
</ol></section>
<figure class="pcalibre5 figure pcalibre" id="P70004970270000000000000000055B3" data-uri="chapter06.xhtml#P70004970270000000000000000055B3">
<span class="pcalibre pagebreak pcalibre1" id="P70004970270000000000000000055B4" title="617" data-uri="chapter06.xhtml#P70004970270000000000000000055B4" epub:type="pagebreak"></span>
<table class="pcalibre largetable pcalibre1" id="P7000497027000000000000000043D3C" data-uri="chapter06.xhtml#P7000497027000000000000000043D3C">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P7000497027000000000000000043D3D" data-uri="chapter06.xhtml#P7000497027000000000000000043D3D" class="calibre18 pcalibre pcalibre1">Parameter</th>
<th id="P7000497027000000000000000043D3E" data-uri="chapter06.xhtml#P7000497027000000000000000043D3E" class="calibre18 pcalibre pcalibre1">Description</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td colspan="2" id="P7000497027000000000000000043D3F" data-uri="chapter06.xhtml#P7000497027000000000000000043D3F" class="calibre20 pcalibre pcalibre1">Fundamental parameters</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043D40" data-uri="chapter06.xhtml#P7000497027000000000000000043D40" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">S</var> = 2<sup class="pcalibre1 calibre21 pcalibre">s</sup></td>
<td id="P7000497027000000000000000043D41" data-uri="chapter06.xhtml#P7000497027000000000000000043D41" class="calibre20 pcalibre pcalibre1">Number of sets</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043D42" data-uri="chapter06.xhtml#P7000497027000000000000000043D42" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">E</var></td>
<td id="P7000497027000000000000000043D43" data-uri="chapter06.xhtml#P7000497027000000000000000043D43" class="calibre20 pcalibre pcalibre1">Number of lines per set</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043D44" data-uri="chapter06.xhtml#P7000497027000000000000000043D44" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">B</var> = 2<sup class="pcalibre1 calibre21 pcalibre"><var class="calibre5 pcalibre pcalibre1">b</var></sup></td>
<td id="P7000497027000000000000000043D45" data-uri="chapter06.xhtml#P7000497027000000000000000043D45" class="calibre20 pcalibre pcalibre1">Block size (bytes)</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043D46" data-uri="chapter06.xhtml#P7000497027000000000000000043D46" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">m</var> = log<sub class="calibre59 pcalibre pcalibre1">2</sub>(<var class="calibre5 pcalibre pcalibre1">M</var>)</td>
<td id="P7000497027000000000000000043D47" data-uri="chapter06.xhtml#P7000497027000000000000000043D47" class="calibre20 pcalibre pcalibre1">Number of physical (main memory) address bits</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td colspan="2" id="P7000497027000000000000000043D48" data-uri="chapter06.xhtml#P7000497027000000000000000043D48" class="calibre20 pcalibre pcalibre1">Derived quantities</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043D49" data-uri="chapter06.xhtml#P7000497027000000000000000043D49" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">M</var> = 2<sup class="pcalibre1 calibre21 pcalibre"><var class="calibre5 pcalibre pcalibre1">m</var></sup></td>
<td id="P7000497027000000000000000043D4A" data-uri="chapter06.xhtml#P7000497027000000000000000043D4A" class="calibre20 pcalibre pcalibre1">Maximum number of unique memory addresses</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043D4B" data-uri="chapter06.xhtml#P7000497027000000000000000043D4B" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">s</var> = log<sub class="calibre59 pcalibre pcalibre1">2</sub><i class="calibre5 pcalibre pcalibre1">(S)</i></td>
<td id="P7000497027000000000000000043D4C" data-uri="chapter06.xhtml#P7000497027000000000000000043D4C" class="calibre20 pcalibre pcalibre1">Number of <i class="calibre5 pcalibre pcalibre1">set index bits</i></td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043D4D" data-uri="chapter06.xhtml#P7000497027000000000000000043D4D" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">b</var> = log<sub class="calibre59 pcalibre pcalibre1">2</sub><i class="calibre5 pcalibre pcalibre1">(B)</i></td>
<td id="P7000497027000000000000000043D4E" data-uri="chapter06.xhtml#P7000497027000000000000000043D4E" class="calibre20 pcalibre pcalibre1">Number of <i class="calibre5 pcalibre pcalibre1">block offset bits</i></td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043D4F" data-uri="chapter06.xhtml#P7000497027000000000000000043D4F" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">t</var> = <var class="calibre5 pcalibre pcalibre1">m</var> — (<var class="calibre5 pcalibre pcalibre1">s</var> + <var class="calibre5 pcalibre pcalibre1">b</var>)</td>
<td id="P7000497027000000000000000043D50" data-uri="chapter06.xhtml#P7000497027000000000000000043D50" class="calibre20 pcalibre pcalibre1">Number of <i class="calibre5 pcalibre pcalibre1">tag bits</i></td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043D51" data-uri="chapter06.xhtml#P7000497027000000000000000043D51" class="calibre20 pcalibre pcalibre1"><var class="calibre5 pcalibre pcalibre1">C</var> = <var class="calibre5 pcalibre pcalibre1">B</var> × <var class="calibre5 pcalibre pcalibre1">E</var> × <var class="calibre5 pcalibre pcalibre1">S</var></td>
<td id="P7000497027000000000000000043D52" data-uri="chapter06.xhtml#P7000497027000000000000000043D52" class="calibre20 pcalibre pcalibre1">Cache size (bytes), not including overhead such as the valid and tag bits</td>
</tr>
</tbody>
</table>
<figcaption id="P7000497027000000000000000043D53" data-uri="chapter06.xhtml#P7000497027000000000000000043D53" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P7000497027000000000000000043D54" data-uri="chapter06.xhtml#P7000497027000000000000000043D54" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">6.26 </span>Summary of cache parameters.</h1></header></figcaption>
</figure>
<figure class="pcalibre5 figure pcalibre" id="P70004970270000000000000000055CE" data-uri="chapter06.xhtml#P70004970270000000000000000055CE">
<img alt="A diagram of a direct-mapped cache has sets 0, 1, and S minus 1 with E = 1 line per set, each including valid bit, tag bit, and cache block bit." id="P7000497027000000000000000043D55" data-uri="P700049702700000000000000000B73A" src="../images/p617-1.png" class="calibre210 pcalibre pcalibre1"/>
<figcaption id="P7000497027000000000000000043D56" data-uri="chapter06.xhtml#P7000497027000000000000000043D56" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P7000497027000000000000000043D57" data-uri="chapter06.xhtml#P7000497027000000000000000043D57" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="pcalibre label pcalibre1">6.27 </span>Direct-mapped cache (<var class="calibre5 pcalibre pcalibre1">E</var> = 1).</h1></header>
<div class="caption pcalibre pcalibre1" id="P7000497027000000000000000043D58" data-uri="chapter06.xhtml#P7000497027000000000000000043D58"><p id="P7000497027000000000000000043D59" data-uri="chapter06.xhtml#P7000497027000000000000000043D59" class="pcalibre calibre3 pcalibre1">There is exactly one line per set.</p></div>
</figcaption>
</figure>
</section>
<section id="P70004970270000000000000000055D4" data-uri="chapter06.xhtml#P70004970270000000000000000055D4" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P7000497027000000000000000043D5A" data-uri="chapter06.xhtml#P7000497027000000000000000043D5A" epub:type="title"><span class="pcalibre label pcalibre1">6.4.2 </span>Direct-Mapped Caches</h1></header>
<p id="P7000497027000000000000000043D5B" data-uri="chapter06.xhtml#P7000497027000000000000000043D5B" class="pcalibre1 pcalibre calibre2">Caches are grouped into different classes based on <var class="calibre5 pcalibre pcalibre1">E</var>, the number of cache lines per set. A cache with exactly one line per set (<var class="calibre5 pcalibre pcalibre1">E</var> = 1) is known as a <i class="calibre5 pcalibre pcalibre1">direct-mapped</i> cache (see <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P70004970270000000000000000055CE"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">6.27</span></a>). Direct-mapped caches are the simplest both to implement and to understand, so we will use them to illustrate some general concepts about how caches work.</p>
<p id="P7000497027000000000000000043D5C" data-uri="chapter06.xhtml#P7000497027000000000000000043D5C" class="pcalibre1 pcalibre calibre2">Suppose we have a system with a CPU, a register file, an L1 cache, and a main memory. When the CPU executes an instruction that reads a memory word <var class="calibre5 pcalibre pcalibre1">w</var>, it requests the word from the L1 cache. If the L1 cache has a cached copy of <var class="calibre5 pcalibre pcalibre1">w</var>, then we have an L1 cache hit, and the cache quickly extracts <var class="calibre5 pcalibre pcalibre1">w</var> and returns it to the CPU. Otherwise, we have a cache miss, and the CPU must wait while the L1 cache requests a copy of the block containing <var class="calibre5 pcalibre pcalibre1">w</var> from the main memory. When the requested block finally arrives from memory, the L1 cache stores the block in one of its cache lines, extracts word <var class="calibre5 pcalibre pcalibre1">w</var> from the stored block, and returns it to the CPU. The process that a cache goes through of determining whether a request is a hit or a miss and then extracting the requested word consists of three steps: (1) <i class="calibre5 pcalibre pcalibre1">set selection</i>, (2) <i class="calibre5 pcalibre pcalibre1">line matching</i>, and (3) <i class="calibre5 pcalibre pcalibre1">word extraction.</i></p>
<figure class="pcalibre5 figure pcalibre" id="P70004970270000000000000000055D8" data-uri="chapter06.xhtml#P70004970270000000000000000055D8">
<span class="pcalibre pagebreak pcalibre1" id="P70004970270000000000000000055D9" title="618" data-uri="chapter06.xhtml#P70004970270000000000000000055D9" epub:type="pagebreak"></span>
<img alt="A diagram shows set 1 selected, with address extending from m minus 1 to 0. The tag consists of t bits, set index s bits (0 0 0 0 1), and block offset b bits." id="P7000497027000000000000000043D5D" data-uri="P700049702700000000000000000B73B" src="../images/p618-1.png" class="calibre211 pcalibre pcalibre1"/>
<figcaption id="P7000497027000000000000000043D5E" data-uri="chapter06.xhtml#P7000497027000000000000000043D5E" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P7000497027000000000000000043D5F" data-uri="chapter06.xhtml#P7000497027000000000000000043D5F" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">6.28 </span>Set selection in a direct-mapped cache.</h1></header>
</figcaption></figure>
<figure class="pcalibre5 figure pcalibre" id="P70004970270000000000000000055DD" data-uri="chapter06.xhtml#P70004970270000000000000000055DD">
<img alt="A diagram illustrates line matching and word selection." id="P7000497027000000000000000043D60" data-uri="P700049702700000000000000000B73C" src="../images/p618-2.png" class="calibre212 pcalibre pcalibre1"/>
<figcaption id="P7000497027000000000000000043D61" data-uri="chapter06.xhtml#P7000497027000000000000000043D61" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P7000497027000000000000000043D62" data-uri="chapter06.xhtml#P7000497027000000000000000043D62" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">6.29 </span>Line matching and word selection in a direct-mapped cache.</h1></header>
<div class="edition pcalibre pcalibre1" id="P7000497027000000000000000043D63" data-uri="chapter06.xhtml#P7000497027000000000000000043D63"><p id="P7000497027000000000000000043D64" data-uri="chapter06.xhtml#P7000497027000000000000000043D64" class="pcalibre calibre3 pcalibre1">Within the cache block, <var class="calibre5 pcalibre pcalibre1">w</var><sub class="pcalibre1 calibre47 pcalibre">0</sub> denotes the low-order byte of the word <i class="calibre5 pcalibre pcalibre1">w, w</i><sub class="pcalibre1 calibre47 pcalibre">1</sub> the next byte, and so on.</p></div>
<details class="longdesc pcalibre pcalibre1" id="P7000497027000000000000000024064" data-uri="chapter06.xhtml#P7000497027000000000000000024064">
<summary class="pcalibre6 pcalibre1 pcalibre calibre30"><span class="number pcalibre pcalibre1">Description</span></summary>
<p id="P7000497027000000000000000043D65" data-uri="chapter06.xhtml#P7000497027000000000000000043D65" class="pcalibre1 pcalibre calibre2">A diagram shows selected set (i) with the following numbered steps:</p>
<ol id="P7000497027000000000000000043D66" data-uri="chapter06.xhtml#P7000497027000000000000000043D66" class="pcalibre1 pcalibre calibre45">
<li id="P7000497027000000000000000043D67" data-uri="chapter06.xhtml#P7000497027000000000000000043D67" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043D68" data-uri="chapter06.xhtml#P7000497027000000000000000043D68" class="pcalibre calibre3 pcalibre1">The valid bit must be set. Currently contains 1.</p></li>
<li id="P7000497027000000000000000043D69" data-uri="chapter06.xhtml#P7000497027000000000000000043D69" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043D6A" data-uri="chapter06.xhtml#P7000497027000000000000000043D6A" class="pcalibre calibre3 pcalibre1">The tag bits in the cache line must match the tag bits in the address. The tag bit contains 0110, and the tag in the address contains 0110.</p></li>
<li id="P7000497027000000000000000043D6B" data-uri="chapter06.xhtml#P7000497027000000000000000043D6B" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043D6C" data-uri="chapter06.xhtml#P7000497027000000000000000043D6C" class="pcalibre calibre3 pcalibre1">If (1) and (2), then cache hit, and block offset selects starting byte. The cache block begins with w<sub class="pcalibre1 calibre47 pcalibre">0</sub> in byte 4. The address has 100 in the block offset.</p></li>
</ol>
</details>
</figcaption>
</figure>
<section id="P70004970270000000000000000055E3" data-uri="chapter06.xhtml#P70004970270000000000000000055E3" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title5 pcalibre pcalibre1" id="P7000497027000000000000000043D6D" data-uri="chapter06.xhtml#P7000497027000000000000000043D6D" epub:type="title">Set Selection in Direct-Mapped Caches</h1></header>
<p id="P7000497027000000000000000043D6E" data-uri="chapter06.xhtml#P7000497027000000000000000043D6E" class="pcalibre1 pcalibre calibre2">In this step, the cache extracts the <var class="calibre5 pcalibre pcalibre1">s</var> set index bits from the middle of the address for <i class="calibre5 pcalibre pcalibre1">w.</i> These bits are interpreted as an unsigned integer that corresponds to a set number. In other words, if we think of the cache as a one-dimensional array of sets, then the set index bits form an index into this array. <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P70004970270000000000000000055D8"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">6.28</span></a> shows how set selection works for a direct-mapped cache. In this example, the set index bits 00001<sub class="pcalibre1 calibre47 pcalibre">2</sub> are interpreted as an integer index that selects set 1.</p>
</section>
<section id="P70004970270000000000000000055E6" data-uri="chapter06.xhtml#P70004970270000000000000000055E6" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title5 pcalibre pcalibre1" id="P7000497027000000000000000043D6F" data-uri="chapter06.xhtml#P7000497027000000000000000043D6F" epub:type="title">Line Matching in Direct-Mapped Caches</h1></header>
<p id="P7000497027000000000000000043D70" data-uri="chapter06.xhtml#P7000497027000000000000000043D70" class="pcalibre1 pcalibre calibre2">Now that we have selected some set <var class="calibre5 pcalibre pcalibre1">i</var> in the previous step, the next step is to determine if a copy of the word <var class="calibre5 pcalibre pcalibre1">w</var> is stored in one of the cache lines contained in set <i class="calibre5 pcalibre pcalibre1">i.</i> In a direct-mapped cache, this is easy and fast because there is exactly one line per set. A copy of <var class="calibre5 pcalibre pcalibre1">w</var> is contained in the line if and only if the valid bit is set and the tag in the cache line matches the tag in the address of <i class="calibre5 pcalibre pcalibre1">w.</i></p>
<p id="P7000497027000000000000000043D71" data-uri="chapter06.xhtml#P7000497027000000000000000043D71" class="pcalibre1 pcalibre calibre2"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P70004970270000000000000000055DD"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">6.29</span></a> shows how line matching works in a direct-mapped cache. In this example, there is exactly one cache line in the selected set. The valid bit for this line is set, so we know that the bits in the tag and block are meaningful. Since the tag bits in the cache line match the tag bits in the address, we know that a copy of the word we want is indeed stored in the line. In other words, we have a cache hit. On the other hand, if either the valid bit were not set or the tags did not match, then we would have had a cache miss.</p>
</section>
<section id="P70004970270000000000000000055EA" data-uri="chapter06.xhtml#P70004970270000000000000000055EA" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title5 pcalibre pcalibre1" id="P7000497027000000000000000043D72" data-uri="chapter06.xhtml#P7000497027000000000000000043D72" epub:type="title"><span class="pcalibre pagebreak pcalibre1" id="P70004970270000000000000000055EC" title="619" data-uri="chapter06.xhtml#P70004970270000000000000000055EC" epub:type="pagebreak"></span>Word Selection in Direct-Mapped Caches</h1></header>
<p id="P7000497027000000000000000043D73" data-uri="chapter06.xhtml#P7000497027000000000000000043D73" class="pcalibre1 pcalibre calibre2">Once we have a hit, we know that <var class="calibre5 pcalibre pcalibre1">w</var> is somewhere in the block. This last step determines where the desired word starts in the block. As shown in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P70004970270000000000000000055DD"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">6.29</span></a>, the block offset bits provide us with the offset of the first byte in the desired word. Similar to our view of a cache as an array of lines, we can think of a block as an array of bytes, and the byte offset as an index into that array. In the example, the block offset bits of 100<sub class="pcalibre1 calibre47 pcalibre">2</sub> indicate that the copy of <var class="calibre5 pcalibre pcalibre1">w</var> starts at byte 4 in the block. (We are assuming that words are 4 bytes long.)</p>
</section>
<section id="P70004970270000000000000000055EE" data-uri="chapter06.xhtml#P70004970270000000000000000055EE" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title5 pcalibre pcalibre1" id="P7000497027000000000000000043D74" data-uri="chapter06.xhtml#P7000497027000000000000000043D74" epub:type="title">Line Replacement on Misses in Direct-Mapped Caches</h1></header>
<p id="P7000497027000000000000000043D75" data-uri="chapter06.xhtml#P7000497027000000000000000043D75" class="pcalibre1 pcalibre calibre2">If the cache misses, then it needs to retrieve the requested block from the next level in the memory hierarchy and store the new block in one of the cache lines of the set indicated by the set index bits. In general, if the set is full of valid cache lines, then one of the existing lines must be evicted. For a direct-mapped cache, where each set contains exactly one line, the replacement policy is trivial: the current line is replaced by the newly fetched line.</p>
</section>
<section id="P70004970270000000000000000055F1" data-uri="chapter06.xhtml#P70004970270000000000000000055F1" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title5 pcalibre pcalibre1" id="P7000497027000000000000000043D76" data-uri="chapter06.xhtml#P7000497027000000000000000043D76" epub:type="title">Putting It Together: A Direct-Mapped Cache in Action</h1></header>
<p id="P7000497027000000000000000043D77" data-uri="chapter06.xhtml#P7000497027000000000000000043D77" class="pcalibre1 pcalibre calibre2">The mechanisms that a cache uses to select sets and identify lines are extremely simple. They have to be, because the hardware must perform them in a few nanoseconds. However, manipulating bits in this way can be confusing to us humans. A concrete example will help clarify the process. Suppose we have a direct-mapped cache described by</p>
<div class="informalequation pcalibre pcalibre1" id="P7000497027000000000000000043D78" data-uri="chapter06.xhtml#P7000497027000000000000000043D78">
<m:math display="block" alttext="" data-uri="" altimg-width="161" altimg-height="14" altimg="../images/ch06-08.png"><m:mrow><m:mrow><m:mo>(</m:mo><m:mrow><m:mi>S</m:mi><m:mo>,</m:mo><m:mtext> </m:mtext><m:mi>E</m:mi><m:mo>,</m:mo><m:mtext> </m:mtext><m:mi>B</m:mi><m:mo>,</m:mo><m:mtext> </m:mtext><m:mi>m</m:mi></m:mrow><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mrow><m:mo>(</m:mo><m:mrow><m:mn>4</m:mn><m:mo>,</m:mo><m:mtext> </m:mtext><m:mn>1</m:mn><m:mo>,</m:mo><m:mtext> </m:mtext><m:mn>2</m:mn><m:mo>,</m:mo><m:mtext> </m:mtext><m:mn>4</m:mn></m:mrow><m:mo>)</m:mo></m:mrow></m:mrow></m:math>
</div>
<p class="pcalibre1 pcalibre calibre2" id="P7000497027000000000000000043D79" data-uri="chapter06.xhtml#P7000497027000000000000000043D79">In other words, the cache has four sets, one line per set, 2 bytes per block, and 4-bit addresses. We will also assume that each word is a single byte. Of course, these assumptions are totally unrealistic, but they will help us keep the example simple.</p>
<p id="P7000497027000000000000000043D7A" data-uri="chapter06.xhtml#P7000497027000000000000000043D7A" class="pcalibre1 pcalibre calibre2">When you are first learning about caches, it can be very instructive to enumerate the entire address space and partition the bits, as we've done in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P70004970270000000000000000055FE"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">6.30</span></a> for our 4-bit example. There are some interesting things to notice about this enumerated space:</p>
<ul id="P7000497027000000000000000043D7B" data-uri="chapter06.xhtml#P7000497027000000000000000043D7B" class="calibre28 pcalibre pcalibre1">
<li id="P7000497027000000000000000043D7C" data-uri="chapter06.xhtml#P7000497027000000000000000043D7C" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043D7D" data-uri="chapter06.xhtml#P7000497027000000000000000043D7D" class="pcalibre calibre3 pcalibre1">The concatenation of the tag and index bits uniquely identifies each block in memory. For example, block 0 consists of addresses 0 and 1, block 1 consists of addresses 2 and 3, block 2 consists of addresses 4 and 5, and so on.</p></li>
<li id="P7000497027000000000000000043D7E" data-uri="chapter06.xhtml#P7000497027000000000000000043D7E" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043D7F" data-uri="chapter06.xhtml#P7000497027000000000000000043D7F" class="pcalibre calibre3 pcalibre1">Since there are eight memory blocks but only four cache sets, multiple blocks map to the same cache set (i.e., they have the same set index). For example, blocks 0 and 4 both map to set 0, blocks 1 and 5 both map to set 1, and so on.</p></li>
<li id="P7000497027000000000000000043D80" data-uri="chapter06.xhtml#P7000497027000000000000000043D80" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043D81" data-uri="chapter06.xhtml#P7000497027000000000000000043D81" class="pcalibre calibre3 pcalibre1">Blocks that map to the same cache set are uniquely identified by the tag. For example, block 0 has a tag bit of 0 while block 4 has a tag bit of 1, block 1 has a tag bit of 0 while block 5 has a tag bit of 1, and so on.</p></li>
</ul>
<figure class="pcalibre5 figure pcalibre" id="P70004970270000000000000000055FE" data-uri="chapter06.xhtml#P70004970270000000000000000055FE">
<span class="pcalibre pagebreak pcalibre1" id="P70004970270000000000000000055FF" title="620" data-uri="chapter06.xhtml#P70004970270000000000000000055FF" epub:type="pagebreak"></span>
<table class="pcalibre largetable pcalibre1" id="P7000497027000000000000000043D82" data-uri="chapter06.xhtml#P7000497027000000000000000043D82">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P7000497027000000000000000043D83" data-uri="chapter06.xhtml#P7000497027000000000000000043D83" class="calibre18 pcalibre pcalibre1"/>
<th colspan="3" id="P7000497027000000000000000043D84" data-uri="chapter06.xhtml#P7000497027000000000000000043D84" class="calibre18 pcalibre pcalibre1">Address bits</th>
<th id="P7000497027000000000000000043D85" data-uri="chapter06.xhtml#P7000497027000000000000000043D85" class="calibre18 pcalibre pcalibre1"/>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<th id="P7000497027000000000000000043D86" data-uri="chapter06.xhtml#P7000497027000000000000000043D86" class="calibre18 pcalibre pcalibre1">Address (decimal)</th>
<th id="P7000497027000000000000000043D87" data-uri="chapter06.xhtml#P7000497027000000000000000043D87" class="calibre18 pcalibre pcalibre1">Tag bits (<var class="calibre5 pcalibre pcalibre1">t</var> = 1)</th>
<th id="P7000497027000000000000000043D88" data-uri="chapter06.xhtml#P7000497027000000000000000043D88" class="calibre18 pcalibre pcalibre1">Index bits (<var class="calibre5 pcalibre pcalibre1">s</var> = 2)</th>
<th id="P7000497027000000000000000043D89" data-uri="chapter06.xhtml#P7000497027000000000000000043D89" class="calibre18 pcalibre pcalibre1">Offset bits (<var class="calibre5 pcalibre pcalibre1">b</var> = 1)</th>
<th id="P7000497027000000000000000043D8A" data-uri="chapter06.xhtml#P7000497027000000000000000043D8A" class="calibre18 pcalibre pcalibre1">Block number (decimal)</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043D8B" data-uri="chapter06.xhtml#P7000497027000000000000000043D8B" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043D8C" data-uri="chapter06.xhtml#P7000497027000000000000000043D8C" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043D8D" data-uri="chapter06.xhtml#P7000497027000000000000000043D8D" class="calibre20 pcalibre pcalibre1">00</td>
<td id="P7000497027000000000000000043D8E" data-uri="chapter06.xhtml#P7000497027000000000000000043D8E" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043D8F" data-uri="chapter06.xhtml#P7000497027000000000000000043D8F" class="calibre20 pcalibre pcalibre1">0</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043D90" data-uri="chapter06.xhtml#P7000497027000000000000000043D90" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043D91" data-uri="chapter06.xhtml#P7000497027000000000000000043D91" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043D92" data-uri="chapter06.xhtml#P7000497027000000000000000043D92" class="calibre20 pcalibre pcalibre1">00</td>
<td id="P7000497027000000000000000043D93" data-uri="chapter06.xhtml#P7000497027000000000000000043D93" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043D94" data-uri="chapter06.xhtml#P7000497027000000000000000043D94" class="calibre20 pcalibre pcalibre1">0</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043D95" data-uri="chapter06.xhtml#P7000497027000000000000000043D95" class="calibre20 pcalibre pcalibre1">2</td>
<td id="P7000497027000000000000000043D96" data-uri="chapter06.xhtml#P7000497027000000000000000043D96" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043D97" data-uri="chapter06.xhtml#P7000497027000000000000000043D97" class="calibre20 pcalibre pcalibre1">01</td>
<td id="P7000497027000000000000000043D98" data-uri="chapter06.xhtml#P7000497027000000000000000043D98" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043D99" data-uri="chapter06.xhtml#P7000497027000000000000000043D99" class="calibre20 pcalibre pcalibre1">1</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043D9A" data-uri="chapter06.xhtml#P7000497027000000000000000043D9A" class="calibre20 pcalibre pcalibre1">3</td>
<td id="P7000497027000000000000000043D9B" data-uri="chapter06.xhtml#P7000497027000000000000000043D9B" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043D9C" data-uri="chapter06.xhtml#P7000497027000000000000000043D9C" class="calibre20 pcalibre pcalibre1">01</td>
<td id="P7000497027000000000000000043D9D" data-uri="chapter06.xhtml#P7000497027000000000000000043D9D" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043D9E" data-uri="chapter06.xhtml#P7000497027000000000000000043D9E" class="calibre20 pcalibre pcalibre1">1</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043D9F" data-uri="chapter06.xhtml#P7000497027000000000000000043D9F" class="calibre20 pcalibre pcalibre1">4</td>
<td id="P7000497027000000000000000043DA0" data-uri="chapter06.xhtml#P7000497027000000000000000043DA0" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043DA1" data-uri="chapter06.xhtml#P7000497027000000000000000043DA1" class="calibre20 pcalibre pcalibre1">10</td>
<td id="P7000497027000000000000000043DA2" data-uri="chapter06.xhtml#P7000497027000000000000000043DA2" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043DA3" data-uri="chapter06.xhtml#P7000497027000000000000000043DA3" class="calibre20 pcalibre pcalibre1">2</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043DA4" data-uri="chapter06.xhtml#P7000497027000000000000000043DA4" class="calibre20 pcalibre pcalibre1">5</td>
<td id="P7000497027000000000000000043DA5" data-uri="chapter06.xhtml#P7000497027000000000000000043DA5" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043DA6" data-uri="chapter06.xhtml#P7000497027000000000000000043DA6" class="calibre20 pcalibre pcalibre1">10</td>
<td id="P7000497027000000000000000043DA7" data-uri="chapter06.xhtml#P7000497027000000000000000043DA7" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043DA8" data-uri="chapter06.xhtml#P7000497027000000000000000043DA8" class="calibre20 pcalibre pcalibre1">2</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043DA9" data-uri="chapter06.xhtml#P7000497027000000000000000043DA9" class="calibre20 pcalibre pcalibre1">6</td>
<td id="P7000497027000000000000000043DAA" data-uri="chapter06.xhtml#P7000497027000000000000000043DAA" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043DAB" data-uri="chapter06.xhtml#P7000497027000000000000000043DAB" class="calibre20 pcalibre pcalibre1">11</td>
<td id="P7000497027000000000000000043DAC" data-uri="chapter06.xhtml#P7000497027000000000000000043DAC" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043DAD" data-uri="chapter06.xhtml#P7000497027000000000000000043DAD" class="calibre20 pcalibre pcalibre1">3</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043DAE" data-uri="chapter06.xhtml#P7000497027000000000000000043DAE" class="calibre20 pcalibre pcalibre1">7</td>
<td id="P7000497027000000000000000043DAF" data-uri="chapter06.xhtml#P7000497027000000000000000043DAF" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043DB0" data-uri="chapter06.xhtml#P7000497027000000000000000043DB0" class="calibre20 pcalibre pcalibre1">11</td>
<td id="P7000497027000000000000000043DB1" data-uri="chapter06.xhtml#P7000497027000000000000000043DB1" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043DB2" data-uri="chapter06.xhtml#P7000497027000000000000000043DB2" class="calibre20 pcalibre pcalibre1">3</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043DB3" data-uri="chapter06.xhtml#P7000497027000000000000000043DB3" class="calibre20 pcalibre pcalibre1">8</td>
<td id="P7000497027000000000000000043DB4" data-uri="chapter06.xhtml#P7000497027000000000000000043DB4" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043DB5" data-uri="chapter06.xhtml#P7000497027000000000000000043DB5" class="calibre20 pcalibre pcalibre1">00</td>
<td id="P7000497027000000000000000043DB6" data-uri="chapter06.xhtml#P7000497027000000000000000043DB6" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043DB7" data-uri="chapter06.xhtml#P7000497027000000000000000043DB7" class="calibre20 pcalibre pcalibre1">4</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043DB8" data-uri="chapter06.xhtml#P7000497027000000000000000043DB8" class="calibre20 pcalibre pcalibre1">9</td>
<td id="P7000497027000000000000000043DB9" data-uri="chapter06.xhtml#P7000497027000000000000000043DB9" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043DBA" data-uri="chapter06.xhtml#P7000497027000000000000000043DBA" class="calibre20 pcalibre pcalibre1">00</td>
<td id="P7000497027000000000000000043DBB" data-uri="chapter06.xhtml#P7000497027000000000000000043DBB" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043DBC" data-uri="chapter06.xhtml#P7000497027000000000000000043DBC" class="calibre20 pcalibre pcalibre1">4</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043DBD" data-uri="chapter06.xhtml#P7000497027000000000000000043DBD" class="calibre20 pcalibre pcalibre1">10</td>
<td id="P7000497027000000000000000043DBE" data-uri="chapter06.xhtml#P7000497027000000000000000043DBE" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043DBF" data-uri="chapter06.xhtml#P7000497027000000000000000043DBF" class="calibre20 pcalibre pcalibre1">01</td>
<td id="P7000497027000000000000000043DC0" data-uri="chapter06.xhtml#P7000497027000000000000000043DC0" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043DC1" data-uri="chapter06.xhtml#P7000497027000000000000000043DC1" class="calibre20 pcalibre pcalibre1">5</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043DC2" data-uri="chapter06.xhtml#P7000497027000000000000000043DC2" class="calibre20 pcalibre pcalibre1">11</td>
<td id="P7000497027000000000000000043DC3" data-uri="chapter06.xhtml#P7000497027000000000000000043DC3" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043DC4" data-uri="chapter06.xhtml#P7000497027000000000000000043DC4" class="calibre20 pcalibre pcalibre1">01</td>
<td id="P7000497027000000000000000043DC5" data-uri="chapter06.xhtml#P7000497027000000000000000043DC5" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043DC6" data-uri="chapter06.xhtml#P7000497027000000000000000043DC6" class="calibre20 pcalibre pcalibre1">5</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043DC7" data-uri="chapter06.xhtml#P7000497027000000000000000043DC7" class="calibre20 pcalibre pcalibre1">12</td>
<td id="P7000497027000000000000000043DC8" data-uri="chapter06.xhtml#P7000497027000000000000000043DC8" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043DC9" data-uri="chapter06.xhtml#P7000497027000000000000000043DC9" class="calibre20 pcalibre pcalibre1">10</td>
<td id="P7000497027000000000000000043DCA" data-uri="chapter06.xhtml#P7000497027000000000000000043DCA" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043DCB" data-uri="chapter06.xhtml#P7000497027000000000000000043DCB" class="calibre20 pcalibre pcalibre1">6</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043DCC" data-uri="chapter06.xhtml#P7000497027000000000000000043DCC" class="calibre20 pcalibre pcalibre1">13</td>
<td id="P7000497027000000000000000043DCD" data-uri="chapter06.xhtml#P7000497027000000000000000043DCD" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043DCE" data-uri="chapter06.xhtml#P7000497027000000000000000043DCE" class="calibre20 pcalibre pcalibre1">10</td>
<td id="P7000497027000000000000000043DCF" data-uri="chapter06.xhtml#P7000497027000000000000000043DCF" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043DD0" data-uri="chapter06.xhtml#P7000497027000000000000000043DD0" class="calibre20 pcalibre pcalibre1">6</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043DD1" data-uri="chapter06.xhtml#P7000497027000000000000000043DD1" class="calibre20 pcalibre pcalibre1">14</td>
<td id="P7000497027000000000000000043DD2" data-uri="chapter06.xhtml#P7000497027000000000000000043DD2" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043DD3" data-uri="chapter06.xhtml#P7000497027000000000000000043DD3" class="calibre20 pcalibre pcalibre1">11</td>
<td id="P7000497027000000000000000043DD4" data-uri="chapter06.xhtml#P7000497027000000000000000043DD4" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043DD5" data-uri="chapter06.xhtml#P7000497027000000000000000043DD5" class="calibre20 pcalibre pcalibre1">7</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043DD6" data-uri="chapter06.xhtml#P7000497027000000000000000043DD6" class="calibre20 pcalibre pcalibre1">15</td>
<td id="P7000497027000000000000000043DD7" data-uri="chapter06.xhtml#P7000497027000000000000000043DD7" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043DD8" data-uri="chapter06.xhtml#P7000497027000000000000000043DD8" class="calibre20 pcalibre pcalibre1">11</td>
<td id="P7000497027000000000000000043DD9" data-uri="chapter06.xhtml#P7000497027000000000000000043DD9" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043DDA" data-uri="chapter06.xhtml#P7000497027000000000000000043DDA" class="calibre20 pcalibre pcalibre1">7</td>
</tr>
</tbody>
</table>
<figcaption id="P7000497027000000000000000043DDB" data-uri="chapter06.xhtml#P7000497027000000000000000043DDB" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P7000497027000000000000000043DDC" data-uri="chapter06.xhtml#P7000497027000000000000000043DDC" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">6.30 </span>4-bit address space for example direct-mapped cache.</h1></header></figcaption>
</figure>
<p id="P7000497027000000000000000043DDD" data-uri="chapter06.xhtml#P7000497027000000000000000043DDD" class="pcalibre1 pcalibre calibre2">Let us simulate the cache in action as the CPU performs a sequence of reads. Remember that for this example we are assuming that the CPU reads 1-byte words. While this kind of manual simulation is tedious and you may be tempted to skip it, in our experience students do not really understand how caches work until they work their way through a few of them.</p>
<p id="P7000497027000000000000000043DDE" data-uri="chapter06.xhtml#P7000497027000000000000000043DDE" class="pcalibre1 pcalibre calibre2">Initially, the cache is empty (i.e., each valid bit is 0):</p>
<table id="P7000497027000000000000000043DDF" data-uri="chapter06.xhtml#P7000497027000000000000000043DDF" class="pcalibre largetable pcalibre1">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P7000497027000000000000000043DE0" data-uri="chapter06.xhtml#P7000497027000000000000000043DE0" class="calibre18 pcalibre pcalibre1">Set</th>
<th id="P7000497027000000000000000043DE1" data-uri="chapter06.xhtml#P7000497027000000000000000043DE1" class="calibre18 pcalibre pcalibre1">Valid</th>
<th id="P7000497027000000000000000043DE2" data-uri="chapter06.xhtml#P7000497027000000000000000043DE2" class="calibre18 pcalibre pcalibre1">Tag</th>
<th id="P7000497027000000000000000043DE3" data-uri="chapter06.xhtml#P7000497027000000000000000043DE3" class="calibre18 pcalibre pcalibre1">block[0]</th>
<th id="P7000497027000000000000000043DE4" data-uri="chapter06.xhtml#P7000497027000000000000000043DE4" class="calibre18 pcalibre pcalibre1">block[1]</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043DE5" data-uri="chapter06.xhtml#P7000497027000000000000000043DE5" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043DE6" data-uri="chapter06.xhtml#P7000497027000000000000000043DE6" class="calibre20 pcalibre pcalibre1">0</td>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043DE7" data-uri="chapter06.xhtml#P7000497027000000000000000043DE7" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043DE8" data-uri="chapter06.xhtml#P7000497027000000000000000043DE8" class="calibre20 pcalibre pcalibre1">0</td>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043DE9" data-uri="chapter06.xhtml#P7000497027000000000000000043DE9" class="calibre20 pcalibre pcalibre1">2</td>
<td id="P7000497027000000000000000043DEA" data-uri="chapter06.xhtml#P7000497027000000000000000043DEA" class="calibre20 pcalibre pcalibre1">0</td>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043DEB" data-uri="chapter06.xhtml#P7000497027000000000000000043DEB" class="calibre20 pcalibre pcalibre1">3</td>
<td id="P7000497027000000000000000043DEC" data-uri="chapter06.xhtml#P7000497027000000000000000043DEC" class="calibre20 pcalibre pcalibre1">0</td>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
</tr>
</tbody>
</table>
<p class="pcalibre1 pcalibre calibre2" id="P7000497027000000000000000043DED" data-uri="chapter06.xhtml#P7000497027000000000000000043DED">Each row in the table represents a cache line. The first column indicates the set that the line belongs to, but keep in mind that this is provided for convenience and is not really part of the cache. The next four columns represent the actual bits in each cache line. Now, let's see what happens when the CPU performs a sequence of reads:</p>
<ol id="P7000497027000000000000000043DEE" data-uri="chapter06.xhtml#P7000497027000000000000000043DEE" class="calibre72 pcalibre pcalibre1">
<li id="P7000497027000000000000000043DEF" data-uri="chapter06.xhtml#P7000497027000000000000000043DEF" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043DF0" data-uri="chapter06.xhtml#P7000497027000000000000000043DF0" class="pcalibre calibre3 pcalibre1"><span class="pcalibre leadin pcalibre1">Read word at address 0. </span>Since the valid bit for set 0 is 0, this is a cache miss. The cache fetches block 0 from memory (or a lower-level cache) and stores the <span class="pcalibre pagebreak pcalibre1" id="P700049702700000000000000000566F" title="621" data-uri="chapter06.xhtml#P700049702700000000000000000566F" epub:type="pagebreak"></span>block in set 0. Then the cache returns m[0] (the contents of memory location 0) from block[0] of the newly fetched cache line.</p>
<table id="P7000497027000000000000000043DF1" data-uri="chapter06.xhtml#P7000497027000000000000000043DF1" class="pcalibre largetable pcalibre1">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P7000497027000000000000000043DF2" data-uri="chapter06.xhtml#P7000497027000000000000000043DF2" class="calibre18 pcalibre pcalibre1">Set</th>
<th id="P7000497027000000000000000043DF3" data-uri="chapter06.xhtml#P7000497027000000000000000043DF3" class="calibre18 pcalibre pcalibre1">Valid</th>
<th id="P7000497027000000000000000043DF4" data-uri="chapter06.xhtml#P7000497027000000000000000043DF4" class="calibre18 pcalibre pcalibre1">Tag</th>
<th id="P7000497027000000000000000043DF5" data-uri="chapter06.xhtml#P7000497027000000000000000043DF5" class="calibre18 pcalibre pcalibre1">block[0]</th>
<th id="P7000497027000000000000000043DF6" data-uri="chapter06.xhtml#P7000497027000000000000000043DF6" class="calibre18 pcalibre pcalibre1">block[1]</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043DF7" data-uri="chapter06.xhtml#P7000497027000000000000000043DF7" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043DF8" data-uri="chapter06.xhtml#P7000497027000000000000000043DF8" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043DF9" data-uri="chapter06.xhtml#P7000497027000000000000000043DF9" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043DFA" data-uri="chapter06.xhtml#P7000497027000000000000000043DFA" class="calibre20 pcalibre pcalibre1">m[0]</td>
<td id="P7000497027000000000000000043DFB" data-uri="chapter06.xhtml#P7000497027000000000000000043DFB" class="calibre20 pcalibre pcalibre1">m[1]</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043DFC" data-uri="chapter06.xhtml#P7000497027000000000000000043DFC" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043DFD" data-uri="chapter06.xhtml#P7000497027000000000000000043DFD" class="calibre20 pcalibre pcalibre1">0</td>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043DFE" data-uri="chapter06.xhtml#P7000497027000000000000000043DFE" class="calibre20 pcalibre pcalibre1">2</td>
<td id="P7000497027000000000000000043DFF" data-uri="chapter06.xhtml#P7000497027000000000000000043DFF" class="calibre20 pcalibre pcalibre1">0</td>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E00" data-uri="chapter06.xhtml#P7000497027000000000000000043E00" class="calibre20 pcalibre pcalibre1">3</td>
<td id="P7000497027000000000000000043E01" data-uri="chapter06.xhtml#P7000497027000000000000000043E01" class="calibre20 pcalibre pcalibre1">0</td>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
</tr>
</tbody>
</table>
</li>
<li id="P7000497027000000000000000043E02" data-uri="chapter06.xhtml#P7000497027000000000000000043E02" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043E03" data-uri="chapter06.xhtml#P7000497027000000000000000043E03" class="pcalibre calibre3 pcalibre1"><span class="pcalibre leadin pcalibre1">Read word at address 1. </span>This is a cache hit. The cache immediately returns m[1] from block[1] of the cache line. The state of the cache does not change.</p></li>
<li id="P7000497027000000000000000043E04" data-uri="chapter06.xhtml#P7000497027000000000000000043E04" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043E05" data-uri="chapter06.xhtml#P7000497027000000000000000043E05" class="pcalibre calibre3 pcalibre1"><span class="pcalibre leadin pcalibre1">Read word at address 13. </span>Since the cache line in set 2 is not valid, this is a cache miss. The cache loads block 6 into set 2 and returns m[13] from block[1] of the new cache line.</p>
<table id="P7000497027000000000000000043E06" data-uri="chapter06.xhtml#P7000497027000000000000000043E06" class="pcalibre largetable pcalibre1">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P7000497027000000000000000043E07" data-uri="chapter06.xhtml#P7000497027000000000000000043E07" class="calibre18 pcalibre pcalibre1">Set</th>
<th id="P7000497027000000000000000043E08" data-uri="chapter06.xhtml#P7000497027000000000000000043E08" class="calibre18 pcalibre pcalibre1">Valid</th>
<th id="P7000497027000000000000000043E09" data-uri="chapter06.xhtml#P7000497027000000000000000043E09" class="calibre18 pcalibre pcalibre1">Tag</th>
<th id="P7000497027000000000000000043E0A" data-uri="chapter06.xhtml#P7000497027000000000000000043E0A" class="calibre18 pcalibre pcalibre1">block[0]</th>
<th id="P7000497027000000000000000043E0B" data-uri="chapter06.xhtml#P7000497027000000000000000043E0B" class="calibre18 pcalibre pcalibre1">block[1]</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E0C" data-uri="chapter06.xhtml#P7000497027000000000000000043E0C" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043E0D" data-uri="chapter06.xhtml#P7000497027000000000000000043E0D" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043E0E" data-uri="chapter06.xhtml#P7000497027000000000000000043E0E" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043E0F" data-uri="chapter06.xhtml#P7000497027000000000000000043E0F" class="calibre20 pcalibre pcalibre1">m[0]</td>
<td id="P7000497027000000000000000043E10" data-uri="chapter06.xhtml#P7000497027000000000000000043E10" class="calibre20 pcalibre pcalibre1">m[1]</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E11" data-uri="chapter06.xhtml#P7000497027000000000000000043E11" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043E12" data-uri="chapter06.xhtml#P7000497027000000000000000043E12" class="calibre20 pcalibre pcalibre1">0</td>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E13" data-uri="chapter06.xhtml#P7000497027000000000000000043E13" class="calibre20 pcalibre pcalibre1">2</td>
<td id="P7000497027000000000000000043E14" data-uri="chapter06.xhtml#P7000497027000000000000000043E14" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043E15" data-uri="chapter06.xhtml#P7000497027000000000000000043E15" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043E16" data-uri="chapter06.xhtml#P7000497027000000000000000043E16" class="calibre20 pcalibre pcalibre1">m[12]</td>
<td id="P7000497027000000000000000043E17" data-uri="chapter06.xhtml#P7000497027000000000000000043E17" class="calibre20 pcalibre pcalibre1">m[13]</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E18" data-uri="chapter06.xhtml#P7000497027000000000000000043E18" class="calibre20 pcalibre pcalibre1">3</td>
<td id="P7000497027000000000000000043E19" data-uri="chapter06.xhtml#P7000497027000000000000000043E19" class="calibre20 pcalibre pcalibre1">0</td>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
</tr>
</tbody>
</table>
</li>
<li id="P7000497027000000000000000043E1A" data-uri="chapter06.xhtml#P7000497027000000000000000043E1A" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043E1B" data-uri="chapter06.xhtml#P7000497027000000000000000043E1B" class="pcalibre calibre3 pcalibre1"><span class="pcalibre leadin pcalibre1">Read word at address 8. </span>This is a miss. The cache line in set 0 is indeed valid, but the tags do not match. The cache loads block 4 into set 0 (replacing the line that was there from the read of address 0) and returns m[8] from block[0] of the new cache line.</p>
<table id="P7000497027000000000000000043E1C" data-uri="chapter06.xhtml#P7000497027000000000000000043E1C" class="pcalibre largetable pcalibre1">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P7000497027000000000000000043E1D" data-uri="chapter06.xhtml#P7000497027000000000000000043E1D" class="calibre18 pcalibre pcalibre1">Set</th>
<th id="P7000497027000000000000000043E1E" data-uri="chapter06.xhtml#P7000497027000000000000000043E1E" class="calibre18 pcalibre pcalibre1">Valid</th>
<th id="P7000497027000000000000000043E1F" data-uri="chapter06.xhtml#P7000497027000000000000000043E1F" class="calibre18 pcalibre pcalibre1">Tag</th>
<th id="P7000497027000000000000000043E20" data-uri="chapter06.xhtml#P7000497027000000000000000043E20" class="calibre18 pcalibre pcalibre1">block[0]</th>
<th id="P7000497027000000000000000043E21" data-uri="chapter06.xhtml#P7000497027000000000000000043E21" class="calibre18 pcalibre pcalibre1">block[1]</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E22" data-uri="chapter06.xhtml#P7000497027000000000000000043E22" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043E23" data-uri="chapter06.xhtml#P7000497027000000000000000043E23" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043E24" data-uri="chapter06.xhtml#P7000497027000000000000000043E24" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043E25" data-uri="chapter06.xhtml#P7000497027000000000000000043E25" class="calibre20 pcalibre pcalibre1">m[8]</td>
<td id="P7000497027000000000000000043E26" data-uri="chapter06.xhtml#P7000497027000000000000000043E26" class="calibre20 pcalibre pcalibre1">m[9]</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E27" data-uri="chapter06.xhtml#P7000497027000000000000000043E27" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043E28" data-uri="chapter06.xhtml#P7000497027000000000000000043E28" class="calibre20 pcalibre pcalibre1">0</td>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E29" data-uri="chapter06.xhtml#P7000497027000000000000000043E29" class="calibre20 pcalibre pcalibre1">2</td>
<td id="P7000497027000000000000000043E2A" data-uri="chapter06.xhtml#P7000497027000000000000000043E2A" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043E2B" data-uri="chapter06.xhtml#P7000497027000000000000000043E2B" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043E2C" data-uri="chapter06.xhtml#P7000497027000000000000000043E2C" class="calibre20 pcalibre pcalibre1">m[12]</td>
<td id="P7000497027000000000000000043E2D" data-uri="chapter06.xhtml#P7000497027000000000000000043E2D" class="calibre20 pcalibre pcalibre1">m[13]</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E2E" data-uri="chapter06.xhtml#P7000497027000000000000000043E2E" class="calibre20 pcalibre pcalibre1">3</td>
<td id="P7000497027000000000000000043E2F" data-uri="chapter06.xhtml#P7000497027000000000000000043E2F" class="calibre20 pcalibre pcalibre1">0</td>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
</tr>
</tbody>
</table></li>
<li id="P7000497027000000000000000043E30" data-uri="chapter06.xhtml#P7000497027000000000000000043E30" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043E31" data-uri="chapter06.xhtml#P7000497027000000000000000043E31" class="pcalibre calibre3 pcalibre1"><span class="pcalibre leadin pcalibre1">Read word at address 0. </span>This is another miss, due to the unfortunate fact that we just replaced block 0 during the previous reference to address 8. This kind of miss, where we have plenty of room in the cache but keep alternating references to blocks that map to the same set, is an example of a conflict miss.</p>
<table id="P7000497027000000000000000043E32" data-uri="chapter06.xhtml#P7000497027000000000000000043E32" class="pcalibre largetable pcalibre1">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P7000497027000000000000000043E33" data-uri="chapter06.xhtml#P7000497027000000000000000043E33" class="calibre18 pcalibre pcalibre1">Set</th>
<th id="P7000497027000000000000000043E34" data-uri="chapter06.xhtml#P7000497027000000000000000043E34" class="calibre18 pcalibre pcalibre1">Valid</th>
<th id="P7000497027000000000000000043E35" data-uri="chapter06.xhtml#P7000497027000000000000000043E35" class="calibre18 pcalibre pcalibre1">Tag</th>
<th id="P7000497027000000000000000043E36" data-uri="chapter06.xhtml#P7000497027000000000000000043E36" class="calibre18 pcalibre pcalibre1">block[0]</th>
<th id="P7000497027000000000000000043E37" data-uri="chapter06.xhtml#P7000497027000000000000000043E37" class="calibre18 pcalibre pcalibre1">block[1]</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E38" data-uri="chapter06.xhtml#P7000497027000000000000000043E38" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043E39" data-uri="chapter06.xhtml#P7000497027000000000000000043E39" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043E3A" data-uri="chapter06.xhtml#P7000497027000000000000000043E3A" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043E3B" data-uri="chapter06.xhtml#P7000497027000000000000000043E3B" class="calibre20 pcalibre pcalibre1">m[0]</td>
<td id="P7000497027000000000000000043E3C" data-uri="chapter06.xhtml#P7000497027000000000000000043E3C" class="calibre20 pcalibre pcalibre1">m[1]</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E3D" data-uri="chapter06.xhtml#P7000497027000000000000000043E3D" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043E3E" data-uri="chapter06.xhtml#P7000497027000000000000000043E3E" class="calibre20 pcalibre pcalibre1">0</td>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E3F" data-uri="chapter06.xhtml#P7000497027000000000000000043E3F" class="calibre20 pcalibre pcalibre1">2</td>
<td id="P7000497027000000000000000043E40" data-uri="chapter06.xhtml#P7000497027000000000000000043E40" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043E41" data-uri="chapter06.xhtml#P7000497027000000000000000043E41" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043E42" data-uri="chapter06.xhtml#P7000497027000000000000000043E42" class="calibre20 pcalibre pcalibre1">m[12]</td>
<td id="P7000497027000000000000000043E43" data-uri="chapter06.xhtml#P7000497027000000000000000043E43" class="calibre20 pcalibre pcalibre1">m[13]</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E44" data-uri="chapter06.xhtml#P7000497027000000000000000043E44" class="calibre20 pcalibre pcalibre1">3</td>
<td id="P7000497027000000000000000043E45" data-uri="chapter06.xhtml#P7000497027000000000000000043E45" class="calibre20 pcalibre pcalibre1">0</td>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
<td class="calibre20 pcalibre pcalibre1"/>
</tr>
</tbody>
</table>
</li></ol>
</section>
<section id="P70004970270000000000000000056C5" data-uri="chapter06.xhtml#P70004970270000000000000000056C5" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title5 pcalibre pcalibre1" id="P7000497027000000000000000043E46" data-uri="chapter06.xhtml#P7000497027000000000000000043E46" epub:type="title"><span class="pcalibre pagebreak pcalibre1" id="P70004970270000000000000000056C7" title="622" data-uri="chapter06.xhtml#P70004970270000000000000000056C7" epub:type="pagebreak"></span>Conflict Misses in Direct-Mapped Caches</h1></header>
<p id="P7000497027000000000000000043E47" data-uri="chapter06.xhtml#P7000497027000000000000000043E47" class="pcalibre1 pcalibre calibre2">Conflict misses are common in real programs and can cause baffling performance problems. Conflict misses in direct-mapped caches typically occur when programs access arrays whose sizes are a power of 2. For example, consider a function that computes the dot product of two vectors:</p>
<pre id="P7000497027000000000000000043E48" data-uri="chapter06.xhtml#P7000497027000000000000000043E48" class="calibre9 pcalibre pcalibre1"><code id="P7000497027000000000000000043E49" data-uri="chapter06.xhtml#P7000497027000000000000000043E49" class="calibre10 pcalibre pcalibre1">
1	float dotprod(float x [8], float y [8])
2	{
3		float sum = 0.0;
4		int i;
5	
6		for (i = 0; i &lt; 8; i++)
7			sum += x [i] * y [i];
8		return sum;
9	}
</code></pre>
<p class="pcalibre1 pcalibre calibre2" id="P7000497027000000000000000043E4A" data-uri="chapter06.xhtml#P7000497027000000000000000043E4A">This function has good spatial locality with respect to <code id="P7000497027000000000000000043E4B" data-uri="chapter06.xhtml#P7000497027000000000000000043E4B" class="pcalibre1 calibre8 pcalibre">x</code> and <code id="P7000497027000000000000000043E4C" data-uri="chapter06.xhtml#P7000497027000000000000000043E4C" class="pcalibre1 calibre8 pcalibre">y</code>, and so we might expect it to enjoy a good number of cache hits. Unfortunately, this is not always true.</p>
<p id="P7000497027000000000000000043E4D" data-uri="chapter06.xhtml#P7000497027000000000000000043E4D" class="pcalibre1 pcalibre calibre2">Suppose that floats are 4 bytes, that <code id="P7000497027000000000000000043E4E" data-uri="chapter06.xhtml#P7000497027000000000000000043E4E" class="pcalibre1 calibre8 pcalibre">x</code> is loaded into the 32 bytes of contiguous memory starting at address 0, and that <code id="P7000497027000000000000000043E4F" data-uri="chapter06.xhtml#P7000497027000000000000000043E4F" class="pcalibre1 calibre8 pcalibre">y</code> starts immediately after <code id="P7000497027000000000000000043E50" data-uri="chapter06.xhtml#P7000497027000000000000000043E50" class="pcalibre1 calibre8 pcalibre">x</code> at address 32. For simplicity, suppose that a block is 16 bytes (big enough to hold four floats) and that the cache consists of two sets, for a total cache size of 32 bytes. We will assume that the variable <code id="P7000497027000000000000000043E51" data-uri="chapter06.xhtml#P7000497027000000000000000043E51" class="pcalibre1 calibre8 pcalibre">sum</code> is actually stored in a CPU register and thus does not require a memory reference. Given these assumptions, each <code id="P7000497027000000000000000043E52" data-uri="chapter06.xhtml#P7000497027000000000000000043E52" class="pcalibre1 calibre8 pcalibre">x[i]</code> and <code id="P7000497027000000000000000043E53" data-uri="chapter06.xhtml#P7000497027000000000000000043E53" class="pcalibre1 calibre8 pcalibre">y[i]</code> will map to the identical cache set:</p>
<table class="informaltable pcalibre pcalibre1" id="P7000497027000000000000000043E54" data-uri="chapter06.xhtml#P7000497027000000000000000043E54">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P7000497027000000000000000043E55" data-uri="chapter06.xhtml#P7000497027000000000000000043E55" class="calibre18 pcalibre pcalibre1">Element</th>
<th id="P7000497027000000000000000043E56" data-uri="chapter06.xhtml#P7000497027000000000000000043E56" class="calibre18 pcalibre pcalibre1">Address</th>
<th id="P7000497027000000000000000043E57" data-uri="chapter06.xhtml#P7000497027000000000000000043E57" class="calibre18 pcalibre pcalibre1">Set index</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E58" data-uri="chapter06.xhtml#P7000497027000000000000000043E58" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043E59" data-uri="chapter06.xhtml#P7000497027000000000000000043E59" class="calibre10 pcalibre pcalibre1">x[0]</code></td>
<td id="P7000497027000000000000000043E5A" data-uri="chapter06.xhtml#P7000497027000000000000000043E5A" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043E5B" data-uri="chapter06.xhtml#P7000497027000000000000000043E5B" class="calibre20 pcalibre pcalibre1">0</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E5C" data-uri="chapter06.xhtml#P7000497027000000000000000043E5C" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043E5D" data-uri="chapter06.xhtml#P7000497027000000000000000043E5D" class="calibre10 pcalibre pcalibre1">x[1]</code></td>
<td id="P7000497027000000000000000043E5E" data-uri="chapter06.xhtml#P7000497027000000000000000043E5E" class="calibre20 pcalibre pcalibre1">4</td>
<td id="P7000497027000000000000000043E5F" data-uri="chapter06.xhtml#P7000497027000000000000000043E5F" class="calibre20 pcalibre pcalibre1">0</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E60" data-uri="chapter06.xhtml#P7000497027000000000000000043E60" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043E61" data-uri="chapter06.xhtml#P7000497027000000000000000043E61" class="calibre10 pcalibre pcalibre1">x[2]</code></td>
<td id="P7000497027000000000000000043E62" data-uri="chapter06.xhtml#P7000497027000000000000000043E62" class="calibre20 pcalibre pcalibre1">8</td>
<td id="P7000497027000000000000000043E63" data-uri="chapter06.xhtml#P7000497027000000000000000043E63" class="calibre20 pcalibre pcalibre1">0</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E64" data-uri="chapter06.xhtml#P7000497027000000000000000043E64" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043E65" data-uri="chapter06.xhtml#P7000497027000000000000000043E65" class="calibre10 pcalibre pcalibre1">x[3]</code></td>
<td id="P7000497027000000000000000043E66" data-uri="chapter06.xhtml#P7000497027000000000000000043E66" class="calibre20 pcalibre pcalibre1">12</td>
<td id="P7000497027000000000000000043E67" data-uri="chapter06.xhtml#P7000497027000000000000000043E67" class="calibre20 pcalibre pcalibre1">0</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E68" data-uri="chapter06.xhtml#P7000497027000000000000000043E68" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043E69" data-uri="chapter06.xhtml#P7000497027000000000000000043E69" class="calibre10 pcalibre pcalibre1">x[4]</code></td>
<td id="P7000497027000000000000000043E6A" data-uri="chapter06.xhtml#P7000497027000000000000000043E6A" class="calibre20 pcalibre pcalibre1">16</td>
<td id="P7000497027000000000000000043E6B" data-uri="chapter06.xhtml#P7000497027000000000000000043E6B" class="calibre20 pcalibre pcalibre1">1</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E6C" data-uri="chapter06.xhtml#P7000497027000000000000000043E6C" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043E6D" data-uri="chapter06.xhtml#P7000497027000000000000000043E6D" class="calibre10 pcalibre pcalibre1">x[5]</code></td>
<td id="P7000497027000000000000000043E6E" data-uri="chapter06.xhtml#P7000497027000000000000000043E6E" class="calibre20 pcalibre pcalibre1">20</td>
<td id="P7000497027000000000000000043E6F" data-uri="chapter06.xhtml#P7000497027000000000000000043E6F" class="calibre20 pcalibre pcalibre1">1</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E70" data-uri="chapter06.xhtml#P7000497027000000000000000043E70" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043E71" data-uri="chapter06.xhtml#P7000497027000000000000000043E71" class="calibre10 pcalibre pcalibre1">x[6]</code></td>
<td id="P7000497027000000000000000043E72" data-uri="chapter06.xhtml#P7000497027000000000000000043E72" class="calibre20 pcalibre pcalibre1">24</td>
<td id="P7000497027000000000000000043E73" data-uri="chapter06.xhtml#P7000497027000000000000000043E73" class="calibre20 pcalibre pcalibre1">1</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E74" data-uri="chapter06.xhtml#P7000497027000000000000000043E74" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043E75" data-uri="chapter06.xhtml#P7000497027000000000000000043E75" class="calibre10 pcalibre pcalibre1">x[7]</code></td>
<td id="P7000497027000000000000000043E76" data-uri="chapter06.xhtml#P7000497027000000000000000043E76" class="calibre20 pcalibre pcalibre1">28</td>
<td id="P7000497027000000000000000043E77" data-uri="chapter06.xhtml#P7000497027000000000000000043E77" class="calibre20 pcalibre pcalibre1">1</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E78" data-uri="chapter06.xhtml#P7000497027000000000000000043E78" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043E79" data-uri="chapter06.xhtml#P7000497027000000000000000043E79" class="calibre10 pcalibre pcalibre1">y[0]</code></td>
<td id="P7000497027000000000000000043E7A" data-uri="chapter06.xhtml#P7000497027000000000000000043E7A" class="calibre20 pcalibre pcalibre1">32</td>
<td id="P7000497027000000000000000043E7B" data-uri="chapter06.xhtml#P7000497027000000000000000043E7B" class="calibre20 pcalibre pcalibre1">0</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E7C" data-uri="chapter06.xhtml#P7000497027000000000000000043E7C" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043E7D" data-uri="chapter06.xhtml#P7000497027000000000000000043E7D" class="calibre10 pcalibre pcalibre1">y[1]</code></td>
<td id="P7000497027000000000000000043E7E" data-uri="chapter06.xhtml#P7000497027000000000000000043E7E" class="calibre20 pcalibre pcalibre1">36</td>
<td id="P7000497027000000000000000043E7F" data-uri="chapter06.xhtml#P7000497027000000000000000043E7F" class="calibre20 pcalibre pcalibre1">0</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E80" data-uri="chapter06.xhtml#P7000497027000000000000000043E80" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043E81" data-uri="chapter06.xhtml#P7000497027000000000000000043E81" class="calibre10 pcalibre pcalibre1">y[2]</code></td>
<td id="P7000497027000000000000000043E82" data-uri="chapter06.xhtml#P7000497027000000000000000043E82" class="calibre20 pcalibre pcalibre1">40</td>
<td id="P7000497027000000000000000043E83" data-uri="chapter06.xhtml#P7000497027000000000000000043E83" class="calibre20 pcalibre pcalibre1">0</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E84" data-uri="chapter06.xhtml#P7000497027000000000000000043E84" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043E85" data-uri="chapter06.xhtml#P7000497027000000000000000043E85" class="calibre10 pcalibre pcalibre1">y[3]</code></td>
<td id="P7000497027000000000000000043E86" data-uri="chapter06.xhtml#P7000497027000000000000000043E86" class="calibre20 pcalibre pcalibre1">44</td>
<td id="P7000497027000000000000000043E87" data-uri="chapter06.xhtml#P7000497027000000000000000043E87" class="calibre20 pcalibre pcalibre1">0</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E88" data-uri="chapter06.xhtml#P7000497027000000000000000043E88" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043E89" data-uri="chapter06.xhtml#P7000497027000000000000000043E89" class="calibre10 pcalibre pcalibre1">y[4]</code></td>
<td id="P7000497027000000000000000043E8A" data-uri="chapter06.xhtml#P7000497027000000000000000043E8A" class="calibre20 pcalibre pcalibre1">48</td>
<td id="P7000497027000000000000000043E8B" data-uri="chapter06.xhtml#P7000497027000000000000000043E8B" class="calibre20 pcalibre pcalibre1">1</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E8C" data-uri="chapter06.xhtml#P7000497027000000000000000043E8C" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043E8D" data-uri="chapter06.xhtml#P7000497027000000000000000043E8D" class="calibre10 pcalibre pcalibre1">y[5]</code></td>
<td id="P7000497027000000000000000043E8E" data-uri="chapter06.xhtml#P7000497027000000000000000043E8E" class="calibre20 pcalibre pcalibre1">52</td>
<td id="P7000497027000000000000000043E8F" data-uri="chapter06.xhtml#P7000497027000000000000000043E8F" class="calibre20 pcalibre pcalibre1">1</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E90" data-uri="chapter06.xhtml#P7000497027000000000000000043E90" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043E91" data-uri="chapter06.xhtml#P7000497027000000000000000043E91" class="calibre10 pcalibre pcalibre1">y[6]</code></td>
<td id="P7000497027000000000000000043E92" data-uri="chapter06.xhtml#P7000497027000000000000000043E92" class="calibre20 pcalibre pcalibre1">56</td>
<td id="P7000497027000000000000000043E93" data-uri="chapter06.xhtml#P7000497027000000000000000043E93" class="calibre20 pcalibre pcalibre1">1</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043E94" data-uri="chapter06.xhtml#P7000497027000000000000000043E94" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043E95" data-uri="chapter06.xhtml#P7000497027000000000000000043E95" class="calibre10 pcalibre pcalibre1">y[7]</code></td>
<td id="P7000497027000000000000000043E96" data-uri="chapter06.xhtml#P7000497027000000000000000043E96" class="calibre20 pcalibre pcalibre1">60</td>
<td id="P7000497027000000000000000043E97" data-uri="chapter06.xhtml#P7000497027000000000000000043E97" class="calibre20 pcalibre pcalibre1">1</td>
</tr>
</tbody>
</table>
<p id="P7000497027000000000000000043E98" data-uri="chapter06.xhtml#P7000497027000000000000000043E98" class="pcalibre1 pcalibre calibre2">At run time, the first iteration of the loop references <code id="P7000497027000000000000000043E99" data-uri="chapter06.xhtml#P7000497027000000000000000043E99" class="pcalibre1 calibre8 pcalibre">x[0]</code>, a miss that causes the block containing <code id="P7000497027000000000000000043E9A" data-uri="chapter06.xhtml#P7000497027000000000000000043E9A" class="pcalibre1 calibre8 pcalibre">x[0]−x [3]</code> to be loaded into set 0. The next reference is to <code id="P7000497027000000000000000043E9B" data-uri="chapter06.xhtml#P7000497027000000000000000043E9B" class="pcalibre1 calibre8 pcalibre">y[0]</code>, another miss that causes the block containing <code id="P7000497027000000000000000043E9C" data-uri="chapter06.xhtml#P7000497027000000000000000043E9C" class="pcalibre1 calibre8 pcalibre">y [0]−y [3]</code> to be copied into set 0, overwriting the values of <code id="P7000497027000000000000000043E9D" data-uri="chapter06.xhtml#P7000497027000000000000000043E9D" class="pcalibre1 calibre8 pcalibre">x</code> that were copied in by the previous reference. During the next iteration, the reference to <code id="P7000497027000000000000000043E9E" data-uri="chapter06.xhtml#P7000497027000000000000000043E9E" class="pcalibre1 calibre8 pcalibre">x[1]</code> misses, which causes the <code id="P7000497027000000000000000043E9F" data-uri="chapter06.xhtml#P7000497027000000000000000043E9F" class="pcalibre1 calibre8 pcalibre">x[0]−x [3]</code> block to be loaded back into set 0, overwriting the <code id="P7000497027000000000000000043EA0" data-uri="chapter06.xhtml#P7000497027000000000000000043EA0" class="pcalibre1 calibre8 pcalibre">y[0]−y[3]</code> block. So now we have a conflict miss, and in fact each subsequent reference to <code id="P7000497027000000000000000043EA1" data-uri="chapter06.xhtml#P7000497027000000000000000043EA1" class="pcalibre1 calibre8 pcalibre">x</code> and <code id="P7000497027000000000000000043EA2" data-uri="chapter06.xhtml#P7000497027000000000000000043EA2" class="pcalibre1 calibre8 pcalibre">y</code> will result in a conflict miss as we thrash back and forth between blocks of <code id="P7000497027000000000000000043EA3" data-uri="chapter06.xhtml#P7000497027000000000000000043EA3" class="pcalibre1 calibre8 pcalibre">x</code> and <code id="P7000497027000000000000000043EA4" data-uri="chapter06.xhtml#P7000497027000000000000000043EA4" class="pcalibre1 calibre8 pcalibre">y</code>. The term <i class="calibre5 pcalibre pcalibre1">thrashing</i> describes any situation where a cache is repeatedly loading and evicting the same sets of cache blocks.</p>
<aside class="sidebar pcalibre5 pcalibre" id="P7000497027000000000000000005726" data-uri="chapter06.xhtml#P7000497027000000000000000005726"><header class="pcalibre halftitlepage pcalibre1"><h1 class="pcalibre1 title2 pcalibre" id="P7000497027000000000000000043EA5" data-uri="chapter06.xhtml#P7000497027000000000000000043EA5" epub:type="title"><span class="pcalibre pagebreak pcalibre1" id="P7000497027000000000000000005728" title="623" data-uri="chapter06.xhtml#P7000497027000000000000000005728" epub:type="pagebreak"></span><span class="pcalibre label1 pcalibre1">Aside </span>Why index with the middle bits?</h1></header>
<p id="P7000497027000000000000000043EA6" data-uri="chapter06.xhtml#P7000497027000000000000000043EA6" class="pcalibre calibre3 pcalibre1">You may be wondering why caches use the middle bits for the set index instead of the high-order bits. There is a good reason why the middle bits are better. <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P700049702700000000000000000572A"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">6.31</span></a> shows why. If the high-order bits are used as an index, then some contiguous memory blocks will map to the same cache set. For example, in the figure, the first four blocks map to the first cache set, the second four blocks map to the second set, and so on. If a program has good spatial locality and scans the elements of an array sequentially, then the cache can only hold a block-size chunk of the array at any point in time. This is an inefficient use of the cache. Contrast this with middle-bit indexing, where adjacent blocks always map to different cache sets. In this case, the cache can hold an entire <var class="calibre5 pcalibre pcalibre1">C</var>-size chunk of the array, where <var class="calibre5 pcalibre pcalibre1">C</var> is the cache size.</p>
</aside>
<figure class="pcalibre5 figure pcalibre" id="P700049702700000000000000000572A" data-uri="chapter06.xhtml#P700049702700000000000000000572A">
<img alt="A diagram illustrates indexing of bits." id="P7000497027000000000000000043EA7" data-uri="P700049702700000000000000000B73D" src="../images/p623-1.png" class="calibre213 pcalibre pcalibre1"/>
<figcaption id="P7000497027000000000000000043EA8" data-uri="chapter06.xhtml#P7000497027000000000000000043EA8" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P7000497027000000000000000043EA9" data-uri="chapter06.xhtml#P7000497027000000000000000043EA9" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">6.31 </span>Why caches index with the middle bits.</h1></header>
<details class="longdesc pcalibre pcalibre1" id="P70004970270000000000000000241AA" data-uri="chapter06.xhtml#P70004970270000000000000000241AA">
<summary class="pcalibre6 pcalibre1 pcalibre calibre30"><span class="number pcalibre pcalibre1">Description</span></summary>
<p id="P7000497027000000000000000043EAA" data-uri="chapter06.xhtml#P7000497027000000000000000043EAA" class="pcalibre calibre3 pcalibre1">A diagram shows a four-set cache consisting of blocks representing 00, 01, 10, and 11. A high-order bit indexing has set index bits in groups, with 00 at the top (including 0000, 0001, 0010, and 0011) at the top, 01 second (including 0100, 0101, 0110, and 0111), 10 third, and 11 on bottom. A middle-order bit indexing alternates set index bits, using the second two digits.</p>
</details>
</figcaption></figure>
<p id="P7000497027000000000000000043EAB" data-uri="chapter06.xhtml#P7000497027000000000000000043EAB" class="pcalibre1 pcalibre calibre2">The bottom line is that even though the program has good spatial locality and we have room in the cache to hold the blocks for both <code id="P7000497027000000000000000043EAC" data-uri="chapter06.xhtml#P7000497027000000000000000043EAC" class="pcalibre1 calibre8 pcalibre">x[i]</code> and <code id="P7000497027000000000000000043EAD" data-uri="chapter06.xhtml#P7000497027000000000000000043EAD" class="pcalibre1 calibre8 pcalibre">y[i]</code>, each reference results in a conflict miss because the blocks map to the same cache set. It is not unusual for this kind of thrashing to result in a slowdown by a factor of 2 or 3. Also, be aware that even though our example is extremely simple, the problem is real for larger and more realistic direct-mapped caches.</p>
<p id="P7000497027000000000000000043EAE" data-uri="chapter06.xhtml#P7000497027000000000000000043EAE" class="pcalibre1 pcalibre calibre2">Luckily, thrashing is easy for programmers to fix once they recognize what is going on. One easy solution is to put <var class="calibre5 pcalibre pcalibre1">B</var> bytes of padding at the end of each array. <span class="pcalibre pagebreak pcalibre1" id="P7000497027000000000000000005732" title="624" data-uri="chapter06.xhtml#P7000497027000000000000000005732" epub:type="pagebreak"></span>For example, instead of defining <code id="P7000497027000000000000000043EAF" data-uri="chapter06.xhtml#P7000497027000000000000000043EAF" class="pcalibre1 calibre8 pcalibre">x</code> to be float <code id="P7000497027000000000000000043EB0" data-uri="chapter06.xhtml#P7000497027000000000000000043EB0" class="pcalibre1 calibre8 pcalibre">x[8]</code>, we define it to be float <code id="P7000497027000000000000000043EB1" data-uri="chapter06.xhtml#P7000497027000000000000000043EB1" class="pcalibre1 calibre8 pcalibre">x[12]</code>. Assuming <code id="P7000497027000000000000000043EB2" data-uri="chapter06.xhtml#P7000497027000000000000000043EB2" class="pcalibre1 calibre8 pcalibre">y</code> starts immediately after <code id="P7000497027000000000000000043EB3" data-uri="chapter06.xhtml#P7000497027000000000000000043EB3" class="pcalibre1 calibre8 pcalibre">x</code> in memory, we have the following mapping of array elements to sets:</p>
<table class="informaltable pcalibre pcalibre1" id="P7000497027000000000000000043EB4" data-uri="chapter06.xhtml#P7000497027000000000000000043EB4">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P7000497027000000000000000043EB5" data-uri="chapter06.xhtml#P7000497027000000000000000043EB5" class="calibre18 pcalibre pcalibre1">Element</th>
<th id="P7000497027000000000000000043EB6" data-uri="chapter06.xhtml#P7000497027000000000000000043EB6" class="calibre18 pcalibre pcalibre1">Address</th>
<th id="P7000497027000000000000000043EB7" data-uri="chapter06.xhtml#P7000497027000000000000000043EB7" class="calibre18 pcalibre pcalibre1">Set index</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043EB8" data-uri="chapter06.xhtml#P7000497027000000000000000043EB8" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043EB9" data-uri="chapter06.xhtml#P7000497027000000000000000043EB9" class="calibre10 pcalibre pcalibre1">x[0]</code></td>
<td id="P7000497027000000000000000043EBA" data-uri="chapter06.xhtml#P7000497027000000000000000043EBA" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043EBB" data-uri="chapter06.xhtml#P7000497027000000000000000043EBB" class="calibre20 pcalibre pcalibre1">0</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043EBC" data-uri="chapter06.xhtml#P7000497027000000000000000043EBC" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043EBD" data-uri="chapter06.xhtml#P7000497027000000000000000043EBD" class="calibre10 pcalibre pcalibre1">x[1]</code></td>
<td id="P7000497027000000000000000043EBE" data-uri="chapter06.xhtml#P7000497027000000000000000043EBE" class="calibre20 pcalibre pcalibre1">4</td>
<td id="P7000497027000000000000000043EBF" data-uri="chapter06.xhtml#P7000497027000000000000000043EBF" class="calibre20 pcalibre pcalibre1">0</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043EC0" data-uri="chapter06.xhtml#P7000497027000000000000000043EC0" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043EC1" data-uri="chapter06.xhtml#P7000497027000000000000000043EC1" class="calibre10 pcalibre pcalibre1">x[2]</code></td>
<td id="P7000497027000000000000000043EC2" data-uri="chapter06.xhtml#P7000497027000000000000000043EC2" class="calibre20 pcalibre pcalibre1">8</td>
<td id="P7000497027000000000000000043EC3" data-uri="chapter06.xhtml#P7000497027000000000000000043EC3" class="calibre20 pcalibre pcalibre1">0</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043EC4" data-uri="chapter06.xhtml#P7000497027000000000000000043EC4" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043EC5" data-uri="chapter06.xhtml#P7000497027000000000000000043EC5" class="calibre10 pcalibre pcalibre1">x[3]</code></td>
<td id="P7000497027000000000000000043EC6" data-uri="chapter06.xhtml#P7000497027000000000000000043EC6" class="calibre20 pcalibre pcalibre1">12</td>
<td id="P7000497027000000000000000043EC7" data-uri="chapter06.xhtml#P7000497027000000000000000043EC7" class="calibre20 pcalibre pcalibre1">0</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043EC8" data-uri="chapter06.xhtml#P7000497027000000000000000043EC8" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043EC9" data-uri="chapter06.xhtml#P7000497027000000000000000043EC9" class="calibre10 pcalibre pcalibre1">x[4]</code></td>
<td id="P7000497027000000000000000043ECA" data-uri="chapter06.xhtml#P7000497027000000000000000043ECA" class="calibre20 pcalibre pcalibre1">16</td>
<td id="P7000497027000000000000000043ECB" data-uri="chapter06.xhtml#P7000497027000000000000000043ECB" class="calibre20 pcalibre pcalibre1">1</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043ECC" data-uri="chapter06.xhtml#P7000497027000000000000000043ECC" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043ECD" data-uri="chapter06.xhtml#P7000497027000000000000000043ECD" class="calibre10 pcalibre pcalibre1">x[5]</code></td>
<td id="P7000497027000000000000000043ECE" data-uri="chapter06.xhtml#P7000497027000000000000000043ECE" class="calibre20 pcalibre pcalibre1">20</td>
<td id="P7000497027000000000000000043ECF" data-uri="chapter06.xhtml#P7000497027000000000000000043ECF" class="calibre20 pcalibre pcalibre1">1</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043ED0" data-uri="chapter06.xhtml#P7000497027000000000000000043ED0" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043ED1" data-uri="chapter06.xhtml#P7000497027000000000000000043ED1" class="calibre10 pcalibre pcalibre1">x[6]</code></td>
<td id="P7000497027000000000000000043ED2" data-uri="chapter06.xhtml#P7000497027000000000000000043ED2" class="calibre20 pcalibre pcalibre1">24</td>
<td id="P7000497027000000000000000043ED3" data-uri="chapter06.xhtml#P7000497027000000000000000043ED3" class="calibre20 pcalibre pcalibre1">1</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043ED4" data-uri="chapter06.xhtml#P7000497027000000000000000043ED4" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043ED5" data-uri="chapter06.xhtml#P7000497027000000000000000043ED5" class="calibre10 pcalibre pcalibre1">x[7]</code></td>
<td id="P7000497027000000000000000043ED6" data-uri="chapter06.xhtml#P7000497027000000000000000043ED6" class="calibre20 pcalibre pcalibre1">28</td>
<td id="P7000497027000000000000000043ED7" data-uri="chapter06.xhtml#P7000497027000000000000000043ED7" class="calibre20 pcalibre pcalibre1">1</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043ED8" data-uri="chapter06.xhtml#P7000497027000000000000000043ED8" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043ED9" data-uri="chapter06.xhtml#P7000497027000000000000000043ED9" class="calibre10 pcalibre pcalibre1">y[0]</code></td>
<td id="P7000497027000000000000000043EDA" data-uri="chapter06.xhtml#P7000497027000000000000000043EDA" class="calibre20 pcalibre pcalibre1">48</td>
<td id="P7000497027000000000000000043EDB" data-uri="chapter06.xhtml#P7000497027000000000000000043EDB" class="calibre20 pcalibre pcalibre1">1</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043EDC" data-uri="chapter06.xhtml#P7000497027000000000000000043EDC" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043EDD" data-uri="chapter06.xhtml#P7000497027000000000000000043EDD" class="calibre10 pcalibre pcalibre1">y[1]</code></td>
<td id="P7000497027000000000000000043EDE" data-uri="chapter06.xhtml#P7000497027000000000000000043EDE" class="calibre20 pcalibre pcalibre1">52</td>
<td id="P7000497027000000000000000043EDF" data-uri="chapter06.xhtml#P7000497027000000000000000043EDF" class="calibre20 pcalibre pcalibre1">1</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043EE0" data-uri="chapter06.xhtml#P7000497027000000000000000043EE0" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043EE1" data-uri="chapter06.xhtml#P7000497027000000000000000043EE1" class="calibre10 pcalibre pcalibre1">y[2]</code></td>
<td id="P7000497027000000000000000043EE2" data-uri="chapter06.xhtml#P7000497027000000000000000043EE2" class="calibre20 pcalibre pcalibre1">56</td>
<td id="P7000497027000000000000000043EE3" data-uri="chapter06.xhtml#P7000497027000000000000000043EE3" class="calibre20 pcalibre pcalibre1">1</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043EE4" data-uri="chapter06.xhtml#P7000497027000000000000000043EE4" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043EE5" data-uri="chapter06.xhtml#P7000497027000000000000000043EE5" class="calibre10 pcalibre pcalibre1">y[3]</code></td>
<td id="P7000497027000000000000000043EE6" data-uri="chapter06.xhtml#P7000497027000000000000000043EE6" class="calibre20 pcalibre pcalibre1">60</td>
<td id="P7000497027000000000000000043EE7" data-uri="chapter06.xhtml#P7000497027000000000000000043EE7" class="calibre20 pcalibre pcalibre1">1</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043EE8" data-uri="chapter06.xhtml#P7000497027000000000000000043EE8" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043EE9" data-uri="chapter06.xhtml#P7000497027000000000000000043EE9" class="calibre10 pcalibre pcalibre1">y[4]</code></td>
<td id="P7000497027000000000000000043EEA" data-uri="chapter06.xhtml#P7000497027000000000000000043EEA" class="calibre20 pcalibre pcalibre1">64</td>
<td id="P7000497027000000000000000043EEB" data-uri="chapter06.xhtml#P7000497027000000000000000043EEB" class="calibre20 pcalibre pcalibre1">0</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043EEC" data-uri="chapter06.xhtml#P7000497027000000000000000043EEC" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043EED" data-uri="chapter06.xhtml#P7000497027000000000000000043EED" class="calibre10 pcalibre pcalibre1">y[5]</code></td>
<td id="P7000497027000000000000000043EEE" data-uri="chapter06.xhtml#P7000497027000000000000000043EEE" class="calibre20 pcalibre pcalibre1">68</td>
<td id="P7000497027000000000000000043EEF" data-uri="chapter06.xhtml#P7000497027000000000000000043EEF" class="calibre20 pcalibre pcalibre1">0</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043EF0" data-uri="chapter06.xhtml#P7000497027000000000000000043EF0" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043EF1" data-uri="chapter06.xhtml#P7000497027000000000000000043EF1" class="calibre10 pcalibre pcalibre1">y[6]</code></td>
<td id="P7000497027000000000000000043EF2" data-uri="chapter06.xhtml#P7000497027000000000000000043EF2" class="calibre20 pcalibre pcalibre1">72</td>
<td id="P7000497027000000000000000043EF3" data-uri="chapter06.xhtml#P7000497027000000000000000043EF3" class="calibre20 pcalibre pcalibre1">0</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043EF4" data-uri="chapter06.xhtml#P7000497027000000000000000043EF4" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043EF5" data-uri="chapter06.xhtml#P7000497027000000000000000043EF5" class="calibre10 pcalibre pcalibre1">y[7]</code></td>
<td id="P7000497027000000000000000043EF6" data-uri="chapter06.xhtml#P7000497027000000000000000043EF6" class="calibre20 pcalibre pcalibre1">76</td>
<td id="P7000497027000000000000000043EF7" data-uri="chapter06.xhtml#P7000497027000000000000000043EF7" class="calibre20 pcalibre pcalibre1">0</td>
</tr>
</tbody>
</table>
<p class="pcalibre1 pcalibre calibre2" id="P7000497027000000000000000043EF8" data-uri="chapter06.xhtml#P7000497027000000000000000043EF8">With the padding at the end of <code id="P7000497027000000000000000043EF9" data-uri="chapter06.xhtml#P7000497027000000000000000043EF9" class="pcalibre1 calibre8 pcalibre">x, x[i]</code> and <code id="P7000497027000000000000000043EFA" data-uri="chapter06.xhtml#P7000497027000000000000000043EFA" class="pcalibre1 calibre8 pcalibre">y[i]</code> now map to different sets, which eliminates the thrashing conflict misses.</p>
<section id="P700049702700000000000000000577F" data-uri="chapter06.xhtml#P700049702700000000000000000577F" epub:type="practice" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title10 pcalibre pcalibre1" id="P7000497027000000000000000043EFB" data-uri="chapter06.xhtml#P7000497027000000000000000043EFB" epub:type="title"><span class="pcalibre label pcalibre1">Practice Problem </span><span class="pcalibre label pcalibre1">6.10 </span>(solution page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP7000497027000000000000000005E52.xhtml#P7000497027000000000000000005EAC">663</a>)</h1></header>
<ol class="practicelist pcalibre pcalibre1" id="P7000497027000000000000000043EFC" data-uri="chapter06.xhtml#P7000497027000000000000000043EFC">
<li class="general-problem pcalibre pcalibre1" id="P7000497027000000000000000043EFD" data-uri="chapter06.xhtml#P7000497027000000000000000043EFD">
<div class="edition pcalibre pcalibre1" id="P7000497027000000000000000043EFE" data-uri="chapter06.xhtml#P7000497027000000000000000043EFE"><p id="P7000497027000000000000000043EFF" data-uri="chapter06.xhtml#P7000497027000000000000000043EFF" class="pcalibre calibre3 pcalibre1">In the previous <code id="P7000497027000000000000000043F00" data-uri="chapter06.xhtml#P7000497027000000000000000043F00" class="pcalibre1 calibre8 pcalibre">dotprod</code> example, what fraction of the total references to <code id="P7000497027000000000000000043F01" data-uri="chapter06.xhtml#P7000497027000000000000000043F01" class="pcalibre1 calibre8 pcalibre">x</code> and <code id="P7000497027000000000000000043F02" data-uri="chapter06.xhtml#P7000497027000000000000000043F02" class="pcalibre1 calibre8 pcalibre">y</code> will be hits once we have padded array <code id="P7000497027000000000000000043F03" data-uri="chapter06.xhtml#P7000497027000000000000000043F03" class="pcalibre1 calibre8 pcalibre">x</code>?</p></div></li>
</ol>
</section>
<section id="P7000497027000000000000000005789" data-uri="chapter06.xhtml#P7000497027000000000000000005789" epub:type="practice" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title10 pcalibre pcalibre1" id="P7000497027000000000000000043F04" data-uri="chapter06.xhtml#P7000497027000000000000000043F04" epub:type="title"><span class="pcalibre label pcalibre1">Practice Problem </span><span class="pcalibre label pcalibre1">6.11 </span>(solution page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP7000497027000000000000000005E52.xhtml#P7000497027000000000000000005EAC">663</a>)</h1></header>
<ol class="practicelist pcalibre pcalibre1" id="P7000497027000000000000000043F05" data-uri="chapter06.xhtml#P7000497027000000000000000043F05">
<li class="general-problem pcalibre pcalibre1" id="P7000497027000000000000000043F06" data-uri="chapter06.xhtml#P7000497027000000000000000043F06">
<div class="edition pcalibre pcalibre1" id="P7000497027000000000000000043F07" data-uri="chapter06.xhtml#P7000497027000000000000000043F07"><p id="P7000497027000000000000000043F08" data-uri="chapter06.xhtml#P7000497027000000000000000043F08" class="pcalibre calibre3 pcalibre1">Imagine a hypothetical cache that uses the high-order <var class="calibre5 pcalibre pcalibre1">s</var> bits of an address as the set index. For such a cache, contiguous chunks of memory blocks are mapped to the same cache set.</p>
<ol class="pcalibre ol_upper-alpha pcalibre1" id="P7000497027000000000000000043F09" data-uri="chapter06.xhtml#P7000497027000000000000000043F09">
<li id="P7000497027000000000000000043F0A" data-uri="chapter06.xhtml#P7000497027000000000000000043F0A" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043F0B" data-uri="chapter06.xhtml#P7000497027000000000000000043F0B" class="pcalibre calibre3 pcalibre1">How many blocks are in each of these contiguous array chunks?</p></li>
<li id="P7000497027000000000000000043F0C" data-uri="chapter06.xhtml#P7000497027000000000000000043F0C" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043F0D" data-uri="chapter06.xhtml#P7000497027000000000000000043F0D" class="pcalibre calibre3 pcalibre1">Consider the following code that runs on a system with a cache of the form <i class="calibre5 pcalibre pcalibre1">(S, E, B, m)</i> = (512, 1, 32, 32):</p>
<pre id="P7000497027000000000000000043F0E" data-uri="chapter06.xhtml#P7000497027000000000000000043F0E" class="calibre9 pcalibre pcalibre1"><code id="P7000497027000000000000000043F0F" data-uri="chapter06.xhtml#P7000497027000000000000000043F0F" class="calibre10 pcalibre pcalibre1">
int array[4096];
for (i = 0; i &lt; 4096; i++)
	sum += array [i];
</code></pre>
<p id="P7000497027000000000000000043F10" data-uri="chapter06.xhtml#P7000497027000000000000000043F10" class="pcalibre calibre3 pcalibre1">What is the maximum number of array blocks that are stored in the cache at any point in time?</p>
</li></ol></div></li>
</ol>
</section>
</section>
</section>
<section id="P7000497027000000000000000005797" data-uri="chapter06.xhtml#P7000497027000000000000000005797" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P7000497027000000000000000043F11" data-uri="chapter06.xhtml#P7000497027000000000000000043F11" epub:type="title"><span class="pcalibre label pcalibre1">6.4.3 </span>Set Associative Caches</h1></header>
<p id="P7000497027000000000000000043F12" data-uri="chapter06.xhtml#P7000497027000000000000000043F12" class="pcalibre1 pcalibre calibre2">The problem with conflict misses in direct-mapped caches stems from the constraint that each set has exactly one line (or in our terminology, <var class="calibre5 pcalibre pcalibre1">E</var> = 1). A <i class="calibre5 pcalibre pcalibre1">set associative cache</i> relaxes this constraint so that each set holds more than one cache line. A cache with 1 &lt; <var class="calibre5 pcalibre pcalibre1">E</var> &lt; <i class="calibre5 pcalibre pcalibre1">C/B</i> is often called an <var class="calibre5 pcalibre pcalibre1">E</var>-way set associative cache. We</p>
<figure class="pcalibre5 figure pcalibre" id="P700049702700000000000000000579A" data-uri="chapter06.xhtml#P700049702700000000000000000579A">
<span class="pcalibre pagebreak pcalibre1" id="P700049702700000000000000000579B" title="625" data-uri="chapter06.xhtml#P700049702700000000000000000579B" epub:type="pagebreak"></span>
<img alt="A diagram of set associative cache shows E = 2 lines per set." id="P7000497027000000000000000043F13" data-uri="P700049702700000000000000000B73E" src="../images/p625-1.png" class="pcalibre calibre214 pcalibre1"/>
<figcaption id="P7000497027000000000000000043F14" data-uri="chapter06.xhtml#P7000497027000000000000000043F14" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P7000497027000000000000000043F15" data-uri="chapter06.xhtml#P7000497027000000000000000043F15" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="pcalibre label pcalibre1">6.32 </span>Set associative cache (1 &lt; <var class="calibre5 pcalibre pcalibre1">E</var> &lt; <i class="calibre5 pcalibre pcalibre1">C/B</i>).</h1></header>
<div class="caption pcalibre pcalibre1" id="P7000497027000000000000000043F16" data-uri="chapter06.xhtml#P7000497027000000000000000043F16"><p id="P7000497027000000000000000043F17" data-uri="chapter06.xhtml#P7000497027000000000000000043F17" class="pcalibre calibre3 pcalibre1">In a set associative cache, each set contains more than one line. This particular example shows a two-way set associative cache.</p></div></figcaption>
</figure>
<figure class="pcalibre5 figure pcalibre" id="P70004970270000000000000000057A1" data-uri="chapter06.xhtml#P70004970270000000000000000057A1">
<img alt="A diagram of set selection in a set associative cache shows set 1 selected, with address extending from m minus 1 to 1. The tag consists of t bits, set index s bits with 0 0 0 0 1, and block offset with b bits." id="P7000497027000000000000000043F18" data-uri="P700049702700000000000000000B73F" src="../images/p625-2.png" class="pcalibre1 pcalibre calibre215"/>
<figcaption id="P7000497027000000000000000043F19" data-uri="chapter06.xhtml#P7000497027000000000000000043F19" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P7000497027000000000000000043F1A" data-uri="chapter06.xhtml#P7000497027000000000000000043F1A" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">6.33 </span>Set selection in a set associative cache.</h1></header></figcaption>
</figure>
<p class="pcalibre1 pcalibre calibre2" id="P7000497027000000000000000043F1B" data-uri="chapter06.xhtml#P7000497027000000000000000043F1B">will discuss the special case, where <var class="calibre5 pcalibre pcalibre1">E</var> = <i class="calibre5 pcalibre pcalibre1">C/B</i>, in the next section. <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P700049702700000000000000000579A"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">6.32</span></a> shows the organization of a two-way set associative cache.</p>
<section id="P70004970270000000000000000057A6" data-uri="chapter06.xhtml#P70004970270000000000000000057A6" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title5 pcalibre pcalibre1" id="P7000497027000000000000000043F1C" data-uri="chapter06.xhtml#P7000497027000000000000000043F1C" epub:type="title">Set Selection in Set Associative Caches</h1></header>
<p id="P7000497027000000000000000043F1D" data-uri="chapter06.xhtml#P7000497027000000000000000043F1D" class="pcalibre1 pcalibre calibre2">Set selection is identical to a direct-mapped cache, with the set index bits identifying the set. <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P70004970270000000000000000057A1"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">6.33</span></a> summarizes this principle.</p>
</section>
<section id="P70004970270000000000000000057A9" data-uri="chapter06.xhtml#P70004970270000000000000000057A9" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title5 pcalibre pcalibre1" id="P7000497027000000000000000043F1E" data-uri="chapter06.xhtml#P7000497027000000000000000043F1E" epub:type="title">Line Matching and Word Selection in Set Associative Caches</h1></header>
<p id="P7000497027000000000000000043F1F" data-uri="chapter06.xhtml#P7000497027000000000000000043F1F" class="pcalibre1 pcalibre calibre2">Line matching is more involved in a set associative cache than in a direct-mapped cache because it must check the tags and valid bits of multiple lines in order to determine if the requested word is in the set. A conventional memory is an array of values that takes an address as input and returns the value stored at that address. An <i class="calibre5 pcalibre pcalibre1">associative memory</i>, on the other hand, is an array of (key, value) pairs that takes as input the key and returns a value from one of the (key, value) pairs that matches the input key. Thus, we can think of each set in a set associative cache as a small associative memory where the keys are the concatenation of the tag and valid bits, and the values are the contents of a block.</p>
<figure class="pcalibre5 figure pcalibre" id="P70004970270000000000000000057AC" data-uri="chapter06.xhtml#P70004970270000000000000000057AC">
<span class="pcalibre pagebreak pcalibre1" id="P70004970270000000000000000057AD" title="626" data-uri="chapter06.xhtml#P70004970270000000000000000057AD" epub:type="pagebreak"></span>
<img alt="A diagram illustrates line matching and word selection in a set associative cache." id="P7000497027000000000000000043F20" data-uri="P700049702700000000000000000B740" src="../images/p626-1.png" class="calibre216 pcalibre pcalibre1"/>
<figcaption id="P7000497027000000000000000043F21" data-uri="chapter06.xhtml#P7000497027000000000000000043F21" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P7000497027000000000000000043F22" data-uri="chapter06.xhtml#P7000497027000000000000000043F22" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">6.34 </span>Line matching and word selection in a set associative cache.</h1></header>
<details class="longdesc pcalibre pcalibre1" id="P7000497027000000000000000024224" data-uri="chapter06.xhtml#P7000497027000000000000000024224">
<summary class="pcalibre6 pcalibre1 pcalibre calibre30"><span class="number pcalibre pcalibre1">Description</span></summary>
<p id="P7000497027000000000000000043F23" data-uri="chapter06.xhtml#P7000497027000000000000000043F23" class="pcalibre1 pcalibre calibre2">A diagram shows selected set (i) with the following numbered steps:</p>
<ol id="P7000497027000000000000000043F24" data-uri="chapter06.xhtml#P7000497027000000000000000043F24" class="pcalibre1 pcalibre calibre45">
<li id="P7000497027000000000000000043F25" data-uri="chapter06.xhtml#P7000497027000000000000000043F25" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043F26" data-uri="chapter06.xhtml#P7000497027000000000000000043F26" class="pcalibre calibre3 pcalibre1">The valid bit must be set. Each currently contains 1.</p></li>
<li id="P7000497027000000000000000043F27" data-uri="chapter06.xhtml#P7000497027000000000000000043F27" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043F28" data-uri="chapter06.xhtml#P7000497027000000000000000043F28" class="pcalibre calibre3 pcalibre1">The tag bits in the cache lines must match the tag bits in the address. The first tag bit contains 1001 and the second 0110, and the tag in the address contains 0110.</p></li>
<li id="P7000497027000000000000000043F29" data-uri="chapter06.xhtml#P7000497027000000000000000043F29" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043F2A" data-uri="chapter06.xhtml#P7000497027000000000000000043F2A" class="pcalibre calibre3 pcalibre1">If (1) and (2), then cache hit, and block offset selects starting byte. The cache block in line 2 begins with w<sub class="pcalibre1 calibre47 pcalibre">0</sub> in byte 4. The address has 100 in the block offset.</p></li>
</ol>
</details>
</figcaption></figure>
<p id="P7000497027000000000000000043F2B" data-uri="chapter06.xhtml#P7000497027000000000000000043F2B" class="pcalibre1 pcalibre calibre2"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P70004970270000000000000000057AC"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">6.34</span></a> shows the basic idea of line matching in an associative cache. An important idea here is that any line in the set can contain any of the memory blocks that map to that set. So the cache must search each line in the set for a valid line whose tag matches the tag in the address. If the cache finds such a line, then we have a hit and the block offset selects a word from the block, as before.</p>
</section>
<section id="P70004970270000000000000000057B2" data-uri="chapter06.xhtml#P70004970270000000000000000057B2" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title5 pcalibre pcalibre1" id="P7000497027000000000000000043F2C" data-uri="chapter06.xhtml#P7000497027000000000000000043F2C" epub:type="title">Line Replacement on Misses in Set Associative Caches</h1></header>
<p id="P7000497027000000000000000043F2D" data-uri="chapter06.xhtml#P7000497027000000000000000043F2D" class="pcalibre1 pcalibre calibre2">If the word requested by the CPU is not stored in any of the lines in the set, then we have a cache miss, and the cache must fetch the block that contains the word from memory. However, once the cache has retrieved the block, which line should it replace? Of course, if there is an empty line, then it would be a good candidate. But if there are no empty lines in the set, then we must choose one of the nonempty lines and hope that the CPU does not reference the replaced line anytime soon.</p>
<p id="P7000497027000000000000000043F2E" data-uri="chapter06.xhtml#P7000497027000000000000000043F2E" class="pcalibre1 pcalibre calibre2">It is very difficult for programmers to exploit knowledge of the cache replacement policy in their codes, so we will not go into much detail about it here. The simplest replacement policy is to choose the line to replace at random. Other more sophisticated policies draw on the principle of locality to try to minimize the probability that the replaced line will be referenced in the near future. For example, a <i class="calibre5 pcalibre pcalibre1">least frequently used (LFU)</i> policy will replace the line that has been referenced the fewest times over some past time window. A <i class="calibre5 pcalibre pcalibre1">least recently used (LRU)</i> policy will replace the line that was last accessed the furthest in the past. All of these policies require additional time and hardware. But as we move further down the memory hierarchy, away from the CPU, the cost of a miss becomes more expensive and it becomes more worthwhile to minimize misses with good replacement policies.</p>
</section>
</section>
<section id="P70004970270000000000000000057B6" data-uri="chapter06.xhtml#P70004970270000000000000000057B6" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P7000497027000000000000000043F2F" data-uri="chapter06.xhtml#P7000497027000000000000000043F2F" epub:type="title"><span class="pcalibre label pcalibre1">6.4.4 </span>Fully Associative Caches</h1></header>
<p id="P7000497027000000000000000043F30" data-uri="chapter06.xhtml#P7000497027000000000000000043F30" class="pcalibre1 pcalibre calibre2"><i class="calibre5 pcalibre pcalibre1">A fully associative cache</i> consists of a single set (i.e., <var class="calibre5 pcalibre pcalibre1">E</var> = <i class="calibre5 pcalibre pcalibre1">C/B</i>) that contains all of the cache lines. <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P70004970270000000000000000057B9"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">6.35</span></a> shows the basic organization.</p>
<figure class="pcalibre5 figure pcalibre" id="P70004970270000000000000000057B9" data-uri="chapter06.xhtml#P70004970270000000000000000057B9">
<span class="pcalibre pagebreak pcalibre1" id="P70004970270000000000000000057BA" title="627" data-uri="chapter06.xhtml#P70004970270000000000000000057BA" epub:type="pagebreak"></span>
<img alt="A diagram of a fully associative cache shows set 0 with E = C/B lines in the one and only set." id="P7000497027000000000000000043F31" data-uri="P700049702700000000000000000B741" src="../images/p627-1.png" class="pcalibre1 calibre217 pcalibre"/>
<figcaption id="P7000497027000000000000000043F32" data-uri="chapter06.xhtml#P7000497027000000000000000043F32" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P7000497027000000000000000043F33" data-uri="chapter06.xhtml#P7000497027000000000000000043F33" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="pcalibre label pcalibre1">6.35 </span>Fully associative cache (<var class="calibre5 pcalibre pcalibre1">E</var> = <i class="calibre5 pcalibre pcalibre1">C/B</i>).</h1></header>
<div class="caption pcalibre pcalibre1" id="P7000497027000000000000000043F34" data-uri="chapter06.xhtml#P7000497027000000000000000043F34"><p id="P7000497027000000000000000043F35" data-uri="chapter06.xhtml#P7000497027000000000000000043F35" class="pcalibre calibre3 pcalibre1">In a fully associative cache, a single set contains all of the lines.</p></div></figcaption>
</figure>
<figure class="pcalibre5 figure pcalibre" id="P70004970270000000000000000057C0" data-uri="chapter06.xhtml#P70004970270000000000000000057C0">
<img alt="A diagram of set selection in a fully associative cache shows that the entire cache is one set, so by default set 0 is always selected. The address, from m minus 1 to 0, has tag with t bits and block offset with b bits." id="P7000497027000000000000000043F36" data-uri="P700049702700000000000000000B742" src="../images/p627-2.png" class="calibre218 pcalibre pcalibre1"/>
<figcaption id="P7000497027000000000000000043F37" data-uri="chapter06.xhtml#P7000497027000000000000000043F37" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P7000497027000000000000000043F38" data-uri="chapter06.xhtml#P7000497027000000000000000043F38" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">6.36 </span>Set selection in a fully associative cache.</h1></header>
<div class="caption pcalibre pcalibre1" id="P7000497027000000000000000043F39" data-uri="chapter06.xhtml#P7000497027000000000000000043F39"><p id="P7000497027000000000000000043F3A" data-uri="chapter06.xhtml#P7000497027000000000000000043F3A" class="pcalibre calibre3 pcalibre1">Notice that there are no set index bits.</p></div></figcaption>
</figure>
<figure class="pcalibre5 figure pcalibre" id="P70004970270000000000000000057C6" data-uri="chapter06.xhtml#P70004970270000000000000000057C6">
<img alt="A diagram illustrates line matching and word selection in a fully associative cache." id="P7000497027000000000000000043F3B" data-uri="P700049702700000000000000000B743" src="../images/p627-3.png" class="calibre219 pcalibre pcalibre1"/>
<figcaption id="P7000497027000000000000000043F3C" data-uri="chapter06.xhtml#P7000497027000000000000000043F3C" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P7000497027000000000000000043F3D" data-uri="chapter06.xhtml#P7000497027000000000000000043F3D" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">6.37 </span>Line matching and word selection in a fully associative cache.</h1></header>
<details class="longdesc pcalibre pcalibre1" id="P7000497027000000000000000024240" data-uri="chapter06.xhtml#P7000497027000000000000000024240">
<summary class="pcalibre6 pcalibre1 pcalibre calibre30"><span class="number pcalibre pcalibre1">Description</span></summary>
<p id="P7000497027000000000000000043F3E" data-uri="chapter06.xhtml#P7000497027000000000000000043F3E" class="pcalibre1 pcalibre calibre2">A diagram shows the entire cache with one set, with the following numbered steps:</p>
<ol id="P7000497027000000000000000043F3F" data-uri="chapter06.xhtml#P7000497027000000000000000043F3F" class="pcalibre1 pcalibre calibre45">
<li id="P7000497027000000000000000043F40" data-uri="chapter06.xhtml#P7000497027000000000000000043F40" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043F41" data-uri="chapter06.xhtml#P7000497027000000000000000043F41" class="pcalibre calibre3 pcalibre1">The valid bit must be set. Lines 1 and 3 each contain 1 and lines 2 and 4 each contain 0.</p></li>
<li id="P7000497027000000000000000043F42" data-uri="chapter06.xhtml#P7000497027000000000000000043F42" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043F43" data-uri="chapter06.xhtml#P7000497027000000000000000043F43" class="pcalibre calibre3 pcalibre1">The tag bits in one of the cache lines must match the tag bits in the address. The first tag bit contains 1001, the second and third each contain 0110, and the fourth contains 1110. The address tag contains 0110.</p></li>
<li id="P7000497027000000000000000043F44" data-uri="chapter06.xhtml#P7000497027000000000000000043F44" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043F45" data-uri="chapter06.xhtml#P7000497027000000000000000043F45" class="pcalibre calibre3 pcalibre1">If (1) and (2), then cache hit, and block offset selects starting byte. The cache block in line 3 begins with w<sub class="pcalibre1 calibre47 pcalibre">0</sub> in byte 4. The address has 100 in the block offset.</p></li>
</ol>
</details>
</figcaption></figure>
<section id="P70004970270000000000000000057CA" data-uri="chapter06.xhtml#P70004970270000000000000000057CA" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title5 pcalibre pcalibre1" id="P7000497027000000000000000043F46" data-uri="chapter06.xhtml#P7000497027000000000000000043F46" epub:type="title">Set Selection in Fully Associative Caches</h1></header>
<p id="P7000497027000000000000000043F47" data-uri="chapter06.xhtml#P7000497027000000000000000043F47" class="pcalibre1 pcalibre calibre2">Set selection in a fully associative cache is trivial because there is only one set, summarized in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P70004970270000000000000000057C0"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">6.36</span></a>. Notice that there are no set index bits in the address, which is partitioned into only a tag and a block offset.</p>
</section>
<section id="P70004970270000000000000000057CD" data-uri="chapter06.xhtml#P70004970270000000000000000057CD" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title5 pcalibre pcalibre1" id="P7000497027000000000000000043F48" data-uri="chapter06.xhtml#P7000497027000000000000000043F48" epub:type="title">Line Matching and Word Selection in Fully Associative Caches</h1></header>
<p id="P7000497027000000000000000043F49" data-uri="chapter06.xhtml#P7000497027000000000000000043F49" class="pcalibre1 pcalibre calibre2">Line matching and word selection in a fully associative cache work the same as with a set associative cache, as we show in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P70004970270000000000000000057C6"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">6.37</span></a>. The difference is mainly a question of scale.</p>
<p id="P7000497027000000000000000043F4A" data-uri="chapter06.xhtml#P7000497027000000000000000043F4A" class="pcalibre1 pcalibre calibre2">Because the cache circuitry must search for many matching tags in parallel, it is difficult and expensive to build an associative cache that is both large and fast. As a result, fully associative caches are only appropriate for small caches, such <span class="pcalibre pagebreak pcalibre1" id="P70004970270000000000000000057D1" title="628" data-uri="chapter06.xhtml#P70004970270000000000000000057D1" epub:type="pagebreak"></span>as the translation lookaside buffers (TLBs) in virtual memory systems that cache page table entries (<a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP70004970270000000000000000000D8.xhtml#P70004970270000000000000000000D8"><span class="pcalibre label pcalibre1">Section </span><span class="pcalibre label pcalibre1">9.6.2</span></a>).</p>
<section id="P70004970270000000000000000057D2" data-uri="chapter06.xhtml#P70004970270000000000000000057D2" epub:type="practice" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title10 pcalibre pcalibre1" id="P7000497027000000000000000043F4B" data-uri="chapter06.xhtml#P7000497027000000000000000043F4B" epub:type="title"><span class="pcalibre label pcalibre1">Practice Problem </span><span class="pcalibre label pcalibre1">6.12 </span>(solution page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP7000497027000000000000000005E52.xhtml#P7000497027000000000000000005EAC">663</a>)</h1></header>
<ol class="practicelist pcalibre pcalibre1" id="P7000497027000000000000000043F4C" data-uri="chapter06.xhtml#P7000497027000000000000000043F4C">
<li class="general-problem pcalibre pcalibre1" id="P7000497027000000000000000043F4D" data-uri="chapter06.xhtml#P7000497027000000000000000043F4D">
<div class="edition pcalibre pcalibre1" id="P7000497027000000000000000043F4E" data-uri="chapter06.xhtml#P7000497027000000000000000043F4E"><p id="P7000497027000000000000000043F4F" data-uri="chapter06.xhtml#P7000497027000000000000000043F4F" class="pcalibre calibre3 pcalibre1">The problems that follow will help reinforce your understanding of how caches work. Assume the following:</p>
<ul id="P7000497027000000000000000043F50" data-uri="chapter06.xhtml#P7000497027000000000000000043F50" class="calibre79 pcalibre pcalibre1">
<li id="P7000497027000000000000000043F51" data-uri="chapter06.xhtml#P7000497027000000000000000043F51" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043F52" data-uri="chapter06.xhtml#P7000497027000000000000000043F52" class="pcalibre calibre3 pcalibre1">The memory is byte addressable.</p></li>
<li id="P7000497027000000000000000043F53" data-uri="chapter06.xhtml#P7000497027000000000000000043F53" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043F54" data-uri="chapter06.xhtml#P7000497027000000000000000043F54" class="pcalibre calibre3 pcalibre1">Memory accesses are to 1-byte words (not to 4-byte words).</p></li>
<li id="P7000497027000000000000000043F55" data-uri="chapter06.xhtml#P7000497027000000000000000043F55" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043F56" data-uri="chapter06.xhtml#P7000497027000000000000000043F56" class="pcalibre calibre3 pcalibre1">Addresses are 13 bits wide.</p></li>
<li id="P7000497027000000000000000043F57" data-uri="chapter06.xhtml#P7000497027000000000000000043F57" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043F58" data-uri="chapter06.xhtml#P7000497027000000000000000043F58" class="pcalibre calibre3 pcalibre1">The cache is two-way set associative (<var class="calibre5 pcalibre pcalibre1">E</var> = 2), with a 4-byte block size (<var class="calibre5 pcalibre pcalibre1">B</var> = 4) and eight sets (<var class="calibre5 pcalibre pcalibre1">S</var> = 8).</p></li>
</ul>
<p id="P7000497027000000000000000043F59" data-uri="chapter06.xhtml#P7000497027000000000000000043F59" class="pcalibre calibre3 pcalibre1">The contents of the cache are as follows, with all numbers given in hexadecimal notation.</p>
<table class="informaltable pcalibre pcalibre1" id="P7000497027000000000000000043F5A" data-uri="chapter06.xhtml#P7000497027000000000000000043F5A">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th colspan="13" id="P7000497027000000000000000043F5B" data-uri="chapter06.xhtml#P7000497027000000000000000043F5B" class="calibre18 pcalibre pcalibre1">2-way set associative cache</th>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<th rowspan="2" id="P7000497027000000000000000043F5C" data-uri="chapter06.xhtml#P7000497027000000000000000043F5C" class="calibre18 pcalibre pcalibre1">Set index</th>
<th colspan="6" id="P7000497027000000000000000043F5D" data-uri="chapter06.xhtml#P7000497027000000000000000043F5D" class="calibre18 pcalibre pcalibre1">Line 0</th>
<th colspan="6" id="P7000497027000000000000000043F5E" data-uri="chapter06.xhtml#P7000497027000000000000000043F5E" class="calibre18 pcalibre pcalibre1">Line 1</th>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<th id="P7000497027000000000000000043F5F" data-uri="chapter06.xhtml#P7000497027000000000000000043F5F" class="calibre18 pcalibre pcalibre1">Tag</th>
<th id="P7000497027000000000000000043F60" data-uri="chapter06.xhtml#P7000497027000000000000000043F60" class="calibre18 pcalibre pcalibre1">Valid</th>
<th id="P7000497027000000000000000043F61" data-uri="chapter06.xhtml#P7000497027000000000000000043F61" class="calibre18 pcalibre pcalibre1">Byte 0</th>
<th id="P7000497027000000000000000043F62" data-uri="chapter06.xhtml#P7000497027000000000000000043F62" class="calibre18 pcalibre pcalibre1">Byte 1</th>
<th id="P7000497027000000000000000043F63" data-uri="chapter06.xhtml#P7000497027000000000000000043F63" class="calibre18 pcalibre pcalibre1">Byte 2</th>
<th id="P7000497027000000000000000043F64" data-uri="chapter06.xhtml#P7000497027000000000000000043F64" class="calibre18 pcalibre pcalibre1">Byte 3</th>
<th id="P7000497027000000000000000043F65" data-uri="chapter06.xhtml#P7000497027000000000000000043F65" class="calibre18 pcalibre pcalibre1">Tag</th>
<th id="P7000497027000000000000000043F66" data-uri="chapter06.xhtml#P7000497027000000000000000043F66" class="calibre18 pcalibre pcalibre1">Valid</th>
<th id="P7000497027000000000000000043F67" data-uri="chapter06.xhtml#P7000497027000000000000000043F67" class="calibre18 pcalibre pcalibre1">Byte 0</th>
<th id="P7000497027000000000000000043F68" data-uri="chapter06.xhtml#P7000497027000000000000000043F68" class="calibre18 pcalibre pcalibre1">Byte 1</th>
<th id="P7000497027000000000000000043F69" data-uri="chapter06.xhtml#P7000497027000000000000000043F69" class="calibre18 pcalibre pcalibre1">Byte 2</th>
<th id="P7000497027000000000000000043F6A" data-uri="chapter06.xhtml#P7000497027000000000000000043F6A" class="calibre18 pcalibre pcalibre1">Byte 3</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043F6B" data-uri="chapter06.xhtml#P7000497027000000000000000043F6B" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043F6C" data-uri="chapter06.xhtml#P7000497027000000000000000043F6C" class="calibre20 pcalibre pcalibre1">09</td>
<td id="P7000497027000000000000000043F6D" data-uri="chapter06.xhtml#P7000497027000000000000000043F6D" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043F6E" data-uri="chapter06.xhtml#P7000497027000000000000000043F6E" class="calibre20 pcalibre pcalibre1">86</td>
<td id="P7000497027000000000000000043F6F" data-uri="chapter06.xhtml#P7000497027000000000000000043F6F" class="calibre20 pcalibre pcalibre1">30</td>
<td id="P7000497027000000000000000043F70" data-uri="chapter06.xhtml#P7000497027000000000000000043F70" class="calibre20 pcalibre pcalibre1">3F</td>
<td id="P7000497027000000000000000043F71" data-uri="chapter06.xhtml#P7000497027000000000000000043F71" class="calibre20 pcalibre pcalibre1">10</td>
<td id="P7000497027000000000000000043F72" data-uri="chapter06.xhtml#P7000497027000000000000000043F72" class="calibre20 pcalibre pcalibre1">00</td>
<td id="P7000497027000000000000000043F73" data-uri="chapter06.xhtml#P7000497027000000000000000043F73" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043F74" data-uri="chapter06.xhtml#P7000497027000000000000000043F74" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043F75" data-uri="chapter06.xhtml#P7000497027000000000000000043F75" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043F76" data-uri="chapter06.xhtml#P7000497027000000000000000043F76" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043F77" data-uri="chapter06.xhtml#P7000497027000000000000000043F77" class="calibre20 pcalibre pcalibre1">—</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043F78" data-uri="chapter06.xhtml#P7000497027000000000000000043F78" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043F79" data-uri="chapter06.xhtml#P7000497027000000000000000043F79" class="calibre20 pcalibre pcalibre1">45</td>
<td id="P7000497027000000000000000043F7A" data-uri="chapter06.xhtml#P7000497027000000000000000043F7A" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043F7B" data-uri="chapter06.xhtml#P7000497027000000000000000043F7B" class="calibre20 pcalibre pcalibre1">60</td>
<td id="P7000497027000000000000000043F7C" data-uri="chapter06.xhtml#P7000497027000000000000000043F7C" class="calibre20 pcalibre pcalibre1">4F</td>
<td id="P7000497027000000000000000043F7D" data-uri="chapter06.xhtml#P7000497027000000000000000043F7D" class="calibre20 pcalibre pcalibre1">E0</td>
<td id="P7000497027000000000000000043F7E" data-uri="chapter06.xhtml#P7000497027000000000000000043F7E" class="calibre20 pcalibre pcalibre1">23</td>
<td id="P7000497027000000000000000043F7F" data-uri="chapter06.xhtml#P7000497027000000000000000043F7F" class="calibre20 pcalibre pcalibre1">38</td>
<td id="P7000497027000000000000000043F80" data-uri="chapter06.xhtml#P7000497027000000000000000043F80" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043F81" data-uri="chapter06.xhtml#P7000497027000000000000000043F81" class="calibre20 pcalibre pcalibre1">00</td>
<td id="P7000497027000000000000000043F82" data-uri="chapter06.xhtml#P7000497027000000000000000043F82" class="calibre20 pcalibre pcalibre1">BC</td>
<td id="P7000497027000000000000000043F83" data-uri="chapter06.xhtml#P7000497027000000000000000043F83" class="calibre20 pcalibre pcalibre1">0B</td>
<td id="P7000497027000000000000000043F84" data-uri="chapter06.xhtml#P7000497027000000000000000043F84" class="calibre20 pcalibre pcalibre1">37</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043F85" data-uri="chapter06.xhtml#P7000497027000000000000000043F85" class="calibre20 pcalibre pcalibre1">2</td>
<td id="P7000497027000000000000000043F86" data-uri="chapter06.xhtml#P7000497027000000000000000043F86" class="calibre20 pcalibre pcalibre1">EB</td>
<td id="P7000497027000000000000000043F87" data-uri="chapter06.xhtml#P7000497027000000000000000043F87" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043F88" data-uri="chapter06.xhtml#P7000497027000000000000000043F88" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043F89" data-uri="chapter06.xhtml#P7000497027000000000000000043F89" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043F8A" data-uri="chapter06.xhtml#P7000497027000000000000000043F8A" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043F8B" data-uri="chapter06.xhtml#P7000497027000000000000000043F8B" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043F8C" data-uri="chapter06.xhtml#P7000497027000000000000000043F8C" class="calibre20 pcalibre pcalibre1">0B</td>
<td id="P7000497027000000000000000043F8D" data-uri="chapter06.xhtml#P7000497027000000000000000043F8D" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043F8E" data-uri="chapter06.xhtml#P7000497027000000000000000043F8E" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043F8F" data-uri="chapter06.xhtml#P7000497027000000000000000043F8F" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043F90" data-uri="chapter06.xhtml#P7000497027000000000000000043F90" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043F91" data-uri="chapter06.xhtml#P7000497027000000000000000043F91" class="calibre20 pcalibre pcalibre1">—</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043F92" data-uri="chapter06.xhtml#P7000497027000000000000000043F92" class="calibre20 pcalibre pcalibre1">3</td>
<td id="P7000497027000000000000000043F93" data-uri="chapter06.xhtml#P7000497027000000000000000043F93" class="calibre20 pcalibre pcalibre1">06</td>
<td id="P7000497027000000000000000043F94" data-uri="chapter06.xhtml#P7000497027000000000000000043F94" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043F95" data-uri="chapter06.xhtml#P7000497027000000000000000043F95" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043F96" data-uri="chapter06.xhtml#P7000497027000000000000000043F96" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043F97" data-uri="chapter06.xhtml#P7000497027000000000000000043F97" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043F98" data-uri="chapter06.xhtml#P7000497027000000000000000043F98" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043F99" data-uri="chapter06.xhtml#P7000497027000000000000000043F99" class="calibre20 pcalibre pcalibre1">32</td>
<td id="P7000497027000000000000000043F9A" data-uri="chapter06.xhtml#P7000497027000000000000000043F9A" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043F9B" data-uri="chapter06.xhtml#P7000497027000000000000000043F9B" class="calibre20 pcalibre pcalibre1">12</td>
<td id="P7000497027000000000000000043F9C" data-uri="chapter06.xhtml#P7000497027000000000000000043F9C" class="calibre20 pcalibre pcalibre1">08</td>
<td id="P7000497027000000000000000043F9D" data-uri="chapter06.xhtml#P7000497027000000000000000043F9D" class="calibre20 pcalibre pcalibre1">7B</td>
<td id="P7000497027000000000000000043F9E" data-uri="chapter06.xhtml#P7000497027000000000000000043F9E" class="calibre20 pcalibre pcalibre1">AD</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043F9F" data-uri="chapter06.xhtml#P7000497027000000000000000043F9F" class="calibre20 pcalibre pcalibre1">4</td>
<td id="P7000497027000000000000000043FA0" data-uri="chapter06.xhtml#P7000497027000000000000000043FA0" class="calibre20 pcalibre pcalibre1">C7</td>
<td id="P7000497027000000000000000043FA1" data-uri="chapter06.xhtml#P7000497027000000000000000043FA1" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043FA2" data-uri="chapter06.xhtml#P7000497027000000000000000043FA2" class="calibre20 pcalibre pcalibre1">06</td>
<td id="P7000497027000000000000000043FA3" data-uri="chapter06.xhtml#P7000497027000000000000000043FA3" class="calibre20 pcalibre pcalibre1">78</td>
<td id="P7000497027000000000000000043FA4" data-uri="chapter06.xhtml#P7000497027000000000000000043FA4" class="calibre20 pcalibre pcalibre1">07</td>
<td id="P7000497027000000000000000043FA5" data-uri="chapter06.xhtml#P7000497027000000000000000043FA5" class="calibre20 pcalibre pcalibre1">C5</td>
<td id="P7000497027000000000000000043FA6" data-uri="chapter06.xhtml#P7000497027000000000000000043FA6" class="calibre20 pcalibre pcalibre1">05</td>
<td id="P7000497027000000000000000043FA7" data-uri="chapter06.xhtml#P7000497027000000000000000043FA7" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043FA8" data-uri="chapter06.xhtml#P7000497027000000000000000043FA8" class="calibre20 pcalibre pcalibre1">40</td>
<td id="P7000497027000000000000000043FA9" data-uri="chapter06.xhtml#P7000497027000000000000000043FA9" class="calibre20 pcalibre pcalibre1">67</td>
<td id="P7000497027000000000000000043FAA" data-uri="chapter06.xhtml#P7000497027000000000000000043FAA" class="calibre20 pcalibre pcalibre1">C2</td>
<td id="P7000497027000000000000000043FAB" data-uri="chapter06.xhtml#P7000497027000000000000000043FAB" class="calibre20 pcalibre pcalibre1">3B</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043FAC" data-uri="chapter06.xhtml#P7000497027000000000000000043FAC" class="calibre20 pcalibre pcalibre1">5</td>
<td id="P7000497027000000000000000043FAD" data-uri="chapter06.xhtml#P7000497027000000000000000043FAD" class="calibre20 pcalibre pcalibre1">71</td>
<td id="P7000497027000000000000000043FAE" data-uri="chapter06.xhtml#P7000497027000000000000000043FAE" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043FAF" data-uri="chapter06.xhtml#P7000497027000000000000000043FAF" class="calibre20 pcalibre pcalibre1">OB</td>
<td id="P7000497027000000000000000043FB0" data-uri="chapter06.xhtml#P7000497027000000000000000043FB0" class="calibre20 pcalibre pcalibre1">DE</td>
<td id="P7000497027000000000000000043FB1" data-uri="chapter06.xhtml#P7000497027000000000000000043FB1" class="calibre20 pcalibre pcalibre1">18</td>
<td id="P7000497027000000000000000043FB2" data-uri="chapter06.xhtml#P7000497027000000000000000043FB2" class="calibre20 pcalibre pcalibre1">4B</td>
<td id="P7000497027000000000000000043FB3" data-uri="chapter06.xhtml#P7000497027000000000000000043FB3" class="calibre20 pcalibre pcalibre1">6E</td>
<td id="P7000497027000000000000000043FB4" data-uri="chapter06.xhtml#P7000497027000000000000000043FB4" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043FB5" data-uri="chapter06.xhtml#P7000497027000000000000000043FB5" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043FB6" data-uri="chapter06.xhtml#P7000497027000000000000000043FB6" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043FB7" data-uri="chapter06.xhtml#P7000497027000000000000000043FB7" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043FB8" data-uri="chapter06.xhtml#P7000497027000000000000000043FB8" class="calibre20 pcalibre pcalibre1">—</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043FB9" data-uri="chapter06.xhtml#P7000497027000000000000000043FB9" class="calibre20 pcalibre pcalibre1">6</td>
<td id="P7000497027000000000000000043FBA" data-uri="chapter06.xhtml#P7000497027000000000000000043FBA" class="calibre20 pcalibre pcalibre1">91</td>
<td id="P7000497027000000000000000043FBB" data-uri="chapter06.xhtml#P7000497027000000000000000043FBB" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043FBC" data-uri="chapter06.xhtml#P7000497027000000000000000043FBC" class="calibre20 pcalibre pcalibre1">A0</td>
<td id="P7000497027000000000000000043FBD" data-uri="chapter06.xhtml#P7000497027000000000000000043FBD" class="calibre20 pcalibre pcalibre1">B7</td>
<td id="P7000497027000000000000000043FBE" data-uri="chapter06.xhtml#P7000497027000000000000000043FBE" class="calibre20 pcalibre pcalibre1">26</td>
<td id="P7000497027000000000000000043FBF" data-uri="chapter06.xhtml#P7000497027000000000000000043FBF" class="calibre20 pcalibre pcalibre1">2D</td>
<td id="P7000497027000000000000000043FC0" data-uri="chapter06.xhtml#P7000497027000000000000000043FC0" class="calibre20 pcalibre pcalibre1">F0</td>
<td id="P7000497027000000000000000043FC1" data-uri="chapter06.xhtml#P7000497027000000000000000043FC1" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043FC2" data-uri="chapter06.xhtml#P7000497027000000000000000043FC2" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043FC3" data-uri="chapter06.xhtml#P7000497027000000000000000043FC3" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043FC4" data-uri="chapter06.xhtml#P7000497027000000000000000043FC4" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043FC5" data-uri="chapter06.xhtml#P7000497027000000000000000043FC5" class="calibre20 pcalibre pcalibre1">—</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043FC6" data-uri="chapter06.xhtml#P7000497027000000000000000043FC6" class="calibre20 pcalibre pcalibre1">7</td>
<td id="P7000497027000000000000000043FC7" data-uri="chapter06.xhtml#P7000497027000000000000000043FC7" class="calibre20 pcalibre pcalibre1">46</td>
<td id="P7000497027000000000000000043FC8" data-uri="chapter06.xhtml#P7000497027000000000000000043FC8" class="calibre20 pcalibre pcalibre1">0</td>
<td id="P7000497027000000000000000043FC9" data-uri="chapter06.xhtml#P7000497027000000000000000043FC9" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043FCA" data-uri="chapter06.xhtml#P7000497027000000000000000043FCA" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043FCB" data-uri="chapter06.xhtml#P7000497027000000000000000043FCB" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043FCC" data-uri="chapter06.xhtml#P7000497027000000000000000043FCC" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000043FCD" data-uri="chapter06.xhtml#P7000497027000000000000000043FCD" class="calibre20 pcalibre pcalibre1">DE</td>
<td id="P7000497027000000000000000043FCE" data-uri="chapter06.xhtml#P7000497027000000000000000043FCE" class="calibre20 pcalibre pcalibre1">1</td>
<td id="P7000497027000000000000000043FCF" data-uri="chapter06.xhtml#P7000497027000000000000000043FCF" class="calibre20 pcalibre pcalibre1">12</td>
<td id="P7000497027000000000000000043FD0" data-uri="chapter06.xhtml#P7000497027000000000000000043FD0" class="calibre20 pcalibre pcalibre1">CO</td>
<td id="P7000497027000000000000000043FD1" data-uri="chapter06.xhtml#P7000497027000000000000000043FD1" class="calibre20 pcalibre pcalibre1">88</td>
<td id="P7000497027000000000000000043FD2" data-uri="chapter06.xhtml#P7000497027000000000000000043FD2" class="calibre20 pcalibre pcalibre1">37</td>
</tr>
</tbody>
</table>
<p id="P7000497027000000000000000043FD3" data-uri="chapter06.xhtml#P7000497027000000000000000043FD3" class="pcalibre calibre3 pcalibre1">The following figure shows the format of an address (1 bit per box). Indicate (by labeling the diagram) the fields that would be used to determine the following:</p>
<ul class="pcalibre ul_none pcalibre1" id="P7000497027000000000000000043FD4" data-uri="chapter06.xhtml#P7000497027000000000000000043FD4">
<li id="P7000497027000000000000000043FD5" data-uri="chapter06.xhtml#P7000497027000000000000000043FD5" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043FD6" data-uri="chapter06.xhtml#P7000497027000000000000000043FD6" class="calibre13 pcalibre pcalibre1">CO. The cache block offset</p></li>
<li id="P7000497027000000000000000043FD7" data-uri="chapter06.xhtml#P7000497027000000000000000043FD7" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043FD8" data-uri="chapter06.xhtml#P7000497027000000000000000043FD8" class="calibre13 pcalibre pcalibre1">CI. The cache set index</p></li>
<li id="P7000497027000000000000000043FD9" data-uri="chapter06.xhtml#P7000497027000000000000000043FD9" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043FDA" data-uri="chapter06.xhtml#P7000497027000000000000000043FDA" class="calibre13 pcalibre pcalibre1">CT. The cache tag</p></li>
</ul>
<figure class="pcalibre5 figure pcalibre" id="P7000497027000000000000000005863" data-uri="chapter06.xhtml#P7000497027000000000000000005863">
<img alt="A diagram has a row of boxes numbered 12 to 0 from left to right." id="P7000497027000000000000000043FDB" data-uri="P700049702700000000000000000B744" src="../images/p628-1.png" class="pcalibre1 pcalibre calibre220"/>
</figure></div></li>
</ol>
</section>
<section id="P7000497027000000000000000005865" data-uri="chapter06.xhtml#P7000497027000000000000000005865" epub:type="practice" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title10 pcalibre pcalibre1" id="P7000497027000000000000000043FDC" data-uri="chapter06.xhtml#P7000497027000000000000000043FDC" epub:type="title"><span class="pcalibre label pcalibre1">Practice Problem </span><span class="pcalibre label pcalibre1">6.13 </span>(solution page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP7000497027000000000000000005E52.xhtml#P7000497027000000000000000005EED">664</a>)</h1></header>
<ol class="practicelist pcalibre pcalibre1" id="P7000497027000000000000000043FDD" data-uri="chapter06.xhtml#P7000497027000000000000000043FDD">
<li class="general-problem pcalibre pcalibre1" id="P7000497027000000000000000043FDE" data-uri="chapter06.xhtml#P7000497027000000000000000043FDE">
<div class="edition pcalibre pcalibre1" id="P7000497027000000000000000043FDF" data-uri="chapter06.xhtml#P7000497027000000000000000043FDF"><p id="P7000497027000000000000000043FE0" data-uri="chapter06.xhtml#P7000497027000000000000000043FE0" class="pcalibre calibre3 pcalibre1">Suppose a program running on the machine in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P70004970270000000000000000057D2"><span class="pcalibre label pcalibre1">Problem </span><span class="pcalibre label pcalibre1">6.12</span></a> references the 1-byte word at address <code id="P7000497027000000000000000043FE1" data-uri="chapter06.xhtml#P7000497027000000000000000043FE1" class="pcalibre1 calibre8 pcalibre">0x0E34</code>. Indicate the cache entry accessed and the cache byte <span class="pcalibre pagebreak pcalibre1" id="P700049702700000000000000000586C" title="629" data-uri="chapter06.xhtml#P700049702700000000000000000586C" epub:type="pagebreak"></span>value returned in hexadecimal notation. Indicate whether a cache miss occurs. If there is a cache miss, enter "—" for "Cache byte returned."</p>
<ol class="pcalibre ol_upper-alpha pcalibre1" id="P7000497027000000000000000043FE2" data-uri="chapter06.xhtml#P7000497027000000000000000043FE2">
<li id="P7000497027000000000000000043FE3" data-uri="chapter06.xhtml#P7000497027000000000000000043FE3" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043FE4" data-uri="chapter06.xhtml#P7000497027000000000000000043FE4" class="pcalibre calibre3 pcalibre1">Address format (1 bit per box):</p>
<figure class="pcalibre5 figure pcalibre" id="P7000497027000000000000000005870" data-uri="chapter06.xhtml#P7000497027000000000000000005870">
<img alt="A diagram has a row of boxes numbered 12 to 0 from left to right." id="P7000497027000000000000000043FE5" data-uri="P700049702700000000000000000B745" src="../images/p629-1.png" class="pcalibre1 pcalibre calibre220"/>
</figure></li>
<li id="P7000497027000000000000000043FE6" data-uri="chapter06.xhtml#P7000497027000000000000000043FE6" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000043FE7" data-uri="chapter06.xhtml#P7000497027000000000000000043FE7" class="pcalibre calibre3 pcalibre1"><span class="pcalibre pagebreak pcalibre1" id="P7000497027000000000000000005874" title="630" data-uri="chapter06.xhtml#P7000497027000000000000000005874" epub:type="pagebreak"></span>Memory reference:</p>
<table id="P7000497027000000000000000043FE8" data-uri="chapter06.xhtml#P7000497027000000000000000043FE8" class="pcalibre largetable pcalibre1">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P7000497027000000000000000043FE9" data-uri="chapter06.xhtml#P7000497027000000000000000043FE9" class="calibre18 pcalibre pcalibre1">Parameter</th>
<th id="P7000497027000000000000000043FEA" data-uri="chapter06.xhtml#P7000497027000000000000000043FEA" class="calibre18 pcalibre pcalibre1">Value</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043FEB" data-uri="chapter06.xhtml#P7000497027000000000000000043FEB" class="calibre20 pcalibre pcalibre1">Cache block offset (CO)</td>
<td id="P7000497027000000000000000043FEC" data-uri="chapter06.xhtml#P7000497027000000000000000043FEC" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043FED" data-uri="chapter06.xhtml#P7000497027000000000000000043FED" class="calibre10 pcalibre pcalibre1">0x</code>_____</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043FEE" data-uri="chapter06.xhtml#P7000497027000000000000000043FEE" class="calibre20 pcalibre pcalibre1">Cache set index (CI)</td>
<td id="P7000497027000000000000000043FEF" data-uri="chapter06.xhtml#P7000497027000000000000000043FEF" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043FF0" data-uri="chapter06.xhtml#P7000497027000000000000000043FF0" class="calibre10 pcalibre pcalibre1">0x</code>_____</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043FF1" data-uri="chapter06.xhtml#P7000497027000000000000000043FF1" class="calibre20 pcalibre pcalibre1">Cache tag (CT)</td>
<td id="P7000497027000000000000000043FF2" data-uri="chapter06.xhtml#P7000497027000000000000000043FF2" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043FF3" data-uri="chapter06.xhtml#P7000497027000000000000000043FF3" class="calibre10 pcalibre pcalibre1">0x</code>_____</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043FF4" data-uri="chapter06.xhtml#P7000497027000000000000000043FF4" class="calibre20 pcalibre pcalibre1">Cache hit? (Y/N)</td>
<td id="P7000497027000000000000000043FF5" data-uri="chapter06.xhtml#P7000497027000000000000000043FF5" class="calibre20 pcalibre pcalibre1">_____</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000043FF6" data-uri="chapter06.xhtml#P7000497027000000000000000043FF6" class="calibre20 pcalibre pcalibre1">Cache byte returned</td>
<td id="P7000497027000000000000000043FF7" data-uri="chapter06.xhtml#P7000497027000000000000000043FF7" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000043FF8" data-uri="chapter06.xhtml#P7000497027000000000000000043FF8" class="calibre10 pcalibre pcalibre1">0x</code>_____</td>
</tr>
</tbody>
</table>
</li></ol>
</div></li>
</ol>
</section>
<section id="P7000497027000000000000000005886" data-uri="chapter06.xhtml#P7000497027000000000000000005886" epub:type="practice" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title10 pcalibre pcalibre1" id="P7000497027000000000000000043FF9" data-uri="chapter06.xhtml#P7000497027000000000000000043FF9" epub:type="title"><span class="pcalibre label pcalibre1">Practice Problem </span><span class="pcalibre label pcalibre1">6.14 </span>(solution page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP7000497027000000000000000005E52.xhtml#P7000497027000000000000000005EED">664</a>)</h1></header>
<ol class="practicelist pcalibre pcalibre1" id="P7000497027000000000000000043FFA" data-uri="chapter06.xhtml#P7000497027000000000000000043FFA">
<li class="general-problem pcalibre pcalibre1" id="P7000497027000000000000000043FFB" data-uri="chapter06.xhtml#P7000497027000000000000000043FFB">
<div class="edition pcalibre pcalibre1" id="P7000497027000000000000000043FFC" data-uri="chapter06.xhtml#P7000497027000000000000000043FFC"><p id="P7000497027000000000000000043FFD" data-uri="chapter06.xhtml#P7000497027000000000000000043FFD" class="pcalibre calibre3 pcalibre1">Repeat <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000005865"><span class="pcalibre label pcalibre1">Problem </span><span class="pcalibre label pcalibre1">6.13</span></a> for memory address <code id="P7000497027000000000000000043FFE" data-uri="chapter06.xhtml#P7000497027000000000000000043FFE" class="pcalibre1 calibre8 pcalibre">0x0DD5</code>.</p>
<ol class="pcalibre ol_upper-alpha pcalibre1" id="P7000497027000000000000000043FFF" data-uri="chapter06.xhtml#P7000497027000000000000000043FFF">
<li id="P7000497027000000000000000044000" data-uri="chapter06.xhtml#P7000497027000000000000000044000" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000044001" data-uri="chapter06.xhtml#P7000497027000000000000000044001" class="pcalibre calibre3 pcalibre1">Address format (1 bit per box):</p>
<figure class="pcalibre5 figure pcalibre" id="P7000497027000000000000000044002" data-uri="chapter06.xhtml#P7000497027000000000000000044002">
<img alt="A diagram has a row of boxes numbered 12 to 0 from left to right." id="P7000497027000000000000000044003" data-uri="P700049702700000000000000000B745" src="../images/p629-1.png" class="pcalibre1 pcalibre calibre220"/>
</figure></li>
<li id="P7000497027000000000000000044004" data-uri="chapter06.xhtml#P7000497027000000000000000044004" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000044005" data-uri="chapter06.xhtml#P7000497027000000000000000044005" class="pcalibre calibre3 pcalibre1">Memory reference:</p>
<table class="informaltable pcalibre pcalibre1" id="P7000497027000000000000000044006" data-uri="chapter06.xhtml#P7000497027000000000000000044006">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P7000497027000000000000000044007" data-uri="chapter06.xhtml#P7000497027000000000000000044007" class="calibre18 pcalibre pcalibre1">Parameter</th>
<th id="P7000497027000000000000000044008" data-uri="chapter06.xhtml#P7000497027000000000000000044008" class="calibre18 pcalibre pcalibre1">Value</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000044009" data-uri="chapter06.xhtml#P7000497027000000000000000044009" class="calibre20 pcalibre pcalibre1">Cache block offset (CO)</td>
<td id="P700049702700000000000000004400A" data-uri="chapter06.xhtml#P700049702700000000000000004400A" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004400B" data-uri="chapter06.xhtml#P700049702700000000000000004400B" class="calibre10 pcalibre pcalibre1">0x</code>_____</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P700049702700000000000000004400C" data-uri="chapter06.xhtml#P700049702700000000000000004400C" class="calibre20 pcalibre pcalibre1">Cache set index (CI)</td>
<td id="P700049702700000000000000004400D" data-uri="chapter06.xhtml#P700049702700000000000000004400D" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004400E" data-uri="chapter06.xhtml#P700049702700000000000000004400E" class="calibre10 pcalibre pcalibre1">0x</code>_____</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P700049702700000000000000004400F" data-uri="chapter06.xhtml#P700049702700000000000000004400F" class="calibre20 pcalibre pcalibre1">Cache tag (CT)</td>
<td id="P7000497027000000000000000044010" data-uri="chapter06.xhtml#P7000497027000000000000000044010" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000044011" data-uri="chapter06.xhtml#P7000497027000000000000000044011" class="calibre10 pcalibre pcalibre1">0x</code>_____</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000044012" data-uri="chapter06.xhtml#P7000497027000000000000000044012" class="calibre20 pcalibre pcalibre1">Cache hit? (Y/N)</td>
<td id="P7000497027000000000000000044013" data-uri="chapter06.xhtml#P7000497027000000000000000044013" class="calibre20 pcalibre pcalibre1">_____</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000044014" data-uri="chapter06.xhtml#P7000497027000000000000000044014" class="calibre20 pcalibre pcalibre1">Cache byte returned</td>
<td id="P7000497027000000000000000044015" data-uri="chapter06.xhtml#P7000497027000000000000000044015" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000044016" data-uri="chapter06.xhtml#P7000497027000000000000000044016" class="calibre10 pcalibre pcalibre1">0x</code>_____</td>
</tr>
</tbody>
</table>
</li></ol>
</div></li>
</ol>
</section>
<section id="P70004970270000000000000000058A5" data-uri="chapter06.xhtml#P70004970270000000000000000058A5" epub:type="practice" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title10 pcalibre pcalibre1" id="P7000497027000000000000000044017" data-uri="chapter06.xhtml#P7000497027000000000000000044017" epub:type="title"><span class="pcalibre label pcalibre1">Practice Problem </span><span class="pcalibre label pcalibre1">6.15 </span>(solution page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP7000497027000000000000000005E52.xhtml#P7000497027000000000000000005EED">664</a>)</h1></header>
<ol class="practicelist pcalibre pcalibre1" id="P7000497027000000000000000044018" data-uri="chapter06.xhtml#P7000497027000000000000000044018">
<li class="general-problem pcalibre pcalibre1" id="P7000497027000000000000000044019" data-uri="chapter06.xhtml#P7000497027000000000000000044019">
<div class="edition pcalibre pcalibre1" id="P700049702700000000000000004401A" data-uri="chapter06.xhtml#P700049702700000000000000004401A"><p id="P700049702700000000000000004401B" data-uri="chapter06.xhtml#P700049702700000000000000004401B" class="pcalibre calibre3 pcalibre1">Repeat <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P7000497027000000000000000005865"><span class="pcalibre label pcalibre1">Problem </span><span class="pcalibre label pcalibre1">6.13</span></a> for memory address <code id="P700049702700000000000000004401C" data-uri="chapter06.xhtml#P700049702700000000000000004401C" class="pcalibre1 calibre8 pcalibre">0x1FE4</code>.</p>
<ol class="pcalibre ol_upper-alpha pcalibre1" id="P700049702700000000000000004401D" data-uri="chapter06.xhtml#P700049702700000000000000004401D">
<li id="P700049702700000000000000004401E" data-uri="chapter06.xhtml#P700049702700000000000000004401E" class="calibre12 pcalibre pcalibre1"><p id="P700049702700000000000000004401F" data-uri="chapter06.xhtml#P700049702700000000000000004401F" class="pcalibre calibre3 pcalibre1">Address format (1 bit per box):</p>
<figure class="pcalibre5 figure pcalibre" id="P7000497027000000000000000044020" data-uri="chapter06.xhtml#P7000497027000000000000000044020">
<img alt="A diagram has a row of boxes numbered 12 to 0 from left to right." id="P7000497027000000000000000044021" data-uri="P700049702700000000000000000B746" src="../images/p629-2.png" class="pcalibre1 pcalibre calibre220"/>
</figure></li>
<li id="P7000497027000000000000000044022" data-uri="chapter06.xhtml#P7000497027000000000000000044022" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000044023" data-uri="chapter06.xhtml#P7000497027000000000000000044023" class="pcalibre calibre3 pcalibre1">Memory reference:</p>
<table id="P7000497027000000000000000044024" data-uri="chapter06.xhtml#P7000497027000000000000000044024" class="pcalibre largetable pcalibre1">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P7000497027000000000000000044025" data-uri="chapter06.xhtml#P7000497027000000000000000044025" class="calibre18 pcalibre pcalibre1">Parameter</th>
<th id="P7000497027000000000000000044026" data-uri="chapter06.xhtml#P7000497027000000000000000044026" class="calibre18 pcalibre pcalibre1">Value</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000044027" data-uri="chapter06.xhtml#P7000497027000000000000000044027" class="calibre20 pcalibre pcalibre1">Cache block offset (CO)</td>
<td id="P7000497027000000000000000044028" data-uri="chapter06.xhtml#P7000497027000000000000000044028" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000044029" data-uri="chapter06.xhtml#P7000497027000000000000000044029" class="calibre10 pcalibre pcalibre1">0x</code>_____</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P700049702700000000000000004402A" data-uri="chapter06.xhtml#P700049702700000000000000004402A" class="calibre20 pcalibre pcalibre1">Cache set index (CI)</td>
<td id="P700049702700000000000000004402B" data-uri="chapter06.xhtml#P700049702700000000000000004402B" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004402C" data-uri="chapter06.xhtml#P700049702700000000000000004402C" class="calibre10 pcalibre pcalibre1">0x</code>_____</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P700049702700000000000000004402D" data-uri="chapter06.xhtml#P700049702700000000000000004402D" class="calibre20 pcalibre pcalibre1">Cache tag (CT)</td>
<td id="P700049702700000000000000004402E" data-uri="chapter06.xhtml#P700049702700000000000000004402E" class="calibre20 pcalibre pcalibre1"><code id="P700049702700000000000000004402F" data-uri="chapter06.xhtml#P700049702700000000000000004402F" class="calibre10 pcalibre pcalibre1">0x</code>_____</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000044030" data-uri="chapter06.xhtml#P7000497027000000000000000044030" class="calibre20 pcalibre pcalibre1">Cache hit? (Y/N)</td>
<td id="P7000497027000000000000000044031" data-uri="chapter06.xhtml#P7000497027000000000000000044031" class="calibre20 pcalibre pcalibre1">_____</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000044032" data-uri="chapter06.xhtml#P7000497027000000000000000044032" class="calibre20 pcalibre pcalibre1">Cache byte returned</td>
<td id="P7000497027000000000000000044033" data-uri="chapter06.xhtml#P7000497027000000000000000044033" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000044034" data-uri="chapter06.xhtml#P7000497027000000000000000044034" class="calibre10 pcalibre pcalibre1">0x</code>_____</td>
</tr>
</tbody>
</table></li>
</ol></div></li>
</ol>
</section>
<section id="P70004970270000000000000000058C4" data-uri="chapter06.xhtml#P70004970270000000000000000058C4" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title10 pcalibre pcalibre1" id="P7000497027000000000000000044035" data-uri="chapter06.xhtml#P7000497027000000000000000044035" epub:type="title"><span class="pcalibre label pcalibre1">Practice Problem </span><span class="pcalibre label pcalibre1">6.16 </span>(solution page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP7000497027000000000000000005E52.xhtml#P7000497027000000000000000005F33">665</a>)</h1></header>
<p id="P7000497027000000000000000044036" data-uri="chapter06.xhtml#P7000497027000000000000000044036" class="pcalibre1 pcalibre calibre2">For the cache in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P70004970270000000000000000057D2"><span class="pcalibre label pcalibre1">Problem </span><span class="pcalibre label pcalibre1">6.12</span></a>, list all of the hexadecimal memory addresses that will hit in set 3.</p>
</section>
</section>
</section>
<section id="P70004970270000000000000000058C7" data-uri="chapter06.xhtml#P70004970270000000000000000058C7" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P7000497027000000000000000044037" data-uri="chapter06.xhtml#P7000497027000000000000000044037" epub:type="title"><span class="pcalibre label pcalibre1">6.4.5 </span>Issues with Writes</h1></header>
<p id="P7000497027000000000000000044038" data-uri="chapter06.xhtml#P7000497027000000000000000044038" class="pcalibre1 pcalibre calibre2">As we have seen, the operation of a cache with respect to reads is straightforward. First, look for a copy of the desired word <var class="calibre5 pcalibre pcalibre1">w</var> in the cache. If there is a hit, return <var class="calibre5 pcalibre pcalibre1">w</var> immediately. If there is a miss, fetch the block that contains <var class="calibre5 pcalibre pcalibre1">w</var> from the next lower level of the memory hierarchy, store the block in some cache line (possibly evicting a valid line), and then return <i class="calibre5 pcalibre pcalibre1">w.</i></p>
<p id="P7000497027000000000000000044039" data-uri="chapter06.xhtml#P7000497027000000000000000044039" class="pcalibre1 pcalibre calibre2">The situation for writes is a little more complicated. Suppose we write a word <var class="calibre5 pcalibre pcalibre1">w</var> that is already cached (a <i class="calibre5 pcalibre pcalibre1">write hit).</i> After the cache updates its copy of <var class="calibre5 pcalibre pcalibre1">w</var>, what does it do about updating the copy of <var class="calibre5 pcalibre pcalibre1">w</var> in the next lower level of the hierarchy? The simplest approach, known as <i class="calibre5 pcalibre pcalibre1">write-through</i>, is to immediately write w's cache block to the next lower level. While simple, write-through has the disadvantage of causing bus traffic with every write. Another approach, known as <i class="calibre5 pcalibre pcalibre1">write-back</i>, defers the update as long as possible by writing the updated block to the next lower level only when it is evicted from the cache by the replacement algorithm. Because of locality, write-back can significantly reduce the amount of bus traffic, but it has the disadvantage of additional complexity. The cache must maintain an additional <i class="calibre5 pcalibre pcalibre1">dirty bit</i> for each cache line that indicates whether or not the cache block has been modified.</p>
<p id="P700049702700000000000000004403A" data-uri="chapter06.xhtml#P700049702700000000000000004403A" class="pcalibre1 pcalibre calibre2">Another issue is how to deal with write misses. One approach, known as <i class="calibre5 pcalibre pcalibre1">write-allocate</i>, loads the corresponding block from the next lower level into the cache and then updates the cache block. Write-allocate tries to exploit spatial locality of writes, but it has the disadvantage that every miss results in a block transfer from the next lower level to the cache. The alternative, known as <i class="calibre5 pcalibre pcalibre1">no-write-allocate</i>, bypasses the cache and writes the word directly to the next lower level. Write-through caches are typically no-write-allocate. Write-back caches are typically write-allocate.</p>
<p id="P700049702700000000000000004403B" data-uri="chapter06.xhtml#P700049702700000000000000004403B" class="pcalibre1 pcalibre calibre2">Optimizing caches for writes is a subtle and difficult issue, and we are only scratching the surface here. The details vary from system to system and are often proprietary and poorly documented. To the programmer trying to write reasonably <span class="pcalibre pagebreak pcalibre1" id="P70004970270000000000000000058CD" title="631" data-uri="chapter06.xhtml#P70004970270000000000000000058CD" epub:type="pagebreak"></span>cache-friendly programs, we suggest adopting a mental model that assumes write-back, write-allocate caches. There are several reasons for this suggestion: As a rule, caches at lower levels of the memory hierarchy are more likely to use write-back instead of write-through because of the larger transfer times. For example, virtual memory systems (which use main memory as a cache for the blocks stored on disk) use write-back exclusively. But as logic densities increase, the increased complexity of write-back is becoming less of an impediment and we are seeing write-back caches at all levels of modern systems. So this assumption matches current trends. Another reason for assuming a write-back, write-allocate approach is that it is symmetric to the way reads are handled, in that write-back write-allocate tries to exploit locality. Thus, we can develop our programs at a high level to exhibit good spatial and temporal locality rather than trying to optimize for a particular memory system.</p>
</section>
<section id="P70004970270000000000000000058CE" data-uri="chapter06.xhtml#P70004970270000000000000000058CE" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P700049702700000000000000004403C" data-uri="chapter06.xhtml#P700049702700000000000000004403C" epub:type="title"><span class="pcalibre label pcalibre1">6.4.6 </span>Anatomy of a Real Cache Hierarchy</h1></header>
<p id="P700049702700000000000000004403D" data-uri="chapter06.xhtml#P700049702700000000000000004403D" class="pcalibre1 pcalibre calibre2">So far, we have assumed that caches hold only program data. But, in fact, caches can hold instructions as well as data. A cache that holds instructions only is called an <i class="calibre5 pcalibre pcalibre1">i-cache.</i> A cache that holds program data only is called a <i class="calibre5 pcalibre pcalibre1">d-cache.</i> A cache that holds both instructions and data is known as a <i class="calibre5 pcalibre pcalibre1">unified cache.</i> Modern processors include separate i-caches and d-caches. There are a number of reasons for this. With two separate caches, the processor can read an instruction word and a data word at the same time. I-caches are typically read-only, and thus simpler. The two caches are often optimized to different access patterns and can have different block sizes, associativities, and capacities. Also, having separate caches ensures that data accesses do not create conflict misses with instruction accesses, and vice versa, at the cost of a potential increase in capacity misses.</p>
<p id="P700049702700000000000000004403E" data-uri="chapter06.xhtml#P700049702700000000000000004403E" class="pcalibre1 pcalibre calibre2"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P70004970270000000000000000058DD"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">6.38</span></a> shows the cache hierarchy for the Intel Core i7 processor. Each CPU chip has four cores. Each core has its own private L1 i-cache, L1 d-cache, and L2 unified cache. All of the cores share an on-chip L3 unified cache. An interesting feature of this hierarchy is that all of the SRAM cache memories are contained in the CPU chip.</p>
<p id="P700049702700000000000000004403F" data-uri="chapter06.xhtml#P700049702700000000000000004403F" class="pcalibre1 pcalibre calibre2"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="#P70004970270000000000000000058E2"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">6.39</span></a> summarizes the basic characteristics of the Core i7 caches.</p>
</section>
<section id="P70004970270000000000000000058D3" data-uri="chapter06.xhtml#P70004970270000000000000000058D3" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P7000497027000000000000000044040" data-uri="chapter06.xhtml#P7000497027000000000000000044040" epub:type="title"><span class="pcalibre label pcalibre1">6.4.7 </span>Performance Impact of Cache Parameters</h1></header>
<p id="P7000497027000000000000000044041" data-uri="chapter06.xhtml#P7000497027000000000000000044041" class="pcalibre1 pcalibre calibre2">Cache performance is evaluated with a number of metrics:</p>
<ul class="pcalibre ul_none pcalibre1" id="P7000497027000000000000000044042" data-uri="chapter06.xhtml#P7000497027000000000000000044042">
<li id="P7000497027000000000000000044043" data-uri="chapter06.xhtml#P7000497027000000000000000044043" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000044044" data-uri="chapter06.xhtml#P7000497027000000000000000044044" class="calibre13 pcalibre pcalibre1"><span class="pcalibre leadin pcalibre1">Miss rate. </span>The fraction of memory references during the execution of a program, or a part of a program, that miss. It is computed as # <i class="calibre5 pcalibre pcalibre1">misses/</i> # <i class="calibre5 pcalibre pcalibre1">references.</i></p></li>
<li id="P7000497027000000000000000044045" data-uri="chapter06.xhtml#P7000497027000000000000000044045" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000044046" data-uri="chapter06.xhtml#P7000497027000000000000000044046" class="calibre13 pcalibre pcalibre1"><span class="pcalibre leadin pcalibre1">Hit rate. </span>The fraction of memory references that hit. It is computed as 1 − <i class="calibre5 pcalibre pcalibre1">miss rate.</i></p></li>
<li id="P7000497027000000000000000044047" data-uri="chapter06.xhtml#P7000497027000000000000000044047" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000044048" data-uri="chapter06.xhtml#P7000497027000000000000000044048" class="calibre13 pcalibre pcalibre1"><span class="pcalibre leadin pcalibre1">Hit time. </span>The time to deliver a word in the cache to the CPU, including the time for set selection, line identification, and word selection. Hit time is on the order of several clock cycles for L1 caches.</p>
<figure class="pcalibre5 figure pcalibre" id="P70004970270000000000000000058DD" data-uri="chapter06.xhtml#P70004970270000000000000000058DD">
<span class="pcalibre pagebreak pcalibre1" id="P70004970270000000000000000058DE" title="632" data-uri="chapter06.xhtml#P70004970270000000000000000058DE" epub:type="pagebreak"></span>
<img alt="A diagram illustrates an Intel Core I7 cache hierarchy." id="P7000497027000000000000000044049" data-uri="P700049702700000000000000000B749" src="../images/p632-1.png" class="pcalibre calibre221 pcalibre1"/>
<figcaption id="P700049702700000000000000004404A" data-uri="chapter06.xhtml#P700049702700000000000000004404A" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P700049702700000000000000004404B" data-uri="chapter06.xhtml#P700049702700000000000000004404B" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">6.38 </span>Intel Core i7 cache hierarchy.</h1></header>
<details class="longdesc pcalibre pcalibre1" id="P700049702700000000000000002434F" data-uri="chapter06.xhtml#P700049702700000000000000002434F">
<summary class="pcalibre6 pcalibre1 pcalibre calibre30"><span class="number pcalibre pcalibre1">Description</span></summary>
<p id="P700049702700000000000000004404C" data-uri="chapter06.xhtml#P700049702700000000000000004404C" class="calibre13 pcalibre pcalibre1">A hierarchy shows processor package with Core 0 through Core 3 connected to L3 unified cache (shared by all cores), connected to main memory outside the package. Each core has Regs connected to L1 d-cache connected to L2 unified cache, which is also connected to L1 i-cache.</p>
</details>
</figcaption>
</figure>
<figure class="pcalibre5 figure pcalibre" id="P70004970270000000000000000058E2" data-uri="chapter06.xhtml#P70004970270000000000000000058E2">
<table id="P700049702700000000000000004404D" data-uri="chapter06.xhtml#P700049702700000000000000004404D" class="pcalibre largetable pcalibre1">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P700049702700000000000000004404E" data-uri="chapter06.xhtml#P700049702700000000000000004404E" class="calibre18 pcalibre pcalibre1">Cache type</th>
<th id="P700049702700000000000000004404F" data-uri="chapter06.xhtml#P700049702700000000000000004404F" class="calibre18 pcalibre pcalibre1">Access time (cycles)</th>
<th id="P7000497027000000000000000044050" data-uri="chapter06.xhtml#P7000497027000000000000000044050" class="calibre18 pcalibre pcalibre1">Cache size (<var class="calibre5 pcalibre pcalibre1">C</var>)</th>
<th id="P7000497027000000000000000044051" data-uri="chapter06.xhtml#P7000497027000000000000000044051" class="calibre18 pcalibre pcalibre1">Assoc. (<var class="calibre5 pcalibre pcalibre1">E</var>)</th>
<th id="P7000497027000000000000000044052" data-uri="chapter06.xhtml#P7000497027000000000000000044052" class="calibre18 pcalibre pcalibre1">Block size (<var class="calibre5 pcalibre pcalibre1">B</var>)</th>
<th id="P7000497027000000000000000044053" data-uri="chapter06.xhtml#P7000497027000000000000000044053" class="calibre18 pcalibre pcalibre1">Sets (<var class="calibre5 pcalibre pcalibre1">S</var>)</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000044054" data-uri="chapter06.xhtml#P7000497027000000000000000044054" class="calibre20 pcalibre pcalibre1">L1 i-cache</td>
<td id="P7000497027000000000000000044055" data-uri="chapter06.xhtml#P7000497027000000000000000044055" class="calibre20 pcalibre pcalibre1">4</td>
<td id="P7000497027000000000000000044056" data-uri="chapter06.xhtml#P7000497027000000000000000044056" class="calibre20 pcalibre pcalibre1">32 KB</td>
<td id="P7000497027000000000000000044057" data-uri="chapter06.xhtml#P7000497027000000000000000044057" class="calibre20 pcalibre pcalibre1">8</td>
<td id="P7000497027000000000000000044058" data-uri="chapter06.xhtml#P7000497027000000000000000044058" class="calibre20 pcalibre pcalibre1">64 B</td>
<td id="P7000497027000000000000000044059" data-uri="chapter06.xhtml#P7000497027000000000000000044059" class="calibre20 pcalibre pcalibre1">64</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P700049702700000000000000004405A" data-uri="chapter06.xhtml#P700049702700000000000000004405A" class="calibre20 pcalibre pcalibre1">L1 d-cache</td>
<td id="P700049702700000000000000004405B" data-uri="chapter06.xhtml#P700049702700000000000000004405B" class="calibre20 pcalibre pcalibre1">4</td>
<td id="P700049702700000000000000004405C" data-uri="chapter06.xhtml#P700049702700000000000000004405C" class="calibre20 pcalibre pcalibre1">32 KB</td>
<td id="P700049702700000000000000004405D" data-uri="chapter06.xhtml#P700049702700000000000000004405D" class="calibre20 pcalibre pcalibre1">8</td>
<td id="P700049702700000000000000004405E" data-uri="chapter06.xhtml#P700049702700000000000000004405E" class="calibre20 pcalibre pcalibre1">64 B</td>
<td id="P700049702700000000000000004405F" data-uri="chapter06.xhtml#P700049702700000000000000004405F" class="calibre20 pcalibre pcalibre1">64</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000044060" data-uri="chapter06.xhtml#P7000497027000000000000000044060" class="calibre20 pcalibre pcalibre1">L2 unified cache</td>
<td id="P7000497027000000000000000044061" data-uri="chapter06.xhtml#P7000497027000000000000000044061" class="calibre20 pcalibre pcalibre1">10</td>
<td id="P7000497027000000000000000044062" data-uri="chapter06.xhtml#P7000497027000000000000000044062" class="calibre20 pcalibre pcalibre1">256 KB</td>
<td id="P7000497027000000000000000044063" data-uri="chapter06.xhtml#P7000497027000000000000000044063" class="calibre20 pcalibre pcalibre1">8</td>
<td id="P7000497027000000000000000044064" data-uri="chapter06.xhtml#P7000497027000000000000000044064" class="calibre20 pcalibre pcalibre1">64 B</td>
<td id="P7000497027000000000000000044065" data-uri="chapter06.xhtml#P7000497027000000000000000044065" class="calibre20 pcalibre pcalibre1">512</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000044066" data-uri="chapter06.xhtml#P7000497027000000000000000044066" class="calibre20 pcalibre pcalibre1">L3 unified cache</td>
<td id="P7000497027000000000000000044067" data-uri="chapter06.xhtml#P7000497027000000000000000044067" class="calibre20 pcalibre pcalibre1">40−75</td>
<td id="P7000497027000000000000000044068" data-uri="chapter06.xhtml#P7000497027000000000000000044068" class="calibre20 pcalibre pcalibre1">8 MB</td>
<td id="P7000497027000000000000000044069" data-uri="chapter06.xhtml#P7000497027000000000000000044069" class="calibre20 pcalibre pcalibre1">16</td>
<td id="P700049702700000000000000004406A" data-uri="chapter06.xhtml#P700049702700000000000000004406A" class="calibre20 pcalibre pcalibre1">64 B</td>
<td id="P700049702700000000000000004406B" data-uri="chapter06.xhtml#P700049702700000000000000004406B" class="calibre20 pcalibre pcalibre1">8,192</td>
</tr>
</tbody>
</table>
<figcaption id="P700049702700000000000000004406C" data-uri="chapter06.xhtml#P700049702700000000000000004406C" class="calibre11 pcalibre pcalibre1"><header class="pcalibre halftitlepage pcalibre1"><h1 class="title3 pcalibre pcalibre1" id="P700049702700000000000000004406D" data-uri="chapter06.xhtml#P700049702700000000000000004406D" epub:type="title"><span class="pcalibre1 label2 pcalibre">Figure </span><span class="number pcalibre pcalibre1">6.39 </span>Characteristics of the Intel Core i7 cache hierarchy.</h1></header>
</figcaption>
</figure></li>
<li id="P700049702700000000000000004406E" data-uri="chapter06.xhtml#P700049702700000000000000004406E" class="calibre12 pcalibre pcalibre1"><p id="P700049702700000000000000004406F" data-uri="chapter06.xhtml#P700049702700000000000000004406F" class="calibre13 pcalibre pcalibre1"><span class="pcalibre leadin pcalibre1">Miss penalty. </span>Any additional time required because of a miss. The penalty for Ll misses served from L2 is on the order of 10 cycles; from L3,50 cycles; and from main memory, 200 cycles.</p></li>
</ul>
<p id="P7000497027000000000000000044070" data-uri="chapter06.xhtml#P7000497027000000000000000044070" class="pcalibre1 pcalibre calibre2">Optimizing the cost and performance trade-offs of cache memories is a subtle exercise that requires extensive simulation on realistic benchmark codes and thus is beyond our scope. However, it is possible to identify some of the qualitative trade-offs.</p>
<section id="P7000497027000000000000000005907" data-uri="chapter06.xhtml#P7000497027000000000000000005907" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title5 pcalibre pcalibre1" id="P7000497027000000000000000044071" data-uri="chapter06.xhtml#P7000497027000000000000000044071" epub:type="title">Impact of Cache Size</h1></header>
<p id="P7000497027000000000000000044072" data-uri="chapter06.xhtml#P7000497027000000000000000044072" class="pcalibre1 pcalibre calibre2">On the one hand, a larger cache will tend to increase the hit rate. On the other hand, it is always harder to make large memories run faster. As a result, larger caches tend to increase the hit time. This explains why an L1 cache is smaller than an L2 cache, and an L2 cache is smaller than an L3 cache.</p>
</section>
<section id="P700049702700000000000000000590A" data-uri="chapter06.xhtml#P700049702700000000000000000590A" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title5 pcalibre pcalibre1" id="P7000497027000000000000000044073" data-uri="chapter06.xhtml#P7000497027000000000000000044073" epub:type="title"><span class="pcalibre pagebreak pcalibre1" id="P700049702700000000000000000590C" title="633" data-uri="chapter06.xhtml#P700049702700000000000000000590C" epub:type="pagebreak"></span>Impact of Block Size</h1></header>
<p id="P7000497027000000000000000044074" data-uri="chapter06.xhtml#P7000497027000000000000000044074" class="pcalibre1 pcalibre calibre2">Large blocks are a mixed blessing. On the one hand, larger blocks can help increase the hit rate by exploiting any spatial locality that might exist in a program. However, for a given cache size, larger blocks imply a smaller number of cache lines, which can hurt the hit rate in programs with more temporal locality than spatial locality. Larger blocks also have a negative impact on the miss penalty, since larger blocks cause larger transfer times. Modern systems such as the Core i7 compromise with cache blocks that contain 64 bytes.</p>
</section>
<section id="P700049702700000000000000000590E" data-uri="chapter06.xhtml#P700049702700000000000000000590E" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title5 pcalibre pcalibre1" id="P7000497027000000000000000044075" data-uri="chapter06.xhtml#P7000497027000000000000000044075" epub:type="title">Impact of Associativity</h1></header>
<p id="P7000497027000000000000000044076" data-uri="chapter06.xhtml#P7000497027000000000000000044076" class="pcalibre1 pcalibre calibre2">The issue here is the impact of the choice of the parameter <var class="calibre5 pcalibre pcalibre1">E</var>, the number of cache lines per set. The advantage of higher associativity (i.e., larger values of <var class="calibre5 pcalibre pcalibre1">E</var>) is that it decreases the vulnerability of the cache to thrashing due to conflict misses. However, higher associativity comes at a significant cost. Higher associativity is expensive to implement and hard to make fast. It requires more tag bits per line, additional LRU state bits per line, and additional control logic. Higher associativity can increase hit time, because of the increased complexity, and it can also increase the miss penalty because of the increased complexity of choosing a victim line.</p>
<p id="P7000497027000000000000000044077" data-uri="chapter06.xhtml#P7000497027000000000000000044077" class="pcalibre1 pcalibre calibre2">The choice of associativity ultimately boils down to a trade-off between the hit time and the miss penalty. Traditionally, high-performance systems that pushed the clock rates would opt for smaller associativity for L1 caches (where the miss penalty is only a few cycles) and a higher degree of associativity for the lower levels, where the miss penalty is higher. For example, in Intel Core i7 systems, the L1 and L2 caches are 8-way associative, and the L3 cache is 16-way.</p>
</section>
<section id="P7000497027000000000000000005912" data-uri="chapter06.xhtml#P7000497027000000000000000005912" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="title5 pcalibre pcalibre1" id="P7000497027000000000000000044078" data-uri="chapter06.xhtml#P7000497027000000000000000044078" epub:type="title">Impact of Write Strategy</h1></header>
<p id="P7000497027000000000000000044079" data-uri="chapter06.xhtml#P7000497027000000000000000044079" class="pcalibre1 pcalibre calibre2">Write-through caches are simpler to implement and can use a <i class="calibre5 pcalibre pcalibre1">write buffer</i> that works independently of the cache to update memory. Furthermore, read misses are less expensive because they do not trigger a memory write. On the other hand, write-back caches result in fewer transfers, which allows more bandwidth to memory for I/O devices that perform DMA. Further, reducing the number of transfers becomes increasingly important as we move down the hierarchy and the transfer times increase. In general, caches further down the hierarchy are more likely to use write-back than write-through.</p>
</section>
</section>
</section></body></html>
