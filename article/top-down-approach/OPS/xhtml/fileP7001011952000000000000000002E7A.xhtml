<?xml version="1.0" encoding="utf-8"?><html xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:svg="http://www.w3.org/2000/svg" xmlns:epub="http://www.idpf.org/2007/ops" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" epub:prefix="index: http://www.index.com/"><head>
<meta name="dcterms.conformsTo" content="PXE Basic 1.0"></meta>
<meta name="generator" content="PXE Tools version 1.39.109"></meta>
<!--Created by pxe.pl for standard version PXE Basic 1.0,data-profile-product=standard by PXE Tools 1.39.109, partial=false-->
<title>8.3 Message Integrity and Digital Signatures</title><link rel="alternate stylesheet" type="text/css" title="sepia" href="../css/sepia.css"></link><link rel="alternate stylesheet" type="text/css" title="night" href="../css/night.css"></link><link rel="stylesheet" type="text/css" title="day" href="../css/main.css"></link><link rel="stylesheet" type="text/css" title="day" href="../css/print.css"></link>
<script src="js/format_lg_obj.js"></script>
</head><body epub:type="bodymatter">
<section id="P7001011952000000000000000002E7A" class="level1"><header><h1 class="title" id="P700101195200000000000000000B6C7" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6C7" epub:type="title"><span class="number">8.3</span> Message Integrity and Digital Signatures</h1></header>
<p id="P700101195200000000000000000B6C8" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6C8">In the previous section we saw how encryption can be used to provide confidentiality to two communicating entities. In this section we turn to the equally important cryptography topic of providing <span class="keyword" id="P7001011952000000000000000002E7D" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002E7D"><b>message integrity</b></span> (also known as message ­authentication). Along with message integrity, we will discuss two related topics in this section: digital signatures and end-point authentication.</p>
<p id="P700101195200000000000000000B6C9" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6C9">We define the message integrity problem using, once again, Alice and Bob. Suppose Bob receives a message (which may be encrypted or may be in plaintext) and he believes this message was sent by Alice. To authenticate this message, Bob needs to verify:</p>
<ol id="P700101195200000000000000000B6CA" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6CA">
<li id="P700101195200000000000000000B6CB" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6CB"><p id="P700101195200000000000000000B6CC" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6CC">The message indeed originated from Alice.</p></li>
<li id="P700101195200000000000000000B6CD" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6CD"><p id="P700101195200000000000000000B6CE" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6CE">The message was not tampered with on its way to Bob.</p></li>
</ol>
<p class="continued" id="P700101195200000000000000000B6CF" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6CF">We’ll see in <a class="xref" href="fileP7001011952000000000000000002F6A.xhtml#P7001011952000000000000000002F6A" data-foobar="7"><span class="label">Sections</span> <span class="number">8.4</span></a> through <a class="xref" href="fileP700101195200000000000000000305F.xhtml#P700101195200000000000000000305F" data-foobar="7"><span class="number">8.7</span></a> that this problem of message integrity is a critical concern in just about all secure networking protocols.</p>
<p id="P700101195200000000000000000B6D0" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6D0">As a specific example, consider a computer network using a link-state routing algorithm (such as OSPF) for determining routes between each pair of routers in the <span class="pagebreak" title="611" id="P7001011952000000000000000002E86" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002E86" epub:type="pagebreak" role="doc-pagebreak"></span>network (see <a class="xref" href="fileP7001011952000000000000000001EDE.xhtml#P7001011952000000000000000001EDE" data-foobar="7"><span class="label">Chapter</span> <span class="number">5</span></a>). In a link-state algorithm, each router needs to broadcast a link-state message to all other routers in the network. A router’s link-state message includes a list of its directly connected neighbors and the direct costs to these neighbors. Once a router receives link-state messages from all of the other routers, it can create a complete map of the network, run its least-cost routing algorithm, and configure its forwarding table. One relatively easy attack on the routing algorithm is for Trudy to distribute bogus link-state messages with incorrect link-state information. Thus the need for message integrity—when router B receives a link-state message from router A, router B should verify that router A actually created the message and, further, that no one tampered with the message in transit.</p>
<p id="P700101195200000000000000000B6D1" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6D1">In this section, we describe a popular message integrity technique that is used by many secure networking protocols. But before doing so, we need to cover another important topic in cryptography—cryptographic hash functions.</p>
<section id="P7001011952000000000000000002E88" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002E88" class="level2"><header><h1 class="title" id="P700101195200000000000000000B6D2" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6D2" epub:type="title"><span class="number">8.3.1</span> Cryptographic Hash Functions</h1></header>
<p id="P700101195200000000000000000B6D3" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6D3">As shown in <a class="xref" href="#P7001011952000000000000000002E90" data-foobar="1"><span class="label">Figure</span> <span class="number">8.7</span></a>, a hash function takes an input, m, and computes a fixed-size string H(m) known as a hash. The Internet checksum (<a class="xref" href="fileP70010119520000000000000000010EC.xhtml#P70010119520000000000000000010EC" data-foobar="7"><span class="label">Chapter</span> <span class="number">3</span></a>) and CRCs (<a class="xref" href="fileP70010119520000000000000000023B1.xhtml#P70010119520000000000000000023B1" data-foobar="7"><span class="label">Chapter</span> <span class="number">6</span></a>) meet this definition. A <span class="keyword" id="P7001011952000000000000000002E8B" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002E8B">cryptographic hash function</span> is required to have the following additional property:</p>
<ul id="P700101195200000000000000000B6D4" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6D4">
<li id="P700101195200000000000000000B6D5" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6D5"><p id="P700101195200000000000000000B6D6" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6D6">It is computationally infeasible to find any two different messages <i>x</i> and <i>y</i> such that <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="98" altimg-height="17" altimg="../images/ch08math91.png"><m:mrow><m:mi>H</m:mi><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mi>H</m:mi><m:mrow><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math></span>.</p></li>
</ul>
<p id="P700101195200000000000000000B6D7" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6D7">Informally, this property means that it is computationally infeasible for an intruder to substitute one message for another message that is protected by the hash</p>
<figure id="P7001011952000000000000000002E90" class="figure" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002E90">
<img alt="Illustration of hash functions." height="313" width="665" aria-describedby="P7001011952000000000000000002E94" id="P700101195200000000000000000B6D8" data-uri="P7001011952000000000000000005612" src="../images/4055108007.png"></img>
<figcaption id="P700101195200000000000000000B6D9" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6D9"><header><h1 class="title" id="P700101195200000000000000000B6DA" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6DA" epub:type="title"><span class="label">Figure </span> <span class="number">8.7</span> Hash functions</h1></header>

</figcaption>
</figure><div class="longdesc" id="P7001011952000000000000000002E94" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002E94" aria-hidden="false"><a class="xref" aria-hidden="false" href="../longalt/la_4055108007.xhtml#la_4055108007"><span class="label">Description</span></a></div>
<p id="P700101195200000000000000000B6E1" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6E1"><span class="pagebreak" title="612" id="P7001011952000000000000000002E9C" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002E9C" epub:type="pagebreak" role="doc-pagebreak"></span></p>
<figure id="P7001011952000000000000000002E9D" class="figure" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002E9D">
<img alt="Initial message and fraudulent message have the same checksum!" height="352" width="515" aria-describedby="P7001011952000000000000000002EA1" id="P700101195200000000000000000B6E2" data-uri="P7001011952000000000000000005613" src="../images/4055108008.png"></img>
<figcaption id="P700101195200000000000000000B6E3" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6E3"><header><h1 class="title" id="P700101195200000000000000000B6E4" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6E4" epub:type="title"><span class="label">Figure </span> <span class="number">8.8</span> Initial message and fraudulent message have the same ­checksum!</h1></header>

</figcaption>
</figure><div class="longdesc" id="P7001011952000000000000000002EA1" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002EA1" aria-hidden="false"><a class="xref" aria-hidden="false" href="../longalt/la_4055108008.xhtml#la_4055108008"><span class="label">Description</span></a></div>
<p class="continued" id="P700101195200000000000000000B6F9" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6F9">function. That is, if (<i>m</i>, <i>H</i>(<i>m</i>)) are the message and the hash of the message created by the sender, then an intruder cannot forge the contents of another message, <i>y</i>, that has the same hash value as the original message.</p>
<p id="P700101195200000000000000000B6FA" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6FA">Let’s convince ourselves that a simple checksum, such as the Internet checksum, would make a poor cryptographic hash function. Rather than performing 1s complement arithmetic (as in the Internet checksum), let us compute a checksum by treating each character as a byte and adding the bytes together using 4-byte chunks at a time. Suppose Bob owes Alice $100.99 and sends an IOU to Alice consisting of the text string “<code id="P700101195200000000000000000B6FB" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6FB">IOU100.99BOB.</code>” The ASCII representation (in hexadecimal notation) for these letters is <code id="P700101195200000000000000000B6FC" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6FC">49</code>, <code id="P700101195200000000000000000B6FD" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6FD">4F</code>, <code id="P700101195200000000000000000B6FE" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6FE">55</code>, <code id="P700101195200000000000000000B6FF" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B6FF">31</code>, <code id="P700101195200000000000000000B700" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B700">30</code>, <code id="P700101195200000000000000000B701" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B701">30</code>, <code id="P700101195200000000000000000B702" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B702">2E</code>, <code id="P700101195200000000000000000B703" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B703">39</code>, <code id="P700101195200000000000000000B704" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B704">39</code>, <code id="P700101195200000000000000000B705" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B705">42</code>, <code id="P700101195200000000000000000B706" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B706">4F</code>, <code id="P700101195200000000000000000B707" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B707">42</code>.</p>
<p id="P700101195200000000000000000B708" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B708"><a class="xref" href="#P7001011952000000000000000002E9D" data-foobar="1"><span class="label">Figure</span> <span class="number">8.8</span></a> (top) shows that the 4-byte checksum for this message is B2 C1 D2 AC. A slightly different message (and a much more costly one for Bob) is shown in the bottom half of <a class="xref" href="#P7001011952000000000000000002E9D" data-foobar="1"><span class="label">Figure</span> <span class="number">8.8</span></a>. The messages “<code id="P700101195200000000000000000B709" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B709">IOU100.99BOB</code>” and “<code id="P700101195200000000000000000B70A" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B70A">IOU900.19BOB</code>” have the <i>same</i> checksum. Thus, this simple checksum algorithm violates the requirement above. Given the original data, it is simple to find another set of data with the same checksum. Clearly, for security purposes, we are going to need a more powerful hash function than a checksum.</p>
<p id="P700101195200000000000000000B70B" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B70B">The MD5 hash algorithm of Ron Rivest <a class="biblioref" href="fileP70010119520000000000000000037E0.xhtml#P7001011952000000000000000003B03" data-foobar="7">[RFC 1321]</a> is in wide use today. It computes a 128-bit hash in a four-step process consisting of a padding step (adding a one followed by enough zeros so that the length of the message satisfies certain conditions), an append step (appending a 64-bit representation of the message length before padding), an initialization of an accumulator, and a final looping step in which the message’s 16-word blocks are processed (mangled) in four rounds. For a description of MD5 (including a C source code implementation) see <a class="biblioref" href="fileP70010119520000000000000000037E0.xhtml#P7001011952000000000000000003B03" data-foobar="7">[RFC 1321]</a>.</p>
<p id="P700101195200000000000000000B70C" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B70C"><span class="pagebreak" title="613" id="P7001011952000000000000000002ECA" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002ECA" epub:type="pagebreak" role="doc-pagebreak"></span>The second major hash algorithm in use today is the Secure Hash Algorithm (SHA-1) <a class="biblioref" href="fileP70010119520000000000000000037E0.xhtml#P70010119520000000000000000038FE" data-foobar="7">[FIPS 1995]</a>. This algorithm is based on principles similar to those used in the design of MD4 <a class="biblioref" href="fileP70010119520000000000000000037E0.xhtml#P7001011952000000000000000003B01" data-foobar="7">[RFC 1320]</a>, the predecessor to MD5. SHA-1, a US federal standard, is required for use whenever a cryptographic hash algorithm is needed for federal applications. It produces a 160-bit message digest. The longer output length makes SHA-1 more secure.</p>
</section>
<section id="P7001011952000000000000000002ECB" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002ECB" class="level2"><header><h1 class="title" id="P700101195200000000000000000B70D" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B70D" epub:type="title"><span class="number">8.3.2</span> Message Authentication Code</h1></header>
<p id="P700101195200000000000000000B70E" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B70E">Let’s now return to the problem of message integrity. Now that we understand hash functions, let’s take a first stab at how we might perform message integrity:</p>
<ol id="P700101195200000000000000000B70F" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B70F">
<li id="P700101195200000000000000000B710" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B710"><p id="P700101195200000000000000000B711" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B711">Alice creates message <i>m</i> and calculates the hash <i>H</i>(<i>m</i>) (for example with SHA-1).</p></li>
<li id="P700101195200000000000000000B712" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B712"><p id="P700101195200000000000000000B713" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B713">Alice then appends <i>H</i>(<i>m</i>) to the message <i>m</i>, creating an extended message (<i>m</i>, <i>H</i>(<i>m</i>)), and sends the extended message to Bob.</p></li>
<li id="P700101195200000000000000000B714" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B714"><p id="P700101195200000000000000000B715" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B715">Bob receives an extended message (<i>m</i>, <i>h</i>) and calculates <i>H</i>(<i>m</i>). If <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="78" altimg-height="17" altimg="../images/ch08math92.png"><m:mrow><m:mi>H</m:mi><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mi>h</m:mi></m:mrow></m:math></span>, Bob concludes that everything is fine.</p></li>
</ol>
<p class="continued" id="P700101195200000000000000000B716" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B716">This approach is obviously flawed. Trudy can create a bogus message <i>m</i>´ in which she says she is Alice, calculate <i>H</i>(<i>m</i>´), and send Bob (<i>m</i>´, <i>H</i>(<i>m</i>´)). When Bob receives the message, everything checks out in step 3, so Bob doesn’t suspect any funny ­business.</p>
<p id="P700101195200000000000000000B717" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B717">To perform message integrity, in addition to using cryptographic hash functions, Alice and Bob will need a shared secret <i>s</i>. This shared secret, which is nothing more than a string of bits, is called the <span class="keyword" id="P7001011952000000000000000002ED7" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002ED7"><b>authentication key</b></span>. Using this shared secret, message integrity can be performed as follows:</p>
<ol id="P700101195200000000000000000B718" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B718">
<li id="P700101195200000000000000000B719" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B719"><p id="P700101195200000000000000000B71A" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B71A">Alice creates message <i>m</i>, concatenates <i>s</i> with <i>m</i> to create <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="48" altimg-height="13" altimg="../images/ch08math93.png"><m:mrow><m:mi>m</m:mi><m:mo>+</m:mo><m:mi>s</m:mi></m:mrow></m:math></span>, and calculates the hash <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="74" altimg-height="17" altimg="../images/ch08math94.png"><m:mrow><m:mi>H</m:mi><m:mrow><m:mo>(</m:mo><m:mrow><m:mi>m</m:mi><m:mo>+</m:mo><m:mi>s</m:mi></m:mrow><m:mo>)</m:mo></m:mrow></m:mrow></m:math></span> (for example with SHA-1). <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="74" altimg-height="17" altimg="../images/ch08math95.png"><m:mrow><m:mi>H</m:mi><m:mrow><m:mo>(</m:mo><m:mrow><m:mi>m</m:mi><m:mo>+</m:mo><m:mi>s</m:mi></m:mrow><m:mo>)</m:mo></m:mrow></m:mrow></m:math></span> is called the <span class="keyword" id="P7001011952000000000000000002EDB" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002EDB"><b>message authentication code (MAC)</b></span>.</p></li>
<li id="P700101195200000000000000000B71B" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B71B"><p id="P700101195200000000000000000B71C" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B71C">Alice then appends the MAC to the message <i>m</i>, creating an extended message <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="109" altimg-height="17" altimg="../images/ch08math96.png"><m:mrow><m:mrow><m:mo>(</m:mo><m:mrow><m:mi>m</m:mi><m:mo>,</m:mo><m:mtext> </m:mtext><m:mi>H</m:mi><m:mrow><m:mo>(</m:mo><m:mrow><m:mi>m</m:mi><m:mo>+</m:mo><m:mi>s</m:mi></m:mrow><m:mo>)</m:mo></m:mrow></m:mrow><m:mo>)</m:mo></m:mrow></m:mrow></m:math></span>, and sends the extended message to Bob.</p></li>
<li id="P700101195200000000000000000B71D" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B71D"><p id="P700101195200000000000000000B71E" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B71E">Bob receives an extended message (<i>m, h</i>) and knowing <i>s</i>, calculates the MAC <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="75" altimg-height="17" altimg="../images/ch08math97.png"><m:mrow><m:mi>H</m:mi><m:mrow><m:mo>(</m:mo><m:mrow><m:mi>m</m:mi><m:mo>+</m:mo><m:mi>s</m:mi></m:mrow><m:mo>)</m:mo></m:mrow></m:mrow></m:math></span>. If <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="110" altimg-height="17" altimg="../images/ch08math98.png"><m:mrow><m:mi>H</m:mi><m:mrow><m:mo>(</m:mo><m:mrow><m:mi>m</m:mi><m:mo>+</m:mo><m:mi>s</m:mi></m:mrow><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mi>h</m:mi></m:mrow></m:math></span>, Bob concludes that everything is fine.</p></li>
</ol>
<p id="P700101195200000000000000000B71F" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B71F">A summary of the procedure is shown in <a class="xref" href="#P7001011952000000000000000002EE3" data-foobar="1"><span class="label">Figure</span> <span class="number">8.9</span></a>. Readers should note that the MAC here (standing for “message authentication code”) is not the same MAC used in link-layer protocols (standing for “medium access control”)!</p>
<p id="P700101195200000000000000000B720" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B720">One nice feature of a MAC is that it does not require an encryption algorithm. Indeed, in many applications, including the link-state routing algorithm described earlier, communicating entities are only concerned with message integrity and are not concerned with message confidentiality. Using a MAC, the entities can authenticate<span class="pagebreak" title="614" id="P7001011952000000000000000002EE2" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002EE2" epub:type="pagebreak" role="doc-pagebreak"></span></p>
<figure id="P7001011952000000000000000002EE3" class="figure" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002EE3">
<img alt="Message authentication code (MAC)" height="296" width="640" aria-describedby="P7001011952000000000000000002EE7" id="P700101195200000000000000000B721" data-uri="P7001011952000000000000000005614" src="../images/4055108009.png"></img>
<figcaption id="P700101195200000000000000000B722" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B722"><header><h1 class="title" id="P700101195200000000000000000B723" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B723" epub:type="title"><span class="label">Figure </span> <span class="number">8.9</span> Message authentication code (MAC)</h1></header>

</figcaption>
</figure><div class="longdesc" id="P7001011952000000000000000002EE7" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002EE7" aria-hidden="false"><a class="xref" aria-hidden="false" href="../longalt/la_4055108009.xhtml#la_4055108009"><span class="label">Description</span></a></div>
<p class="continued" id="P700101195200000000000000000B726" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B726">the messages they send to each other without having to integrate complex encryption algorithms into the integrity process.</p>
<p id="P700101195200000000000000000B727" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B727">As you might expect, a number of different standards for MACs have been proposed over the years. The most popular standard today is <span class="keyword" id="P7001011952000000000000000002EEC" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002EEC"><b>HMAC</b></span>, which can be used either with MD5 or SHA-1. HMAC actually runs data and the authentication key through the hash function twice <a class="biblioref" href="fileP70010119520000000000000000037E0.xhtml#P70010119520000000000000000039DA" data-foobar="7">[Kaufman 1995</a>; RFC 2104].</p>
<p id="P700101195200000000000000000B728" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B728">There still remains an important issue. How do we distribute the shared authentication key to the communicating entities? For example, in the link-state routing algorithm, we would somehow need to distribute the secret authentication key to each of the routers in the autonomous system. (Note that the routers can all use the same authentication key.) A network administrator could actually accomplish this by physically visiting each of the routers. Or, if the network administrator is a lazy guy, and if each router has its own public key, the network administrator could distribute the authentication key to any one of the routers by encrypting it with the router’s public key and then sending the encrypted key over the network to the router.</p>
</section>
<section id="P7001011952000000000000000002EEE" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002EEE" class="level2"><header><h1 class="title" id="P700101195200000000000000000B729" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B729" epub:type="title"><span class="number">8.3.3</span> Digital Signatures</h1></header>
<p id="P700101195200000000000000000B72A" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B72A">Think of the number of the times you’ve signed your name to a piece of paper during the last week. You sign checks, credit card receipts, legal documents, and letters. Your signature attests to the fact that you (as opposed to someone else) have acknowledged and/or agreed with the document’s contents. In a digital world, one often wants to indicate the owner or creator of a document, or to signify one’s agreement with a document’s content. A <span class="keyword" id="P7001011952000000000000000002EF1" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002EF1"><b>digital signature</b></span> is a cryptographic technique for achieving these goals in a digital world.</p>
<p id="P700101195200000000000000000B72B" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B72B">Just as with handwritten signatures, digital signing should be done in a way that is verifiable and nonforgeable. That is, it must be possible to prove that a document <span class="pagebreak" title="615" id="P7001011952000000000000000002EF3" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002EF3" epub:type="pagebreak" role="doc-pagebreak"></span>signed by an individual was indeed signed by that individual (the signature must be verifiable) and that <i>only</i> that individual could have signed the document (the signature cannot be forged).</p>
<p id="P700101195200000000000000000B72C" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B72C">Let’s now consider how we might design a digital signature scheme. Observe that when Bob signs a message, Bob must put something on the message that is unique to him. Bob could consider attaching a MAC for the signature, where the MAC is created by appending his key (unique to him) to the message, and then taking the hash. But for Alice to verify the signature, she must also have a copy of the key, in which case the key would not be unique to Bob. Thus, MACs are not going to get the job done here.</p>
<p id="P700101195200000000000000000B72D" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B72D">Recall that with public-key cryptography, Bob has both a public and private key, with both of these keys being unique to Bob. Thus, public-key cryptography is an excellent candidate for providing digital signatures. Let us now examine how it is done.</p>
<p id="P700101195200000000000000000B72E" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B72E">Suppose that Bob wants to digitally sign a document, <i>m</i>. We can think of the document as a file or a message that Bob is going to sign and send. As shown in <a class="xref" href="#P7001011952000000000000000002EF8" data-foobar="1"><span class="label">Figure</span> <span class="number">8.10</span></a>, to sign this document, Bob simply uses his private key, <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="25" altimg-height="17" altimg="../images/ch08math99.png"><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>−</m:mo></m:msubsup></m:mrow></m:math></span>, to compute <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="51" altimg-height="17" altimg="../images/ch08math100.png"><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>−</m:mo></m:msubsup><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math></span>. At first, it might seem odd that Bob is using his private key (which, as we saw in <a class="xref" href="fileP7001011952000000000000000002D74.xhtml#P7001011952000000000000000002D74" data-foobar="7"><span class="label">Section</span> <span class="number">8.2</span></a>, was used to decrypt a message that had been encrypted with his public key) to sign a document. But recall that encryption and decryption are nothing more than mathematical operations (exponentiation to the power of <i>e</i> or <i>d</i> in RSA; see <a class="xref" href="fileP7001011952000000000000000002D74.xhtml#P7001011952000000000000000002D74" data-foobar="7"><span class="label">Section</span> <span class="number">8.2</span></a>) and recall that Bob’s goal is not to scramble or obscure the contents of the document, but rather to sign the document in a manner that is verifiable and nonforgeable. Bob’s digital signature of the document is <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="51" altimg-height="17" altimg="../images/ch08math101.png"><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>−</m:mo></m:msubsup><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math></span>.</p>
<p id="P700101195200000000000000000B72F" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B72F">Does the digital signature <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="50" altimg-height="17" altimg="../images/ch08math102.png"><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>−</m:mo></m:msubsup><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math></span> meet our requirements of being verifiable and nonforgeable? Suppose Alice has <i>m</i> and <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="51" altimg-height="17" altimg="../images/ch08math103.png"><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>−</m:mo></m:msubsup><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math></span>. She wants to prove in court (being</p>
<figure id="P7001011952000000000000000002EF8" class="figure" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002EF8">
<img alt="Creating a digital signature for a document." height="321" width="670" aria-describedby="P7001011952000000000000000002EFC" id="P700101195200000000000000000B730" data-uri="P7001011952000000000000000005615" src="../images/4055108010.png"></img>
<figcaption id="P700101195200000000000000000B731" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B731"><header><h1 class="title" id="P700101195200000000000000000B732" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B732" epub:type="title"><span class="label">Figure </span> <span class="number">8.10</span> Creating a digital signature for a document</h1></header>

</figcaption>
</figure><div class="longdesc" id="P7001011952000000000000000002EFC" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002EFC" aria-hidden="false"><a class="xref" aria-hidden="false" href="../longalt/la_4055108010.xhtml#la_4055108010"><span class="label">Description</span></a></div>
<p class="continued" id="P700101195200000000000000000B73B" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B73B"><span class="pagebreak" title="616" id="P7001011952000000000000000002F06" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002F06" epub:type="pagebreak" role="doc-pagebreak"></span>litigious) that Bob had indeed signed the document and was the only person who could have possibly signed the document. Alice takes Bob’s public key, <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="25" altimg-height="21" altimg="../images/ch08math104.png"><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>+</m:mo></m:msubsup></m:mrow></m:math></span>, and applies it to the digital signature, <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="51" altimg-height="17" altimg="../images/ch08math105.png"><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>−</m:mo></m:msubsup><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math></span>, associated with the document, <i>m</i>. That is, she computes <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="86" altimg-height="20" altimg="../images/ch08math106.png"><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>+</m:mo></m:msubsup><m:mrow><m:mo>(</m:mo><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>−</m:mo></m:msubsup><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow><m:mo>)</m:mo></m:mrow></m:mrow></m:math></span>, and voilà, with a dramatic flurry, she produces <i>m</i>, which exactly matches the original document! Alice then argues that only Bob could have signed the document, for the following reasons:</p>
<ul id="P700101195200000000000000000B73C" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B73C">
<li id="P700101195200000000000000000B73D" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B73D"><p id="P700101195200000000000000000B73E" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B73E">Whoever signed the message must have used the private key, <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="25" altimg-height="17" altimg="../images/ch08math107.png"><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>−</m:mo></m:msubsup></m:mrow></m:math></span>, in computing the signature <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="50" altimg-height="17" altimg="../images/ch08math108.png"><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>−</m:mo></m:msubsup><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math></span>, such that <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="131" altimg-height="21" altimg="../images/ch08math109.png"><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>+</m:mo></m:msubsup><m:mrow><m:mo>(</m:mo><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>−</m:mo></m:msubsup><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mi>m</m:mi></m:mrow></m:math></span>.</p></li>
<li id="P700101195200000000000000000B73F" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B73F"><p id="P700101195200000000000000000B740" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B740">The only person who could have known the private key, <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="25" altimg-height="17" altimg="../images/ch08math110.png"><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>−</m:mo></m:msubsup></m:mrow></m:math></span>, is Bob. Recall from our discussion of RSA in <a class="xref" href="fileP7001011952000000000000000002D74.xhtml#P7001011952000000000000000002D74" data-foobar="7"><span class="label">Section</span> <span class="number">8.2</span></a> that knowing the public key, <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="25" altimg-height="21" altimg="../images/ch08math111.png"><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>+</m:mo></m:msubsup></m:mrow></m:math></span>, is of no help in learning the private key, <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="25" altimg-height="17" altimg="../images/ch08math112.png"><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>−</m:mo></m:msubsup></m:mrow></m:math></span>. Therefore, the only person who could know <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="25" altimg-height="17" altimg="../images/ch08math113.png"><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>−</m:mo></m:msubsup></m:mrow></m:math></span> is the person who generated the pair of keys, (<span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="25" altimg-height="21" altimg="../images/ch08math114.png"><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>+</m:mo></m:msubsup></m:mrow></m:math></span>, <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="25" altimg-height="17" altimg="../images/ch08math115.png"><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>−</m:mo></m:msubsup></m:mrow></m:math></span>), in the first place, Bob. (Note that this assumes, though, that Bob has not given <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="25" altimg-height="17" altimg="../images/ch08math116.png"><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>−</m:mo></m:msubsup></m:mrow></m:math></span> to anyone, nor has anyone stolen <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="25" altimg-height="17" altimg="../images/ch08math117.png"><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>−</m:mo></m:msubsup></m:mrow></m:math></span> from Bob.)</p></li>
</ul>
<p id="P700101195200000000000000000B741" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B741">It is also important to note that if the original document, <i>m</i>, is ever modified to some alternate form, <i>m</i>´, the signature that Bob created for <i>m</i> will not be valid for <i>m</i>´, since <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="86" altimg-height="21" altimg="../images/ch08math118.png"><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>+</m:mo></m:msubsup><m:mrow><m:mo>(</m:mo><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>−</m:mo></m:msubsup><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow><m:mo>)</m:mo></m:mrow></m:mrow></m:math></span> does not equal <i>m</i>´. Thus we see that digital signatures also provide message integrity, allowing the receiver to verify that the message was unaltered as well as the source of the message.</p>
<p id="P700101195200000000000000000B742" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B742">One concern with signing data by encryption is that encryption and decryption are computationally expensive. Given the overheads of encryption and decryption, signing data via complete encryption/decryption can be overkill. A more efficient approach is to introduce hash functions into the digital signature. Recall from ­<a class="xref" href="#P7001011952000000000000000002ECB" data-foobar="1"><span class="label">Section</span> <span class="number">8.3.2</span></a> that a hash algorithm takes a message, <i>m</i>, of arbitrary length and computes a fixed-length “fingerprint” of the message, denoted by <i>H</i>(<i>m</i>). Using a hash function, Bob signs the hash of a message rather than the message itself, that is, Bob calculates <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="78" altimg-height="17" altimg="../images/ch08math119.png"><m:mrow><m:msubsup><m:mstyle mathsize="140%" displaystyle="true"><m:mi>K</m:mi></m:mstyle><m:mi>B</m:mi><m:mo>−</m:mo></m:msubsup><m:mrow><m:mo>(</m:mo><m:mrow><m:mi>H</m:mi><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow><m:mo>)</m:mo></m:mrow></m:mrow></m:math></span>. Since <i>H</i>(<i>m</i>) is generally much smaller than the original message <i>m</i>, the computational effort required to create the digital signature is substantially reduced.</p>
<p id="P700101195200000000000000000B743" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B743">In the context of Bob sending a message to Alice, <a class="xref" href="#P7001011952000000000000000002F11" data-foobar="1"><span class="label">Figure</span> <span class="number">8.11</span></a> provides a summary of the operational procedure of creating a digital signature. Bob puts his original long message through a hash function. He then digitally signs the resulting hash with his private key. The original message (in cleartext) along with the digitally signed message digest (henceforth referred to as the digital signature) is then sent to Alice. <a class="xref" href="#P7001011952000000000000000002F27" data-foobar="1"><span class="label">Figure</span> <span class="number">8.12</span></a> provides a summary of the operational procedure of the signature. Alice applies the sender’s public key to the message to obtain a hash result. Alice also applies the hash function to the cleartext message to obtain a second hash result. If the two hashes match, then Alice can be sure about the integrity and author of the message.</p>
<p id="P700101195200000000000000000B744" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B744">Before moving on, let’s briefly compare digital signatures with MACs, since they have parallels, but also have important subtle differences. Both digital signatures and<span class="pagebreak" title="617" id="P7001011952000000000000000002F10" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002F10" epub:type="pagebreak" role="doc-pagebreak"></span></p>
<figure id="P7001011952000000000000000002F11" class="figure" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002F11">
<img alt="Sending a digitally signed message." height="503" width="787" aria-describedby="P7001011952000000000000000002F15" id="P700101195200000000000000000B745" data-uri="P7001011952000000000000000005616" src="../images/4055108011.png"></img>
<figcaption id="P700101195200000000000000000B746" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B746"><header><h1 class="title" id="P700101195200000000000000000B747" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B747" epub:type="title"><span class="label">Figure </span> <span class="number">8.11</span> Sending a digitally signed message</h1></header>

</figcaption>
</figure><div class="longdesc" id="P7001011952000000000000000002F15" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002F15" aria-hidden="false"><a class="xref" aria-hidden="false" href="../longalt/la_4055108011.xhtml#la_4055108011"><span class="label">Description</span></a></div>
<p class="continued" id="P700101195200000000000000000B752" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B752">MACs start with a message (or a document). To create a MAC out of the message, we append an authentication key to the message, and then take the hash of the result. Note that neither public key nor symmetric key encryption is involved in creating the MAC. To create a digital signature, we first take the hash of the message and then encrypt the message with our private key (using public key cryptography). Thus, a digital signature is a “heavier” technique, since it requires an underlying Public Key Infrastructure (PKI) with certification authorities as described below. We’ll see in <a class="xref" href="fileP7001011952000000000000000002F6A.xhtml#P7001011952000000000000000002F6A" data-foobar="7"><span class="label">Section</span> <span class="number">8.4</span></a> that PGP—a popular secure e-mail system—uses digital signatures for message integrity. We’ve seen already that OSPF uses MACs for message integrity. We’ll see in <a class="xref" href="fileP7001011952000000000000000002FB6.xhtml#P7001011952000000000000000002FB6" data-foobar="7"><span class="label">Sections</span> <span class="number">8.5</span></a> and <a class="xref" href="fileP7001011952000000000000000002FF6.xhtml#P7001011952000000000000000002FF6" data-foobar="7"><span class="number">8.6</span></a> that MACs are also used for popular transport-layer and network-layer security protocols.</p>
<section id="P7001011952000000000000000002F21" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002F21" class="level3"><header><h1 class="title" id="P700101195200000000000000000B753" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B753" epub:type="title">Public Key Certification</h1></header>
<p id="P700101195200000000000000000B754" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B754">An important application of digital signatures is <span class="keyword" id="P7001011952000000000000000002F24" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002F24"><b>public key certification</b></span>, that is, certifying that a public key belongs to a specific entity. Public key certification is used in many popular secure networking protocols, including IPsec and SSL.</p>
<p id="P700101195200000000000000000B755" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B755">To gain insight into this problem, let’s consider an Internet-commerce version of the classic “pizza prank.” Alice is in the pizza delivery business and accepts orders<span class="pagebreak" title="618" id="P7001011952000000000000000002F26" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002F26" epub:type="pagebreak" role="doc-pagebreak"></span></p>
<figure id="P7001011952000000000000000002F27" class="figure" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002F27">
<img alt="Verifying a signed hash." height="594" width="783" aria-describedby="P7001011952000000000000000002F2B" id="P700101195200000000000000000B756" data-uri="P7001011952000000000000000005617" src="../images/4055108012.png"></img>
<figcaption id="P700101195200000000000000000B757" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B757"><header><h1 class="title" id="P700101195200000000000000000B758" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B758" epub:type="title"><span class="label">Figure </span> <span class="number">8.12</span> Verifying a signed message</h1></header>

</figcaption>
</figure><div class="longdesc" id="P7001011952000000000000000002F2B" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002F2B" aria-hidden="false"><a class="xref" aria-hidden="false" href="../longalt/la_4055108012.xhtml#la_4055108012"><span class="label">Description</span></a></div>
<p class="continued" id="P700101195200000000000000000B75C" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B75C">over the Internet. Bob, a pizza lover, sends Alice a plaintext message that includes his home address and the type of pizza he wants. In this message, Bob also includes a digital signature (that is, a signed hash of the original plaintext message) to prove to Alice that he is the true source of the message. To verify the signature, Alice obtains Bob’s public key (perhaps from a public key server or from the e-mail message) and checks the digital signature. In this manner she makes sure that Bob, rather than some adolescent prankster, placed the order.</p>
<p id="P700101195200000000000000000B75D" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B75D">This all sounds fine until clever Trudy comes along. As shown in <a class="xref" href="#P7001011952000000000000000002F32" data-foobar="1"><span class="label">Figure</span> <span class="number">8.13</span></a>, Trudy is indulging in a prank. She sends a message to Alice in which she says she is Bob, gives Bob’s home address, and orders a pizza. In this message she also includes her (Trudy’s) public key, although Alice naturally assumes it is Bob’s public key. Trudy also attaches a digital signature, which was created with her own (Trudy’s) private key. After receiving the message, Alice applies Trudy’s public key (thinking that it is Bob’s) to the digital signature and concludes that the plaintext message was<span class="pagebreak" title="619" id="P7001011952000000000000000002F31" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002F31" epub:type="pagebreak" role="doc-pagebreak"></span></p>
<figure id="P7001011952000000000000000002F32" class="figure" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002F32">
<img alt="Trudy masquerades as Bob using public key cryptography." height="566" width="855" aria-describedby="P7001011952000000000000000002F36" id="P700101195200000000000000000B75E" data-uri="P7001011952000000000000000005618" src="../images/4055108013.png"></img>
<figcaption id="P700101195200000000000000000B75F" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B75F"><header><h1 class="title" id="P700101195200000000000000000B760" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B760" epub:type="title"><span class="label">Figure </span> <span class="number">8.13</span> Trudy masquerades as Bob using public key cryptography</h1></header>

</figcaption>
</figure><div class="longdesc" id="P7001011952000000000000000002F36" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002F36" aria-hidden="false"><a class="xref" aria-hidden="false" href="../longalt/la_4055108013.xhtml#la_4055108013"><span class="label">Description</span></a></div>
<p class="continued" id="P700101195200000000000000000B76B" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B76B">indeed created by Bob. Bob will be very surprised when the delivery person brings a pizza with pepperoni and anchovies to his home!</p>
<p id="P700101195200000000000000000B76C" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B76C">We see from this example that for public key cryptography to be useful, you need to be able to verify that you have the actual public key of the entity (person, router, browser, and so on) with whom you want to communicate. For example, when Alice wants to communicate with Bob using public key cryptography, she needs to verify that the public key that is supposed to be Bob’s is indeed Bob’s.</p>
<p id="P700101195200000000000000000B76D" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B76D">Binding a public key to a particular entity is typically done by a <span class="keyword" id="P7001011952000000000000000002F44" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002F44"><b>Certification Authority (CA)</b></span>, whose job is to validate identities and issue certificates. A CA has the following roles:</p>
<ol id="P700101195200000000000000000B76E" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B76E">
<li id="P700101195200000000000000000B76F" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B76F"><p id="P700101195200000000000000000B770" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B770">A CA verifies that an entity (a person, a router, and so on) is who it says it is. There are no mandated procedures for how certification is done. When dealing with a CA, one must trust the CA to have performed a suitably rigorous identity verification. For example, if Trudy were able to walk into the Fly-by-Night<span class="pagebreak" title="620" id="P7001011952000000000000000002F48" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002F48" epub:type="pagebreak" role="doc-pagebreak"></span></p>
<figure id="P7001011952000000000000000002F49" class="figure" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002F49">
<img alt="Bob has his public key certified by the CA." height="400" width="572" aria-describedby="P7001011952000000000000000002F4D" id="P700101195200000000000000000B771" data-uri="P7001011952000000000000000005619" src="../images/4055108014.png"></img>
<figcaption id="P700101195200000000000000000B772" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B772"><header><h1 class="title" id="P700101195200000000000000000B773" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B773" epub:type="title"><span class="label">Figure </span> <span class="number">8.14</span> Bob has his public key certified by the CA</h1></header>

</figcaption>
</figure><div class="longdesc" id="P7001011952000000000000000002F4D" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002F4D" aria-hidden="false"><a class="xref" aria-hidden="false" href="../longalt/la_4055108014.xhtml#la_4055108014"><span class="label">Description</span></a></div>
<p class="continued" id="P700101195200000000000000000B775" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B775">CA and simply announce “I am Alice” and receive certificates associated with the identity of Alice, then one shouldn’t put much faith in public keys certified by the Fly-by-Night CA. On the other hand, one might (or might not!) be more willing to trust a CA that is part of a federal or state program. You can trust the identity associated with a public key only to the extent to which you can trust a CA and its identity verification techniques. What a tangled web of trust we spin!</p></li>
<li id="P700101195200000000000000000B776" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B776"><p id="P700101195200000000000000000B777" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B777">Once the CA verifies the identity of the entity, the CA creates a <span class="keyword" id="P7001011952000000000000000002F52" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002F52"><b>certificate</b></span> that binds the public key of the entity to the identity. The certificate contains the public key and globally unique identifying information about the owner of the public key (for example, a human name or an IP address). The certificate is digitally signed by the CA. These steps are shown in <a class="xref" href="#P7001011952000000000000000002F49" data-foobar="1"><span class="label">Figure</span> <span class="number">8.14</span></a>.</p></li>
</ol>
<p id="P700101195200000000000000000B778" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B778">Let us now see how certificates can be used to combat pizza-ordering pranksters, like Trudy, and other undesirables. When Bob places his order he also sends his CA-signed certificate. Alice uses the CA’s public key to check the validity of Bob’s certificate and extract Bob’s public key.</p>
<p id="P700101195200000000000000000B779" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B779">Both the International Telecommunication Union (ITU) and the IETF have developed standards for CAs. ITU X.509 <a class="biblioref" href="fileP70010119520000000000000000037E0.xhtml#P70010119520000000000000000039A2" data-foobar="7">[ITU 2005a]</a> specifies an authentication service as well as a specific syntax for certificates. <a class="biblioref" href="fileP70010119520000000000000000037E0.xhtml#P7001011952000000000000000003B07" data-foobar="7">[RFC 1422]</a> describes CA-based key management for use with secure Internet e-mail. It is compatible with X.509 but goes beyond X.509 by establishing procedures and conventions for a key management architecture. <a class="xref" href="#P7001011952000000000000000002F56" data-foobar="1"><span class="label">Table</span> <span class="number">8.4</span></a> describes some of the important fields in a certificate.<span class="pagebreak" title="621" id="P7001011952000000000000000002F55" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002F55" epub:type="pagebreak" role="doc-pagebreak"></span></p>
<figure id="P7001011952000000000000000002F56" class="table" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000002F56">
<figcaption id="P700101195200000000000000000B77A" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B77A"><header><h1 class="title" id="P700101195200000000000000000B77B" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B77B" epub:type="title"><span class="label">Table </span> <span class="number">8.4</span> Selected fields in an X.509 and RFC 1422 public key</h1></header></figcaption>
<table id="P700101195200000000000000000B77C" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B77C">
<thead>
<tr>
<th id="P700101195200000000000000000B77D" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B77D">Field Name</th>
<th id="P700101195200000000000000000B77E" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B77E">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td id="P700101195200000000000000000B77F" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B77F">Version</td>
<td id="P700101195200000000000000000B780" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B780">Version number of X.509 specification</td>
</tr>
<tr>
<td id="P700101195200000000000000000B781" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B781">Serial number</td>
<td id="P700101195200000000000000000B782" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B782">CA-issued unique identifier for a certificate</td>
</tr>
<tr>
<td id="P700101195200000000000000000B783" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B783">Signature</td>
<td id="P700101195200000000000000000B784" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B784">Specifies the algorithm used by CA to sign this certificate</td>
</tr>
<tr>
<td id="P700101195200000000000000000B785" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B785">Issuer name</td>
<td id="P700101195200000000000000000B786" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B786">Identity of CA issuing this certificate, in distinguished name (DN) <a class="biblioref" href="fileP70010119520000000000000000037E0.xhtml#P7001011952000000000000000003B9E" data-foobar="7">[RFC 4514]</a> format</td>
</tr>
<tr>
<td id="P700101195200000000000000000B787" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B787">Validity period</td>
<td id="P700101195200000000000000000B788" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B788">Start and end of period of validity for certificate</td>
</tr>
<tr>
<td id="P700101195200000000000000000B789" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B789">Subject name</td>
<td id="P700101195200000000000000000B78A" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B78A">Identity of entity whose public key is associated with this certificate, in DN format</td>
</tr>
<tr>
<td id="P700101195200000000000000000B78B" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B78B">Subject public key</td>
<td id="P700101195200000000000000000B78C" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B78C">The subject’s public key as well indication of the public key algorithm (and algorithm parameters) to be used with this key</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
</section></body></html>