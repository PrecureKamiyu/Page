<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Some Other Details</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part383.htm">&lt; 上一个</a><span> | </span><a href="../ostep.html">内容</a><span> | </span><a href="part385.htm">下一个 &gt;</a></p><p class="s32" style="padding-left: 68pt;text-indent: 0pt;text-align: justify;">Some Other Details</p><p style="padding-top: 5pt;padding-left: 68pt;text-indent: 0pt;line-height: 89%;text-align: justify;">Though we won’t spend too much time on it, there are some other inter- esting details about how hard drives operate. Many drives employ some kind of <b>track skew </b>to make sure that sequential reads can be properly serviced even when crossing track boundaries. In our simple example disk, this might appear as seen in Figure <span style=" color: #00AEEF;">37.4</span>.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="157" height="167" alt="image" src="Image_544.png"/></span></p><p class="s46" style="text-indent: 0pt;line-height: 6pt;text-align: left;">9</p><p style="text-indent: 0pt;text-align: left;"/><p class="s46" style="text-indent: 0pt;line-height: 6pt;text-align: left;">8</p><p style="text-indent: 0pt;text-align: left;"/><p class="s46" style="text-indent: 0pt;line-height: 6pt;text-align: left;">7</p><p style="text-indent: 0pt;text-align: left;"/><p class="s46" style="padding-left: 5pt;text-indent: 0pt;line-height: 6pt;text-align: left;">18</p><p class="s46" style="padding-top: 2pt;padding-left: 11pt;text-indent: 0pt;text-align: left;">28</p><p class="s46" style="padding-top: 4pt;text-indent: 0pt;text-align: left;">27</p><p style="text-indent: 0pt;text-align: left;"/><p class="s46" style="text-indent: 0pt;line-height: 6pt;text-align: left;">19</p><p class="s46" style="padding-top: 4pt;text-indent: 0pt;text-align: left;">29</p><p style="text-indent: 0pt;text-align: left;"/><p class="s46" style="padding-left: 11pt;text-indent: 0pt;line-height: 6pt;text-align: left;">10</p><p class="s46" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">20</p><p class="s46" style="padding-top: 2pt;text-indent: 0pt;text-align: left;">30</p><p class="s46" style="padding-top: 4pt;padding-left: 11pt;text-indent: 0pt;text-align: left;">31</p><p style="text-indent: 0pt;text-align: left;"/><p class="s46" style="text-indent: 0pt;line-height: 6pt;text-align: left;">11</p><p style="text-indent: 0pt;text-align: left;"/><p class="s46" style="text-indent: 0pt;line-height: 6pt;text-align: left;">17</p><p style="text-indent: 0pt;text-align: left;"/><p class="s46" style="text-indent: 0pt;line-height: 6pt;text-align: left;">21</p><p style="text-indent: 0pt;text-align: left;"/><p class="s46" style="text-indent: 0pt;line-height: 6pt;text-align: left;">Spindle</p><p style="text-indent: 0pt;text-align: left;"/><p class="s46" style="text-indent: 0pt;line-height: 6pt;text-align: left;">6 16 26</p><p style="text-indent: 0pt;text-align: left;"/><p class="s46" style="text-indent: 0pt;line-height: 6pt;text-align: left;">32 22 0</p><p style="text-indent: 0pt;text-align: left;"/><p class="s46" style="text-indent: 0pt;line-height: 6pt;text-align: left;">25</p><p style="text-indent: 0pt;text-align: left;"/><p class="s46" style="text-indent: 0pt;line-height: 6pt;text-align: left;">33</p><p style="text-indent: 0pt;text-align: left;"/><p class="s46" style="padding-left: 8pt;text-indent: 0pt;line-height: 5pt;text-align: left;">15         23</p><p class="s46" style="text-indent: 0pt;line-height: 7pt;text-align: left;">5  24</p><p class="s46" style="padding-top: 2pt;padding-left: 23pt;text-indent: 0pt;text-align: left;">14</p><p style="text-indent: 0pt;text-align: left;"/><p class="s46" style="text-indent: 0pt;line-height: 6pt;text-align: left;">4</p><p style="text-indent: 0pt;text-align: left;"/><p class="s46" style="text-indent: 0pt;line-height: 6pt;text-align: left;">35</p><p class="s46" style="padding-top: 4pt;text-indent: 0pt;text-align: left;">13</p><p class="s46" style="padding-top: 4pt;padding-left: 1pt;text-indent: 0pt;text-align: left;">3</p><p style="text-indent: 0pt;text-align: left;"/><p class="s46" style="text-indent: 0pt;line-height: 6pt;text-align: left;">34</p><p class="s46" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">12</p><p style="text-indent: 0pt;text-align: left;"/><p class="s46" style="text-indent: 0pt;line-height: 6pt;text-align: left;">1</p><p style="text-indent: 0pt;text-align: left;"/><p class="s46" style="text-indent: 0pt;line-height: 6pt;text-align: left;">2</p><p style="text-indent: 0pt;text-align: left;"/><p class="s46" style="text-indent: 0pt;line-height: 6pt;text-align: left;">Track skew: 2 blocks</p><p style="text-indent: 0pt;text-align: left;"/><p class="s46" style="padding-top: 4pt;padding-left: 28pt;text-indent: 0pt;text-align: center;">Rotates this way</p><p style="padding-left: 170pt;text-indent: 0pt;line-height: 3pt;text-align: left;"><span><img width="45" height="5" alt="image" src="Image_545.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 4pt;padding-left: 98pt;text-indent: 0pt;text-align: left;">Figure 37.4: <b>Three Tracks: Track Skew Of 2</b></p><p style="padding-top: 5pt;padding-left: 41pt;text-indent: 11pt;line-height: 89%;text-align: justify;">Sectors are often skewed like this because when switching from one track to another, the disk needs time to reposition the head (even to neigh- boring tracks). Without such skew, the head would be moved to the next track but the desired next block would have already rotated under the head, and thus the drive would have to wait almost the entire rotational delay to access the next block.</p><p style="padding-left: 41pt;text-indent: 11pt;line-height: 89%;text-align: justify;">Another reality is that outer tracks tend to have more sectors than inner tracks, which is a result of geometry; there is simply more room out there. These tracks are often referred to as <b>multi-zoned </b>disk drives, where the disk is organized into multiple zones, and where a zone is con- secutive set of tracks on a surface. Each zone has the same number of sectors per track, and outer zones have more sectors than inner zones.</p><p style="padding-left: 41pt;text-indent: 11pt;line-height: 89%;text-align: justify;">Finally, an important part of any modern disk drive is its <b>cache</b>, for historical reasons sometimes called a <b>track buffer</b>. This cache is just some small amount of memory (usually around 8 or 16 MB) which the drive can use to hold data read from or written to the disk. For example, when reading a sector from the disk, the drive might decide to read in all of the sectors on that track and cache them in its memory; doing so allows the drive to quickly respond to any subsequent requests to the same track.</p><p style="padding-left: 41pt;text-indent: 11pt;line-height: 89%;text-align: justify;">On writes, the drive has a choice: should it acknowledge the write has completed when it has put the data in its memory, or after the write has actually been written to disk? The former is called <b>write back </b>caching (or sometimes <b>immediate reporting</b>), and the latter <b>write through</b>. Write back caching sometimes makes the drive appear “faster”, but can be dan- gerous; if the file system or applications require that data be written to disk in a certain order for correctness, write-back caching can lead to problems (read the chapter on file-system journaling for details).</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="408" height="483" alt="image" src="Image_546.png"/></span></p><p style="padding-top: 2pt;padding-left: 144pt;text-indent: 0pt;line-height: 11pt;text-align: left;">A<span class="s7">SIDE</span>: <b>D</b><span class="s45">IMENSIONAL </span><b>A</b><span class="s45">NALYSIS</span></p><p style="padding-left: 68pt;text-indent: 12pt;line-height: 89%;text-align: justify;">Remember in Chemistry class, how you solved virtually every prob- lem by simply setting up the units such that they canceled out, and some- how the answers popped out as a result? That chemical magic is known by the highfalutin name of <b>dimensional analysis </b>and it turns out it is useful in computer systems analysis too.</p><p style="padding-top: 2pt;padding-left: 68pt;text-indent: 12pt;line-height: 89%;text-align: justify;">Let’s do an example to see how dimensional analysis works and why it is useful. In this case, assume you have to figure out how long, in mil- liseconds, a single rotation of a disk takes. Unfortunately, you are given only the <b>RPM </b>of the disk, or <b>rotations per minute</b>. Let’s assume we’re talking about a 10K RPM disk (i.e., it rotates 10,000 times per minute). How do we set up the dimensional analysis so that we get time per rota- tion in milliseconds?</p><p style="padding-top: 2pt;padding-left: 68pt;text-indent: 12pt;line-height: 89%;text-align: justify;">To do so, we start by putting the desired units on the left; in this case, we wish to obtain the time (in milliseconds) per rotation, so that is ex-</p><p class="s62" style="text-indent: 0pt;line-height: 6pt;text-align: left;">1 <i>Rotation</i></p><p style="text-indent: 0pt;text-align: left;"/><p class="s124" style="padding-top: 2pt;padding-left: 68pt;text-indent: 0pt;line-height: 89%;text-align: justify;"><span class="p">actly what we write down: </span>Time<span class="s125"> </span><span class="s63">(</span>ms<span class="s63">)</span><span class="s64"> </span><span class="p">. We then write down everything we know, making sure to cancel units where possible. First, we obtain</span></p><p class="s62" style="text-indent: 0pt;line-height: 6pt;text-align: left;">1 <i>minute</i></p><p style="text-indent: 0pt;text-align: left;"/><p class="s62" style="text-indent: 0pt;line-height: 6pt;text-align: left;">1 <i>second</i></p><p style="text-indent: 0pt;text-align: left;"/><p class="s62" style="text-indent: 0pt;line-height: 6pt;text-align: left;">10<i>,</i>000 <i>Rotations</i></p><p style="text-indent: 0pt;text-align: left;"/><p class="s63" style="padding-left: 68pt;text-indent: 1pt;line-height: 110%;text-align: justify;"><span class="s92">  </span>1<span class="s126"> </span><i>minute</i><i> </i><i> </i><span class="p">(keeping rotation on the bottom, as that’s where it is on the left), then transform minutes into seconds with </span>60<span class="s126"> </span><i>seconds</i><i> </i><span class="p">, and then finally transform seconds in milliseconds with </span>1000<span class="s126"> </span><i>ms</i><i> </i><span class="p">. The final result is</span></p><p style="padding-left: 68pt;text-indent: 0pt;line-height: 9pt;text-align: left;">this equation, with units nicely canceled, is:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s157" style="padding-left: 88pt;text-indent: -7pt;text-align: left;">Time <span class="s158">(</span>ms<span class="s158">)</span><span class="s62"> 1 </span><span class="s127">Rot.</span></p><p class="s159" style="padding-top: 4pt;padding-left: 20pt;text-indent: 0pt;line-height: 81%;text-align: left;">---<span class="s160">---</span><span class="s161">---</span></p><p class="s162" style="text-indent: 0pt;line-height: 57%;text-align: left;">= <span class="s62">1 </span><span class="s127">minute</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s62" style="padding-left: 12pt;text-indent: 0pt;line-height: 6pt;text-align: left;">10<i>,</i>000 <i>Rot.</i></p><p class="s159" style="padding-top: 2pt;padding-left: 38pt;text-indent: 0pt;line-height: 11pt;text-align: right;">---<span class="s163">---</span><span class="s161">---</span></p><p class="s62" style="text-indent: 0pt;line-height: 6pt;text-align: left;">1 <i>minute</i></p><p style="text-indent: 0pt;text-align: left;"/><p class="s127" style="padding-left: 38pt;text-indent: 0pt;line-height: 11%;text-align: right;"><span class="s164">· </span><span class="s62">60</span><span class="s165">---</span>sec<span class="s166">---</span>on<span class="s159">---</span>ds <span class="s164">·</span></p><p class="s157" style="padding-top: 9pt;padding-left: 2pt;text-indent: 0pt;text-align: left;"><span class="s158">1000</span><span class="s167">---</span>m<span class="s159">---</span>s<span class="s127"> </span><span class="s162">=</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s158" style="padding-left: 1pt;text-indent: 0pt;text-align: left;"><span class="s168"> </span>60<i>,</i>000 <i>ms </i></p><p class="s44" style="text-indent: 0pt;line-height: 9pt;text-align: left;">=</p><p style="text-indent: 0pt;text-align: left;"/><p class="s62" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">10<i>,</i>000 <i>Rot.</i></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s168" style="padding-left: 1pt;text-indent: 0pt;text-align: left;"> <span class="s158">6 </span><span class="s157">ms </span><span class="s127"> Rotation</span></p><p class="s169" style="text-indent: 0pt;line-height: 10pt;text-align: left;">1 <span class="s161">---</span><i>second</i></p><p style="text-indent: 0pt;text-align: left;"/><p class="s160" style="text-indent: 0pt;line-height: 11pt;text-align: left;">---<span class="s161">---</span></p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-top: 7pt;padding-left: 68pt;text-indent: 12pt;line-height: 89%;text-align: justify;">As you can see from this example, dimensional analysis makes what seems obvious into a simple and repeatable process. Beyond the RPM calculation above, it comes in handy with I/O analysis regularly. For example, you will often be given the transfer rate of a disk, e.g., 100 MB/second, and then asked: how long does it take to transfer a 512 KB block (in milliseconds)? With dimensional analysis, it’s easy:</p><p class="s157" style="padding-top: 9pt;padding-left: 94pt;text-indent: 0pt;line-height: 3pt;text-align: left;">Time <span class="s158">(</span>ms<span class="s158">)</span><span class="s62"> </span><span class="s162">= </span><span class="s168">&nbsp;</span><span class="s158">512</span><span class="s171"> </span>K<span class="s172"> </span>B <span class="s127"> </span><span class="s164">· </span><span class="s168">&nbsp;</span><span class="s158">1</span><span class="s173"> </span>M<span class="s174"> </span>B <span class="s127"> </span><span class="s164">·</span></p><p class="s170" style="padding-top: 7pt;padding-left: 1pt;text-indent: 0pt;line-height: 5pt;text-align: left;"><span class="s169">1 </span><span class="s161">---</span>second <span class="s164">· </span><span class="s169">1000</span><span class="s159">---</span>m<span class="s175">---</span>s <span class="s162">= </span><span class="s176">&nbsp;</span><u>5 </u><u>ms </u></p><p class="s62" style="padding-top: 4pt;padding-left: 38pt;text-indent: 0pt;text-align: right;">1 <i>Request</i></p><p class="s62" style="padding-top: 4pt;padding-left: 14pt;text-indent: 0pt;text-align: left;">1 <i>Request</i></p><p class="s127" style="padding-top: 5pt;padding-left: 7pt;text-indent: 0pt;text-align: left;"><span class="s62">1024</span><span class="s160"> </span>K<span class="s161"> </span>B</p><p class="s127" style="padding-top: 5pt;padding-left: 8pt;text-indent: 0pt;text-align: left;"><span class="s62">100</span><span class="s163"> </span>M<span class="s179"> </span>B</p><p class="s169" style="padding-top: 1pt;padding-left: 8pt;text-indent: 0pt;text-align: left;">1 <span class="s161">---</span><i>second</i></p><p class="s127" style="padding-top: 4pt;padding-left: 12pt;text-indent: 0pt;text-align: left;">Request</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part383.htm">&lt; 上一个</a><span> | </span><a href="../ostep.html">内容</a><span> | </span><a href="part385.htm">下一个 &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
