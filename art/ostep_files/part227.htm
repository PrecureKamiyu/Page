<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>22.3 A Simple Policy: FIFO</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part226.htm">&lt; 上一个</a><span> | </span><a href="../ostep.html">内容</a><span> | </span><a href="part228.htm">下一个 &gt;</a></p><p class="s40" style="padding-top: 7pt;padding-left: 38pt;text-indent: 0pt;text-align: left;">22.3 A Simple Policy: FIFO</p><p style="padding-top: 4pt;padding-left: 68pt;text-indent: 12pt;line-height: 89%;text-align: justify;">Many early systems avoided the complexity of trying to approach optimal and employed very simple replacement policies. For example, some systems used <b>FIFO </b>(first-in, first-out) replacement, where pages were simply placed in a queue when they enter the system; when a re- placement occurs, the page on the tail of the queue (the “first-in” page) is evicted. FIFO has one great strength: it is quite simple to implement.</p><p style="padding-left: 68pt;text-indent: 12pt;line-height: 89%;text-align: justify;">Let’s examine how FIFO does on our example reference stream (Table <span style=" color: #00AEEF;">22.2</span>). We again begin our trace with three compulsory misses to pages 0, 1, and 2, and then hit on both 0 and 1. Next, page 3 is referenced, causing a miss; the replacement decision is easy with FIFO: pick the page that</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 68pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="154" height="1" alt="image" src="Image_294.png"/></span></p><p class="s11" style="padding-top: 2pt;padding-left: 68pt;text-indent: 13pt;line-height: 92%;text-align: justify;">1<span class="s12">If you can, let us know! We can become rich together. Or, like the scientists who “discov- ered” cold fusion, widely scorned and mocked.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:88.108pt" cellspacing="0"><tr style="height:18pt"><td style="width:36pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F"><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s123" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Access</p></td><td style="width:48pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F"><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s123" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Hit/Miss?</p></td><td style="width:30pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F"><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s123" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Evict</p></td><td style="width:78pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F"><p class="s123" style="padding-left: 21pt;text-indent: 0pt;line-height: 8pt;text-align: left;">Resulting</p><p class="s123" style="padding-left: 17pt;text-indent: 0pt;line-height: 9pt;text-align: left;">Cache State</p></td></tr><tr style="height:10pt"><td style="width:36pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F"><p class="s108" style="text-indent: 0pt;line-height: 7pt;text-align: center;">0</p></td><td style="width:48pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 7pt;text-align: center;">Miss</p></td><td style="width:30pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:78pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 7pt;text-align: center;">First-in<span class="s128">→</span><span class="s129">   </span>0</p></td></tr><tr style="height:10pt"><td style="width:36pt"><p class="s108" style="text-indent: 0pt;line-height: 9pt;text-align: center;">1</p></td><td style="width:48pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Miss</p></td><td style="width:30pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:78pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">First-in<span class="s128">→  </span>0, 1</p></td></tr><tr style="height:10pt"><td style="width:36pt"><p class="s108" style="text-indent: 0pt;line-height: 9pt;text-align: center;">2</p></td><td style="width:48pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Miss</p></td><td style="width:30pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:78pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">First-in<span class="s128">→  </span>0, 1, 2</p></td></tr><tr style="height:10pt"><td style="width:36pt"><p class="s108" style="text-indent: 0pt;line-height: 9pt;text-align: center;">0</p></td><td style="width:48pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Hit</p></td><td style="width:30pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:78pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">First-in<span class="s128">→  </span>0, 1, 2</p></td></tr><tr style="height:10pt"><td style="width:36pt"><p class="s108" style="text-indent: 0pt;line-height: 9pt;text-align: center;">1</p></td><td style="width:48pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Hit</p></td><td style="width:30pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:78pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">First-in<span class="s128">→  </span>0, 1, 2</p></td></tr><tr style="height:10pt"><td style="width:36pt"><p class="s108" style="text-indent: 0pt;line-height: 8pt;text-align: center;">3</p></td><td style="width:48pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 8pt;text-align: center;">Miss</p></td><td style="width:30pt"><p class="s108" style="text-indent: 0pt;line-height: 8pt;text-align: center;">0</p></td><td style="width:78pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 8pt;text-align: center;">First-in<span class="s128">→  </span>1, 2, 3</p></td></tr><tr style="height:10pt"><td style="width:36pt"><p class="s108" style="text-indent: 0pt;line-height: 8pt;text-align: center;">0</p></td><td style="width:48pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 8pt;text-align: center;">Miss</p></td><td style="width:30pt"><p class="s108" style="text-indent: 0pt;line-height: 8pt;text-align: center;">1</p></td><td style="width:78pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 8pt;text-align: center;">First-in<span class="s128">→  </span>2, 3, 0</p></td></tr><tr style="height:10pt"><td style="width:36pt"><p class="s108" style="text-indent: 0pt;line-height: 9pt;text-align: center;">3</p></td><td style="width:48pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Hit</p></td><td style="width:30pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:78pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">First-in<span class="s128">→  </span>2, 3, 0</p></td></tr><tr style="height:10pt"><td style="width:36pt"><p class="s108" style="text-indent: 0pt;line-height: 9pt;text-align: center;">1</p></td><td style="width:48pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Miss</p></td><td style="width:30pt"><p class="s108" style="text-indent: 0pt;line-height: 9pt;text-align: center;">2</p></td><td style="width:78pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">First-in<span class="s128">→  </span>3, 0, 1</p></td></tr><tr style="height:10pt"><td style="width:36pt"><p class="s108" style="text-indent: 0pt;line-height: 9pt;text-align: center;">2</p></td><td style="width:48pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Miss</p></td><td style="width:30pt"><p class="s108" style="text-indent: 0pt;line-height: 9pt;text-align: center;">3</p></td><td style="width:78pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">First-in<span class="s128">→  </span>0, 1, 2</p></td></tr><tr style="height:10pt"><td style="width:36pt"><p class="s108" style="text-indent: 0pt;line-height: 9pt;text-align: center;">1</p></td><td style="width:48pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Hit</p></td><td style="width:30pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:78pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">First-in<span class="s128">→  </span>0, 1, 2</p></td></tr></table><p style="padding-top: 4pt;padding-left: 114pt;text-indent: 0pt;text-align: left;">Table 22.2: <b>Tracing the FIFO Policy</b></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 5pt;padding-left: 41pt;text-indent: 0pt;line-height: 89%;text-align: justify;">was the “first one” in (the cache state in the table is kept in FIFO order, with the first-in page on the left), which is page 0. Unfortunately, our next access is to page 0, causing another miss and replacement (of page 1). We then hit on page 3, but miss on 1 and 2, and finally hit on 3.</p><p style="padding-left: 41pt;text-indent: 11pt;line-height: 89%;text-align: justify;">Comparing FIFO to optimal, FIFO does notably worse: a 36.4% hit rate (or 57.1% excluding compulsory misses). FIFO simply can’t deter- mine the importance of blocks: even though page 0 had been accessed a number of times, FIFO still kicks it out, simply because it was the first one brought into memory.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s27" style="padding-top: 6pt;padding-left: 94pt;text-indent: 0pt;line-height: 11pt;text-align: left;"><span class="p">A</span><span class="s7">SIDE</span><span class="p">: </span>B<span class="s45">ELADY</span>’<span class="s45">S </span>A<span class="s45">NOMALY</span></p><p style="padding-left: 9pt;text-indent: 0pt;line-height: 89%;text-align: justify;">Belady (of the optimal policy) and colleagues found an interesting refer- ence stream that behaved a little unexpectedly [BNS69]. The memory- reference stream: 1, 2, 3, 4, 1, 2, 5, 1, 2, 3, 4, 5. The replacement policy they were studying was FIFO. The interesting part: how the cache hit rate changed when moving from a cache size of 3 to 4 pages.</p><p style="padding-top: 3pt;padding-left: 9pt;text-indent: 0pt;line-height: 89%;text-align: justify;">In general, you would expect the cache hit rate to <i>increase </i>(get better) when the cache gets larger. But in this case, with FIFO, it gets worse! Cal- culate the hits and misses yourself and see. This odd behavior is generally referred to as <b>Belady’s Anomaly </b>(to the chagrin of his co-authors).</p><p style="padding-top: 3pt;padding-left: 9pt;text-indent: 0pt;line-height: 89%;text-align: justify;">Some other policies, such as LRU, don’t suffer from this problem. Can you guess why? As it turns out, LRU has what is known as a <b>stack prop- erty </b>[M+70]. For algorithms with this property, a cache of size <span class="s43">N </span><span class="s44">+ 1 </span>naturally includes the contents of a cache of size <span class="s43">N </span>. Thus, when increas- ing the cache size, hit rate will either stay the same or improve. FIFO and Random (among others) clearly do not obey the stack property, and thus are susceptible to anomalous behavior.</p><p style="padding-left: 32pt;text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:127.828pt" cellspacing="0"><tr style="height:21pt"><td style="width:36pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F"><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s123" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Access</p></td><td style="width:48pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F"><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s123" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Hit/Miss?</p></td><td style="width:30pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F"><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s123" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Evict</p></td><td style="width:54pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F"><p class="s123" style="padding-left: 6pt;padding-right: 5pt;text-indent: 3pt;line-height: 10pt;text-align: left;">Resulting Cache State</p></td></tr><tr style="height:10pt"><td style="width:36pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F"><p class="s108" style="text-indent: 0pt;line-height: 9pt;text-align: center;">0</p></td><td style="width:48pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Miss</p></td><td style="width:30pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:54pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F"><p class="s108" style="padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: right;">0</p></td></tr><tr style="height:10pt"><td style="width:36pt"><p class="s108" style="text-indent: 0pt;line-height: 9pt;text-align: center;">1</p></td><td style="width:48pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Miss</p></td><td style="width:30pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:54pt"><p class="s108" style="padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: right;">0, 1</p></td></tr><tr style="height:10pt"><td style="width:36pt"><p class="s108" style="text-indent: 0pt;line-height: 9pt;text-align: center;">2</p></td><td style="width:48pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Miss</p></td><td style="width:30pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:54pt"><p class="s108" style="padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: right;">0, 1, 2</p></td></tr><tr style="height:10pt"><td style="width:36pt"><p class="s108" style="text-indent: 0pt;line-height: 9pt;text-align: center;">0</p></td><td style="width:48pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Hit</p></td><td style="width:30pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:54pt"><p class="s108" style="padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: right;">0, 1, 2</p></td></tr><tr style="height:10pt"><td style="width:36pt"><p class="s108" style="text-indent: 0pt;line-height: 9pt;text-align: center;">1</p></td><td style="width:48pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Hit</p></td><td style="width:30pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:54pt"><p class="s108" style="padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: right;">0, 1, 2</p></td></tr><tr style="height:10pt"><td style="width:36pt"><p class="s108" style="text-indent: 0pt;line-height: 8pt;text-align: center;">3</p></td><td style="width:48pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 8pt;text-align: center;">Miss</p></td><td style="width:30pt"><p class="s108" style="text-indent: 0pt;line-height: 8pt;text-align: center;">0</p></td><td style="width:54pt"><p class="s108" style="padding-right: 5pt;text-indent: 0pt;line-height: 8pt;text-align: right;">1, 2, 3</p></td></tr><tr style="height:10pt"><td style="width:36pt"><p class="s108" style="text-indent: 0pt;line-height: 8pt;text-align: center;">0</p></td><td style="width:48pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 8pt;text-align: center;">Miss</p></td><td style="width:30pt"><p class="s108" style="text-indent: 0pt;line-height: 8pt;text-align: center;">1</p></td><td style="width:54pt"><p class="s108" style="padding-right: 5pt;text-indent: 0pt;line-height: 8pt;text-align: right;">2, 3, 0</p></td></tr><tr style="height:10pt"><td style="width:36pt"><p class="s108" style="text-indent: 0pt;line-height: 9pt;text-align: center;">3</p></td><td style="width:48pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Hit</p></td><td style="width:30pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:54pt"><p class="s108" style="padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: right;">2, 3, 0</p></td></tr><tr style="height:10pt"><td style="width:36pt"><p class="s108" style="text-indent: 0pt;line-height: 9pt;text-align: center;">1</p></td><td style="width:48pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Miss</p></td><td style="width:30pt"><p class="s108" style="text-indent: 0pt;line-height: 9pt;text-align: center;">3</p></td><td style="width:54pt"><p class="s108" style="padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: right;">2, 0, 1</p></td></tr><tr style="height:10pt"><td style="width:36pt"><p class="s108" style="text-indent: 0pt;line-height: 9pt;text-align: center;">2</p></td><td style="width:48pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Hit</p></td><td style="width:30pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:54pt"><p class="s108" style="padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: right;">2, 0, 1</p></td></tr><tr style="height:12pt"><td style="width:36pt"><p class="s108" style="text-indent: 0pt;line-height: 9pt;text-align: center;">1</p></td><td style="width:48pt"><p class="s108" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Hit</p></td><td style="width:30pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:54pt"><p class="s108" style="padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: right;">2, 0, 1</p></td></tr></table><p style="padding-top: 2pt;padding-left: 135pt;text-indent: 0pt;text-align: left;">Table 22.3: <b>Tracing the Random Policy</b></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part226.htm">&lt; 上一个</a><span> | </span><a href="../ostep.html">内容</a><span> | </span><a href="part228.htm">下一个 &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
