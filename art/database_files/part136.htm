<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>6.5   Primary Key</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part135.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part137.htm">下一个 &gt;</a></p><p class="s65" style="padding-left: 40pt;text-indent: 0pt;text-align: left;">6.5   <span style=" color: #00AEEF;">Primary Key</span></p><p style="padding-top: 12pt;padding-left: 88pt;text-indent: 0pt;text-align: justify;">We must have a way to specify how entities within a given entity set and relationships within a given relationship set are distinguished.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s68" style="padding-top: 4pt;padding-left: 119pt;text-indent: 0pt;text-align: left;">6.5.1 Entity Sets</p><p style="padding-top: 6pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">Conceptually, individual entities are distinct; from a database perspective, however, the diﬀerences among them must be expressed in terms of their attributes.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">Therefore, the values of the attribute values of an entity must be such that they can <i>uniquely identify </i>the entity. In other words, no two entities in an entity set are allowed to have exactly the same value for all attributes.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">The notion of a <i>key </i>for a relation schema, as deﬁned in Section 2.3, applies directly to entity sets. That is, a key for an entity is a set of attributes that suﬃce to distinguish entities from each other. The concepts of superkey, candidate key, and primary key are applicable to entity sets just as they are applicable to relation schemas.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">Keys also help to identify relationships uniquely, and thus distinguish relationships from each other. Next, we deﬁne the corresponding notions of keys for relationship sets.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s68" style="padding-left: 119pt;text-indent: 0pt;text-align: left;">6.5.2 Relationship Sets</p><p style="padding-top: 6pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">We need a mechanism to distinguish among the various relationships of a relationship set.</p><p class="s13" style="padding-left: 119pt;text-indent: 17pt;text-align: justify;"><span class="p">Let </span>R <span class="p">be a relationship set involving entity sets </span>E<span class="s93">1</span><span class="s94">, </span>E<span class="s93">2</span><span class="s94">, </span><span class="s15">… </span><span class="p">, </span>E<span class="s145">n</span><span class="p">. Let </span>primary-key<span class="p">(</span>E<span class="s145">i</span><span class="p">) denote the set of attributes that forms the primary key for entity set </span>E<span class="s145">i</span><span class="p">. Assume for now that the attribute names of all primary keys are unique. The composition of the primary key for a relationship set depends on the set of attributes associated with the relationship set </span>R<span class="p">.</span></p><p style="padding-left: 137pt;text-indent: 0pt;text-align: justify;">If the relationship set <i>R </i>has no attributes associated with it, then the set of attributes</p><p class="s13" style="padding-top: 5pt;padding-left: 119pt;text-indent: 58pt;line-height: 19pt;text-align: justify;">primary-key<span class="p">(</span>E<span class="s130">1</span><span class="s94">) </span><span class="s15">∪ </span>primary-key<span class="p">(</span>E<span class="s130">2</span><span class="s94">) </span><span class="s15">∪ </span><span class="s86">⋯ </span><span class="s15">∪ </span>primary-key<span class="p">(</span>E<span class="s97">n</span><span class="p">) describes an individual relationship in set </span>R<span class="p">.</span></p><p style="padding-top: 1pt;padding-left: 119pt;text-indent: 17pt;line-height: 87%;text-align: justify;">If the relationship set <i>R </i>has attributes <i>a</i><span class="s98">1</span>, <i>a</i><span class="s98">2</span>, <span class="s15">… </span>, <i>a</i><span class="s97">m </span>associated with it, then the set of attributes</p><p class="s13" style="padding-top: 7pt;padding-left: 137pt;text-indent: 0pt;text-align: justify;">primary-key<span class="p">(</span>E<span class="s93">1</span><span class="s94">) </span><span class="s15">∪ </span>primary-key<span class="p">(</span>E<span class="s93">2</span><span class="s94">) </span><span class="s15">∪ </span><span class="s86">⋯ </span><span class="s15">∪ </span>primary-key<span class="p">(</span>E<span class="s145">n</span><span class="p">) </span><span class="s15">∪ {</span>a<span class="s93">1</span><span class="s94">, </span>a<span class="s93">2</span><span class="s94">, </span><span class="s15">… </span><span class="p">, </span>a<span class="s145">m</span><span class="s15">}</span></p><p style="padding-top: 6pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">describes an individual relationship in set <i>R</i>.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">If the attribute names of primary keys are not unique across entity sets, the at- tributes are renamed to distinguish them; the name of the entity set combined with the name of the attribute would form a unique name. If an entity set participates more than once in a relationship set (as in the <i>prereq </i>relationship in Section 6.2.2), the role name is used instead of the name of the entity set, to form a unique attribute name.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">Recall that a relationship set is a set of relationship instances, and each instance is uniquely identiﬁed by the entities that participate in it. Thus, in both of the preceding cases, the set of attributes</p><p class="s13" style="padding-top: 7pt;padding-left: 119pt;text-indent: 58pt;line-height: 139%;text-align: justify;">primary-key<span class="p">(</span>E<span class="s93">1</span><span class="s94">) </span><span class="s15">∪ </span>primary-key<span class="p">(</span>E<span class="s93">2</span><span class="s94">) </span><span class="s15">∪ </span><span class="s86">⋯ </span><span class="s15">∪ </span>primary-key<span class="p">(</span>E<span class="s145">n</span><span class="p">) forms a superkey for the relationship set.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 4pt;padding-left: 88pt;text-indent: 17pt;text-align: justify;">The choice of the primary key for a binary relationship set depends on the map- ping cardinality of the relationship set. For many-to-many relationships, the preceding union of the primary keys is a minimal superkey and is chosen as the primary key. As an illustration, consider the entity sets <i>instructor </i>and <i>student</i>, and the relationship set <i>advisor</i>, in Section 6.2.2. Suppose that the relationship set is many-to-many. Then the primary key of <i>advisor </i>consists of the union of the primary keys of <i>instructor </i>and <i>student</i>.</p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">For one-to-many and many-to-one relationships, the primary key of the “many” side is a minimal superkey and is used as the primary key. For example, if the relationship is many-to-one from <i>student </i>to <i>instructor </i>— that is, each student can have at most one advisor— then the primary key of <i>advisor </i>is simply the primary key of <i>student</i>. However, if an instructor can advise only one student— that is, if the <i>advisor </i>relationship is many- to-one from <i>instructor </i>to <i>student </i>— then the primary key of <i>advisor </i>is simply the primary key of <i>instructor</i>.</p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">For one-to-one relationships, the primary key of either one of the participating entity sets forms a minimal superkey, and either one can be chosen as the primary key of the relationship set. However, if an instructor can advise only one student, and each student can be advised by only one instructor— that is, if the <i>advisor </i>relationship is one-to-one— then the primary key of either <i>student </i>or <i>instructor </i>can be chosen as the primary key for <i>advisor</i>.</p><p class="s13" style="padding-left: 88pt;text-indent: 17pt;text-align: right;"><span class="p">For nonbinary relationships, if no cardinality constraints are present, then the su- perkey formed as described earlier in this section is the only candidate key, and it is chosen as the primary key. The choice of the primary key is more complicated if cardi- nality constraints are present. As we noted in Section 6.4, we permit at most one arrow out of a relationship set. We do so because an </span><span class="s44">E-R </span><span class="p">diagram with two or more arrows out of a nonbinary relationship set can be interpreted in the two ways we describe below. Suppose there is a relationship set </span>R <span class="p">between entity sets </span>E<span class="s93">1</span><span class="s94">, </span>E<span class="s93">2</span><span class="s94">, </span>E<span class="s93">3</span><span class="s94">, </span>E<span class="s93">4</span><span class="s94">, and the only</span></p><p style="text-indent: 0pt;line-height: 11pt;text-align: right;">arrows are on the edges to entity sets <i>E</i><span class="s98">3</span> and <i>E</i><span class="s98">4</span>. Then, the two possible interpretations</p><p style="padding-left: 88pt;text-indent: 0pt;text-align: left;">are:</p><p style="padding-top: 10pt;padding-left: 113pt;text-indent: -16pt;text-align: justify;"><span class="s63">1. </span>A particular combination of entities from <i>E</i><span class="s98">1</span>, <i>E</i><span class="s98">2</span> can be associated with at most one combination of entities from <i>E</i><span class="s98">3</span>, <i>E</i><span class="s98">4</span>. Thus, the primary key for the relation- ship <i>R </i>can be constructed by the union of the primary keys of <i>E</i><span class="s98">1</span> and <i>E</i><span class="s98">2</span>.</p><p class="s13" style="padding-top: 6pt;padding-left: 113pt;text-indent: -17pt;text-align: justify;"><span class="s63">2. </span><span class="p">A particular combination of entities from </span>E<span class="s98">1</span><span class="p">, </span>E<span class="s98">2</span><span class="p">, </span>E<span class="s98">3</span><span class="p"> can be associated with at most one combination of entities from </span>E<span class="s98">4</span><span class="p">, and further a particular combination of entities from </span>E<span class="s98">1</span><span class="p">, </span>E<span class="s98">2</span><span class="p">, </span>E<span class="s98">4</span><span class="p"> can be associated with at most one combination of entities from </span>E<span class="s130">3</span><span class="s94">, Then the union of the primary keys of </span>E<span class="s130">1</span><span class="s94">, </span>E<span class="s130">2</span><span class="s94">, and </span>E<span class="s130">3 </span><span class="s94">forms a</span></p><p class="s13" style="padding-left: 113pt;text-indent: 0pt;line-height: 79%;text-align: justify;"><span class="p">candidate key, as does the union of the primary keys of </span>E<span class="s130">1</span><span class="s94">, </span>E<span class="s130">2</span><span class="s94">, and </span>E<span class="s130">4</span><span class="s94">.</span></p><p style="padding-top: 9pt;padding-left: 88pt;text-indent: 0pt;text-align: justify;">Each of these interpretations has been used in practice and both are correct for particu- lar enterprises being modeled. Thus, to avoid confusion, we permit only one arrow out of a nonbinary relationship set, in which case the two interpretations are equivalent.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 4pt;padding-left: 119pt;text-indent: 17pt;text-align: justify;">In order to represent a situation where one of the multiple-arrow situations holds, the <span class="s44">E-R </span>design can be modiﬁed by replacing the non-binary relationship set with an entity set. That is, we treat each instance of the non-binary relationship set as an entity. Then we can relate each of those entities to corresponding instances of <i>E</i><span class="s98">1</span>, <i>E</i><span class="s98">2</span>, <i>E</i><span class="s98">4</span> via separate relationship sets. A simpler approach is to use <i>functional dependencies</i>, which we study in Chapter 7 (Section 7.4). Functional dependencies which allow either of these interpretations to be speciﬁed simply in an unambiguous manner.</p><p style="padding-top: 1pt;padding-left: 119pt;text-indent: 17pt;line-height: 94%;text-align: justify;">The primary key for the relationship set <i>R </i>is then the union of the primary keys of those participating entity sets <i>E</i><span class="s97">i </span>that do not have an incoming arrow from the relation- ship set <i>R</i>.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s68" style="padding-left: 119pt;text-indent: 0pt;text-align: left;">6.5.3 Weak Entity Sets</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1432.png"/></span></p><p style="padding-top: 6pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">Consider a <i>section </i>entity, which is uniquely identiﬁed by a course identiﬁer, semester, year, and section identiﬁer. Section entities are related to course entities. Suppose we create a relationship set <i>sec course </i>between entity sets <i>section </i>and <i>course</i>.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1433.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1434.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1435.png"/></span></p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">Now, observe that the information in <i>sec course </i>is redundant, since <i>section </i>already has an attribute <i>course id</i>, which identiﬁes the course with which the section is related. One option to deal with this redundancy is to get rid of the relationship <i>sec course</i>; however, by doing so the relationship between <i>section </i>and <i>course </i>becomes implicit in an attribute, which is not desirable.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1436.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1437.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1438.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1439.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1440.png"/></span></p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">An alternative way to deal with this redundancy is to not store the attribute <i>course id </i>in the <i>section </i>entity and to only store the remaining attributes <i>sec id</i>, <i>year</i>, and <i>semester</i>.<span class="s76">2</span> However, the entity set <i>section </i>then does not have enough attributes to iden- tify a particular <i>section </i>entity uniquely; although each <i>section </i>entity is distinct, sections for diﬀerent courses may share the same <i>sec id</i>, <i>year</i>, and <i>semester</i>. To deal with this problem, we treat the relationship <i>sec course </i>as a special relationship that provides extra information, in this case the <i>course id</i>, required to identify <i>section </i>entities uniquely.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">The notion of <i>weak entity set </i>formalizes the above intuition. A <span class="s63">weak entity set </span>is one whose existence is dependent on another entity set, called its <span class="s63">identifying entity set</span>; instead of associating a primary key with a weak entity, we use the primary key of the identifying entity, along with extra attributes, called <span class="s63">discriminator attributes </span>to uniquely identify a weak entity. An entity set that is not a weak entity set is termed a <span class="s63">strong entity set</span>.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">Every weak entity must be associated with an identifying entity; that is, the weak entity set is said to be <span class="s63">existence dependent </span>on the identifying entity set. The identifying entity set is said to <span class="s63">own </span>the weak entity set that it identiﬁes. The relationship associating the weak entity set with the identifying entity set is called the <span class="s63">identifying relationship</span>.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">The identifying relationship is many-to-one from the weak entity set to the identi- fying entity set, and the participation of the weak entity set in the relationship is total.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="96" height="1" alt="image" src="Image_1441.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="3" height="1" alt="image" src="Image_1442.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="3" height="1" alt="image" src="Image_1443.png"/></span></p><p class="s111" style="padding-top: 3pt;padding-left: 119pt;text-indent: 0pt;text-align: left;"><span class="s77">2</span><span class="s78">Note that the relational schema we eventually create from the entity set </span>section <span class="s80">does have the attribute </span>course id<span class="s80">, for reasons that will become clear later, even though we have dropped the attribute </span>course id <span class="s80">from the entity set </span>section<span class="s80">.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 4pt;padding-left: 88pt;text-indent: 0pt;text-align: justify;">The identifying relationship set should not have any descriptive attributes, since any such attributes can instead be associated with the weak entity set.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1444.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1445.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1446.png"/></span></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">In our example, the identifying entity set for <i>section </i>is <i>course</i>, and the relationship <i>sec course</i>, which associates <i>section </i>entities with their corresponding <i>course </i>entities, is the identifying relationship. The primary key of <i>section </i>is formed by the primary key of the identifying entity set (that is, <i>course</i>), plus the discriminator of the weak entity set (that is, <i>section</i>). Thus, the primary key is <span class="s95">{</span><i>course id</i>, <i>sec id</i>, <i>year</i>, <i>semester</i><span class="s95">}</span>.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1447.png"/></span></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">Note that we could have chosen to make <i>sec id </i>globally unique across all courses oﬀered in the university, in which case the <i>section </i>entity set would have had a primary key. However, conceptually, a <i>section </i>is still dependent on a <i>course </i>for its existence, which is made explicit by making it a weak entity set.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1448.png"/></span></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">In <span class="s44">E-R </span>diagrams, a weak entity set is depicted via a double rectangle with the dis- criminator being underlined with a dashed line. The relationship set connecting the weak entity set to the identifying strong entity set is depicted by a double diamond. In Figure 6.14, the weak entity set <i>section </i>depends on the strong entity set <i>course </i>via the relationship set <i>sec course</i>.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1449.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1450.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1451.png"/></span></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">The ﬁgure also illustrates the use of double lines to indicate that the participation of the (weak) entity set <i>section </i>in the relationship <i>sec course </i>is <i>total</i>, meaning that every section must be related via <i>sec course </i>to some course. Finally, the arrow from <i>sec course </i>to <i>course </i>indicates that each section is related to a single course.</p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">In general, a weak entity set must have a total participation in its identifying rela- tionship set, and the relationship is many-to-one toward the identifying entity set.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1452.png"/></span></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">A weak entity set can participate in relationships other than the identifying rela- tionship. For instance, the <i>section </i>entity could participate in a relationship with the <i>time slot </i>entity set, identifying the time when a particular class section meets. A weak entity set may participate as owner in an identifying relationship with another weak en- tity set. It is also possible to have a weak entity set with more than one identifying entity set. A particular weak entity would then be identiﬁed by a combination of entities, one from each identifying entity set. The primary key of the weak entity set would consist of the union of the primary keys of the identifying entity sets, plus the discriminator of the weak entity set.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="301" height="79" alt="image" src="Image_1453.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s69" style="padding-top: 6pt;padding-left: 50pt;text-indent: 0pt;text-align: left;">sec_course</p><p style="text-indent: 0pt;text-align: left;"/><p class="s193" style="padding-left: 8pt;text-indent: 0pt;line-height: 107%;text-align: left;">sec_id<span class="s91"> </span>semester<span class="s91"> </span>year</p><p style="text-indent: 0pt;text-align: left;"/><p class="s69" style="padding-top: 2pt;padding-left: 22pt;text-indent: 0pt;text-align: left;">section</p><p style="text-indent: 0pt;text-align: left;"/><p class="s193" style="padding-top: 1pt;padding-left: 12pt;text-indent: 0pt;line-height: 106%;text-align: left;">course_id<span class="s91"> title credits</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s69" style="padding-top: 1pt;padding-left: 22pt;text-indent: 0pt;text-align: left;">course</p><p style="text-indent: 0pt;text-align: left;"/><p class="s73" style="padding-top: 4pt;padding-left: 59pt;text-indent: 0pt;text-align: center;">Figure 6.14 <span class="s151">E-R </span><span class="s152">diagram with a weak entity set.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part135.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part137.htm">下一个 &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
