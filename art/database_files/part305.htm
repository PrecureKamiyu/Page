<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Exercises</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part304.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part306.htm">下一个 &gt;</a></p><p class="s45" style="padding-top: 9pt;padding-left: 41pt;text-indent: 0pt;text-align: left;">Exercises</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_2956.png"/></span></p><p style="padding-left: 60pt;text-indent: 0pt;text-align: center;"><b>16.16 </b>Suppose that a B<span class="s181">+</span>-tree index on (<i>dept name</i>, <i>building</i>) is available on relation</p><p class="s13" style="padding-left: 83pt;text-indent: 0pt;text-align: center;">department<span class="p">. What would be the best way to handle the following selection?</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="3" height="1" alt="image" src="Image_2957.png"/></span></p><p class="s119" style="padding-left: 152pt;text-indent: 0pt;text-align: left;"><span class="s117">σ</span>(<i>building </i><span class="s126">&lt; </span>“Watson”) <span class="s118">∧ </span>(<i>budget </i><span class="s126">&lt; </span>55000) <span class="s118">∧ </span>(<i>dept name </i><span class="s118">= </span>“Music”)<span class="s120">(</span><span class="s121">department</span><span class="s122">)</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 88pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="494" height="1" alt="image" src="Image_2958.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_2959.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_2960.png"/></span></p><p style="padding-top: 4pt;padding-left: 155pt;text-indent: 0pt;text-align: left;"><i>branch</i>(<u><i>branch name</i></u>, <i>branch city, assets</i>)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_2961.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_2962.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_2963.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_2964.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_2965.png"/></span></p><p style="padding-left: 155pt;text-indent: 0pt;text-align: left;"><i>customer </i>(<u><i>customer name</i></u>, <i>customer street, customer city</i>) <i>loan </i>(<u><i>loan number</i></u>, <i>branch name, amount</i>)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_2966.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_2967.png"/></span></p><p style="padding-left: 155pt;text-indent: 0pt;text-align: left;"><i>borrower </i>(<u><i>customer name</i></u>, <u><i>loan number</i></u>)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_2968.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_2969.png"/></span></p><p style="padding-left: 155pt;text-indent: 0pt;text-align: left;"><i>account </i>(<u><i>account number</i></u>, <i>branch name, balance </i>)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_2970.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_2971.png"/></span></p><p style="padding-left: 155pt;text-indent: 0pt;text-align: left;"><i>depositor </i>(<u><i>customer name</i></u>, <u><i>account number</i></u>)</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 88pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="494" height="1" alt="image" src="Image_2972.png"/></span></p><p class="s73" style="padding-top: 8pt;padding-left: 59pt;text-indent: 0pt;text-align: center;">Figure 16.9 <span class="s74">Banking database.</span></p><p class="s64" style="padding-top: 3pt;padding-left: 119pt;text-indent: 0pt;text-align: right;">Exercises  <span class="s164">793</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s46" style="padding-left: 155pt;text-indent: -34pt;text-align: left;">16.17 <span class="p">Show how to derive the following equivalences by a sequence of transforma- tions using the equivalence rules in Section 16.2.1.</span></p><p class="s150" style="text-indent: 0pt;line-height: 6pt;text-align: left;">1  2  3       1   2   3</p><p style="text-indent: 0pt;text-align: left;"/><p class="s15" style="padding-top: 5pt;padding-left: 162pt;text-indent: 0pt;text-align: left;"><span class="p">a.  </span>σ<span class="s137">θ</span> <span class="s137">∧θ</span> <span class="s137">∧θ</span> <span class="p">(</span><span class="s13">E</span><span class="p">) </span><span class="s86">≡ </span>σ<span class="s137">θ</span> <span class="p">(</span>σ<span class="s137">θ</span> <span class="p">(</span>σ<span class="s137">θ</span> <span class="p">(</span><span class="s13">E</span><span class="p">)))</span></p><p class="s15" style="padding-top: 2pt;padding-left: 162pt;text-indent: 0pt;line-height: 12pt;text-align: left;"><span class="p">b.  </span>σ<span class="s137">θ</span> <span class="s137">∧θ</span> <span class="p">(</span><span class="s13">E</span><span class="s130">1 </span><span class="s86">⋈</span><span class="s136">θ </span><span class="s13">E</span><span class="s130">2</span><span class="s94">) </span><span class="s86">≡ </span>σ<span class="s137">θ</span> <span class="p">(</span><span class="s13">E</span><span class="s130">1 </span><span class="s86">⋈</span><span class="s136">θ </span><span class="p">(</span>σ<span class="s137">θ</span> <span class="p">(</span><span class="s13">E</span><span class="s130">2</span><span class="s94">))), where </span>θ<span class="s98">2</span><span class="p"> involves only</span></p><p class="s150" style="padding-left: 191pt;text-indent: 0pt;line-height: 3pt;text-align: left;">1  2      3         1      3    2</p><p style="padding-left: 181pt;text-indent: 0pt;line-height: 12pt;text-align: left;">attributes from <i>E</i><span class="s98">2</span></p><p class="s13" style="padding-top: 5pt;padding-left: 120pt;text-indent: 0pt;text-align: justify;"><b>16.18  </b><span class="p">Consider the two expressions </span><span class="s15">σ</span><span class="s137">θ</span><span class="p">(</span>E<span class="s93">1 </span><span class="s15">⟕ </span>E<span class="s93">2</span><span class="s94">) and </span><span class="s15">σ</span><span class="s137">θ</span><span class="p">(</span>E<span class="s93">1 </span><span class="s86">⋈ </span>E<span class="s93">2</span><span class="s94">).</span></p><p style="padding-top: 4pt;padding-left: 181pt;text-indent: -18pt;text-align: left;">a. Show using an example that the two expressions are not equivalent in general.</p><p style="padding-top: 5pt;padding-left: 181pt;text-indent: -19pt;text-align: left;">b.  Give a simple condition on the predicate <span class="s15">θ</span>, which if satisﬁed will ensure that the two expressions are equivalent.</p><p style="padding-top: 7pt;padding-left: 155pt;text-indent: -35pt;text-align: justify;"><b>16.19  </b>A set of equivalence rules is said to be <i>complete </i>if, whenever two expressions are equivalent, one can be derived from the other by a sequence of uses of the equivalence rules. Is the set of equivalence rules that we considered in Section</p><p style="padding-left: 155pt;text-indent: 0pt;line-height: 15pt;text-align: left;">16.2.1 complete? Hint: Consider the equivalence <span class="s15">σ</span><span class="s98">3</span><span class="s137">=</span><span class="s98">5</span>(<i>r</i>) <span class="s86">≡ </span><span class="s15">{ }</span>.</p><p class="s46" style="padding-top: 3pt;padding-left: 119pt;text-indent: 0pt;line-height: 12pt;text-align: justify;">16.20  <span class="p">Explain how to use a histogram to estimate the size of a selection of the form</span></p><p class="s123" style="padding-left: 155pt;text-indent: 0pt;line-height: 16pt;text-align: left;"><span class="s15">σ</span>A<span class="s369">≤</span>v<span class="p">(</span><span class="s13">r</span><span class="p">).</span></p><p class="s13" style="padding-top: 3pt;padding-left: 155pt;text-indent: -35pt;line-height: 79%;text-align: justify;"><b>16.21  </b><span class="p">Suppose two relations </span>r <span class="p">and </span>s <span class="p">have histograms on attributes </span>r<span class="s83">.</span>A <span class="p">and </span>s<span class="s83">.</span>A<span class="p">, respec- tively, but with diﬀerent ranges. Suggest how to use the histograms to estimate the size of </span>r <span class="s86">⋈ </span>s<span class="p">. Hint: Split the ranges of each histogram further.</span></p><p class="s46" style="padding-top: 4pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">16.22 <span class="p">Consider the query</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="padding-top: 4pt;padding-left: 248pt;text-indent: 0pt;text-align: left;"><b>select </b>A<span class="p">, </span>B</p><p class="s46" style="padding-left: 248pt;text-indent: 0pt;line-height: 11pt;text-align: left;">from <i>r</i></p><p class="s46" style="padding-left: 248pt;text-indent: 0pt;line-height: 17pt;text-align: left;">where <i>r</i><span class="s83">.</span><i>B </i><span class="s83">&lt; </span>some <span class="p">(</span>select <i>B</i></p><p class="s46" style="padding-left: 330pt;text-indent: 0pt;line-height: 9pt;text-align: left;">from <i>s</i></p><p class="s13" style="padding-left: 330pt;text-indent: 0pt;line-height: 20pt;text-align: left;"><b>where </b>s<span class="s83">.</span>A <span class="s15">= </span>r<span class="s83">.</span>A<span class="p">)</span></p><p style="padding-top: 3pt;padding-left: 155pt;text-indent: 0pt;text-align: left;">Show how to decorrelate this query using the multiset version of the semi join operation.</p><p class="s46" style="padding-top: 6pt;padding-left: 155pt;text-indent: -35pt;text-align: justify;">16.23  <span class="p">Describe how to incrementally maintain the results of the following operations on both insertions and deletions:</span></p><p style="padding-top: 7pt;padding-left: 162pt;text-indent: 0pt;text-align: left;">a. Union and set diﬀerence.</p><p style="padding-top: 6pt;padding-left: 162pt;text-indent: 0pt;text-align: left;">b. Left outer join.</p><p class="s46" style="padding-top: 7pt;padding-left: 155pt;text-indent: -35pt;text-align: justify;">16.24  <span class="p">Give an example of an expression deﬁning a materialized view and two situa- tions (sets of statistics for the input relations and the diﬀerentials) such that incremental view maintenance is better than recomputation in one situation, and recomputation is better in the other situation.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="padding-top: 3pt;padding-left: 124pt;text-indent: -35pt;line-height: 93%;text-align: justify;"><a name="bookmark344"><b>16.25  </b></a><span class="p">Suppose you want to get answers to </span>r <span class="s86">⋈ </span>s <span class="p">sorted on an attribute of </span>r<span class="p">, and want only the top </span>K <span class="p">answers for some relatively small </span>K<span class="p">. Give a good way of evaluating the query:</span><a name="bookmark364">&zwnj;</a></p><p style="padding-top: 7pt;padding-left: 150pt;text-indent: -18pt;text-align: left;">a. When the join is on a foreign key of <i>r </i>referencing <i>s</i>, where the foreign key attribute is declared to be not null.</p><p style="padding-top: 6pt;padding-left: 130pt;text-indent: 0pt;text-align: left;">b.  When the join is not on a foreign key.</p><p style="padding-top: 7pt;padding-left: 124pt;text-indent: -35pt;text-align: justify;"><b>16.26  </b>Consider a relation <i>r</i>(<i>A</i>, <i>B</i>, <i>C</i>), with an index on attribute <i>A</i>. Give an example of a query that can be answered by using the index only, without looking at the tuples in the relation. (Query plans that use only the index, without accessing the actual relation, are called <i>index-only </i>plans.)</p><p style="padding-top: 6pt;padding-left: 124pt;text-indent: -35pt;text-align: justify;"><b>16.27  </b>Suppose you have an update query <i>U </i>. Give a simple suﬃcient condition on <i>U </i>that will ensure that the Halloween problem cannot occur, regardless of the execution plan chosen or the indices that exist.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part304.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part306.htm">下一个 &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
