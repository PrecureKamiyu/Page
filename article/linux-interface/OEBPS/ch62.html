<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:pls="http://www.w3.org/2005/01/pronunciation-lexicon" xmlns:ssml="http://www.w3.org/2001/10/synthesis" xmlns:svg="http://www.w3.org/2000/svg"><head><title>Chapter 62. Terminals</title><link rel="stylesheet" type="text/css" href="core.css"/><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"/><link rel="up" href="index.html" title="The Linux Programming Interface"/><link rel="prev" href="ch61.html" title="Chapter 61. Sockets: Advanced Topics"/><link rel="next" href="ch63.html" title="Chapter 63. Alternative I/O Models"/></head><body><section class="chapter" title="Chapter 62. Terminals" epub:type="chapter" id="terminals"><div class="titlepage"><div><div><h2 class="title">Chapter 62. Terminals</h2></div></div></div><p>Historically, users accessed a UNIX system using a terminal connected via a serial
            line (an RS-232 connection). Terminals were cathode ray tubes (CRTs) capable of
            displaying characters and, in some cases, primitive graphics. Typically, CRTs provided a
            monochrome display of 24 lines by 80 columns. By today’s standards, these CRTs were
            small and expensive. In even earlier times, terminals were sometimes hard-copy teletype
            devices. Serial lines were also used to connect other devices, such as printers and
            modems, to a computer or to connect one computer to another.<a id="IDX-CHP-62-8148" class="indexterm"/></p><div class="note" title="Note"><h3 class="title">Note</h3><p>On early UNIX systems, the terminal lines connected to the system were represented
                by character devices with names of the form <code class="literal">/dev/tty</code><span class="emphasis"><em>n</em></span>. (On Linux, the /<code class="literal">dev/tty</code><span class="emphasis"><em>n</em></span> devices are the virtual
                consoles on the system.) It is common to see the abbreviation
                    <span class="emphasis"><em>tty</em></span> (derived from teletype) as a shorthand for
                    <span class="emphasis"><em>terminal</em></span>.<a id="IDX-CHP-62-8149" class="indexterm"/></p></div><p>Especially during the early years of UNIX, terminal devices were not standardized,
            which meant that different character sequences were required to perform operations such
            as moving the cursor to the beginning of the line or the top of the screen. (Eventually,
            some vendor implementations of such <span class="emphasis"><em>escape sequences</em></span>—for example,
            Digital’s VT-100—became de facto and, ultimately, ANSI standards, but a wide variety of
            terminal types continued to exist.) This lack of standardization meant that it was
            difficult to write portable programs that used terminal features. The
                <span class="emphasis"><em>vi</em></span> editor was an early example of a program with such
            requirements. The <span class="emphasis"><em>termcap</em></span> and <span class="emphasis"><em>terminfo</em></span>
            databases (described in [Strang et al., 1988]), which tabulate how to perform various
            screen-control operations for a wide variety of terminal types, and the
                <span class="emphasis"><em>curses</em></span> library ([Strang, 1986]) were developed in response to
            this lack of standardization.<a id="IDX-CHP-62-8150" class="indexterm"/></p><p>It is no longer common to see a conventional terminal. The usual interface to modern
            UNIX systems is an X Window System window manager on a high-performance bit-mapped
            graphical monitor. (An old-style terminal provided functionality roughly equivalent to a
            single terminal window—an <span class="emphasis"><em>xterm</em></span> or similar—in an X Window System.
            The fact that the user of such a terminal had only a single “window” to the system was
            the driving force behind the development of the job-control facilities described in
            Section 34.7.) Similarly, many devices (e.g., printers) that were once connected
            directly to a computer are now often intelligent devices connected via a network.</p><p>All of the above is a preamble to saying that the need to program terminal devices is
            less frequent than it used to be. Therefore, this chapter focuses on the aspects of
            terminal programming that are particularly relevant to software terminal emulators
            (i.e., <span class="emphasis"><em>xterm</em></span> and similar). It gives only brief coverage to serial
            lines; references for further information about serial programming are provided at the
            end of this chapter.</p><div class="sect1" title="Overview"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="overview-id20">Overview</h2></div></div></div><p>Both a conventional terminal and a terminal emulator have an associated terminal
                driver that handles input and output on the device. (In the case of a terminal
                emulator, the device is a pseudoterminal. We describe pseudoterminals in <a class="xref" href="ch64.html" title="Chapter 64. Pseudoterminals">Chapter 64</a>.) Various aspects of the operation of the
                terminal driver can be controlled using the functions described in this
                    chapter.<a id="IDX-CHP-62-8151" class="indexterm"/><a id="IDX-CHP-62-8152" class="indexterm"/><a id="IDX-CHP-62-8153" class="indexterm"/><a id="IDX-CHP-62-8154" class="indexterm"/><a id="IDX-CHP-62-8155" class="indexterm"/><a id="IDX-CHP-62-8156" class="indexterm"/></p><p>When performing input, the driver is capable of operating in either of the
                following modes:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><span class="emphasis"><em>Canonical mode</em></span>: In this mode, terminal input is
                        processed line by line, and line editing is enabled. Lines are terminated by
                        a newline character, generated when the user presses the
                            <span class="emphasis"><em>Enter</em></span> key. A <span class="emphasis"><em>read()</em></span> from the
                        terminal returns only when a complete line of input is available, and
                        returns at most one line. (If the <span class="emphasis"><em>read()</em></span> requests fewer
                        bytes than are available in the current line, then the remaining bytes are
                        available for the next <span class="emphasis"><em>read()</em></span>.) This is the default
                        input mode.</p></li><li class="listitem"><p><span class="emphasis"><em>Noncanonical mode</em></span>: Terminal input is not gathered
                        into lines. Programs such as <span class="emphasis"><em>vi</em></span>,
                            <span class="emphasis"><em>more</em></span>, and <span class="emphasis"><em>less</em></span> place the
                        terminal in noncanonical mode so that they can read single characters
                        without the user needing to press the <span class="emphasis"><em>Enter</em></span> key.</p></li></ul></div><p>The terminal driver also interprets a range of special characters, such as the
                    <span class="emphasis"><em>interrupt</em></span> character (normally
                    <span class="emphasis"><em>Control-C</em></span>) and the <span class="emphasis"><em>end-of-file</em></span>
                character (normally <span class="emphasis"><em>Control-D</em></span>). Such interpretation may result
                in a signal being generated for the foreground process group or some type of input
                condition occurring for a program reading from the terminal. Programs that place the
                terminal in noncanonical mode typically also disable processing of some or all of
                these special characters.</p><p>A terminal driver operates two queues (<a class="xref" href="ch62.html#input_and_output_queues_for_a_terminal_d" title="Figure 62-1. Input and output queues for a terminal device">Figure 62-1</a>): one for input characters
                transmitted from the terminal device to the reading process(es) and the other for
                output characters transmitted from processes to the terminal. If terminal echoing is
                enabled, then the terminal driver automatically appends a copy of any input
                character to the end of the output queue, so that input characters are also output
                on the terminal.<a id="IDX-CHP-62-8157" class="indexterm"/></p><div class="note" title="Note"><h3 class="title">Note</h3><p>SUSv3 specifies the limit <code class="literal">MAX_INPUT</code>, which
                    an implementation can use to indicate the maximum length of the terminal’s input
                    queue. A related limit, <code class="literal">MAX_CANON</code>, defines
                    the maximum number of bytes in a line of input in canonical mode. On Linux,
                        <span class="emphasis"><em>sysconf(_SC_MAX_INPUT)</em></span> and
                        <span class="emphasis"><em>sysconf(_SC_MAX_CANON)</em></span> both return the value 255.
                    However, neither of these limits is actually employed by the kernel, which
                    simply imposes a limit of 4096 bytes on the input queue. A corresponding limit
                    on the size of the output queue also exists. However, applications don’t need to
                    be concerned with this, since, if a process produces output faster than the
                    terminal driver can handle it, the kernel suspends execution of the writing
                    process until space is once more available in the output queue.<a id="IDX-CHP-62-8158" class="indexterm"/></p><p>On Linux, we can call <span class="emphasis"><em>ioctl(fd, FIONREAD, &amp;cnt)</em></span>
                    to obtain the number of unread bytes in the input queue of the terminal referred
                    to by the file descriptor <span class="emphasis"><em>fd</em></span>. This feature is not specified
                    in SUSv3.</p></div><div class="figure"><a id="input_and_output_queues_for_a_terminal_d"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject62_d1e160333"/><img src="figs/web/62-1_TERM-IO-queues-scale90.png.jpg" alt="Input and output queues for a terminal device"/></div></div><div class="figure-title">Figure 62-1. Input and output queues for a terminal device</div></div></div><div class="sect1" title="Retrieving and Modifying Terminal Attributes"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="retrieving_and_modifying_terminal_attrib">Retrieving and Modifying Terminal Attributes</h2></div></div></div><p>The <span class="emphasis"><em>tcgetattr()</em></span> and <span class="emphasis"><em>tcsetattr()</em></span>
                functions retrieve and modify the attributes of a terminal.<a id="IDX-CHP-62-8159" class="indexterm"/><a id="IDX-CHP-62-8160" class="indexterm"/><a id="IDX-CHP-62-8161" class="indexterm"/><a id="IDX-CHP-62-8162" class="indexterm"/><a id="IDX-CHP-62-8163" class="indexterm"/><a id="IDX-CHP-62-8164" class="indexterm"/><a id="IDX-CHP-62-8165" class="indexterm"/><a id="IDX-CHP-62-8166" class="indexterm"/><a id="IDX-CHP-62-8167" class="indexterm"/><a id="IDX-CHP-62-8168" class="indexterm"/><a id="IDX-CHP-62-8169" class="indexterm"/><a id="IDX-CHP-62-8170" class="indexterm"/><a id="IDX-CHP-62-8171" class="indexterm"/></p><a id="I_programlisting62_d1e160420"/><pre class="programlisting">#include &lt;termios.h&gt;

int <strong class="userinput"><code>tcgetattr</code></strong>(int <span class="emphasis"><em>fd</em></span>, struct termios *<span class="emphasis"><em>termios_p</em></span>);
int <strong class="userinput"><code>tcsetattr</code></strong>(int <span class="emphasis"><em>fd</em></span>, int <span class="emphasis"><em>optional_actions</em></span>, const struct termios *<span class="emphasis"><em>termios_p</em></span>);</pre><div class="note" title="Note"><h3 class="title">Note</h3><p>Both return 0 on success, or -1 on error</p></div><p>The <span class="emphasis"><em>fd</em></span> argument is a file descriptor that refers to a
                terminal. (If <span class="emphasis"><em>fd</em></span> doesn’t refer to a terminal, these functions
                fail with the error <code class="literal">ENOTTY</code>.)</p><p>The <span class="emphasis"><em>termios_p</em></span> argument is a pointer to a
                    <span class="emphasis"><em>termios</em></span> structure, which records terminal
                    attributes:<a id="IDX-CHP-62-8172" class="indexterm"/></p><a id="I_programlisting62_d1e160471"/><pre class="programlisting">struct termios {
    tcflag_t c_iflag;           /* Input flags */
    tcflag_t c_oflag;           /* Output flags */
    tcflag_t c_cflag;           /* Control flags */
    tcflag_t c_lflag;           /* Local modes */
    cc_t     c_line;            /* Line discipline (nonstandard)*/
    cc_t     c_cc[NCCS];        /* Terminal special characters */
    speed_t  c_ispeed;          /* Input speed (nonstandard; unused) */
    speed_t  c_ospeed;          /* Output speed (nonstandard; unused) */
};</pre><p>The first four fields of the <span class="emphasis"><em>termios</em></span> structure are bit masks
                (the <span class="emphasis"><em>tcflag_t</em></span> data type is an integer type of suitable size)
                containing flags that control various aspects of the terminal driver’s
                    operation:<a id="IDX-CHP-62-8173" class="indexterm"/></p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><span class="emphasis"><em>c_iflag</em></span> contains flags controlling terminal
                        input;</p></li><li class="listitem"><p><span class="emphasis"><em>c_oflag</em></span> contains flags controlling terminal
                        output;</p></li><li class="listitem"><p><span class="emphasis"><em>c_cflag</em></span> contains flags relating to hardware control
                        of the terminal line; and</p></li><li class="listitem"><p><span class="emphasis"><em>c_lflag</em></span> contains flags controlling the user interface
                        for terminal input.</p></li></ul></div><p>All of the flags used in the above fields are listed in <a class="xref" href="ch62.html#terminal_flags-id1" title="Table 62-2. Terminal flags">Table 62-2</a> (in <a class="xref" href="ch62.html#terminal_flags" title="Terminal Flags">Terminal Flags</a>).</p><p>The <span class="emphasis"><em>c_line</em></span> field specifies the line discipline for this
                terminal. For the purposes of programming terminal emulators, the line discipline
                will always be set to <code class="literal">N_TTY</code>, the so-called
                    <span class="emphasis"><em>new</em></span> discipline, a component of the kernel terminal-handling
                code that implements canonical mode I/O processing. Setting the line discipline can
                be relevant when programming serial lines.</p><p>The <span class="emphasis"><em>c_cc</em></span> array contains the terminal special characters
                    (<span class="emphasis"><em>interrupt</em></span>, <span class="emphasis"><em>suspend</em></span>, and so on) as
                well as fields controlling the operation of noncanonical mode input. The
                    <span class="emphasis"><em>cc_t</em></span> data type is an unsigned integer type suitable for
                holding these values, and the <code class="literal">NCCS</code> constant
                specifies the number of elements in this array. We describe the terminal special
                characters in Section 62.4.<a id="IDX-CHP-62-8174" class="indexterm"/><a id="IDX-CHP-62-8175" class="indexterm"/></p><p>The <span class="emphasis"><em>c_ispeed</em></span> and <span class="emphasis"><em>c_ospeed</em></span> fields are
                unused on Linux (and are not specified in SUSv3). We explain how Linux stores
                terminal line speeds in Section 62.7.</p><div class="note" title="Note"><h3 class="title">Note</h3><p>The Seventh Edition and early BSD terminal driver (known as the
                        <span class="emphasis"><em>tty</em></span> driver) had grown over time so that it used no less
                    than four different data structures to represent the information equivalent to
                    the <span class="emphasis"><em>termios</em></span> structure. System V replaced this baroque
                    arrangement with a single structure called <span class="emphasis"><em>termio</em></span>. The
                    initial POSIX committee selected the System V API almost as is, in the process
                    renaming it to <span class="emphasis"><em>termios</em></span>.</p></div><p>When changing terminal attributes with <span class="emphasis"><em>tcsetattr()</em></span>, the
                    <span class="emphasis"><em>optional_actions</em></span> argument determines when the change takes
                effect. This argument is specified as one of the following values:</p><div class="variablelist"><dl><dt><span class="term">
                        <code class="literal">TCSANOW</code>
                    </span></dt><dd><p>The change is carried out immediately.</p></dd><dt><span class="term">
                        <code class="literal">TCSADRAIN</code>
                    </span></dt><dd><p>The change takes effect after all currently queued output has been
                            transmitted to the terminal. Normally, this flag should be specified
                            when making changes that affect terminal output, so that we don’t affect
                            output that has already been queued but not yet displayed.</p></dd><dt><span class="term">
                        <code class="literal">TCSAFLUSH</code>
                    </span></dt><dd><p>The change takes effect as for <code class="literal">TCSADRAIN</code>, but, in addition, any input that is still
                            pending at the time the change takes effect is discarded. This is
                            useful, for example, when reading a password, where we wish to disable
                            terminal echoing and prevent user type-ahead.</p></dd></dl></div><p>The usual (and recommended) way to change terminal attributes is to use
                    <span class="emphasis"><em>tcgetattr()</em></span> to retrieve a <span class="emphasis"><em>termios</em></span>
                structure containing a copy of the current settings, change the desired attributes,
                and then use <span class="emphasis"><em>tcsetattr()</em></span> to push the updated structure back to
                the driver. (This approach ensures that we pass a fully initialized structure to
                    <span class="emphasis"><em>tcsetattr()</em></span>.) For example, we can use the following
                sequence to turn terminal echoing off:</p><a id="I_programlisting62_d1e160623"/><pre class="programlisting">struct termios tp;

if (tcgetattr(STDIN_FILENO, &amp;tp) == -1)
    errExit("tcgetattr");
tp.c_lflag &amp;= ~ECHO;
if (tcsetattr(STDIN_FILENO, TCSAFLUSH, &amp;tp) == -1)
    errExit("tcsetattr");</pre><p>The <span class="emphasis"><em>tcsetattr()</em></span> function returns successfully if
                    <span class="emphasis"><em>any</em></span> of the requested changes to terminal attributes could
                be performed; it fails only if <span class="emphasis"><em>none</em></span> of the requested changes
                could be made. This means that, when making multiple attribute changes, it may
                sometimes be necessary to make a further call to <span class="emphasis"><em>tcgetattr()</em></span> to
                retrieve the new terminal attributes and compare them against the requested
                changes.</p><div class="note" title="Note"><h3 class="title">Note</h3><p>In <a class="xref" href="ch34.html#implementing_job_control" title="Implementing Job Control">Implementing Job Control</a>, we noted that if
                        <span class="emphasis"><em>tcsetattr()</em></span> is called from a process in a background
                    process group, then the terminal driver suspends the process group by delivering
                    a <code class="literal">SIGTTOU</code> signal, and that, if called from an
                    orphaned process group, <span class="emphasis"><em>tcsetattr()</em></span> fails with the error
                    EIO. The same statements apply for various other functions described in this
                    chapter, including <span class="emphasis"><em>tcflush()</em></span>,
                    <span class="emphasis"><em>tcflow()</em></span>, <span class="emphasis"><em>tcsendbreak()</em></span>, and
                        <span class="emphasis"><em>tcdrain()</em></span>.<a id="IDX-CHP-62-8176" class="indexterm"/><a id="IDX-CHP-62-8177" class="indexterm"/><a id="IDX-CHP-62-8178" class="indexterm"/><a id="IDX-CHP-62-8179" class="indexterm"/><a id="IDX-CHP-62-8180" class="indexterm"/></p><p>In earlier UNIX implementations, terminal attributes were accessed using
                        <span class="emphasis"><em>ioctl()</em></span> calls. Like several other functions described
                    in this chapter, the <span class="emphasis"><em>tcgetattr()</em></span> and
                        <span class="emphasis"><em>tcsetattr()</em></span> functions are POSIX inventions designed to
                    address the problem that type checking of the third argument of
                        <span class="emphasis"><em>ioctl()</em></span> isn’t possible. On Linux, as in many other UNIX
                    implementations, these are library functions layered on top of
                        <span class="emphasis"><em>ioctl()</em></span>.<a id="IDX-CHP-62-8181" class="indexterm"/></p></div></div><div class="sect1" title="The stty Command"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="the_stty_command">The <span class="emphasis"><em>stty</em></span> Command</h2></div></div></div><p>The <span class="emphasis"><em>stty</em></span> command is the command-line analog of the
                    <span class="emphasis"><em>tcgetattr()</em></span> and <span class="emphasis"><em>tcsetattr()</em></span> functions,
                allowing us to view and change terminal attributes from the shell. This is useful
                when trying to monitor, debug, or undo the effects of programs that modify terminal
                    attributes.<a id="IDX-CHP-62-8182" class="indexterm"/><a id="IDX-CHP-62-8183" class="indexterm"/></p><p>We can view the current settings of all terminal attributes using the following
                command (here carried out on a virtual console):</p><a id="I_programlisting62_d1e160738"/><pre class="programlisting">$ <strong class="userinput"><code>stty -a</code></strong>
speed 38400 baud; rows 25; columns 80; line = 0;
intr = ^C; quit = ^\; erase = ^?; kill = ^U; eof = ^D; eol = &lt;undef&gt;;
eol2 = &lt;undef&gt;; start = ^Q; stop = ^S; susp = ^Z; rprnt = ^R;
werase = ^W; lnext = ^V; flush = ^O; min = 1; time = 0;
-parenb -parodd cs8 hupcl -cstopb cread -clocal -crtscts
-ignbrk brkint -ignpar -parmrk -inpck -istrip -inlcr -igncr
 icrnl ixon -ixoff -iuclc -ixany imaxbel -iutf8
opost -olcuc -ocrnl onlcr -onocr -onlret -ofill -ofdel nl0 cr0 tab0 bs0 vt0 ff0
isig icanon iexten echo echoe echok -echonl -noflsh
 -xcase -tostop -echoprt echoctl echoke</pre><p>The first line of the above output shows the terminal line speed (bits per
                second), the terminal window size, and the line discipline in numeric form (0
                corresponds to <code class="literal">N_TTY</code>, the new line
                discipline).</p><p>The next three lines show the settings of the various terminal special characters.
                The notation <code class="literal">^C</code> denotes
                    <span class="emphasis"><em>Control-C</em></span>, and so on. The string <code class="literal">&lt;undef&gt;</code> means that the corresponding terminal special
                character is not currently defined. The <span class="emphasis"><em>min</em></span> and
                    <span class="emphasis"><em>time</em></span> values relate to noncanonical mode input, and are
                described in <a class="xref" href="ch62.html#noncanonical_mode" title="Noncanonical Mode">Noncanonical Mode</a>.</p><p>The remaining lines show the settings of the various flags from (in order) the
                    <span class="emphasis"><em>c_cflag</em></span>, <span class="emphasis"><em>c_iflag</em></span>,
                    <span class="emphasis"><em>c_oflag</em></span>, and <span class="emphasis"><em>c_lflag</em></span> fields of the
                    <span class="emphasis"><em>termios</em></span> structure. Where a flag name is preceded by a
                hyphen (<code class="literal">-</code>), the flag is currently disabled;
                otherwise, it is currently enabled.</p><p>When entered without command-line arguments, <span class="emphasis"><em>stty</em></span> shows just
                the terminal line speed, the line discipline, and any of the other settings that
                deviate from sane values.</p><p>We can change the settings of terminal special characters using commands such as
                the following:</p><a id="I_programlisting62_d1e160796"/><pre class="programlisting">$ <strong class="userinput"><code>stty intr ^L</code></strong>                  <em class="lineannotation"><span class="lineannotation">Make the interrupt character Control-L</span></em></pre><p>When specifying a control character as the final argument, we can do so in a
                variety of ways:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>as a 2-character sequence consisting of a caret (<code class="literal">^</code>) followed by the corresponding character (as shown
                        above);</p></li><li class="listitem"><p>as an octal or hexadecimal number (thus: <code class="literal">014</code> or <code class="literal">0xC</code>); or</p></li><li class="listitem"><p>by typing the actual character itself.</p></li></ul></div><p>If we employ the final option, and the character in question is one interpreted
                specially by the shell or the terminal driver, then we must precede it with the
                    <span class="emphasis"><em>literal next</em></span> character (usually
                    <span class="emphasis"><em>Control-V</em></span>):</p><a id="I_programlisting62_d1e160833"/><pre class="programlisting">$ <strong class="userinput"><code>stty intr</code></strong> <span class="emphasis"><em>Control-V Control-L</em></span></pre><p>(Although, for readability, a space is shown between the
                    <span class="emphasis"><em>Control-V</em></span> and the <span class="emphasis"><em>Control-L</em></span> in the
                above example, no white-space characters should be typed between the
                    <span class="emphasis"><em>Control-V</em></span> and the desired character.)</p><p>It is possible, though unusual, to define terminal special characters to be
                something other than control characters:</p><a id="I_programlisting62_d1e160853"/><pre class="programlisting">$ <strong class="userinput"><code>stty intr q</code></strong>                   <em class="lineannotation"><span class="lineannotation">Make the interrupt character q</span></em></pre><p>Of course, when we do this, we can no longer use the <span class="emphasis"><em>q</em></span> key
                for its usual purpose (i.e., generating the letter <span class="emphasis"><em>q</em></span>).</p><p>To change terminal flags, such as the <code class="literal">TOSTOP</code>
                flag, we can use commands such as the following:</p><a id="I_programlisting62_d1e160873"/><pre class="programlisting">$ <strong class="userinput"><code>stty tostop</code></strong>                   <em class="lineannotation"><span class="lineannotation">Enable the</span></em> TOSTOP <em class="lineannotation"><span class="lineannotation">flag</span></em>
$ <strong class="userinput"><code>stty -tostop</code></strong>                  <em class="lineannotation"><span class="lineannotation">Disable the</span></em> TOSTOP <em class="lineannotation"><span class="lineannotation">flag</span></em></pre><p>Sometimes, when developing programs that modify terminal attributes, a program may
                crash, leaving the terminal in a state that renders it all but unusable. On a
                terminal emulator, we have the luxury of simply closing the terminal window and
                starting another. Alternatively, we can type in the following character sequence to
                restore the terminal flags and special characters to a reasonable state:</p><a id="I_programlisting62_d1e160895"/><pre class="programlisting"><span class="emphasis"><em>Control-J</em></span> <strong class="userinput"><code>stty sane</code></strong> <span class="emphasis"><em>Control-J</em></span></pre><p>The <span class="emphasis"><em>Control-J</em></span> character is the real newline character (ASCII
                10 decimal). We use this character because, in some modes, the terminal driver may
                no longer map the <span class="emphasis"><em>Enter</em></span> key (ASCII 13 decimal) into a newline
                character. We type an initial <span class="emphasis"><em>Control-J</em></span> to ensure that we have
                a fresh command line with no preceding characters. This may not be easy to verify
                if, for example, terminal echoing has been disabled.</p><p>The <span class="emphasis"><em>stty</em></span> command operates on the terminal referred to by
                standard input. Using the <span class="emphasis"><em>-F</em></span> option, we can (subject to
                permission checks) monitor and set the attributes of a terminal other than the one
                on which the <span class="emphasis"><em>stty</em></span> command is run:</p><a id="I_programlisting62_d1e160927"/><pre class="programlisting">$ <strong class="userinput"><code>su</code></strong>                            <em class="lineannotation"><span class="lineannotation">Need privilege to access another user’s terminal</span></em>
Password:
# <strong class="userinput"><code>stty -a -F /dev/tty3</code></strong>          <em class="lineannotation"><span class="lineannotation">Fetch attributes for terminal</span></em> /dev/tty3
<em class="lineannotation"><span class="lineannotation">Output omitted for brevity</span></em></pre><p>The <span class="emphasis"><em>-F</em></span> option is a Linux-specific extension to the
                    <span class="emphasis"><em>stty</em></span> command. On many other UNIX implementations,
                    <span class="emphasis"><em>stty</em></span> always acts on the terminal referred to by standard
                input, and we must use the following alternative form (which can also be used on
                Linux):</p><a id="I_programlisting62_d1e160954"/><pre class="programlisting"># <strong class="userinput"><code>stty -a &lt; /dev/tty3</code></strong></pre></div><div class="sect1" title="Terminal Special Characters"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="terminal_special_characters">Terminal Special Characters</h2></div></div></div><p><a class="xref" href="ch62.html#terminal_special_characters-id1" title="Table 62-1. Terminal special characters">Table 62-1</a> lists the special characters
                recognized by the Linux terminal driver. The first two columns show the name of the
                character and the corresponding constant that can be used as a subscript in the
                    <span class="emphasis"><em>c_cc</em></span> array. (As can be seen, these constants simply prefix
                the letter <span class="emphasis"><em>V</em></span> in front of the character name.) The CR and NL
                characters don’t have corresponding <span class="emphasis"><em>c_cc</em></span> subscripts, because
                the values of these characters can’t be changed.</p><p>The <span class="emphasis"><em>Default setting</em></span> column of the table shows the usual
                default value for the special character. As well as being able to set a terminal
                special character to a specific value, it is also possible to disable the character
                by setting it to the value returned by the call <span class="emphasis"><em>fpathconf(fd,
                    _PC_VDISABLE)</em></span>, where <span class="emphasis"><em>fd</em></span> is a file descriptor
                referring to a terminal. (On most UNIX implementations, this call returns the value
                    0.)<a id="IDX-CHP-62-8184" class="indexterm"/></p><p>The operation of each of the special characters is subject to the setting of
                various flags in the <span class="emphasis"><em>termios</em></span> bit-mask fields (described in
                    <a class="xref" href="ch62.html#terminal_flags" title="Terminal Flags">Terminal Flags</a>), as shown in the penultimate column of the
                table.</p><p>The final column indicates which of these characters are specified by SUSv3.
                Regardless of the SUSv3 specification, most of these characters are supported on all
                UNIX implementations.</p><div class="table"><a id="terminal_special_characters-id1"/><div class="table-title">Table 62-1. Terminal special characters</div><div class="table-contents"><table style="border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col1"/><col class="col2"/><col class="col3"/><col class="col4"/><col class="col5"/><col class="col6"/></colgroup><thead><tr><td style="text-align: left; vertical-align: bottom; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Character</p>
                            </td><td style="text-align: left; vertical-align: bottom; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p><span class="emphasis"><em>c_cc</em></span> subscript</p>
                            </td><td style="text-align: left; vertical-align: bottom; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Description</p>
                            </td><td style="text-align: left; vertical-align: bottom; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Default setting</p>
                            </td><td style="text-align: left; vertical-align: bottom; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Relevant bit-mask flags</p>
                            </td><td style="text-align: left; vertical-align: bottom; border-bottom: 0.5pt solid ; ">
                                <p>SUSv3</p>
                            </td></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>CR</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>(none)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Carriage return</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">^M</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p><code class="literal">ICANON</code>, <code class="literal">IGNCR</code>, <code class="literal">ICRNL</code>, <code class="literal">OPOST</code>,
                                        <code class="literal">OCRNL</code>, <code class="literal">ONOCR</code></p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>DISCARD</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">VDISCARD</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Discard output</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">^O</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>(not implemented)</p>
                            </td><td style="border-bottom: 0.5pt solid ; "> </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>EOF</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">VEOF</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>End-of-file</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">^D</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">ICANON</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>EOL</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">VEOL</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>End-of-line</p>
                            </td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "> </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">ICANON</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>EOL2</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">VEOL2</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Alternate end-of-line</p>
                            </td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "> </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p><code class="literal">ICANON</code>, <code class="literal">IEXTEN</code></p>
                            </td><td style="border-bottom: 0.5pt solid ; "> </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>ERASE</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">VERASE</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Erase character</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">^?</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">ICANON</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>INTR</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">VINTR</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Interrupt (<code class="literal">SIGINT</code>)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">^C</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">ISIG</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>KILL</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">VKILL</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Erase line</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">^U</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">ICANON</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>LNEXT</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">VLNEXT</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Literal next</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">^V</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p><code class="literal">ICANON</code>, <code class="literal">IEXTEN</code></p>
                            </td><td style="border-bottom: 0.5pt solid ; "> </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>NL</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>(none)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Newline</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">^J</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p><code class="literal">ICANON</code>, <code class="literal">INLCR</code>, <code class="literal">ECHONL</code>, <code class="literal">OPOST</code>,
                                        <code class="literal">ONLCR</code>, <code class="literal">ONLRET</code></p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>QUIT</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">VQUIT</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Quit (<code class="literal">SIGQUIT</code>)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">^\</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">ISIG</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>REPRINT</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">VREPRINT</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Reprint input line</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">^R</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p><code class="literal">ICANON</code>, <code class="literal">IEXTEN</code>, <code class="literal">ECHO</code></p>
                            </td><td style="border-bottom: 0.5pt solid ; "> </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>START</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">VSTART</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Start output</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">^Q</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p><code class="literal">IXON</code>, <code class="literal">IXOFF</code></p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>STOP</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">VSTOP</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Stop output</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">^S</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p><code class="literal">IXON</code>, <code class="literal">IXOFF</code></p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>SUSP</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">VSUSP</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Suspend (<code class="literal">SIGTSTP</code>)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">^Z</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">ISIG</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; ">
                                <p>WERASE</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">VWERASE</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; ">
                                <p>Erase word</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">^W</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; ">
                                <p><code class="literal">ICANON</code>, <code class="literal">IEXTEN</code></p>
                            </td><td> </td></tr></tbody></table></div></div><p>The following paragraphs provide more detailed explanations of the terminal
                special characters. Note that if the terminal driver performs its special input
                interpretation on one of these characters, then—with the exception of CR, EOL, EOL2,
                and NL—the character is discarded (i.e., it is not passed to any reading
                process).</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title" id="cr"/></div></div></div><div class="sect3" title="CR"><div class="titlepage"><div><div><h4 class="title" id="cr-id1">CR</h4></div></div></div><p>CR is the <span class="emphasis"><em>carriage return</em></span> character. This character
                        is passed to the reading process. In canonical mode (<code class="literal">ICANON</code> flag set) with the <code class="literal">ICRNL</code> (<span class="emphasis"><em>map CR to NL on
                            input</em></span>) flag set (the default), this character is first
                        converted to a newline (ASCII 10 decimal, <code class="literal">^J</code>) before being passed to the reading process. If the
                            <code class="literal">IGNCR</code> (<span class="emphasis"><em>ignore
                        CR</em></span>) flag is set, then this character is ignored on input (in
                        which case the true newline character must be used to terminate a line of
                        input). An output CR character causes the terminal to move the cursor to the
                        beginning of the line.<a id="IDX-CHP-62-8185" class="indexterm"/><a id="IDX-CHP-62-8186" class="indexterm"/><a id="IDX-CHP-62-8187" class="indexterm"/><a id="IDX-CHP-62-8188" class="indexterm"/><a id="IDX-CHP-62-8189" class="indexterm"/><a id="IDX-CHP-62-8190" class="indexterm"/><a id="IDX-CHP-62-8191" class="indexterm"/><a id="IDX-CHP-62-8192" class="indexterm"/><a id="IDX-CHP-62-8193" class="indexterm"/><a id="IDX-CHP-62-8194" class="indexterm"/><a id="IDX-CHP-62-8195" class="indexterm"/><a id="IDX-CHP-62-8196" class="indexterm"/><a id="IDX-CHP-62-8197" class="indexterm"/><a id="IDX-CHP-62-8198" class="indexterm"/><a id="IDX-CHP-62-8199" class="indexterm"/><a id="IDX-CHP-62-8200" class="indexterm"/><a id="IDX-CHP-62-8201" class="indexterm"/><a id="IDX-CHP-62-8202" class="indexterm"/><a id="IDX-CHP-62-8203" class="indexterm"/><a id="IDX-CHP-62-8204" class="indexterm"/><a id="IDX-CHP-62-8205" class="indexterm"/><a id="IDX-CHP-62-8206" class="indexterm"/><a id="IDX-CHP-62-8207" class="indexterm"/><a id="IDX-CHP-62-8208" class="indexterm"/><a id="IDX-CHP-62-8209" class="indexterm"/><a id="IDX-CHP-62-8210" class="indexterm"/><a id="IDX-CHP-62-8211" class="indexterm"/><a id="IDX-CHP-62-8212" class="indexterm"/><a id="IDX-CHP-62-8213" class="indexterm"/><a id="IDX-CHP-62-8214" class="indexterm"/><a id="IDX-CHP-62-8215" class="indexterm"/><a id="IDX-CHP-62-8216" class="indexterm"/><a id="IDX-CHP-62-8217" class="indexterm"/><a id="IDX-CHP-62-8218" class="indexterm"/><a id="IDX-CHP-62-8219" class="indexterm"/><a id="IDX-CHP-62-8220" class="indexterm"/><a id="IDX-CHP-62-8221" class="indexterm"/><a id="IDX-CHP-62-8222" class="indexterm"/><a id="IDX-CHP-62-8223" class="indexterm"/><a id="IDX-CHP-62-8224" class="indexterm"/><a id="IDX-CHP-62-8225" class="indexterm"/><a id="IDX-CHP-62-8226" class="indexterm"/><a id="IDX-CHP-62-8227" class="indexterm"/><a id="IDX-CHP-62-8228" class="indexterm"/><a id="IDX-CHP-62-8229" class="indexterm"/><a id="IDX-CHP-62-8230" class="indexterm"/><a id="IDX-CHP-62-8231" class="indexterm"/><a id="IDX-CHP-62-8232" class="indexterm"/><a id="IDX-CHP-62-8233" class="indexterm"/><a id="IDX-CHP-62-8234" class="indexterm"/><a id="IDX-CHP-62-8235" class="indexterm"/><a id="IDX-CHP-62-8236" class="indexterm"/><a id="IDX-CHP-62-8237" class="indexterm"/><a id="IDX-CHP-62-8238" class="indexterm"/><a id="IDX-CHP-62-8239" class="indexterm"/></p></div><div class="sect3" title="DISCARD"><div class="titlepage"><div><div><h4 class="title" id="discard">DISCARD</h4></div></div></div><p>DISCARD is the <span class="emphasis"><em>discard output</em></span> character. Although
                        this character is defined within the <span class="emphasis"><em>c_cc</em></span> array, it has
                        no effect on Linux. On some other UNIX implementations, typing this
                        character once causes program output to be discarded. This character is a
                        toggle—typing it once more reenables the display of output. This is useful
                        when a program is generating a large amount of output and we want to skip
                        some of it. (This was much more useful on traditional terminals, where line
                        speeds were slower and other “terminal windows” were unavailable.) This
                        character is not passed to the reading process.<a id="IDX-CHP-62-8240" class="indexterm"/><a id="IDX-CHP-62-8241" class="indexterm"/><a id="IDX-CHP-62-8242" class="indexterm"/><a id="IDX-CHP-62-8243" class="indexterm"/><a id="IDX-CHP-62-8244" class="indexterm"/><a id="IDX-CHP-62-8245" class="indexterm"/><a id="IDX-CHP-62-8246" class="indexterm"/><a id="IDX-CHP-62-8247" class="indexterm"/><a id="IDX-CHP-62-8248" class="indexterm"/><a id="IDX-CHP-62-8249" class="indexterm"/><a id="IDX-CHP-62-8250" class="indexterm"/><a id="IDX-CHP-62-8251" class="indexterm"/><a id="IDX-CHP-62-8252" class="indexterm"/><a id="IDX-CHP-62-8253" class="indexterm"/></p></div><div class="sect3" title="EOF"><div class="titlepage"><div><div><h4 class="title" id="eof">EOF</h4></div></div></div><p>EOF is the canonical mode <span class="emphasis"><em>end-of-file</em></span> character
                        (usually <span class="emphasis"><em>Control-D</em></span>). Entering this character at the
                        beginning of a line causes an end-of-file condition to be detected by a
                        process reading from the terminal (i.e., <span class="emphasis"><em>read()</em></span> returns
                        0). If typed anywhere other than the initial character of a line, then this
                        character simply causes <span class="emphasis"><em>read()</em></span> to complete immediately,
                        returning the characters so far input in the line. In both cases, the EOF
                        character itself is not passed to the reading process.</p></div><div class="sect3" title="EOL and EOL2"><div class="titlepage"><div><div><h4 class="title" id="eol_and_eol2">EOL and EOL2</h4></div></div></div><p>EOL and EOL2 are <span class="emphasis"><em>additional line-delimiter</em></span> characters
                        that operate like the standard newline (NL) character for canonical mode
                        input, terminating a line of input and making it available to the reading
                        process. By default, these characters are undefined. If they are defined,
                        they are passed to the reading process. The EOL2 character is operational
                        only if the <code class="literal">IEXTEN</code> (<span class="emphasis"><em>extended
                            input processing</em></span>) flag is set (the default).</p><p>These characters are rarely used. One application that does use them is
                            <span class="emphasis"><em>telnet</em></span>. By setting EOL or EOL2 to be the
                            <span class="emphasis"><em>telnet</em></span> escape character (usually
                            <span class="emphasis"><em>Control-]</em></span>, or, alternatively, the tilde character,
                        ~, if operating in <span class="emphasis"><em>rlogin</em></span> mode),
                            <span class="emphasis"><em>telnet</em></span> is able to immediately catch that character,
                        even while reading input in canonical mode.</p></div><div class="sect3" title="ERASE"><div class="titlepage"><div><div><h4 class="title" id="erase">ERASE</h4></div></div></div><p>In canonical mode, typing the ERASE character erases the previously input
                        character on the current line. The erased character and the ERASE character
                        itself are not passed to the reading process.</p></div><div class="sect3" title="INTR"><div class="titlepage"><div><div><h4 class="title" id="intr">INTR</h4></div></div></div><p>INTR is the <span class="emphasis"><em>interrupt</em></span> character. If the <code class="literal">ISIG</code> (<span class="emphasis"><em>enable signals</em></span>)
                        flag is set (the default), typing this character causes an
                            <span class="emphasis"><em>interrupt</em></span> signal (<code class="literal">SIGINT</code>) to be sent to the terminal’s foreground process group
                            (<a class="xref" href="ch34.html#process_groups" title="Process Groups">Process Groups</a>). The INTR character itself is not
                        passed to the reading process.<a id="IDX-CHP-62-8254" class="indexterm"/></p></div><div class="sect3" title="KILL"><div class="titlepage"><div><div><h4 class="title" id="kill">KILL</h4></div></div></div><p>KILL is the <span class="emphasis"><em>erase line</em></span> (also known as <span class="emphasis"><em>kill
                            line</em></span>) character. In canonical mode, typing this character
                        causes the current line of input to be discarded (i.e., the characters typed
                        so far, as well as the KILL character itself, are not passed to the reading
                            process).<a id="IDX-CHP-62-8255" class="indexterm"/><a id="IDX-CHP-62-8256" class="indexterm"/><a id="IDX-CHP-62-8257" class="indexterm"/><a id="IDX-CHP-62-8258" class="indexterm"/><a id="IDX-CHP-62-8259" class="indexterm"/><a id="IDX-CHP-62-8260" class="indexterm"/><a id="IDX-CHP-62-8261" class="indexterm"/><a id="IDX-CHP-62-8262" class="indexterm"/><a id="IDX-CHP-62-8263" class="indexterm"/><a id="IDX-CHP-62-8264" class="indexterm"/><a id="IDX-CHP-62-8265" class="indexterm"/><a id="IDX-CHP-62-8266" class="indexterm"/><a id="IDX-CHP-62-8267" class="indexterm"/><a id="IDX-CHP-62-8268" class="indexterm"/><a id="IDX-CHP-62-8269" class="indexterm"/><a id="IDX-CHP-62-8270" class="indexterm"/><a id="IDX-CHP-62-8271" class="indexterm"/></p></div><div class="sect3" title="LNEXT"><div class="titlepage"><div><div><h4 class="title" id="lnext">LNEXT</h4></div></div></div><p>LNEXT is the <span class="emphasis"><em>literal next</em></span> character. In some
                        circumstances, we may wish to treat one of the terminal special characters
                        as though it were a normal character for input to a reading process. Typing
                        the literal next character (usually <span class="emphasis"><em>Control-V</em></span>) causes
                        the next character to be treated literally, voiding any special
                        interpretation of the character that the terminal driver would normally
                        perform. Thus, we could enter the 2-character sequence <span class="emphasis"><em>Control-V
                            Control-C</em></span> to supply a real <span class="emphasis"><em>Control-C</em></span>
                        character (ASCII 3) as input to the reading process. The LNEXT character
                        itself is not passed to the reading process. This character is interpreted
                        only in canonical mode with the <code class="literal">IEXTEN</code>
                            (<span class="emphasis"><em>extended input processing</em></span>) flag set (which is the
                        default).</p></div><div class="sect3" title="NL"><div class="titlepage"><div><div><h4 class="title" id="nl">NL</h4></div></div></div><p>NL is the <span class="emphasis"><em>newline</em></span> character. In canonical mode, this
                        character terminates an input line. The NL character itself is included in
                        the line returned to the reading process. (The CR character is normally
                        converted to NL in canonical mode.) An output NL character causes the
                        terminal to move the cursor down one line. If the <code class="literal">OPOST</code> and <code class="literal">ONLCR</code>
                            (<span class="emphasis"><em>map NL to CR-NL</em></span>) flags are set (the default),
                        then, on output, a newline character is mapped to the 2-character sequence
                        CR plus NL. (The combination of the <code class="literal">ICRNL</code>
                        and <code class="literal">ONLCR</code> flags means that an input CR is
                        converted to a NL, and then echoed as CR plus NL.)<a id="IDX-CHP-62-8272" class="indexterm"/></p></div><div class="sect3" title="QUIT"><div class="titlepage"><div><div><h4 class="title" id="quit">QUIT</h4></div></div></div><p>If the <code class="literal">ISIG</code> flag is set (the default),
                        typing the QUIT character causes a <span class="emphasis"><em>quit</em></span> signal
                            (<code class="literal">SIGQUIT</code>) to be sent to the
                        terminal’s foreground process group (<a class="xref" href="ch34.html#process_groups" title="Process Groups">Process Groups</a>). The
                        QUIT character itself is not passed to the reading process.</p></div><div class="sect3" title="REPRINT"><div class="titlepage"><div><div><h4 class="title" id="reprint">REPRINT</h4></div></div></div><p>REPRINT is the <span class="emphasis"><em>reprint input</em></span> character. In canonical
                        mode with the <code class="literal">IEXTEN</code> flag set (the
                        default), typing this character causes the current (as yet incomplete) line
                        of input to be redisplayed on the terminal. This is useful if some other
                        program (e.g., <span class="emphasis"><em>wall(1)</em></span> or
                        <span class="emphasis"><em>write(1)</em></span>) has written output that has messed up the
                        terminal display. The REPRINT character itself is not passed to the reading
                        process.</p></div><div class="sect3" title="START and STOP"><div class="titlepage"><div><div><h4 class="title" id="start_and_stop">START and STOP</h4></div></div></div><p>START and STOP are the <span class="emphasis"><em>start output</em></span> and
                            <span class="emphasis"><em>stop output</em></span> characters, which operate if the
                            <code class="literal">IXON</code> (<span class="emphasis"><em>enable start/stop
                            output control</em></span>) flag is enabled (the default). (The START and
                        STOP characters are not honored by some terminal emulators.)</p><p>Typing the STOP character suspends terminal output. The STOP character
                        itself is not passed to the reading process. If the <code class="literal">IXOFF</code> flag is set and the terminal input queue is full, then
                        the terminal driver automatically sends a STOP character to throttle the
                        input.</p><p>Typing the START character causes terminal output to resume after
                        previously being stopped by the STOP character. The START character itself
                        is not passed to the reading process. If the <code class="literal">IXOFF</code> (<span class="emphasis"><em>enable start/stop input control</em></span>)
                        flag is set (this flag is disabled by default) and the terminal driver had
                        previously sent a STOP character because the input queue was full, the
                        terminal driver automatically generates a START character when space once
                        more becomes available in the input queue.</p><p>If the <code class="literal">IXANY</code> flag is set, then any
                        character, not just <code class="literal">START</code>, may be typed
                        in order to restart output (and that character is similarly not passed to
                        the reading process).</p><p>The START and STOP characters are used for software flow control in either
                        direction between the computer and the terminal device. One function of
                        these characters is to allow users to stop and start terminal output. This
                        is output flow control, as enabled by <code class="literal">IXON</code>. However, flow control in the other direction (i.e.,
                        control of input flow from the device to the computer, as enabled by
                            <code class="literal">IXOFF</code>) is also important when, for
                        example, the device in question is a modem or another computer. Input flow
                        control makes sure that no data is lost if the application is slow to handle
                        input and the kernel buffers fill up.<a id="IDX-CHP-62-8273" class="indexterm"/></p><p>With the higher line speeds that are nowadays typical, software flow
                        control has been superseded by hardware (RTS/CTS) flow control, whereby data
                        flow is enabled and disabled using signals sent via separate wires on the
                        serial port. (RTS stands for <span class="emphasis"><em>Request To Send</em></span>, and CTS
                        stands for <span class="emphasis"><em>Clear To Send</em></span>.)</p></div><div class="sect3" title="SUSP"><div class="titlepage"><div><div><h4 class="title" id="susp">SUSP</h4></div></div></div><p>SUSP is the <span class="emphasis"><em>suspend</em></span> character. If the <code class="literal">ISIG</code> flag is set (the default), typing this
                        character causes a <span class="emphasis"><em>terminal suspend</em></span> signal (<code class="literal">SIGTSTP</code>) to be sent to the terminal’s
                        foreground process group (<a class="xref" href="ch34.html#process_groups" title="Process Groups">Process Groups</a>). The SUSP
                        character itself is not passed to the reading process.<a id="IDX-CHP-62-8274" class="indexterm"/><a id="IDX-CHP-62-8275" class="indexterm"/><a id="IDX-CHP-62-8276" class="indexterm"/><a id="IDX-CHP-62-8277" class="indexterm"/><a id="IDX-CHP-62-8278" class="indexterm"/><a id="IDX-CHP-62-8279" class="indexterm"/><a id="IDX-CHP-62-8280" class="indexterm"/><a id="IDX-CHP-62-8281" class="indexterm"/><a id="IDX-CHP-62-8282" class="indexterm"/><a id="IDX-CHP-62-8283" class="indexterm"/><a id="IDX-CHP-62-8284" class="indexterm"/><a id="IDX-CHP-62-8285" class="indexterm"/></p></div><div class="sect3" title="WERASE"><div class="titlepage"><div><div><h4 class="title" id="werase">WERASE</h4></div></div></div><p>WERASE is the <span class="emphasis"><em>word erase</em></span> character. In canonical
                        mode, with the <code class="literal">IEXTEN</code> flag set (the
                        default), typing this character erases all characters back to the beginning
                        of the previous word. A word is considered to be a sequence of letters,
                        digits, and the underscore character. (On some UNIX implementations, a word
                        is considered to be delimited by white space.)</p></div><div class="sect3" title="Other terminal special characters"><div class="titlepage"><div><div><h4 class="title" id="other_terminal_special_characters">Other terminal special characters</h4></div></div></div><p>Other UNIX implementations provide terminal special characters in addition
                        to those listed in <a class="xref" href="ch62.html#terminal_special_characters-id1" title="Table 62-1. Terminal special characters">Table 62-1</a>.</p><p>BSD provides the DSUSP and STATUS characters. The DSUSP character
                        (typically <span class="emphasis"><em>Control-Y</em></span>) operates in a fashion similar to
                        the SUSP character, but suspends the foreground process group only when it
                        attempts to read the character (i.e., after all preceding input has been
                        read). Several non-BSD-derived implementations also provide the DSUSP
                        character.</p><p>The STATUS character (typically <span class="emphasis"><em>Control-T</em></span>) causes the
                        kernel to display status information on the terminal (including the state of
                        the foreground process and how much CPU time it has consumed), and sends a
                            <code class="literal">SIGINFO</code> signal to the foreground
                        process group. If desired, processes can catch this signal and display
                        further status information. (Linux provides a vaguely similar feature in the
                        form of the magic SysRq <span class="emphasis"><em>key</em></span>; see the kernel source file
                            <code class="literal">Documentation/sysrq.txt</code> for
                            details.)<a id="IDX-CHP-62-8286" class="indexterm"/></p><p>System V derivatives provide the SWTCH character. This character is used
                        to switch shells under <span class="emphasis"><em>shell layers</em></span>, a System V
                        predecessor to job control.<a id="IDX-CHP-62-8287" class="indexterm"/></p></div><div class="sect3" title="Example program"><div class="titlepage"><div><div><h4 class="title" id="example_program-id75">Example program</h4></div></div></div><p><a class="xref" href="ch62.html#changing_the_terminal_interrupt_characte" title="Example 62-1. Changing the terminal interrupt character">Example 62-1</a> shows the use
                        of <span class="emphasis"><em>tcgetattr()</em></span> and <span class="emphasis"><em>tcsetattr()</em></span> to
                        change the terminal <span class="emphasis"><em>interrupt</em></span> character. This program
                        sets the <span class="emphasis"><em>interrupt</em></span> character to be the character whose
                        numeric value is supplied as the program’s command-line argument, or
                        disables the <span class="emphasis"><em>interrupt</em></span> character if no command-line
                        argument is supplied.<a id="IDX-CHP-62-8288" class="indexterm"/><a id="IDX-CHP-62-8289" class="indexterm"/></p><p>The following shell session demonstrates the use of this program. We begin
                        by setting the <span class="emphasis"><em>interrupt</em></span> character to
                            <span class="emphasis"><em>Control-L</em></span> (ASCII 12), and then verify the change
                        with <span class="emphasis"><em>stty</em></span>:</p><a id="I_programlisting62_d1e162232"/><pre class="programlisting">$ <strong class="userinput"><code>./new_intr 12</code></strong>
$ <strong class="userinput"><code>stty</code></strong>
speed 38400 baud; line = 0;
intr = ^L;</pre><p>We then start a process running <span class="emphasis"><em>sleep(1)</em></span>. We find
                        that typing <span class="emphasis"><em>Control-C</em></span> no longer has its usual effect of
                        terminating a process, but typing <span class="emphasis"><em>Control-L</em></span> does
                        terminate the process.</p><a id="I_programlisting62_d1e162251"/><pre class="programlisting">$ <strong class="userinput"><code>sleep 10</code></strong>
^C                              <em class="lineannotation"><span class="lineannotation">Control-C has no effect; it is just echoed</span></em>
<em class="lineannotation"><span class="lineannotation">Type Control-L to terminate sleep</span></em></pre><p>We now display the value of the shell $? variable, which shows the
                        termination status of the last command:</p><a id="I_programlisting62_d1e162263"/><pre class="programlisting">$ <strong class="userinput"><code>echo $?</code></strong>
130</pre><p>We see that the termination status of the process was 130. This indicates
                        that the process was killed by signal 130 - 128 = 2; signal number 2 is
                            <code class="literal">SIGINT</code>.</p><p>Next, we use our program to disable the <span class="emphasis"><em>interrupt</em></span>
                        character.</p><a id="I_programlisting62_d1e162278"/><pre class="programlisting">$ <strong class="userinput"><code>./new_intr</code></strong>
$ <strong class="userinput"><code>stty</code></strong>                          <em class="lineannotation"><span class="lineannotation">Verify the change</span></em>
speed 38400 baud; line = 0;
intr = &lt;undef&gt;;</pre><p>Now we find that neither <span class="emphasis"><em>Control-C</em></span> nor
                            <span class="emphasis"><em>Control-L</em></span> generates a <code class="literal">SIGINT</code> signal, and we must instead use
                            <span class="emphasis"><em>Control-\</em></span> to terminate a program:</p><a id="I_programlisting62_d1e162304"/><pre class="programlisting">$ <strong class="userinput"><code>sleep 10</code></strong>
^C^L                            <em class="lineannotation"><span class="lineannotation">Control-C and Control-L are simply echoed</span></em>
<em class="lineannotation"><span class="lineannotation">Type Control-\ to generate</span></em> SIGQUIT
Quit
$ <strong class="userinput"><code>stty sane</code></strong>                     <em class="lineannotation"><span class="lineannotation">Return terminal to a sane state</span></em></pre><div class="example"><a id="changing_the_terminal_interrupt_characte"/><div class="example-title">Example 62-1. Changing the terminal <span class="emphasis"><em>interrupt</em></span>
                            character</div><div class="example-contents"><pre class="programlisting"><strong class="userinput"><code>tty/new_intr.c</code></strong>
#include &lt;termios.h&gt;
#include &lt;ctype.h&gt;
#include "tlpi_hdr.h"

int
main(int argc, char *argv[])
{
    struct termios tp;
    int intrChar;

    if (argc &gt; 1 &amp;&amp; strcmp(argv[1], "--help") == 0)
        usageErr("%s [intr-char]\n", argv[0]);

    /* Determine new INTR setting from command line */

    if (argc == 1) {                                     /* Disable */
        intrChar = fpathconf(STDIN_FILENO, _PC_VDISABLE);
        if (intrChar == -1)
            errExit("Couldn't determine VDISABLE");
    } else if (isdigit((unsigned char) argv[1][0])) {
        intrChar = strtoul(argv[1], NULL, 0);           /* Allows hex, octal */
    } else {                                            /* Literal character */
        intrChar = argv[1][0];
    }

    /* Fetch current terminal settings, modify INTR character, and
       push changes back to the terminal driver */

    if (tcgetattr(STDIN_FILENO, &amp;tp) == -1)
        errExit("tcgetattr");
    tp.c_cc[VINTR] = intrChar;
    if (tcsetattr(STDIN_FILENO, TCSAFLUSH, &amp;tp) == -1)
        errExit("tcsetattr");

    exit(EXIT_SUCCESS);
}
      <strong class="userinput"><code>tty/new_intr.c</code></strong></pre></div></div></div></div></div><div class="sect1" title="Terminal Flags"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="terminal_flags">Terminal Flags</h2></div></div></div><p><a class="xref" href="ch62.html#terminal_flags-id1" title="Table 62-2. Terminal flags">Table 62-2</a> lists the settings controlled by each of the
                four flag fields of the <span class="emphasis"><em>termios</em></span> structure. The constants listed
                in this table correspond to single bits, except those specifying the term
                    <span class="emphasis"><em>mask</em></span>, which are values spanning several bits; these may
                contain one of a range of values, shown in parentheses. The column labeled
                    <span class="emphasis"><em>SUSv3</em></span> indicates whether the flag is specified in SUSv3. The
                    <span class="emphasis"><em>Default</em></span> column shows the default settings for a virtual
                console login.<a id="IDX-CHP-62-8290" class="indexterm"/><a id="IDX-CHP-62-8291" class="indexterm"/><a id="IDX-CHP-62-8292" class="indexterm"/><a id="IDX-CHP-62-8293" class="indexterm"/><a id="IDX-CHP-62-8294" class="indexterm"/><a id="IDX-CHP-62-8295" class="indexterm"/><a id="IDX-CHP-62-8296" class="indexterm"/><a id="IDX-CHP-62-8297" class="indexterm"/><a id="IDX-CHP-62-8298" class="indexterm"/><a id="IDX-CHP-62-8299" class="indexterm"/><a id="IDX-CHP-62-8300" class="indexterm"/><a id="IDX-CHP-62-8301" class="indexterm"/><a id="IDX-CHP-62-8302" class="indexterm"/><a id="IDX-CHP-62-8303" class="indexterm"/><a id="IDX-CHP-62-8304" class="indexterm"/><a id="IDX-CHP-62-8305" class="indexterm"/><a id="IDX-CHP-62-8306" class="indexterm"/><a id="IDX-CHP-62-8307" class="indexterm"/><a id="IDX-CHP-62-8308" class="indexterm"/><a id="IDX-CHP-62-8309" class="indexterm"/><a id="IDX-CHP-62-8310" class="indexterm"/><a id="IDX-CHP-62-8311" class="indexterm"/><a id="IDX-CHP-62-8312" class="indexterm"/><a id="IDX-CHP-62-8313" class="indexterm"/><a id="IDX-CHP-62-8314" class="indexterm"/><a id="IDX-CHP-62-8315" class="indexterm"/><a id="IDX-CHP-62-8316" class="indexterm"/><a id="IDX-CHP-62-8317" class="indexterm"/><a id="IDX-CHP-62-8318" class="indexterm"/><a id="IDX-CHP-62-8319" class="indexterm"/><a id="IDX-CHP-62-8320" class="indexterm"/><a id="IDX-CHP-62-8321" class="indexterm"/><a id="IDX-CHP-62-8322" class="indexterm"/><a id="IDX-CHP-62-8323" class="indexterm"/><a id="IDX-CHP-62-8324" class="indexterm"/><a id="IDX-CHP-62-8325" class="indexterm"/><a id="IDX-CHP-62-8326" class="indexterm"/><a id="IDX-CHP-62-8327" class="indexterm"/><a id="IDX-CHP-62-8328" class="indexterm"/><a id="IDX-CHP-62-8329" class="indexterm"/><a id="IDX-CHP-62-8330" class="indexterm"/><a id="IDX-CHP-62-8331" class="indexterm"/><a id="IDX-CHP-62-8332" class="indexterm"/><a id="IDX-CHP-62-8333" class="indexterm"/><a id="IDX-CHP-62-8334" class="indexterm"/><a id="IDX-CHP-62-8335" class="indexterm"/><a id="IDX-CHP-62-8336" class="indexterm"/><a id="IDX-CHP-62-8337" class="indexterm"/><a id="IDX-CHP-62-8338" class="indexterm"/><a id="IDX-CHP-62-8339" class="indexterm"/><a id="IDX-CHP-62-8340" class="indexterm"/><a id="IDX-CHP-62-8341" class="indexterm"/><a id="IDX-CHP-62-8342" class="indexterm"/><a id="IDX-CHP-62-8343" class="indexterm"/><a id="IDX-CHP-62-8344" class="indexterm"/><a id="IDX-CHP-62-8345" class="indexterm"/><a id="IDX-CHP-62-8346" class="indexterm"/><a id="IDX-CHP-62-8347" class="indexterm"/><a id="IDX-CHP-62-8348" class="indexterm"/><a id="IDX-CHP-62-8349" class="indexterm"/><a id="IDX-CHP-62-8350" class="indexterm"/></p><div class="note" title="Note"><h3 class="title">Note</h3><p>Many shells that provide command-line editing facilities perform their own
                    manipulations of the flags listed in <a class="xref" href="ch62.html#terminal_flags-id1" title="Table 62-2. Terminal flags">Table 62-2</a>. This
                    means that if we try using <span class="emphasis"><em>stty(1)</em></span> to experiment with these
                    settings, then the changes may not be effective when entering shell commands. To
                    circumvent this behavior, we must disable command-line editing in the shell. For
                    example, command-line editing can be disabled by specifying the command-line
                    option —<span class="emphasis"><em>noediting</em></span> when invoking
                    <span class="emphasis"><em>bash</em></span>.</p></div><div class="table"><a id="terminal_flags-id1"/><div class="table-title">Table 62-2. Terminal flags</div><div class="table-contents"><table style="border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col1"/><col class="col2"/><col class="col3"/><col class="col4"/></colgroup><thead><tr><td style="text-align: left; vertical-align: bottom; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Field/Flag</p>
                            </td><td style="text-align: left; vertical-align: bottom; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Description</p>
                            </td><td style="text-align: left; vertical-align: bottom; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Default</p>
                            </td><td style="text-align: left; vertical-align: bottom; border-bottom: 0.5pt solid ; ">
                                <p>SUSv3</p>
                            </td></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; " colspan="4">
                                <p>
                                    <span class="emphasis"><em>c_iflag</em></span>
                                </p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">BRKINT</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Signal interrupt (<code class="literal">SIGINT</code>)
                                    on BREAK condition<a id="IDX-CHP-62-8351" class="indexterm"/></p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>on</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">ICRNL</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Map CR to NL on input</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>on</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">IGNBRK</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Ignore BREAK condition</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">IGNCR</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Ignore CR on input</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">IGNPAR</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Ignore characters with parity errors</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">IMAXBEL</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Ring bell when terminal input queue is full (unused)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>(on)</p>
                            </td><td style="border-bottom: 0.5pt solid ; "> </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">INLCR</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Map NL to CR on input</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">INPCK</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Enable input parity checking</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">ISTRIP</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Strip high bit (bit 8) from input characters</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">IUTF8</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Input is UTF-8 (since Linux 2.6.4)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="border-bottom: 0.5pt solid ; "> </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">IUCLC</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Map uppercase to lowercase on input (if <code class="literal">IEXTEN</code> also set)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="border-bottom: 0.5pt solid ; "> </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">IXANY</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Allow any character to restart stopped output</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">IXOFF</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Enable start/stop input flow control</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">IXON</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Enable start/stop output flow control</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>on</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">PARMRK</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Mark parity errors (with 2 prefix bytes: 0377 + 0)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <span class="emphasis"><em>c_oflag</em></span>
                                </p>
                            </td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "> </td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "> </td><td style="border-bottom: 0.5pt solid ; "> </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">BSDLY</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Backspace delay mask (<code class="literal">BS0</code>,
                                        <code class="literal">BS1</code>)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">BS0</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">CRDLY</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>CR delay mask (<code class="literal">CR0</code>,
                                        <code class="literal">CR1</code>, <code class="literal">CR2</code>, <code class="literal">CR3</code>)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">CR0</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">FFDLY</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Form-feed delay mask (<code class="literal">FF0</code>,
                                        <code class="literal">FF1</code>)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">FF0</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">NLDLY</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Newline delay mask (<code class="literal">NL0</code>,
                                        <code class="literal">NL1</code>)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">NL0</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">OCRNL</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Map CR to NL on output (see also <code class="literal">ONOCR</code>)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">OFDEL</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Use DEL (0177) as fill character; otherwise NUL (0)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">OFILL</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Use fill characters for delay (rather than timed delay)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">OLCUC</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Map lowercase to uppercase on output</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="border-bottom: 0.5pt solid ; "> </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">ONLCR</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Map NL to CR-NL on output</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>on</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">ONLRET</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Assume NL performs CR function (move to start of line)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">ONOCR</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Don’t output CR if already at column 0 (start of line)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">OPOST</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Perform output postprocessing</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>on</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">TABDLY</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Horizontal-tab delay mask (<code class="literal">TAB0</code>, <code class="literal">TAB1</code>,
                                        <code class="literal">TAB2</code>, <code class="literal">TAB3</code>)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">TAB0</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">VTDLY</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Vertical-tab delay mask (<code class="literal">VT0</code>, <code class="literal">VT1</code>)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">VT0</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <span class="emphasis"><em>c_cflag</em></span>
                                </p>
                            </td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "> </td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "> </td><td style="border-bottom: 0.5pt solid ; "> </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">CBAUD</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Baud (bit rate) mask (<code class="literal">B0</code>,
                                        <code class="literal">B2400</code>, <code class="literal">B9600</code>, and so on)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">B38400</code>
                                </p>
                            </td><td style="border-bottom: 0.5pt solid ; "> </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">CBAUDEX</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Extended baud (bit rate) mask (for rates &gt;
                                    38,400)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="border-bottom: 0.5pt solid ; "> </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">CIBAUD</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Input baud (bit rate), if different from output
                                    (unused)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>(off)</p>
                            </td><td style="border-bottom: 0.5pt solid ; " class="auto-generated"> </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">CLOCAL</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Ignore modem status lines (don’t check carrier signal)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">CMSPAR</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Use “stick” (mark/space) parity</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="border-bottom: 0.5pt solid ; "> </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">CREAD</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Allow input to be received</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>on</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">CRTSCTS</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Enable RTS/CTS (hardware) flow control</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="border-bottom: 0.5pt solid ; "> </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">CSIZE</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Character-size mask (5 to 8 bits: <code class="literal">CS5</code>, <code class="literal">CS6</code>,
                                        <code class="literal">CS7</code>, <code class="literal">CS8</code>)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">CS8</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">CSTOPB</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Use 2 stop bits per character; otherwise 1</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">HUPCL</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Hang up (drop modem connection) on last close</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>on</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">PARENB</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Parity enable</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">PARODD</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Use odd parity; otherwise even</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <span class="emphasis"><em>c_lflag</em></span>
                                </p>
                            </td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "> </td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "> </td><td style="border-bottom: 0.5pt solid ; "> </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">ECHO</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Echo input characters</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>on</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">ECHOCTL</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Echo control characters visually (e.g., <code class="literal">^L</code>)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>on</p>
                            </td><td style="border-bottom: 0.5pt solid ; "> </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">ECHOE</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Perform ERASE visually</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>on</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">ECHOK</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Echo KILL visually</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>on</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">ECHOKE</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Don’t output a newline after echoed KILL</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>on</p>
                            </td><td style="border-bottom: 0.5pt solid ; "> </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">ECHONL</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Echo NL (in canonical mode) even if echoing is disabled</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">ECHOPRT</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Echo deleted characters backward (between <code class="literal">\</code> and <code class="literal">/</code>)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="border-bottom: 0.5pt solid ; "> </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">FLUSHO</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Output is being flushed (unused)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>-</p>
                            </td><td style="border-bottom: 0.5pt solid ; "> </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">ICANON</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Canonical mode (line-by-line) input</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>on</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">IEXTEN</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Enable extended processing of input characters</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>on</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">ISIG</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Enable signal-generating characters (INTR, QUIT, SUSP)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>on</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">NOFLSH</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Disable flushing on INTR, QUIT, and SUSP</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">PENDIN</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Redisplay pending input at next read (not implemented)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>(off)</p>
                            </td><td style="border-bottom: 0.5pt solid ; "> </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">TOSTOP</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Generate <code class="literal">SIGTTOU</code> for
                                    background output (<a class="xref" href="ch34.html#using_job_control_within_the_shell" title="Using Job Control Within the Shell">Using Job Control Within the Shell</a>)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>off</p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>•</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">XCASE</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; ">
                                <p>Canonical upper/lowercase presentation (unimplemented)</p>
                            </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; ">
                                <p>(off)</p>
                            </td><td> </td></tr></tbody></table></div></div><p>Several of the flags listed in <a class="xref" href="ch62.html#terminal_flags-id1" title="Table 62-2. Terminal flags">Table 62-2</a> were provided
                for historical terminals with limited capabilities, and these flags have little use
                on modern systems. For example, the <code class="literal">IUCLC</code>,
                    <code class="literal">OLCUC</code>, and <code class="literal">XCASE</code> flags were used with terminals that were capable of displaying
                only uppercase letters. On many older UNIX systems, if a user tried logging in with
                an uppercase username, the <span class="emphasis"><em>login</em></span> program assumed that the user
                was sitting at such a terminal and would set these flags, and then the following
                password prompt would appear:</p><a id="I_programlisting62_d1e163612"/><pre class="programlisting">\PASSWORD:</pre><p>From this point on, all lowercase characters were output in uppercase, and real
                uppercase characters were preceded by a backslash (\). Similarly, for input, a real
                uppercase character could be specified by a preceding backslash. The <code class="literal">ECHOPRT</code> flag was also designed for limited-capability
                terminals.</p><p>The various delay masks are also historical, allowing for terminals and printers
                that took longer to echo characters such as carriage return and form feed. The
                related <code class="literal">OFILL</code> and <code class="literal">OFDEL</code> flags specified how such a delay was to be performed. Most of
                these flags are unused on Linux. One exception is the <code class="literal">TAB3</code> setting for the <code class="literal">TABDLY</code> mask,
                which causes tab characters to be output as (up to eight) spaces.</p><p>The following paragraphs provide more details about some of the
                    <span class="emphasis"><em>termios</em></span> flags.</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title" id="brkint"/></div></div></div><div class="sect3" title="BRKINT"><div class="titlepage"><div><div><h4 class="title" id="brkint-id1">BRKINT</h4></div></div></div><p>If the <code class="literal">BRKINT</code> flag is set and the
                            <code class="literal">IGNBRK</code> flag is not set, then a
                            <code class="literal">SIGINT</code> signal is sent to the
                        foreground process group when a BREAK condition occurs.<a id="IDX-CHP-62-8352" class="indexterm"/><a id="IDX-CHP-62-8353" class="indexterm"/></p><div class="note" title="Note"><h3 class="title">Note</h3><p>Most conventional dumb terminals provided a <span class="emphasis"><em>BREAK</em></span>
                            key. Pressing this key doesn’t actually generate a character, but
                            instead causes a <span class="emphasis"><em>BREAK condition</em></span>, whereby a series
                            of 0 bits is sent to the terminal driver for a specified length of time,
                            typically 0.25 or 0.5 seconds (i.e., longer than the time required to
                            transmit a single byte). (Unless the <code class="literal">IGNBRK</code> flag has been set, the terminal driver
                            consequently delivers a single 0 byte to the reading process.) On many
                            UNIX systems, the BREAK condition acted as a signal to a remote host to
                            change its line speed (baud) to something suitable for the terminal.
                            Thus, the user would press the <span class="emphasis"><em>BREAK</em></span> key until a
                            valid login prompt appeared, indicating that the line speed was now
                            suitable for this terminal.</p><p>On a virtual console, we can generate a BREAK condition by pressing
                                <span class="emphasis"><em>Control-Break</em></span>.</p></div></div><div class="sect3" title="ECHO"><div class="titlepage"><div><div><h4 class="title" id="echo">ECHO</h4></div></div></div><p>Setting the <code class="literal">ECHO</code> flag enables echoing
                        of input characters. Disabling echoing is useful when reading passwords.
                        Echoing is also disabled within the command mode of <span class="emphasis"><em>vi</em></span>,
                        where keyboard characters are interpreted as editing commands rather than
                        text input. The <code class="literal">ECHO</code> flag is effective in
                        both canonical and noncanonical modes.<a id="IDX-CHP-62-8354" class="indexterm"/><a id="IDX-CHP-62-8355" class="indexterm"/><a id="IDX-CHP-62-8356" class="indexterm"/><a id="IDX-CHP-62-8357" class="indexterm"/><a id="IDX-CHP-62-8358" class="indexterm"/><a id="IDX-CHP-62-8359" class="indexterm"/><a id="IDX-CHP-62-8360" class="indexterm"/><a id="IDX-CHP-62-8361" class="indexterm"/><a id="IDX-CHP-62-8362" class="indexterm"/></p></div><div class="sect3" title="ECHOCTL"><div class="titlepage"><div><div><h4 class="title" id="echoctl">ECHOCTL</h4></div></div></div><p>If <code class="literal">ECHO</code> is set, then enabling the
                            <code class="literal">ECHOCTL</code> flag causes control
                        characters other than tab, newline, START, and STOP to be echoed in the form
                            <code class="literal">^A</code> (for
                            <span class="emphasis"><em>Control-A</em></span>), and so on. If <code class="literal">ECHOCTL</code> is disabled, control characters are not
                        echoed.</p><div class="note" title="Note"><h3 class="title">Note</h3><p>The control characters are those with ASCII codes less than 32, plus
                            the DEL character (127 decimal). A control character, x, is echoed using
                            a caret (<code class="literal">^</code>) followed by the character
                            resulting from the expression (<span class="emphasis"><em>x ^ 64</em></span>). For all
                            characters except DEL, the effect of the XOR (<code class="literal">^</code>) operator in this expression is to add 64 to the value
                            of the character. Thus, <span class="emphasis"><em>Control-A</em></span> (ASCII 1) is
                            echoed as caret plus <code class="literal">A</code> (ASCII 65).
                            For DEL, the expression has the effect of subtracting 64 from 127,
                            yielding the value 63, the ASCII code for ?, so that DEL is echoed as
                                <code class="literal">^</code>?.</p></div></div><div class="sect3" title="ECHOE"><div class="titlepage"><div><div><h4 class="title" id="echoe">ECHOE</h4></div></div></div><p>In canonical mode, setting the <code class="literal">ECHOE</code>
                        flag causes ERASE to be performed visually, by outputting the sequence
                        backspace-space-backspace to the terminal. If <code class="literal">ECHOE</code> is disabled, then the ERASE character is instead echoed
                        (e.g., as <code class="literal">^?</code>), but still performs its
                        function of deleting a character.</p></div><div class="sect3" title="ECHOK and ECHOKE"><div class="titlepage"><div><div><h4 class="title" id="echok_and_echoke"><code class="literal">ECHOK</code> and <code class="literal">ECHOKE</code></h4></div></div></div><p>The <code class="literal">ECHOK</code> and <code class="literal">ECHOKE</code> flags control the visual display when using the KILL
                        (erase line) character in canonical mode. In the default case (both flags
                        enabled), a line is erased visually (see <code class="literal">ECHOE</code>). If either of these flags is disabled, then a visual
                        erase is not performed (but the input line is still discarded), and the KILL
                        character is echoed (e.g., as <code class="literal">^U</code>). If
                            <code class="literal">ECHOK</code> is set, but not <code class="literal">ECHOKE</code>, then a newline character is also
                        output.</p></div><div class="sect3" title="ICANON"><div class="titlepage"><div><div><h4 class="title" id="icanon">ICANON</h4></div></div></div><p>Setting the <code class="literal">ICANON</code> flag enables
                        canonical mode input. Input is gathered into lines, and special
                        interpretation of the EOF, EOL, EOL2, ERASE, LNEXT, KILL, REPRINT, and
                        WERASE characters is enabled (but note the effect of the <code class="literal">IEXTEN</code> flag described below).<a id="IDX-CHP-62-8363" class="indexterm"/><a id="IDX-CHP-62-8364" class="indexterm"/><a id="IDX-CHP-62-8365" class="indexterm"/><a id="IDX-CHP-62-8366" class="indexterm"/><a id="IDX-CHP-62-8367" class="indexterm"/><a id="IDX-CHP-62-8368" class="indexterm"/><a id="IDX-CHP-62-8369" class="indexterm"/><a id="IDX-CHP-62-8370" class="indexterm"/><a id="IDX-CHP-62-8371" class="indexterm"/><a id="IDX-CHP-62-8372" class="indexterm"/><a id="IDX-CHP-62-8373" class="indexterm"/><a id="IDX-CHP-62-8374" class="indexterm"/><a id="IDX-CHP-62-8375" class="indexterm"/><a id="IDX-CHP-62-8376" class="indexterm"/><a id="IDX-CHP-62-8377" class="indexterm"/><a id="IDX-CHP-62-8378" class="indexterm"/><a id="IDX-CHP-62-8379" class="indexterm"/><a id="IDX-CHP-62-8380" class="indexterm"/><a id="IDX-CHP-62-8381" class="indexterm"/><a id="IDX-CHP-62-8382" class="indexterm"/><a id="IDX-CHP-62-8383" class="indexterm"/><a id="IDX-CHP-62-8384" class="indexterm"/><a id="IDX-CHP-62-8385" class="indexterm"/><a id="IDX-CHP-62-8386" class="indexterm"/><a id="IDX-CHP-62-8387" class="indexterm"/><a id="IDX-CHP-62-8388" class="indexterm"/></p></div><div class="sect3" title="IEXTEN"><div class="titlepage"><div><div><h4 class="title" id="iexten">IEXTEN</h4></div></div></div><p>Setting the <code class="literal">IEXTEN</code> flag enables
                        extended processing of input characters. This flag (as well as <code class="literal">ICANON</code>) must be set in order for the following
                        characters to be interpreted: EOL2, LNEXT, REPRINT, and WERASE. The <code class="literal">IEXTEN</code> flag must also be set for the <code class="literal">IUCLC</code> flag to be effective. SUSv3 merely says
                        that the <code class="literal">IEXTEN</code> flag enables extended
                        (implementation-defined) functions; details may vary on other UNIX
                        implementations.</p></div><div class="sect3" title="IMAXBEL"><div class="titlepage"><div><div><h4 class="title" id="imaxbel">IMAXBEL</h4></div></div></div><p>On Linux, the setting of the <code class="literal">IMAXBEL</code>
                        flag is ignored. On a console login, the bell is always rung when the input
                        queue is full.</p></div><div class="sect3" title="IUTF8"><div class="titlepage"><div><div><h4 class="title" id="iutf8">IUTF8</h4></div></div></div><p>Setting the <code class="literal">IUTF8</code> flag enables cooked
                        mode (<a class="xref" href="ch62.html#cooked_comma_cbreak_comma_and_raw_modes" title="Cooked, Cbreak, and Raw Modes">Cooked, Cbreak, and Raw Modes</a>) to
                        correctly handle UTF-8 input when performing line editing.</p></div><div class="sect3" title="NOFLSH"><div class="titlepage"><div><div><h4 class="title" id="noflsh">NOFLSH</h4></div></div></div><p>By default, when a signal is generated by typing the INTR, QUIT, or SUSP
                        character, any outstanding data in the terminal input and output queues is
                        flushed (discarded). Setting the <code class="literal">NOFLSH</code>
                        flag disables such flushing.</p></div><div class="sect3" title="OPOST"><div class="titlepage"><div><div><h4 class="title" id="opost">OPOST</h4></div></div></div><p>Setting the <code class="literal">OPOST</code> flag enables output
                        postprocessing. This flag must be set in order for any of the flags in the
                            <span class="emphasis"><em>c_oflag</em></span> field of the <span class="emphasis"><em>termios</em></span>
                        structure to be effective. (Put conversely, disabling the <code class="literal">OPOST</code> flag prevents all output
                        postprocessing.)</p></div><div class="sect3" title="PARENB, IGNPAR, INPCK, PARMRK, and PARODD"><div class="titlepage"><div><div><h4 class="title" id="parenb_comma_ignpar_comma_inpck_comma_pa">PARENB, IGNPAR, INPCK, PARMRK, and PARODD</h4></div></div></div><p>The <code class="literal">PARENB</code>, <code class="literal">IGNPAR</code>, <code class="literal">INPCK</code>, <code class="literal">PARMRK</code>, and <code class="literal">PARODD</code> flags are concerned with parity generation and
                        checking.</p><p>The <code class="literal">PARENB</code> flag enables generation of
                        parity check bits for output characters and parity checking for input
                        characters. If we want to perform only output parity generation, then we can
                        disable input parity checking by turning <code class="literal">INPCK</code> off. If the <code class="literal">PARODD</code>
                        flag is set, then odd parity is used in both cases; otherwise, even parity
                        is used.</p><p>The remaining flags specify how an input character with parity errors
                        should be handled. If the <code class="literal">IGNPAR</code> flag is
                        set, the character is discarded (not passed to the reading process).
                        Otherwise, if the <code class="literal">PARMRK</code> flag is set,
                        then the character is passed to the reading process, but is preceded by the
                        2-byte sequence 0377 + 0. (If the <code class="literal">PARMRK</code>
                        flag is set and <code class="literal">ISTRIP</code> is clear, then a
                        real 0377 character is doubled to become 0377 + 0377.) If <code class="literal">PARMRK</code> is not set, but <code class="literal">INPCK</code> is set, then the character is discarded,
                        and a 0 byte is passed to the reading process instead. If none of <code class="literal">IGNPAR</code>, <code class="literal">PARMRK</code>, or <code class="literal">INPCK</code> is set,
                        then the character is passed as is to the reading process.</p></div><div class="sect3" title="Example program"><div class="titlepage"><div><div><h4 class="title" id="example_program-id76">Example program</h4></div></div></div><p><a class="xref" href="ch62.html#disabling_terminal_echoing" title="Example 62-2. Disabling terminal echoing">Example 62-2</a> demonstrates the use of
                            <span class="emphasis"><em>tcgetattr()</em></span> and <span class="emphasis"><em>tcsetattr()</em></span> to
                        turn off the <code class="literal">ECHO</code> flag, so that input
                        characters are not echoed. Here is an example of what we see when running
                        this program:<a id="IDX-CHP-62-8389" class="indexterm"/><a id="IDX-CHP-62-8390" class="indexterm"/><a id="IDX-CHP-62-8391" class="indexterm"/><a id="IDX-CHP-62-8392" class="indexterm"/><a id="IDX-CHP-62-8393" class="indexterm"/><a id="IDX-CHP-62-8394" class="indexterm"/><a id="IDX-CHP-62-8395" class="indexterm"/></p><a id="I_programlisting62_d1e164127"/><pre class="programlisting">$ <strong class="userinput"><code>./no_echo</code></strong>
Enter text:                           <em class="lineannotation"><span class="lineannotation">We type some text, which is not echoed,</span></em>
Read: Knock, knock, Neo.              <em class="lineannotation"><span class="lineannotation">but was nevertheless read</span></em></pre><div class="example"><a id="disabling_terminal_echoing"/><div class="example-title">Example 62-2. Disabling terminal echoing</div><div class="example-contents"><pre class="programlisting"><strong class="userinput"><code>tty/no_echo.c</code></strong>
#include &lt;termios.h&gt;
#include "tlpi_hdr.h"

#define BUF_SIZE 100

int
main(int argc, char *argv[])
{
    struct termios tp, save;
    char buf[BUF_SIZE];

    /* Retrieve current terminal settings, turn echoing off */

    if (tcgetattr(STDIN_FILENO, &amp;tp) == -1)
        errExit("tcgetattr");
    save = tp;                          /* So we can restore settings later */
    tp.c_lflag &amp;= ~ECHO;                /* ECHO off, other bits unchanged */
    if (tcsetattr(STDIN_FILENO, TCSAFLUSH, &amp;tp) == -1)
        errExit("tcsetattr");

    /* Read some input and then display it back to the user */

    printf("Enter text: ");
    fflush(stdout);
    if (fgets(buf, BUF_SIZE, stdin) == NULL)
        printf("Got end-of-file/error on fgets()\n");
    else
        printf("\nRead: %s", buf);

    /* Restore original terminal settings */

    if (tcsetattr(STDIN_FILENO, TCSANOW, &amp;save) == -1)
        errExit("tcsetattr");

    exit(EXIT_SUCCESS);
}
      <strong class="userinput"><code>tty/no_echo.c</code></strong></pre></div></div></div></div></div><div class="sect1" title="Terminal I/O Modes"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="terminal_i_solidus_o_modes">Terminal I/O Modes</h2></div></div></div><p>We have already noted that the terminal driver is capable of handling input in
                either canonical or noncanonical mode, depending on the setting of the <code class="literal">ICANON</code> flag. We now describe these two modes in
                detail. We then describe three useful terminal modes—cooked, cbreak, and raw—that
                were available in Seventh Edition UNIX, and show how these modes are emulated on
                modern UNIX systems by setting appropriate values in the
                    <span class="emphasis"><em>termios</em></span> structure.<a id="IDX-CHP-62-8396" class="indexterm"/></p><div class="sect2" title="Canonical Mode"><div class="titlepage"><div><div><h3 class="title" id="canonical_mode">Canonical Mode</h3></div></div></div><p>Canonical mode input is enabled by setting the <code class="literal">ICANON</code> flag. Terminal input in canonical mode is distinguished by
                    the following features:<a id="IDX-CHP-62-8397" class="indexterm"/><a id="IDX-CHP-62-8398" class="indexterm"/><a id="IDX-CHP-62-8399" class="indexterm"/><a id="IDX-CHP-62-8400" class="indexterm"/><a id="IDX-CHP-62-8401" class="indexterm"/><a id="IDX-CHP-62-8402" class="indexterm"/><a id="IDX-CHP-62-8403" class="indexterm"/><a id="IDX-CHP-62-8404" class="indexterm"/><a id="IDX-CHP-62-8405" class="indexterm"/><a id="IDX-CHP-62-8406" class="indexterm"/><a id="IDX-CHP-62-8407" class="indexterm"/><a id="IDX-CHP-62-8408" class="indexterm"/><a id="IDX-CHP-62-8409" class="indexterm"/><a id="IDX-CHP-62-8410" class="indexterm"/><a id="IDX-CHP-62-8411" class="indexterm"/><a id="IDX-CHP-62-8412" class="indexterm"/><a id="IDX-CHP-62-8413" class="indexterm"/><a id="IDX-CHP-62-8414" class="indexterm"/><a id="IDX-CHP-62-8415" class="indexterm"/><a id="IDX-CHP-62-8416" class="indexterm"/><a id="IDX-CHP-62-8417" class="indexterm"/><a id="IDX-CHP-62-8418" class="indexterm"/></p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Input is gathered into lines, terminated by one of the line-delimiter
                            characters: NL, EOL, EOL2 (if the <code class="literal">IEXTEN</code> flag is set), EOF (at anything other than the
                            initial position in the line), or CR (if the <code class="literal">ICRNL</code> flag is enabled). Except in the case of EOF, the
                            line delimiter is passed back to the reading process (as the last
                            character in the line).</p></li><li class="listitem"><p>Line editing is enabled, so that the current line of input can be
                            modified. Thus, the following characters are enabled: ERASE, KILL, and,
                            if the <code class="literal">IEXTEN</code> flag is set,
                            WERASE.</p></li><li class="listitem"><p>If the <code class="literal">IEXTEN</code> flag is set, the
                            REPRINT and LNEXT characters are also enabled.</p></li></ul></div><p>In canonical mode, a terminal <span class="emphasis"><em>read()</em></span> returns when a
                    complete line of input is available. (The <span class="emphasis"><em>read()</em></span> itself may
                    fetch only part of that line if it requested fewer bytes; remaining bytes will
                    be fetched by subsequent calls to <span class="emphasis"><em>read()</em></span>.) A
                        <span class="emphasis"><em>read()</em></span> may also terminate if interrupted by a signal
                    handler and restarting of system calls is not enabled for this signal (<a class="xref" href="ch21.html#interruption_and_restarting_of_system_ca" title="Interruption and Restarting of System Calls">Interruption and Restarting of System Calls</a>).</p><div class="note" title="Note"><h3 class="title">Note</h3><p>While describing the <code class="literal">NOFLSH</code> flag in
                            <a class="xref" href="ch62.html#terminal_flags" title="Terminal Flags">Terminal Flags</a>, we noted that the characters that
                        generate signals also cause the terminal driver to flush the terminal input
                        queue. This flushing occurs regardless of whether the signal is caught or
                        ignored by an application. We can prevent such flushing by enabling the
                            <code class="literal">NOFLSH</code> flag.</p></div></div><div class="sect2" title="Noncanonical Mode"><div class="titlepage"><div><div><h3 class="title" id="noncanonical_mode">Noncanonical Mode</h3></div></div></div><p>Some applications (e.g., <span class="emphasis"><em>vi</em></span> and
                    <span class="emphasis"><em>less</em></span>) need to read characters from the terminal without the
                    user supplying a line delimiter. Noncanonical mode is provided for this purpose.
                    In noncanonical mode (<code class="literal">ICANON</code> unset), no
                    special input processing is performed. In particular, input is no longer
                    gathered into lines, but is instead available immediately.</p><p>In what circumstances does a noncanonical <span class="emphasis"><em>read()</em></span>
                    complete? We can specify that a noncanonical <span class="emphasis"><em>read()</em></span>
                    terminates after a certain time, after a certain number of bytes have been read,
                    or both in combination. Two elements of the <span class="emphasis"><em>termios c_cc</em></span>
                    array determine the behavior: TIME and MIN. The TIME element (indexed using the
                    constant <code class="literal">VTIME</code>) specifies a timeout value in
                    tenths of a second. The MIN element (indexed using <code class="literal">VMIN</code>) specifies the minimum number of bytes to be read. (The MIN
                    and TIME settings have no effect on canonical-mode terminal I/O.)</p><p>The precise operation and interaction of the MIN and TIME parameters depends
                    on whether they each have nonzero values. The four possible cases are described
                    below. Note that in all cases, if, at the time of a <span class="emphasis"><em>read()</em></span>,
                    sufficient bytes are already available to satisfy the requirements specified by
                    MIN, <span class="emphasis"><em>read()</em></span> returns immediately with the lesser of the
                    number of bytes available and the number of bytes requested.</p><div class="sect3" title="MIN == 0, TIME == 0 (polling read)"><div class="titlepage"><div><div><h4 class="title" id="min_equals_equals_0_comma_time_equals_eq">MIN == 0, TIME == 0 (polling read)</h4></div></div></div><p>If data is available at the time of the call, then
                            <span class="emphasis"><em>read()</em></span> returns immediately with the lesser of the
                        number of bytes available or the number of bytes requested. If no bytes are
                        available, <span class="emphasis"><em>read()</em></span> completes immediately, returning
                            0.<a id="IDX-CHP-62-8419" class="indexterm"/></p><p>This case serves the usual requirements of polling, allowing the
                        application to check if input is available without blocking if it is not.
                        This mode is somewhat similar to setting the <code class="literal">O_NONBLOCK</code> flag for the terminal (<a class="xref" href="ch05.html#nonblocking_i_solidus_o" title="Nonblocking I/O">Nonblocking I/O</a>). However, with <code class="literal">O_NONBLOCK</code>, if no bytes are available for
                        reading, then <span class="emphasis"><em>read()</em></span> returns -1 with the error <code class="literal">EAGAIN</code>.</p></div><div class="sect3" title="MIN &gt; 0, TIME == 0 (blocking read)"><div class="titlepage"><div><div><h4 class="title" id="min_g_0_comma_time_equals_equals_0_open">MIN &gt; 0, TIME == 0 (blocking read)</h4></div></div></div><p>The <span class="emphasis"><em>read()</em></span> blocks (possibly indefinitely) until the
                        lesser of the number of bytes requested or MIN bytes are available, and
                        returns the lesser of the two values.</p><p>Programs such as <span class="emphasis"><em>less</em></span> typically set MIN to 1 and TIME
                        to 0. This allows the program to wait for single key presses without needing
                        to waste CPU time by polling in a busy loop.</p><p>If a terminal is placed in noncanonical mode with MIN set to 1 and TIME
                        set to 0, then the techniques described in <a class="xref" href="ch63.html" title="Chapter 63. Alternative I/O Models">Chapter 63</a> can be used to check whether
                        a single character (rather than a complete line) has been typed at the
                        terminal.</p></div><div class="sect3" title="MIN == 0, TIME &gt; 0 (read with timeout)"><div class="titlepage"><div><div><h4 class="title" id="min_equals_equals_0_comma_time_g_0_open">MIN == 0, TIME &gt; 0 (read with timeout)</h4></div></div></div><p>A timer is started when <span class="emphasis"><em>read()</em></span> is called. The call
                        returns as soon as at least 1 byte is available, or when TIME tenths of a
                        second have elapsed. In the latter case, <span class="emphasis"><em>read()</em></span> returns
                        0.</p><p>This case is useful for programs talking to a serial device (e.g., a
                        modem). The program can send data to the device and then wait for a
                        response, using a timeout to avoid hanging forever in case the device
                        doesn’t respond.</p></div><div class="sect3" title="MIN &gt; 0, TIME &gt; 0 (read with interbyte timeout)"><div class="titlepage"><div><div><h4 class="title" id="min_g_0_comma_time_g_0_open_parenthesis">MIN &gt; 0, TIME &gt; 0 (read with interbyte timeout)</h4></div></div></div><p>After the initial byte of input becomes available, a timer is restarted as
                        each further byte is received. The <span class="emphasis"><em>read()</em></span> returns when
                        either the lesser of MIN bytes or the number of bytes requested have been
                        read, or when the time between receiving successive bytes exceeds TIME
                        tenths of a second. Since the timer is started only after the initial byte
                        becomes available, at least 1 byte is returned. (A
                            <span class="emphasis"><em>read()</em></span> can block indefinitely for this
                        case.)</p><p>This case is useful for handling terminal keys that generate escape
                        sequences. For example, on many terminals, the left-arrow key generates the
                        3-character sequence consisting of <span class="emphasis"><em>Escape</em></span> followed by
                            <code class="literal">OD</code>. These characters are transmitted
                        in quick succession. Applications handling such sequences need to
                        distinguish the pressing of such a key from the situation where the user
                        slowly types each of the characters individually. This can be done by
                        performing a <span class="emphasis"><em>read()</em></span> with a small interbyte timeout, say
                        0.2 seconds. Such a technique is used in the command mode of some versions
                        of <span class="emphasis"><em>vi</em></span>. (Depending on the length of the timeout, in such
                        applications, we may be able to simulate a left-arrow key press by quickly
                        typing the aforementioned 3-character sequence.)</p></div><div class="sect3" title="Portably modifying and restoring MIN and TIME"><div class="titlepage"><div><div><h4 class="title" id="portably_modifying_and_restoring_min_and">Portably modifying and restoring MIN and TIME</h4></div></div></div><p>For historical compatibility with some UNIX implementations, SUSv3 allows
                        the values of the <code class="literal">VMIN</code> and <code class="literal">VTIME</code> constants to be the same as <code class="literal">VEOF</code> and <code class="literal">VEOL</code>, respectively, which means that these elements of the
                            <span class="emphasis"><em>termios c_cc</em></span> array may coincide. (On Linux, the
                        values of these constants are distinct.) This is possible because <code class="literal">VEOF</code> and <code class="literal">VEOL</code> are unused in noncanonical mode. The fact that <code class="literal">VMIN</code> and <code class="literal">VEOF</code> may have the same value means that caution is needed in
                        a program that enters noncanonical mode, sets MIN (typically to 1), and then
                        later returns to canonical mode. On return to canonical mode, EOF will no
                        longer have its usual value of ASCII 4 (<span class="emphasis"><em>Control-D</em></span>). The
                        portable way to deal with this problem is to save a copy of the
                            <span class="emphasis"><em>termios</em></span> settings prior to changing to noncanonical
                        mode, and then use this saved structure to return to canonical
                            mode.<a id="IDX-CHP-62-8420" class="indexterm"/><a id="IDX-CHP-62-8421" class="indexterm"/><a id="IDX-CHP-62-8422" class="indexterm"/><a id="IDX-CHP-62-8423" class="indexterm"/><a id="IDX-CHP-62-8424" class="indexterm"/><a id="IDX-CHP-62-8425" class="indexterm"/><a id="IDX-CHP-62-8426" class="indexterm"/></p></div></div><div class="sect2" title="Cooked, Cbreak, and Raw Modes"><div class="titlepage"><div><div><h3 class="title" id="cooked_comma_cbreak_comma_and_raw_modes">Cooked, Cbreak, and Raw Modes</h3></div></div></div><p>The terminal driver in Seventh Edition UNIX (as well as in early versions of
                    BSD) was capable of handling input in three modes: <span class="emphasis"><em>cooked</em></span>,
                        <span class="emphasis"><em>cbreak</em></span>, and <span class="emphasis"><em>raw</em></span>. The differences
                    between the three modes are summarized in <a class="xref" href="ch62.html#differences_between_cooked_comma_cbreak" title="Table 62-3. Differences between cooked, cbreak, and raw terminal modes">Table 62-3</a>.</p><div class="table"><a id="differences_between_cooked_comma_cbreak"/><div class="table-title">Table 62-3. Differences between cooked, cbreak, and raw terminal modes</div><div class="table-contents"><table style="border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col1"/><col class="col2"/><col class="col3"/><col class="col4"/></colgroup><thead><tr><td style="text-align: center; vertical-align: bottom; border-right: 0.5pt solid ; " rowspan="2">
                                    <p>Feature</p>
                                </td><td style="text-align: center; vertical-align: bottom; border-bottom: 0.5pt solid ; " colspan="3">
                                    <p>Mode</p>
                                </td></tr><tr><td style="text-align: left; vertical-align: bottom; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                    <p>Cooked</p>
                                </td><td style="text-align: left; vertical-align: bottom; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                    <p>Cbreak</p>
                                </td><td style="text-align: left; vertical-align: bottom; border-bottom: 0.5pt solid ; ">
                                    <p>Raw</p>
                                </td></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                    <p>Input available</p>
                                </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                    <p>line by line</p>
                                </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                    <p>char. by char.</p>
                                </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                    <p>char. by char.</p>
                                </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                    <p>Line-editing?</p>
                                </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                    <p>yes</p>
                                </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                    <p>no</p>
                                </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                    <p>no</p>
                                </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                    <p>Signal-generating characters interpreted?</p>
                                </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                    <p>yes</p>
                                </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                    <p>yes</p>
                                </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                    <p>no</p>
                                </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                    <p>START/STOP interpreted?</p>
                                </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                    <p>yes</p>
                                </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                    <p>yes</p>
                                </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                    <p>no</p>
                                </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                    <p>Other special characters interpreted?</p>
                                </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                    <p>yes</p>
                                </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                    <p>no</p>
                                </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                    <p>no</p>
                                </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                    <p>Other input processing performed?</p>
                                </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                    <p>yes</p>
                                </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                    <p>yes</p>
                                </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                    <p>no</p>
                                </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                    <p>Other output processing performed?</p>
                                </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                    <p>yes</p>
                                </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                    <p>yes</p>
                                </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                    <p>no</p>
                                </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; ">
                                    <p>Input echoed?</p>
                                </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; ">
                                    <p>yes</p>
                                </td><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; ">
                                    <p>maybe</p>
                                </td><td style="text-align: left; vertical-align: top; ">
                                    <p>no</p>
                                </td></tr></tbody></table></div></div><p>Cooked mode was essentially canonical mode with all of the default special
                    character processing enabled (i.e., interpretation of <code class="literal">CR</code>, <code class="literal">NL</code>, and <code class="literal">EOF</code>; enabling of line editing; handling of
                    signal-generating characters; <code class="literal">ICRNL</code>; <code class="literal">OCRNL</code>; and so on).</p><p>Raw mode was the converse: noncanonical mode, with all input and output
                    processing, as well as echoing, switched off. (An application that needed to
                    ensure that the terminal driver makes absolutely no changes to the data
                    transferred across a serial line would use this mode.)</p><p>Cbreak mode was intermediate between cooked and raw modes. Input was
                    noncanonical, but signal-generating characters were interpreted, and the various
                    input and output transformations could still occur (depending on individual flag
                    settings). Cbreak mode did not disable echoing, but applications employing this
                    mode would usually disable echoing as well. Cbreak mode was useful in
                    screen-handling applications (such as <span class="emphasis"><em>less</em></span>) that permitted
                    character-by-character input, but still needed to allow interpretation of
                    characters such as INTR, QUIT, and SUSP.</p><div class="sect3" title="Example: setting raw and cbreak mode"><div class="titlepage"><div><div><h4 class="title" id="example_colon_setting_raw_and_cbreak_mod">Example: setting raw and cbreak mode</h4></div></div></div><p>In the Seventh Edition and the original BSD terminal drivers, it was
                        possible to switch to raw or cbreak mode by tweaking single bits (called
                            <code class="literal">RAW</code> and <code class="literal">CBREAK</code>) in the terminal driver data structures. With the
                        transition to the POSIX <span class="emphasis"><em>termios</em></span> interface (now
                        supported on all UNIX implementations), single bits for selecting raw and
                        cbreak mode are no longer available, and applications emulating these modes
                        must explicitly change the required fields of the
                            <span class="emphasis"><em>termios</em></span> structure. <a class="xref" href="ch62.html#switching_a_terminal_to_cbreak_and_raw_m" title="Example 62-3. Switching a terminal to cbreak and raw modes">Example 62-3</a> provides two
                        functions, <span class="emphasis"><em>ttySetCbreak()</em></span> and
                            <span class="emphasis"><em>ttySetRaw()</em></span>, that implement the equivalents of
                        these terminal modes.<a id="IDX-CHP-62-8427" class="indexterm"/><a id="IDX-CHP-62-8428" class="indexterm"/><a id="IDX-CHP-62-8429" class="indexterm"/><a id="IDX-CHP-62-8430" class="indexterm"/><a id="IDX-CHP-62-8431" class="indexterm"/><a id="IDX-CHP-62-8432" class="indexterm"/><a id="IDX-CHP-62-8433" class="indexterm"/><a id="IDX-CHP-62-8434" class="indexterm"/><a id="IDX-CHP-62-8435" class="indexterm"/><a id="IDX-CHP-62-8436" class="indexterm"/><a id="IDX-CHP-62-8437" class="indexterm"/><a id="IDX-CHP-62-8438" class="indexterm"/><a id="IDX-CHP-62-8439" class="indexterm"/><a id="IDX-CHP-62-8440" class="indexterm"/><a id="IDX-CHP-62-8441" class="indexterm"/><a id="IDX-CHP-62-8442" class="indexterm"/><a id="IDX-CHP-62-8443" class="indexterm"/><a id="IDX-CHP-62-8444" class="indexterm"/><a id="IDX-CHP-62-8445" class="indexterm"/><a id="IDX-CHP-62-8446" class="indexterm"/><a id="IDX-CHP-62-8447" class="indexterm"/><a id="IDX-CHP-62-8448" class="indexterm"/><a id="IDX-CHP-62-8449" class="indexterm"/><a id="IDX-CHP-62-8450" class="indexterm"/><a id="IDX-CHP-62-8451" class="indexterm"/><a id="IDX-CHP-62-8452" class="indexterm"/><a id="IDX-CHP-62-8453" class="indexterm"/><a id="IDX-CHP-62-8454" class="indexterm"/><a id="IDX-CHP-62-8455" class="indexterm"/><a id="IDX-CHP-62-8456" class="indexterm"/><a id="IDX-CHP-62-8457" class="indexterm"/><a id="IDX-CHP-62-8458" class="indexterm"/><a id="IDX-CHP-62-8459" class="indexterm"/><a id="IDX-CHP-62-8460" class="indexterm"/><a id="IDX-CHP-62-8461" class="indexterm"/><a id="IDX-CHP-62-8462" class="indexterm"/><a id="IDX-CHP-62-8463" class="indexterm"/><a id="IDX-CHP-62-8464" class="indexterm"/><a id="IDX-CHP-62-8465" class="indexterm"/><a id="IDX-CHP-62-8466" class="indexterm"/><a id="IDX-CHP-62-8467" class="indexterm"/><a id="IDX-CHP-62-8468" class="indexterm"/><a id="IDX-CHP-62-8469" class="indexterm"/><a id="IDX-CHP-62-8470" class="indexterm"/></p><div class="note" title="Note"><h3 class="title">Note</h3><p>Applications that use the <span class="emphasis"><em>ncurses</em></span> library can
                            call the functions <span class="emphasis"><em>cbreak()</em></span> and
                                <span class="emphasis"><em>raw()</em></span>, which perform similar tasks to our
                            functions in <a class="xref" href="ch62.html#switching_a_terminal_to_cbreak_and_raw_m" title="Example 62-3. Switching a terminal to cbreak and raw modes">Example 62-3</a>.</p></div><div class="example"><a id="switching_a_terminal_to_cbreak_and_raw_m"/><div class="example-title">Example 62-3. Switching a terminal to cbreak and raw modes</div><div class="example-contents"><pre class="programlisting"><strong class="userinput"><code>tty/tty_functions.c</code></strong>
#include &lt;termios.h&gt;
#include &lt;unistd.h&gt;
#include "tty_functions.h"              /* Declares functions defined here */

/* Place terminal referred to by 'fd' in cbreak mode (noncanonical mode
   with echoing turned off). This function assumes that the terminal is
   currently in cooked mode (i.e., we shouldn't call it if the terminal
   is currently in raw mode, since it does not undo all of the changes
   made by the ttySetRaw() function below). Return 0 on success, or -1
   on error. If 'prevTermios' is non-NULL, then use the buffer to which
   it points to return the previous terminal settings. */

int
ttySetCbreak(int fd, struct termios *prevTermios)
{
    struct termios t;

    if (tcgetattr(fd, &amp;t) == -1)
        return -1;

    if (prevTermios != NULL)
        *prevTermios = t;

    t.c_lflag &amp;= ~(ICANON | ECHO);
    t.c_lflag |= ISIG;

    t.c_iflag &amp;= ~ICRNL;

    t.c_cc[VMIN] = 1;                   /* Character-at-a-time input */
    t.c_cc[VTIME] = 0;                  /* with blocking */

    if (tcsetattr(fd, TCSAFLUSH, &amp;t) == -1)
        return -1;

    return 0;
}

/* Place terminal referred to by 'fd' in raw mode (noncanonical mode
   with all input and output processing disabled). Return 0 on success,
   or -1 on error. If 'prevTermios' is non-NULL, then use the buffer to
   which it points to return the previous terminal settings. */

int
ttySetRaw(int fd, struct termios *prevTermios)
{
    struct termios t;

    if (tcgetattr(fd, &amp;t) == -1)
        return -1;

    if (prevTermios != NULL)
        *prevTermios = t;

    t.c_lflag &amp;= ~(ICANON | ISIG | IEXTEN | ECHO);
                        /* Noncanonical mode, disable signals, extended
                           input processing, and echoing */

    t.c_iflag &amp;= ~(BRKINT | ICRNL | IGNBRK | IGNCR | INLCR |
                      INPCK | ISTRIP | IXON | PARMRK);
                        /* Disable special handling of CR, NL, and BREAK.
                           No 8th-bit stripping or parity error handling.
                           Disable START/STOP output flow control. */

    t.c_oflag &amp;= ~OPOST;                /* Disable all output processing */

    t.c_cc[VMIN] = 1;                   /* Character-at-a-time input */
    t.c_cc[VTIME] = 0;                  /* with blocking */

    if (tcsetattr(fd, TCSAFLUSH, &amp;t) == -1)
        return -1;

    return 0;
}
      <strong class="userinput"><code>tty/tty_functions.c</code></strong></pre></div></div><p>A program that places the terminal in raw or cbreak mode must be careful
                        to return the terminal to a usable mode when it terminates. Among other
                        tasks, this entails handling all of the signals that are likely to be sent
                        to the program, so that the program is not prematurely terminated.
                        (Job-control signals can still be generated from the keyboard in cbreak
                        mode.)</p><p>An example of how to do this is provided in <a class="xref" href="ch62.html#demonstrating_cbreak_and_raw_modes" title="Example 62-4. Demonstrating cbreak and raw modes">Example 62-4</a>. This program performs
                        the following steps:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Set the terminal to either cbreak mode <span class="inlinemediaobject"><a id="I_inlinemediaobject62_d1e165063"/><img src="figs/web/U009.png" alt=""/></span> or raw mode <span class="inlinemediaobject"><a id="I_inlinemediaobject62_d1e165069"/><img src="figs/web/U012.png" alt=""/></span>, depending on whether a command-line argument
                                (any string) is supplied <span class="inlinemediaobject"><a id="I_inlinemediaobject62_d1e165075"/><img src="figs/web/U008.png" alt=""/></span>. The previous terminal settings are saved in
                                the global variable <span class="emphasis"><em>userTermios</em></span>
                                <span class="inlinemediaobject"><a id="I_inlinemediaobject62_d1e165084"/><img src="figs/web/U001.png" alt=""/></span>.</p></li><li class="listitem"><p>If the terminal was placed in cbreak mode, then signals can be
                                generated from the terminal. These signals need to be handled so
                                that terminating or suspending the program leaves the terminal in a
                                state that the user expects. The program installs the same handler
                                for <code class="literal">SIGQUIT</code> and <code class="literal">SIGINT</code>
                                <span class="inlinemediaobject"><a id="I_inlinemediaobject62_d1e165099"/><img src="figs/web/U010.png" alt=""/></span>. The <code class="literal">SIGTSTP</code>
                                signal requires special treatment, so a different handler is
                                installed for that signal <span class="inlinemediaobject"><a id="I_inlinemediaobject62_d1e165108"/><img src="figs/web/U011.png" alt=""/></span>.<a id="IDX-CHP-62-8471" class="indexterm"/></p></li><li class="listitem"><p>Install a handler for the <code class="literal">SIGTERM</code> signal, in order to catch the default signal
                                sent by the <span class="emphasis"><em>kill</em></span> command <span class="inlinemediaobject"><a id="I_inlinemediaobject62_d1e165129"/><img src="figs/web/U013.png" alt=""/></span>.</p></li><li class="listitem"><p>Execute a loop that reads characters one at a time from
                                    <span class="emphasis"><em>stdin</em></span> and echoes them on standard output
                                    <span class="inlinemediaobject"><a id="I_inlinemediaobject62_d1e165141"/><img src="figs/web/U014.png" alt=""/></span>. The program treats various input characters
                                specially before outputting them <span class="inlinemediaobject"><a id="I_inlinemediaobject62_d1e165147"/><img src="figs/web/U015.png" alt=""/></span>:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>All letters are converted to lowercase before being
                                        output.</p></li><li class="listitem"><p>The newline (<code class="literal">\n</code>) and
                                        carriage return (<code class="literal">\r</code>)
                                        characters are echoed without change.</p></li><li class="listitem"><p>Control characters other than the newline and carriage
                                        return are echoed as a 2-character sequence: caret (<code class="literal">^</code>) plus the corresponding
                                        uppercase letter (e.g., <span class="emphasis"><em>Control-A</em></span>
                                        echoes as <code class="literal">^A</code>).</p></li><li class="listitem"><p>All other characters are echoed as asterisks (<code class="literal">*</code>).</p></li><li class="listitem"><p>The letter <span class="emphasis"><em>q</em></span> causes the loop to
                                        terminate <span class="inlinemediaobject"><a id="I_inlinemediaobject62_d1e165190"/><img src="figs/web/U016.png" alt=""/></span>.</p></li></ul></div></li><li class="listitem"><p>On exit from the loop, restore the terminal to its state as last
                                set by the user, and then terminate <span class="inlinemediaobject"><a id="I_inlinemediaobject62_d1e165199"/><img src="figs/web/U017.png" alt=""/></span>.</p></li></ul></div><p>The program installs the same handler for <code class="literal">SIGQUIT</code>, <code class="literal">SIGINT</code>, and
                            <code class="literal">SIGTERM</code>. This handler restores the
                        terminal to its state as last set by the user and terminates the program
                            <span class="inlinemediaobject"><a id="I_inlinemediaobject62_d1e165216"/><img src="figs/web/U002.png" alt=""/></span>.</p><p>The handler for the <code class="literal">SIGTSTP</code> signal
                            <span class="inlinemediaobject"><a id="I_inlinemediaobject62_d1e165227"/><img src="figs/web/U003.png" alt=""/></span> deals with the signal in the manner described in <a class="xref" href="ch34.html#handling_job-control_signals" title="Handling Job-Control Signals">Handling Job-Control Signals</a>. Note the following additional
                        details of the operation of this signal handler:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Upon entry, the handler saves the current terminal settings (in
                                    <span class="emphasis"><em>ourTermios</em></span>) <span class="inlinemediaobject"><a id="I_inlinemediaobject62_d1e165242"/><img src="figs/web/U004.png" alt=""/></span>, and then resets the terminal to the settings
                                that were in effect (saved in <span class="emphasis"><em>userTermios</em></span>) when
                                the program was started <span class="inlinemediaobject"><a id="I_inlinemediaobject62_d1e165251"/><img src="figs/web/U005.png" alt=""/></span>, before once more raising <code class="literal">SIGTSTP</code> to actually stop the
                                process.</p></li><li class="listitem"><p>Upon resumption of execution after receipt of <code class="literal">SIGCONT</code>, the handler once more saves
                                the current terminal settings in <span class="emphasis"><em>userTermios</em></span>
                                <span class="inlinemediaobject"><a id="I_inlinemediaobject62_d1e165269"/><img src="figs/web/U006.png" alt=""/></span>, since the user may have changed the settings
                                while the program was stopped (using the <span class="emphasis"><em>stty</em></span>
                                command, for example). The handler then returns the terminal to the
                                state (<span class="emphasis"><em>ourTermios</em></span>) required by the program
                                    <span class="inlinemediaobject"><a id="I_inlinemediaobject62_d1e165282"/><img src="figs/web/U007.png" alt=""/></span>.</p></li></ul></div><div class="example"><a id="demonstrating_cbreak_and_raw_modes"/><div class="example-title">Example 62-4. Demonstrating cbreak and raw modes</div><div class="example-contents"><pre class="programlisting"><strong class="userinput"><code>tty/test_tty_functions.c</code></strong>
    #include &lt;termios.h&gt;
    #include &lt;signal.h&gt;
    #include &lt;ctype.h&gt;
    #include "tty_functions.h"              /* Declarations of ttySetCbreak()
                                               and ttySetRaw() */
    #include "tlpi_hdr.h"

<img src="figs/web/U001.png" alt=""/>static struct termios userTermios;
                            /* Terminal settings as defined by user */

    static void             /* General handler: restore tty settings and exit */
    handler(int sig)
    {
<img src="figs/web/U002.png" alt=""/>    if (tcsetattr(STDIN_FILENO, TCSAFLUSH, &amp;userTermios) == -1)
            errExit("tcsetattr");
        _exit(EXIT_SUCCESS);
    }

    static void             /* Handler for SIGTSTP */
<img src="figs/web/U003.png" alt=""/>tstpHandler(int sig)
    {
        struct termios ourTermios;          /* To save our tty settings */
        sigset_t tstpMask, prevMask;
        struct sigaction sa;
        int savedErrno;

        savedErrno = errno;                 /* We might change 'errno' here */

        /* Save current terminal settings, restore terminal to
           state at time of program startup */

<img src="figs/web/U004.png" alt=""/>    if (tcgetattr(STDIN_FILENO, &amp;ourTermios) == -1)
            errExit("tcgetattr");
<img src="figs/web/U005.png" alt=""/>    if (tcsetattr(STDIN_FILENO, TCSAFLUSH, &amp;userTermios) == -1)
            errExit("tcsetattr");

        /* Set the disposition of SIGTSTP to the default, raise the signal
           once more, and then unblock it so that we actually stop */

        if (signal(SIGTSTP, SIG_DFL) == SIG_ERR)
            errExit("signal");
        raise(SIGTSTP);

        sigemptyset(&amp;tstpMask);
        sigaddset(&amp;tstpMask, SIGTSTP);
        if (sigprocmask(SIG_UNBLOCK, &amp;tstpMask, &amp;prevMask) == -1)
            errExit("sigprocmask");

        /* Execution resumes here after SIGCONT */

        if (sigprocmask(SIG_SETMASK, &amp;prevMask, NULL) == -1)
            errExit("sigprocmask");         /* Reblock SIGTSTP */

            sigemptyset(&amp;sa.sa_mask);           /* Reestablish handler */
        sa.sa_flags = SA_RESTART;
        sa.sa_handler = tstpHandler;
        if (sigaction(SIGTSTP, &amp;sa, NULL) == -1)
            errExit("sigaction");

        /* The user may have changed the terminal settings while we were
           stopped; save the settings so we can restore them later */

<img src="figs/web/U006.png" alt=""/>    if (tcgetattr(STDIN_FILENO, &amp;userTermios) == -1)
            errExit("tcgetattr");

        /* Restore our terminal settings */

<img src="figs/web/U007.png" alt=""/>    if (tcsetattr(STDIN_FILENO, TCSAFLUSH, &amp;ourTermios) == -1)
            errExit("tcsetattr");

        errno = savedErrno;
    }

    int
    main(int argc, char *argv[])
    {
        char ch;
        struct sigaction sa, prev;
        ssize_t n;

        sigemptyset(&amp;sa.sa_mask);
        sa.sa_flags = SA_RESTART;

<img src="figs/web/U008.png" alt=""/>    if (argc &gt; 1) {                     /* Use cbreak mode */
<img src="figs/web/U009.png" alt=""/>        if (ttySetCbreak(STDIN_FILENO, &amp;userTermios) == -1)
                errExit("ttySetCbreak");

            /* Terminal special characters can generate signals in cbreak
               mode. Catch them so that we can adjust the terminal mode.
               We establish handlers only if the signals are not being ignored. */

<img src="figs/web/U010.png" alt=""/>        sa.sa_handler = handler;

            if (sigaction(SIGQUIT, NULL, &amp;prev) == -1)
                errExit("sigaction");
            if (prev.sa_handler != SIG_IGN)
                if (sigaction(SIGQUIT, &amp;sa, NULL) == -1)
                    errExit("sigaction");

            if (sigaction(SIGINT, NULL, &amp;prev) == -1)
                errExit("sigaction");
            if (prev.sa_handler != SIG_IGN)
                if (sigaction(SIGINT, &amp;sa, NULL) == -1)
                    errExit("sigaction");

<img src="figs/web/U011.png" alt=""/>        sa.sa_handler = tstpHandler;
                if (sigaction(SIGTSTP, NULL, &amp;prev) == -1)
                errExit("sigaction");
            if (prev.sa_handler != SIG_IGN)
                if (sigaction(SIGTSTP, &amp;sa, NULL) == -1)
                    errExit("sigaction");
        } else {                            /* Use raw mode */
<img src="figs/web/U012.png" alt=""/>        if (ttySetRaw(STDIN_FILENO, &amp;userTermios) == -1)
                errExit("ttySetRaw");
        }

<img src="figs/web/U013.png" alt=""/>    sa.sa_handler = handler;
        if (sigaction(SIGTERM, &amp;sa, NULL) == -1)
            errExit("sigaction");

        setbuf(stdout, NULL);               /* Disable stdout buffering */

<img src="figs/web/U014.png" alt=""/>    for (;;) {                          /* Read and echo stdin */
            n = read(STDIN_FILENO, &amp;ch, 1);
            if (n == -1) {
                errMsg("read");
                break;
            }

            if (n == 0)                     /* Can occur after terminal disconnect */
                break;

<img src="figs/web/U015.png" alt=""/>        if (isalpha((unsigned char) ch))          /* Letters --&gt; lowercase */
                putchar(tolower((unsigned char) ch));
            else if (ch == '\n' || ch == '\r')
                putchar(ch);
            else if (iscntrl((unsigned char) ch))
                printf("^%c", ch ^ 64);     /* Echo Control-A as ^A, etc. */
            else
                putchar('*');               /* All other chars as '*' */

<img src="figs/web/U016.png" alt=""/>        if (ch == 'q')                  /* Quit loop */
                break;
        }

<img src="figs/web/U017.png" alt=""/>    if (tcsetattr(STDIN_FILENO, TCSAFLUSH, &amp;userTermios) == -1)
            errExit("tcsetattr");
        exit(EXIT_SUCCESS);
    }
          <strong class="userinput"><code>tty/test_tty_functions.c</code></strong></pre></div></div><p>Here is an example of what we see when we ask the program in <a class="xref" href="ch62.html#demonstrating_cbreak_and_raw_modes" title="Example 62-4. Demonstrating cbreak and raw modes">Example 62-4</a> to use raw mode:</p><a id="I_programlisting62_d1e165407"/><pre class="programlisting">$ <strong class="userinput"><code>stty</code></strong>                              <em class="lineannotation"><span class="lineannotation">Initial terminal mode is sane (cooked)</span></em>
speed 38400 baud; line = 0;
$ <strong class="userinput"><code>./test_tty_functions</code></strong>
<strong class="userinput"><code>abc</code></strong>                                 <em class="lineannotation"><span class="lineannotation">Type abc, and Control-J</span></em>
   <strong class="userinput"><code>def</code></strong>                              <em class="lineannotation"><span class="lineannotation">Type DEF, Control-J, and Enter</span></em>
<strong class="userinput"><code>^C^Z</code></strong>                                <em class="lineannotation"><span class="lineannotation">Type Control-C, Control-Z, and Control-J</span></em>
    <strong class="userinput"><code>q</code></strong>$                              <em class="lineannotation"><span class="lineannotation">Type q to exit</span></em></pre><p>In the last line of the preceding shell session, we see that the shell
                        printed its prompt on the same line as the <span class="emphasis"><em>q</em></span> character
                        that caused the program to terminate.</p><p>The following shows an example run using cbreak mode:</p><a id="I_programlisting62_d1e165449"/><pre class="programlisting">$ <strong class="userinput"><code>./test_tty_functions x</code></strong>
<strong class="userinput"><code>XYZ</code></strong>                                 <em class="lineannotation"><span class="lineannotation">Type XYZ and Control-Z</span></em>
[1]+  Stopped       ./test_tty_functions x
$ <strong class="userinput"><code>stty</code></strong>                              <em class="lineannotation"><span class="lineannotation">Verify that terminal mode was restored</span></em>
speed 38400 baud; line = 0;
$ <strong class="userinput"><code>fg</code></strong>                                <em class="lineannotation"><span class="lineannotation">Resume in foreground</span></em>
./test_tty_functions x
***                                 <em class="lineannotation"><span class="lineannotation">Type 123 and Control-J</span></em>
   $                                <em class="lineannotation"><span class="lineannotation">Type Control-C to terminate program</span></em>
<em class="lineannotation"><span class="lineannotation">Press Enter to get next shell prompt</span></em>
$ <strong class="userinput"><code>stty</code></strong>                              <em class="lineannotation"><span class="lineannotation">Verify that terminal mode was restored</span></em>
speed 38400 baud; line = 0;</pre></div></div></div><div class="sect1" title="Terminal Line Speed (Bit Rate)"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="terminal_line_speed_open_parenthesis_bit">Terminal Line Speed (Bit Rate)</h2></div></div></div><p>Different terminals (and serial lines) are capable of transmitting and receiving
                at different speeds (bits per second). The <span class="emphasis"><em>cfgetispeed()</em></span> and
                    <span class="emphasis"><em>cfsetispeed()</em></span> functions retrieve and modify the input line
                speed. The <span class="emphasis"><em>cfgetospeed()</em></span> and <span class="emphasis"><em>cfsetospeed()</em></span>
                functions retrieve and modify the output line speed.<a id="IDX-CHP-62-8473" class="indexterm"/><a id="IDX-CHP-62-8474" class="indexterm"/><a id="IDX-CHP-62-8475" class="indexterm"/><a id="IDX-CHP-62-8476" class="indexterm"/><a id="IDX-CHP-62-8477" class="indexterm"/><a id="IDX-CHP-62-8478" class="indexterm"/><a id="IDX-CHP-62-8479" class="indexterm"/><a id="IDX-CHP-62-8480" class="indexterm"/><a id="IDX-CHP-62-8481" class="indexterm"/><a id="IDX-CHP-62-8472" class="indexterm"/><a id="IDX-CHP-62-8482" class="indexterm"/><a id="IDX-CHP-62-8483" class="indexterm"/><a id="IDX-CHP-62-8484" class="indexterm"/><a id="IDX-CHP-62-8485" class="indexterm"/><a id="IDX-CHP-62-8486" class="indexterm"/></p><div class="note" title="Note"><h3 class="title">Note</h3><p>The term <span class="emphasis"><em>baud</em></span> is commonly used as a synonym for the
                    terminal line speed (in bits per second), although this usage is not technically
                    correct. Precisely, baud is the per-second rate at which signal changes can
                    occur on the line, which is not necessarily the same as the number of bits
                    transmitted per second, since the latter depends on how bits are encoded into
                    signals. Nevertheless, the term <span class="emphasis"><em>baud</em></span> continues to be used
                    synonymously with <span class="emphasis"><em>bit rate</em></span> (bits per second). (The term
                        <span class="emphasis"><em>baud rate</em></span> is often also used synonymously with
                        <span class="emphasis"><em>baud</em></span>, but this is redundant; the baud is by definition
                    a rate.) To avoid confusion, we’ll generally use terms like <span class="emphasis"><em>line
                        speed</em></span> or <span class="emphasis"><em>bit rate</em></span>.</p></div><a id="I_programlisting62_d1e165606"/><pre class="programlisting">#include &lt;termios.h&gt;

speed_t <strong class="userinput"><code>cfgetispeed</code></strong>(const struct termios *<span class="emphasis"><em>termios_p</em></span>);
speed_t <strong class="userinput"><code>cfgetospeed</code></strong>(const struct termios *<span class="emphasis"><em>termios_p</em></span>);</pre><div class="note" title="Note"><h3 class="title">Note</h3><p>Both return a line speed from given <span class="emphasis"><em>termios</em></span>
                        structure<a id="IDX-CHP-62-8487" class="indexterm"/></p></div><a id="I_programlisting62_d1e165631"/><pre class="programlisting">int <strong class="userinput"><code>cfsetospeed</code></strong>(struct termios *<span class="emphasis"><em>termios_p</em></span>, speed_t <span class="emphasis"><em>speed</em></span>);
int <strong class="userinput"><code>cfsetispeed</code></strong>(struct termios *<span class="emphasis"><em>termios_p</em></span>, speed_t <span class="emphasis"><em>speed</em></span>);</pre><div class="note" title="Note"><h3 class="title">Note</h3><p>Both return 0 on success, or -1 on error</p></div><p>Each of these functions works on a <span class="emphasis"><em>termios</em></span> structure that
                must be previously initialized by a call to <span class="emphasis"><em>tcgetattr()</em></span>.</p><p>For example, to find out the current terminal output line speed, we would do the
                following:</p><a id="I_programlisting62_d1e165665"/><pre class="programlisting">struct termios tp;
speed_t rate;

if (tcgetattr(fd, &amp;tp) == -1)
    errExit("tcgetattr");
rate = cfgetospeed(&amp;tp);
if (rate == -1)
    errExit("cfgetospeed");</pre><p>If we then wanted to change this line speed, we would continue as follows:</p><a id="I_programlisting62_d1e165670"/><pre class="programlisting">if (cfsetospeed(&amp;tp, B38400) == -1)
    errExit("cfsetospeed");
if (tcsetattr(fd, TCSAFLUSH, &amp;tp) == -1)
    errExit("tcsetattr");</pre><p>The <span class="emphasis"><em>speed_t</em></span> data type is used to store a line speed. Rather
                than directly assigning numeric values for line speeds, a set of symbolic constants
                (defined in <code class="literal">&lt;termios.h&gt;</code>) is used.
                These constants define a series of discrete values. Some examples of such constants
                are <code class="literal">B300</code>, <code class="literal">B2400</code>, <code class="literal">B9600</code>, and <code class="literal">B38400</code>, corresponding, respectively, to the line
                speeds 300, 2400, 9600, and 38,400 bits per second. The use of a set of discrete
                values reflects the fact that terminals are normally designed to work with a limited
                set of different (standardized) line speeds, derived from the division of some base
                rate (e.g., 115,200 is typical on PCs) by integral values (e.g., 115,200 / 12 =
                    9600).<a id="IDX-CHP-62-8488" class="indexterm"/></p><p>SUSv3 specifies that the terminal line speeds are stored in the
                    <span class="emphasis"><em>termios</em></span> structure, but (deliberately) does not specify
                where. Many implementations, including Linux, maintain these values in the
                    <span class="emphasis"><em>c_cflag</em></span> field, using the <code class="literal">CBAUD</code> mask and the <code class="literal">CBAUDEX</code> flag.
                (In <a class="xref" href="ch62.html#retrieving_and_modifying_terminal_attrib" title="Retrieving and Modifying Terminal Attributes">Retrieving and Modifying Terminal Attributes</a>, we noted that the
                nonstandard <span class="emphasis"><em>c_ispeed</em></span> and <span class="emphasis"><em>c_ospeed</em></span> fields
                of the Linux <span class="emphasis"><em>termios</em></span> structure are unused.)</p><p>Although the <span class="emphasis"><em>cfsetispeed()</em></span> and
                    <span class="emphasis"><em>cfsetospeed()</em></span> functions allow separate input and output
                line speeds to be specified, on many terminals, these two speeds must be the same.
                Furthermore, Linux uses only a single field to store the line speed (i.e., the two
                rates are assumed to be always the same), which means that all of the input and
                output line-speed functions access the same <span class="emphasis"><em>termios</em></span>
                field.</p><div class="note" title="Note"><h3 class="title">Note</h3><p>Specifying <span class="emphasis"><em>speed</em></span> as 0 in a call to
                        <span class="emphasis"><em>cfsetispeed()</em></span> means “set the input speed to whatever
                    the output speed is when <span class="emphasis"><em>tcsetattr()</em></span> is later called.” This
                    is useful on systems where the two line speeds are maintained as separate
                    values.</p></div></div><div class="sect1" title="Terminal Line Control"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="terminal_line_control">Terminal Line Control</h2></div></div></div><p>The <span class="emphasis"><em>tcsendbreak()</em></span>, <span class="emphasis"><em>tcdrain()</em></span>,
                    <span class="emphasis"><em>tcflush()</em></span>, and <span class="emphasis"><em>tcflow()</em></span> functions
                perform tasks that are usually collectively grouped under the term <span class="emphasis"><em>line
                    control</em></span>. (These functions are POSIX inventions designed to replace
                various <span class="emphasis"><em>ioctl()</em></span> operations.)<a id="IDX-CHP-62-8489" class="indexterm"/><a id="IDX-CHP-62-8490" class="indexterm"/><a id="IDX-CHP-62-8491" class="indexterm"/><a id="IDX-CHP-62-8492" class="indexterm"/><a id="IDX-CHP-62-8493" class="indexterm"/><a id="IDX-CHP-62-8494" class="indexterm"/><a id="IDX-CHP-62-8495" class="indexterm"/><a id="IDX-CHP-62-8496" class="indexterm"/><a id="IDX-CHP-62-8497" class="indexterm"/><a id="IDX-CHP-62-8498" class="indexterm"/><a id="IDX-CHP-62-8499" class="indexterm"/></p><a id="I_programlisting62_d1e165835"/><pre class="programlisting">#include &lt;termios.h&gt;

int <strong class="userinput"><code>tcsendbreak</code></strong>(int <span class="emphasis"><em>fd</em></span>, int <span class="emphasis"><em>duration</em></span>);
int <strong class="userinput"><code>tcdrain</code></strong>(int <span class="emphasis"><em>fd</em></span>);
int <strong class="userinput"><code>tcflush</code></strong>(int <span class="emphasis"><em>fd</em></span>, int <span class="emphasis"><em>queue_selector</em></span>);
int <strong class="userinput"><code>tcflow</code></strong>(int <span class="emphasis"><em>fd</em></span>, int <span class="emphasis"><em>action</em></span>);</pre><div class="note" title="Note"><h3 class="title">Note</h3><p>All return 0 on success, or -1 on error</p></div><p>In each function, <span class="emphasis"><em>fd</em></span> is a file descriptor that refers to a
                terminal or other remote device on a serial line.</p><p>The <span class="emphasis"><em>tcsendbreak()</em></span> function generates a BREAK condition, by
                transmitting a continuous stream of 0 bits. The <span class="emphasis"><em>duration</em></span>
                argument specifies the length of the transmission. If <span class="emphasis"><em>duration</em></span>
                is 0, 0 bits are transmitted for 0.25 seconds. (SUSv3 specifies at least 0.25 and
                not more than 0.5 seconds.) If <span class="emphasis"><em>duration</em></span> is greater than 0, 0
                bits are transmitted for <span class="emphasis"><em>duration</em></span> milliseconds. SUSv3 leaves
                this case unspecified; the handling of a nonzero <span class="emphasis"><em>duration</em></span>
                varies widely on other UNIX implementations (the details described here are for
                    <span class="emphasis"><em>glibc</em></span>).<a id="IDX-CHP-62-8500" class="indexterm"/></p><p>The <span class="emphasis"><em>tcdrain()</em></span> function blocks until all output has been
                transmitted (i.e., until the terminal output queue has been emptied).</p><p>The <span class="emphasis"><em>tcflush()</em></span> function flushes (discards) the data in the
                terminal input queue, the terminal output queue, or both queues (see <a class="xref" href="ch62.html#input_and_output_queues_for_a_terminal_d" title="Figure 62-1. Input and output queues for a terminal device">Figure 62-1</a>). Flushing the input queue
                discards data that has been received by the terminal driver but not yet read by any
                process. For example, an application can use <span class="emphasis"><em>tcflush()</em></span> to
                discard terminal type-ahead before prompting for a password. Flushing the output
                queue discards data that has been written (passed to the terminal driver) but not
                yet transmitted to the device. The <span class="emphasis"><em>queue_selector</em></span> argument
                specifies one of the values shown in <a class="xref" href="ch62.html#values_for_the_tcflush_open_parenthesis" title="Table 62-4. Values for the tcflush() queue_selector argument">Table 62-4</a>.</p><div class="note" title="Note"><h3 class="title">Note</h3><p>Note that the term <span class="emphasis"><em>flush</em></span> is used in a different sense
                    with <span class="emphasis"><em>tcflush()</em></span> than when talking about file I/O. For file
                    I/O, <span class="emphasis"><em>flushing</em></span> means forcing the output to be transferred
                    either user-space memory to the buffer cache in the case of the <span class="emphasis"><em>stdio
                        fflush()</em></span>, or from the buffer cache to the disk, in the case of
                        <span class="emphasis"><em>fsync()</em></span>, <span class="emphasis"><em>fdatasync()</em></span>, and
                        <span class="emphasis"><em>sync()</em></span>.<a id="IDX-CHP-62-8501" class="indexterm"/><a id="IDX-CHP-62-8502" class="indexterm"/></p></div><div class="table"><a id="values_for_the_tcflush_open_parenthesis"/><div class="table-title">Table 62-4. Values for the <span class="emphasis"><em>tcflush() queue_selector</em></span> argument</div><div class="table-contents"><table style="border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col1"/><col class="col2"/></colgroup><thead><tr><td style="text-align: left; vertical-align: bottom; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Value</p>
                            </td><td style="text-align: left; vertical-align: bottom; border-bottom: 0.5pt solid ; ">
                                <p>Description</p>
                            </td></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">TCIFLUSH</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>Flush the input queue</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">TCOFLUSH</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>Flush the output queue</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">TCIOFLUSH</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; ">
                                <p>Flush both the input and the output queues</p>
                            </td></tr></tbody></table></div></div><p>The <span class="emphasis"><em>tcflow()</em></span> function controls the flow of data in either
                direction between the computer and the terminal (or other remote device). The
                    <span class="emphasis"><em>action</em></span> argument is one of the values shown in <a class="xref" href="ch62.html#values_for_the_tcflush_open_parenthe" title="Table 62-5. Values for the tcflush() action argument">Table 62-5</a>. The <code class="literal">TCIOFF</code> and <code class="literal">TCION</code> values are
                effective only if the terminal is capable of interpreting STOP and START characters,
                in which case these operations respectively cause the terminal to suspend and resume
                sending data to the computer, respectively.</p><div class="table"><a id="values_for_the_tcflush_open_parenthe"/><div class="table-title">Table 62-5. Values for the <span class="emphasis"><em>tcflush() action</em></span> argument</div><div class="table-contents"><table style="border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col1"/><col class="col2"/></colgroup><thead><tr><td style="text-align: left; vertical-align: bottom; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>Value</p>
                            </td><td style="text-align: left; vertical-align: bottom; border-bottom: 0.5pt solid ; ">
                                <p>Description</p>
                            </td></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">TCOOFF</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>Suspend output to the terminal</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">TCOON</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>Resume output to the terminal</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">TCIOFF</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; border-bottom: 0.5pt solid ; ">
                                <p>Transmit a STOP character to the terminal</p>
                            </td></tr><tr><td style="text-align: left; vertical-align: top; border-right: 0.5pt solid ; ">
                                <p>
                                    <code class="literal">TCION</code>
                                </p>
                            </td><td style="text-align: left; vertical-align: top; ">
                                <p>Transmit a START character to the terminal</p>
                            </td></tr></tbody></table></div></div></div><div class="sect1" title="Terminal Window Size"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="terminal_window_size">Terminal Window Size</h2></div></div></div><p>In a windowing environment, a screen-handling application needs to be able to
                monitor the size of a terminal window, so that the screen can be redrawn
                appropriately if the user modifies the window size. The kernel provides two pieces
                of support to allow this to happen:<a id="IDX-CHP-62-8503" class="indexterm"/><a id="IDX-CHP-62-8504" class="indexterm"/><a id="IDX-CHP-62-8505" class="indexterm"/><a id="IDX-CHP-62-8506" class="indexterm"/><a id="IDX-CHP-62-8507" class="indexterm"/><a id="IDX-CHP-62-8508" class="indexterm"/><a id="IDX-CHP-62-8509" class="indexterm"/><a id="IDX-CHP-62-8510" class="indexterm"/><a id="IDX-CHP-62-8511" class="indexterm"/><a id="IDX-CHP-62-8512" class="indexterm"/><a id="IDX-CHP-62-8513" class="indexterm"/><a id="IDX-CHP-62-8514" class="indexterm"/><a id="IDX-CHP-62-8515" class="indexterm"/><a id="IDX-CHP-62-8516" class="indexterm"/><a id="IDX-CHP-62-8517" class="indexterm"/><a id="IDX-CHP-62-8518" class="indexterm"/><a id="IDX-CHP-62-8519" class="indexterm"/><a id="IDX-CHP-62-8520" class="indexterm"/></p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>A <code class="literal">SIGWINCH</code> signal is sent to the
                        foreground process group after a change in the terminal window size. By
                        default, this signal is ignored.<a id="IDX-CHP-62-8521" class="indexterm"/></p></li><li class="listitem"><p>At any time—usually following the receipt of a <code class="literal">SIGWINCH</code> signal—a process can use the
                            <span class="emphasis"><em>ioctl()</em></span>
                        <code class="literal">TIOCGWINSZ</code> operation to find out the
                        current size of the terminal window.<a id="IDX-CHP-62-8522" class="indexterm"/></p></li></ul></div><p>The <span class="emphasis"><em>ioctl()</em></span>
                <code class="literal">TIOCGWINSZ</code> operation is used as follows:</p><a id="I_programlisting62_d1e166215"/><pre class="programlisting">if (ioctl(fd, TIOCGWINSZ, &amp;ws) == -1)
    errExit("ioctl");</pre><p>The <span class="emphasis"><em>fd</em></span> argument is a file descriptor referring to a terminal
                window. The final argument to <span class="emphasis"><em>ioctl()</em></span> is a pointer to a
                    <span class="emphasis"><em>winsize</em></span> structure (defined in <code class="literal">&lt;sys/ioctl.h&gt;</code>), used to return the terminal window
                    size:<a id="IDX-CHP-62-8523" class="indexterm"/></p><a id="I_programlisting62_d1e166236"/><pre class="programlisting">struct winsize {
    unsigned short ws_row;          /* Number of rows (characters) */
    unsigned short ws_col;          /* Number of columns (characters) */
    unsigned short ws_xpixel;       /* Horizontal size (pixels) */
    unsigned short ws_ypixel;       /* Vertical size (pixels) */
};</pre><p>Like many other implementations, Linux doesn’t use the pixel-size fields of the
                    <span class="emphasis"><em>winsize</em></span> structure.</p><p><a class="xref" href="ch62.html#monitoring_changes_in_the_terminal_windo" title="Example 62-5. Monitoring changes in the terminal window size">Example 62-5</a> demonstrates the use of
                the <code class="literal">SIGWINCH</code> signal and the
                    <span class="emphasis"><em>ioctl()</em></span>
                <code class="literal">TIOCGWINSZ</code> operation. The following shows an
                example of the output produced when this program is run under a window manager and
                the terminal window size is changed three times:</p><a id="I_programlisting62_d1e166255"/><pre class="programlisting">$ <strong class="userinput"><code>./demo_SIGWINCH</code></strong>
Caught SIGWINCH, new window size: 35 rows * 80 columns
Caught SIGWINCH, new window size: 35 rows * 73 columns
Caught SIGWINCH, new window size: 22 rows * 73 columns
<em class="lineannotation"><span class="lineannotation">Type Control-C to terminate program</span></em></pre><div class="example"><a id="monitoring_changes_in_the_terminal_windo"/><div class="example-title">Example 62-5. Monitoring changes in the terminal window size</div><div class="example-contents"><pre class="programlisting"><strong class="userinput"><code>tty/demo_SIGWINCH.c</code></strong>
#include &lt;signal.h&gt;
#include &lt;termios.h&gt;
#include &lt;sys/ioctl.h&gt;
#include "tlpi_hdr.h"

static void
sigwinchHandler(int sig)
{
}

int
main(int argc, char *argv[])
{
    struct winsize ws;
    struct sigaction sa;

    sigemptyset(&amp;sa.sa_mask);
    sa.sa_flags = 0;
    sa.sa_handler = sigwinchHandler;
    if (sigaction(SIGWINCH, &amp;sa, NULL) == -1)
        errExit("sigaction");

    for (;;) {
        pause();                        /* Wait for SIGWINCH signal */

        if (ioctl(STDIN_FILENO, TIOCGWINSZ, &amp;ws) == -1)
            errExit("ioctl");
        printf("Caught SIGWINCH, new window size: "
                "%d rows * %d columns\n", ws.ws_row, ws.ws_col);
    }
}
     <strong class="userinput"><code>tty/demo_SIGWINCH.c</code></strong></pre></div></div><p>It is also possible to change the terminal driver’s notion of the window size by
                passing an initialized <span class="emphasis"><em>winsize</em></span> structure in an
                    <span class="emphasis"><em>ioctl()</em></span>
                <code class="literal">TIOCSWINSZ</code> operation:</p><a id="I_programlisting62_d1e166283"/><pre class="programlisting">ws.ws_row = 40;
ws.ws_col = 100;
if (ioctl(fd, TIOCSWINSZ, &amp;ws) == -1)
    errExit("ioctl");</pre><p>If the new values in the <span class="emphasis"><em>winsize</em></span> structure differ from the
                terminal driver’s current notion of the terminal window size, two things
                happen:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>The terminal driver data structures are updated using the values supplied
                        in the <span class="emphasis"><em>ws</em></span> argument.</p></li><li class="listitem"><p>A <code class="literal">SIGWINCH</code> signal is sent to the
                        foreground process group of the terminal.<a id="IDX-CHP-62-8524" class="indexterm"/></p></li></ul></div><p>Note, however, that these events on their own are insufficient to change the
                actual dimensions of the displayed window, which are controlled by software outside
                the kernel (such as a window manager or a terminal emulator program).</p><p>Although not standardized in SUSv3, most UNIX implementations provide access to
                the terminal window size using the <span class="emphasis"><em>ioctl()</em></span> operations described
                in this section.</p></div><div class="sect1" title="Terminal Identification"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="terminal_identification">Terminal Identification</h2></div></div></div><p>In <a class="xref" href="ch34.html#controlling_terminals_and_controlling_pr" title="Controlling Terminals and Controlling Processes">Controlling Terminals and Controlling Processes</a>, we described the
                    <span class="emphasis"><em>ctermid()</em></span> function, which returns the name of the
                controlling terminal for a process (usually <code class="literal">/dev/tty</code> on UNIX systems). The functions described in this section
                are also useful for identifying a terminal.<a id="IDX-CHP-62-8525" class="indexterm"/><a id="IDX-CHP-62-8526" class="indexterm"/><a id="IDX-CHP-62-8527" class="indexterm"/><a id="IDX-CHP-62-8528" class="indexterm"/><a id="IDX-CHP-62-8529" class="indexterm"/><a id="IDX-CHP-62-8530" class="indexterm"/></p><p>The <span class="emphasis"><em>isatty()</em></span> function enables us to determine whether a file
                descriptor, <span class="emphasis"><em>fd</em></span>, is associated with a terminal (as opposed to
                some other file type).<a id="IDX-CHP-62-8531" class="indexterm"/></p><a id="I_programlisting62_d1e166375"/><pre class="programlisting">#include &lt;unistd.h&gt;

int <strong class="userinput"><code>isatty</code></strong>(int <span class="emphasis"><em>fd</em></span>);</pre><div class="note" title="Note"><h3 class="title">Note</h3><p>Returns true (1) if <span class="emphasis"><em>fd</em></span> is associated with a terminal,
                    otherwise false (0)</p></div><p>The <span class="emphasis"><em>isatty()</em></span> function is useful in editors and other
                screen-handling programs that need to determine whether their standard input and
                output are directed to a terminal.</p><p>Given a file descriptor, the <span class="emphasis"><em>ttyname()</em></span> function returns the
                name of the associated terminal device.<a id="IDX-CHP-62-8532" class="indexterm"/></p><a id="I_programlisting62_d1e166403"/><pre class="programlisting">#include &lt;unistd.h&gt;

char *<strong class="userinput"><code>ttyname</code></strong>(int <span class="emphasis"><em>fd</em></span>);</pre><div class="note" title="Note"><h3 class="title">Note</h3><p>Returns pointer to (statically allocated) string containing terminal name, or
                        <code class="literal">NULL</code> on error</p></div><p>To find the name of the terminal, <span class="emphasis"><em>ttyname()</em></span> uses the
                    <span class="emphasis"><em>opendir()</em></span> and <span class="emphasis"><em>readdir()</em></span> functions
                described in <a class="xref" href="ch18.html#reading_directories_colon_opendir_open_p" title="Reading Directories: opendir() and readdir()">Reading Directories: <span class="emphasis"><em>opendir()</em></span> and
                    <span class="emphasis"><em>readdir()</em></span></a> to walk
                through the directories holding terminal device names, looking at each directory
                entry until it finds one whose device ID (the <span class="emphasis"><em>st_rdev</em></span> field of
                the <span class="emphasis"><em>stat</em></span> structure) matches that of the device referred to by
                the file descriptor <span class="emphasis"><em>fd</em></span>. Terminal device entries normally reside
                in two directories: <code class="literal">/dev</code> and <code class="literal">/dev/pts</code>. The <code class="literal">/dev</code>
                directory contains entries for virtual consoles (e.g., <code class="literal">/dev/tty1</code>) and BSD pseudoterminals. The <code class="literal">/dev/pts</code> directory contains entries for (System V-style)
                pseudoterminal slave devices. (We describe pseudoterminals in <a class="xref" href="ch64.html" title="Chapter 64. Pseudoterminals">Chapter 64</a>.)<a id="IDX-CHP-62-8533" class="indexterm"/></p><div class="note" title="Note"><h3 class="title">Note</h3><p>A reentrant version of <span class="emphasis"><em>ttyname()</em></span> exists in the form of
                        <span class="emphasis"><em>ttyname_r()</em></span>.<a id="IDX-CHP-62-8534" class="indexterm"/></p><p>The <span class="emphasis"><em>tty(1)</em></span> command, which displays the name of the
                    terminal referred to by its standard input, is the command-line analog of
                        <span class="emphasis"><em>ttyname()</em></span>.</p></div></div><div class="sect1" title="Summary"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="summary-id61">Summary</h2></div></div></div><p>On early UNIX systems, terminals were real hardware devices connected to a
                computer via serial lines. Early terminals were not standardized, meaning that
                different escape sequences were required to program the terminals produced by
                different vendors. On modern workstations, such terminals have been superseded by
                bit-mapped monitors running the X Window System. However, the ability to program
                terminals is still required when dealing with virtual devices, such as virtual
                consoles and terminal emulators (which employ pseudoterminals), and real devices
                connected via serial lines.</p><p>Terminal settings (with the exception of the terminal window size) are maintained
                in a structure of type <span class="emphasis"><em>termios</em></span>, which contains four bit-mask
                fields that control various terminal settings and an array that defines the various
                special characters interpreted by the terminal driver. The
                    <span class="emphasis"><em>tcgetattr()</em></span> and <span class="emphasis"><em>tcsetattr()</em></span> functions
                allow a program to retrieve and modify the terminal settings.</p><p>When performing input, the terminal driver can operate in two different modes. In
                canonical mode, input is gathered into lines (terminated by one of the
                line-delimiter characters) and line editing is enabled. By contrast, noncanonical
                mode allows an application to read terminal input a character at a time, without
                needing to wait for the user to type a line-delimiter character. Line editing is
                disabled in noncanonical mode. Completion of a noncanonical mode read is controlled
                by the MIN and TIME fields of the <span class="emphasis"><em>termios</em></span> structure, which
                determine the minimum number of characters to be read and a timeout to be applied to
                the read operation. We described four distinct cases for the operation of
                noncanonical reads.</p><p>Historically, the Seventh Edition and BSD terminal drivers provided three input
                modes—cooked, cbreak, and raw—which performed varying degrees of processing of
                terminal input and output. Cbreak and raw modes can be emulated by changing various
                fields within the <span class="emphasis"><em>termios</em></span> structure.</p><p>A range of functions perform various other terminal operations. These include
                changing the terminal line speed and performing line-control operations (generating
                a break condition, pausing until output has been transmitted, flushing terminal
                input and output queues, and suspending or resuming transmission of data in either
                direction between the terminal and the computer). Other functions allow us to check
                if a given file descriptor refers to a terminal and to obtain the name of that
                terminal. The <span class="emphasis"><em>ioctl()</em></span> system call can be used to retrieve and
                modify the terminal window size recorded by the kernel, and to perform a range of
                other terminal-related operations.</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title" id="further_information-id86"/></div></div></div><div class="sect3" title="Further information"><div class="titlepage"><div><div><h4 class="title" id="further_information-id87">Further information</h4></div></div></div><p>[Stevens, 1992] also describes terminal programming and goes into much
                        more detail on programming serial ports. Several good online resources
                        discuss terminal programming. Hosted at the LDP web site (<a class="ulink" href="http://www.tldp.org" target="_top">http://www.tldp.org</a>) are the <span class="emphasis"><em>Serial HOWTO</em></span>
                        and the <span class="emphasis"><em>Text-terminal HOWTO</em></span>, both by David S. Lawyer.
                        Another useful source of information is the <span class="emphasis"><em>Serial Programming
                            Guide for POSIX Operating Systems</em></span> by Michael R. Sweet,
                        available online at <a class="ulink" href="http://www.easysw.com/~mike/serial/" target="_top">http://www.easysw.com/~mike/serial/</a>.<a id="IDX-CHP-62-8535" class="indexterm"/><a id="IDX-CHP-62-8536" class="indexterm"/><a id="IDX-CHP-62-8537" class="indexterm"/></p></div></div></div><div class="sect1" title="Exercises"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="exercises-id43">Exercises</h2></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Implement <span class="emphasis"><em>isatty()</em></span>. (You may find it useful to read
                        the description of <span class="emphasis"><em>tcgetattr()</em></span> in Section 62.2.)</p></li><li class="listitem"><p>Implement <span class="emphasis"><em>ttyname()</em></span>.</p></li><li class="listitem"><p>Implement the <span class="emphasis"><em>getpass()</em></span> function described in Section
                        8.5. (The <span class="emphasis"><em>getpass()</em></span> function can obtain a file
                        descriptor for the controlling terminal by opening <code class="literal">/dev/tty</code>.)</p></li><li class="listitem"><p>Write a program that displays information indicating whether the terminal
                        referred to by standard input is in canonical or noncanonical mode. If in
                        noncanonical mode, then display the values of TIME and MIN.</p></li></ol></div></div></section></body></html>
