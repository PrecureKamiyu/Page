<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>16.4 Support for Sharing</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part154.htm">&lt; 上一个</a><span> | </span><a href="../ostep.html">内容</a><span> | </span><a href="part156.htm">下一个 &gt;</a></p><p class="s40" style="padding-top: 6pt;padding-left: 38pt;text-indent: 0pt;text-align: left;">16.4 Support for Sharing</p><p style="padding-top: 7pt;padding-left: 68pt;text-indent: 12pt;line-height: 89%;text-align: justify;">As support for segmentation grew, system designers soon realized that they could realize new types of efficiencies with a little more hardware support. Specifically, to save memory, sometimes it is useful to <b>share </b>certain memory segments between address spaces. In particular, <b>code sharing </b>is common and still in use in systems today.</p><p style="padding-left: 68pt;text-indent: 12pt;line-height: 89%;text-align: justify;">To support sharing, we need a little extra support from the hardware, in the form of <b>protection bits</b>. Basic support adds a few bits per segment, indicating whether or not a program can read or write a segment, or per- haps execute code that lies within the segment. By setting a code segment to read-only, the same code can be shared across multiple processes, with- out worry of harming isolation; while each process still thinks that it is ac- cessing its own private memory, the OS is secretly sharing memory which cannot be modified by the process, and thus the illusion is preserved.</p><p style="padding-left: 68pt;text-indent: 12pt;line-height: 89%;text-align: justify;">An example of the additional information tracked by the hardware (and OS) is shown in Figure <span style=" color: #00AEEF;">16.3</span>. As you can see, the code segment is set to read and execute, and thus the same physical segment in memory could be mapped into multiple virtual address spaces.</p><p style="padding-left: 68pt;text-indent: 12pt;line-height: 89%;text-align: justify;">With protection bits, the hardware algorithm described earlier would also have to change. In addition to checking whether a virtual address is within bounds, the hardware also has to check whether a particular ac- cess is permissible. If a user process tries to write to a read-only page, or execute from a non-executable page, the hardware should raise an excep- tion, and thus let the OS deal with the offending process.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:61.5875pt" cellspacing="0"><tr style="height:10pt"><td style="width:46pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F"><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 8pt;text-align: left;">Segment</p></td><td style="width:30pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F"><p class="s20" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 8pt;text-align: center;">Base</p></td><td style="width:28pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F"><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: left;">Size</p></td><td style="width:77pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F"><p class="s20" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 8pt;text-align: center;">Grows Positive?</p></td><td style="width:66pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F"><p class="s20" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 8pt;text-align: center;">Protection</p></td></tr><tr style="height:10pt"><td style="width:46pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F"><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">Code</p></td><td style="width:30pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F"><p class="s20" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">32K</p></td><td style="width:28pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F"><p class="s20" style="padding-left: 8pt;text-indent: 0pt;line-height: 9pt;text-align: left;">2K</p></td><td style="width:77pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F"><p class="s20" style="text-indent: 0pt;line-height: 9pt;text-align: center;">1</p></td><td style="width:66pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F"><p class="s20" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Read-Execute</p></td></tr><tr style="height:10pt"><td style="width:46pt"><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">Heap</p></td><td style="width:30pt"><p class="s20" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">34K</p></td><td style="width:28pt"><p class="s20" style="padding-left: 8pt;text-indent: 0pt;line-height: 9pt;text-align: left;">2K</p></td><td style="width:77pt"><p class="s20" style="text-indent: 0pt;line-height: 9pt;text-align: center;">1</p></td><td style="width:66pt"><p class="s20" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Read-Write</p></td></tr><tr style="height:10pt"><td style="width:46pt"><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">Stack</p></td><td style="width:30pt"><p class="s20" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">28K</p></td><td style="width:28pt"><p class="s20" style="padding-left: 8pt;text-indent: 0pt;line-height: 9pt;text-align: left;">2K</p></td><td style="width:77pt"><p class="s20" style="text-indent: 0pt;line-height: 9pt;text-align: center;">0</p></td><td style="width:66pt"><p class="s20" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Read-Write</p></td></tr></table><p style="padding-top: 4pt;padding-left: 76pt;text-indent: 0pt;text-align: left;">Table 16.3: <b>Segment Register Values (with Protection)</b></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part154.htm">&lt; 上一个</a><span> | </span><a href="../ostep.html">内容</a><span> | </span><a href="part156.htm">下一个 &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
