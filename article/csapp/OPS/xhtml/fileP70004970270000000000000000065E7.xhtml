<?xml version='1.0' encoding='utf-8'?>
<html xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:svg="http://www.w3.org/2000/svg" xmlns:epub="http://www.idpf.org/2007/ops" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" epub:prefix="index: http://www.index.com/">
  <head>
    <meta name="dcterms.conformsTo" content="PXE Basic 1.0"/>
    <meta name="generator" content="PXE Tools version 1.39.52"/>
    <!--Created by pxe.pl for standard version PXE Basic 1.0,data-profile-product=standard by PXE Tools 1.39.52, partial=false-->
    <title>Solutions to Practice Problems </title>
    <link rel="alternate stylesheet" type="text/css" title="night" href="../css/theme/night.css"/>
    <link rel="alternate stylesheet" type="text/css" title="sepia" href="../css/theme/sepia.css"/>
    <script src="js/format_lg_obj.js"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="../../stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="../../page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body epub:type="bodymatter" class="calibre pcalibre pcalibre1">
<section id="P70004970270000000000000000065E7" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title pcalibre1" id="P7000497027000000000000000044DE1" data-uri="chapter07.xhtml#P7000497027000000000000000044DE1" epub:type="title"><span class="pcalibre label pcalibre1">Solutions to Practice Problems </span></h1></header>
<section id="P70004970270000000000000000065E9" data-uri="chapter07.xhtml#P70004970270000000000000000065E9" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P7000497027000000000000000044DE2" data-uri="chapter07.xhtml#P7000497027000000000000000044DE2" epub:type="title"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP700049702700000000000000000608B.xhtml#P7000497027000000000000000006120"><span class="pcalibre label pcalibre1">Solution to Problem </span><span class="pcalibre label pcalibre1">7.1 </span></a>(page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP700049702700000000000000000608B.xhtml#P70004970270000000000000000060D0">678</a>)</h1></header>
<p id="P7000497027000000000000000044DE3" data-uri="chapter07.xhtml#P7000497027000000000000000044DE3" class="pcalibre1 pcalibre calibre2">The purpose of this problem is to help you understand the relationship between linker symbols and C variables and functions. Notice that the C local variable <code id="P7000497027000000000000000044DE4" data-uri="chapter07.xhtml#P7000497027000000000000000044DE4" class="pcalibre1 calibre8 pcalibre">temp</code> does <i class="calibre5 pcalibre pcalibre1">not</i> have a symbol table entry.</p>

<table id="P7000497027000000000000000044DE5" data-uri="chapter07.xhtml#P7000497027000000000000000044DE5" class="pcalibre largetable pcalibre1">
<thead class="pcalibre1 pcalibre calibre16">
<tr class="pcalibre calibre17 pcalibre1">
<th id="P7000497027000000000000000044DE6" data-uri="chapter07.xhtml#P7000497027000000000000000044DE6" class="calibre18 pcalibre pcalibre1"><span class="pcalibre pagebreak pcalibre1" id="P70004970270000000000000000065EF" title="718" data-uri="chapter07.xhtml#P70004970270000000000000000065EF" epub:type="pagebreak"></span>Symbol</th>
<th id="P7000497027000000000000000044DE7" data-uri="chapter07.xhtml#P7000497027000000000000000044DE7" class="calibre18 pcalibre pcalibre1"><code id="P7000497027000000000000000044DE8" data-uri="chapter07.xhtml#P7000497027000000000000000044DE8" class="calibre10 pcalibre pcalibre1">.symtab</code> entry?</th>
<th id="P7000497027000000000000000044DE9" data-uri="chapter07.xhtml#P7000497027000000000000000044DE9" class="calibre18 pcalibre pcalibre1">Symbol type</th>
<th id="P7000497027000000000000000044DEA" data-uri="chapter07.xhtml#P7000497027000000000000000044DEA" class="calibre18 pcalibre pcalibre1">Module where defined</th>
<th id="P7000497027000000000000000044DEB" data-uri="chapter07.xhtml#P7000497027000000000000000044DEB" class="calibre18 pcalibre pcalibre1">Section</th>
</tr>
</thead>
<tbody class="calibre19 pcalibre pcalibre1">
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000044DEC" data-uri="chapter07.xhtml#P7000497027000000000000000044DEC" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000044DED" data-uri="chapter07.xhtml#P7000497027000000000000000044DED" class="calibre10 pcalibre pcalibre1">buf</code></td>
<td id="P7000497027000000000000000044DEE" data-uri="chapter07.xhtml#P7000497027000000000000000044DEE" class="calibre20 pcalibre pcalibre1">Yes</td>
<td id="P7000497027000000000000000044DEF" data-uri="chapter07.xhtml#P7000497027000000000000000044DEF" class="calibre20 pcalibre pcalibre1">extern</td>
<td id="P7000497027000000000000000044DF0" data-uri="chapter07.xhtml#P7000497027000000000000000044DF0" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000044DF1" data-uri="chapter07.xhtml#P7000497027000000000000000044DF1" class="calibre10 pcalibre pcalibre1">m.o</code></td>
<td id="P7000497027000000000000000044DF2" data-uri="chapter07.xhtml#P7000497027000000000000000044DF2" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000044DF3" data-uri="chapter07.xhtml#P7000497027000000000000000044DF3" class="calibre10 pcalibre pcalibre1">.data</code></td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000044DF4" data-uri="chapter07.xhtml#P7000497027000000000000000044DF4" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000044DF5" data-uri="chapter07.xhtml#P7000497027000000000000000044DF5" class="calibre10 pcalibre pcalibre1">bufp0</code></td>
<td id="P7000497027000000000000000044DF6" data-uri="chapter07.xhtml#P7000497027000000000000000044DF6" class="calibre20 pcalibre pcalibre1">Yes</td>
<td id="P7000497027000000000000000044DF7" data-uri="chapter07.xhtml#P7000497027000000000000000044DF7" class="calibre20 pcalibre pcalibre1">global</td>
<td id="P7000497027000000000000000044DF8" data-uri="chapter07.xhtml#P7000497027000000000000000044DF8" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000044DF9" data-uri="chapter07.xhtml#P7000497027000000000000000044DF9" class="calibre10 pcalibre pcalibre1">swap.o</code></td>
<td id="P7000497027000000000000000044DFA" data-uri="chapter07.xhtml#P7000497027000000000000000044DFA" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000044DFB" data-uri="chapter07.xhtml#P7000497027000000000000000044DFB" class="calibre10 pcalibre pcalibre1">.data</code></td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000044DFC" data-uri="chapter07.xhtml#P7000497027000000000000000044DFC" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000044DFD" data-uri="chapter07.xhtml#P7000497027000000000000000044DFD" class="calibre10 pcalibre pcalibre1">bufp1</code></td>
<td id="P7000497027000000000000000044DFE" data-uri="chapter07.xhtml#P7000497027000000000000000044DFE" class="calibre20 pcalibre pcalibre1">Yes</td>
<td id="P7000497027000000000000000044DFF" data-uri="chapter07.xhtml#P7000497027000000000000000044DFF" class="calibre20 pcalibre pcalibre1">global</td>
<td id="P7000497027000000000000000044E00" data-uri="chapter07.xhtml#P7000497027000000000000000044E00" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000044E01" data-uri="chapter07.xhtml#P7000497027000000000000000044E01" class="calibre10 pcalibre pcalibre1">swap.o</code></td>
<td id="P7000497027000000000000000044E02" data-uri="chapter07.xhtml#P7000497027000000000000000044E02" class="calibre20 pcalibre pcalibre1">COMMON</td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000044E03" data-uri="chapter07.xhtml#P7000497027000000000000000044E03" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000044E04" data-uri="chapter07.xhtml#P7000497027000000000000000044E04" class="calibre10 pcalibre pcalibre1">swap</code></td>
<td id="P7000497027000000000000000044E05" data-uri="chapter07.xhtml#P7000497027000000000000000044E05" class="calibre20 pcalibre pcalibre1">Yes</td>
<td id="P7000497027000000000000000044E06" data-uri="chapter07.xhtml#P7000497027000000000000000044E06" class="calibre20 pcalibre pcalibre1">global</td>
<td id="P7000497027000000000000000044E07" data-uri="chapter07.xhtml#P7000497027000000000000000044E07" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000044E08" data-uri="chapter07.xhtml#P7000497027000000000000000044E08" class="calibre10 pcalibre pcalibre1">swap.o</code></td>
<td id="P7000497027000000000000000044E09" data-uri="chapter07.xhtml#P7000497027000000000000000044E09" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000044E0A" data-uri="chapter07.xhtml#P7000497027000000000000000044E0A" class="calibre10 pcalibre pcalibre1">.text</code></td>
</tr>
<tr class="pcalibre calibre17 pcalibre1">
<td id="P7000497027000000000000000044E0B" data-uri="chapter07.xhtml#P7000497027000000000000000044E0B" class="calibre20 pcalibre pcalibre1"><code id="P7000497027000000000000000044E0C" data-uri="chapter07.xhtml#P7000497027000000000000000044E0C" class="calibre10 pcalibre pcalibre1">temp</code></td>
<td id="P7000497027000000000000000044E0D" data-uri="chapter07.xhtml#P7000497027000000000000000044E0D" class="calibre20 pcalibre pcalibre1">No</td>
<td id="P7000497027000000000000000044E0E" data-uri="chapter07.xhtml#P7000497027000000000000000044E0E" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000044E0F" data-uri="chapter07.xhtml#P7000497027000000000000000044E0F" class="calibre20 pcalibre pcalibre1">—</td>
<td id="P7000497027000000000000000044E10" data-uri="chapter07.xhtml#P7000497027000000000000000044E10" class="calibre20 pcalibre pcalibre1">—</td>
</tr>
</tbody>
</table>
</section>
<section id="P700049702700000000000000000661A" data-uri="chapter07.xhtml#P700049702700000000000000000661A" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P7000497027000000000000000044E11" data-uri="chapter07.xhtml#P7000497027000000000000000044E11" epub:type="title"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP7000497027000000000000000006160.xhtml#P70004970270000000000000000061C5"><span class="pcalibre label pcalibre1">Solution to Problem </span><span class="pcalibre label pcalibre1">7.2 </span></a>(page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP7000497027000000000000000006160.xhtml#P70004970270000000000000000061C7">684</a>)</h1></header>
<p id="P7000497027000000000000000044E12" data-uri="chapter07.xhtml#P7000497027000000000000000044E12" class="pcalibre1 pcalibre calibre2">This is a simple drill that checks your understanding of the rules that a Unix linker uses when it resolves global symbols that are defined in more than one module. Understanding these rules can help you avoid some nasty programming bugs.</p>
<ol class="pcalibre ol_upper-alpha pcalibre1" id="P7000497027000000000000000044E13" data-uri="chapter07.xhtml#P7000497027000000000000000044E13">
<li class="calibre12 pcalibre pcalibre1" id="P7000497027000000000000000044E14" data-uri="chapter07.xhtml#P7000497027000000000000000044E14"><p id="P7000497027000000000000000044E15" data-uri="chapter07.xhtml#P7000497027000000000000000044E15" class="pcalibre calibre3 pcalibre1">The linker chooses the strong symbol defined in module 1 over the weak symbol defined in module 2 (rule 2):</p>
<ol class="pcalibre1 ol_lower-alpha pcalibre" id="P7000497027000000000000000044E16" data-uri="chapter07.xhtml#P7000497027000000000000000044E16">
<li id="P7000497027000000000000000044E17" data-uri="chapter07.xhtml#P7000497027000000000000000044E17" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000044E18" data-uri="chapter07.xhtml#P7000497027000000000000000044E18" class="pcalibre calibre3 pcalibre1"><code id="P7000497027000000000000000044E19" data-uri="chapter07.xhtml#P7000497027000000000000000044E19" class="pcalibre1 calibre8 pcalibre">REF(main.1) → DEF(main.1)</code></p></li>
<li id="P7000497027000000000000000044E1A" data-uri="chapter07.xhtml#P7000497027000000000000000044E1A" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000044E1B" data-uri="chapter07.xhtml#P7000497027000000000000000044E1B" class="pcalibre calibre3 pcalibre1"><code id="P7000497027000000000000000044E1C" data-uri="chapter07.xhtml#P7000497027000000000000000044E1C" class="pcalibre1 calibre8 pcalibre">REF(main.2) → DEF(main.1)</code></p></li>
</ol></li>
<li class="calibre12 pcalibre pcalibre1" id="P7000497027000000000000000044E1D" data-uri="chapter07.xhtml#P7000497027000000000000000044E1D"><p id="P7000497027000000000000000044E1E" data-uri="chapter07.xhtml#P7000497027000000000000000044E1E" class="pcalibre calibre3 pcalibre1">This is an <code id="P7000497027000000000000000044E1F" data-uri="chapter07.xhtml#P7000497027000000000000000044E1F" class="pcalibre1 calibre8 pcalibre"><span class="smallcaps pcalibre pcalibre1">error</span></code>, because each module defines a strong symbol <code id="P7000497027000000000000000044E20" data-uri="chapter07.xhtml#P7000497027000000000000000044E20" class="pcalibre1 calibre8 pcalibre">main</code> (rule 1).</p></li>
<li class="calibre12 pcalibre pcalibre1" id="P7000497027000000000000000044E21" data-uri="chapter07.xhtml#P7000497027000000000000000044E21"><p id="P7000497027000000000000000044E22" data-uri="chapter07.xhtml#P7000497027000000000000000044E22" class="pcalibre calibre3 pcalibre1">The linker chooses the strong symbol defined in module 2 over the weak symbol defined in module 1 (rule 2):</p>
<ol class="pcalibre1 ol_lower-alpha pcalibre" id="P7000497027000000000000000044E23" data-uri="chapter07.xhtml#P7000497027000000000000000044E23">
<li id="P7000497027000000000000000044E24" data-uri="chapter07.xhtml#P7000497027000000000000000044E24" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000044E25" data-uri="chapter07.xhtml#P7000497027000000000000000044E25" class="pcalibre calibre3 pcalibre1"><code id="P7000497027000000000000000044E26" data-uri="chapter07.xhtml#P7000497027000000000000000044E26" class="pcalibre1 calibre8 pcalibre">REF(x.1) → DEF(x.2)</code></p></li>
<li id="P7000497027000000000000000044E27" data-uri="chapter07.xhtml#P7000497027000000000000000044E27" class="calibre12 pcalibre pcalibre1"><p id="P7000497027000000000000000044E28" data-uri="chapter07.xhtml#P7000497027000000000000000044E28" class="pcalibre calibre3 pcalibre1"><code id="P7000497027000000000000000044E29" data-uri="chapter07.xhtml#P7000497027000000000000000044E29" class="pcalibre1 calibre8 pcalibre">REF(x.2) → DEF(x.2)</code></p></li>
</ol></li>
</ol>
</section>
<section id="P7000497027000000000000000006634" data-uri="chapter07.xhtml#P7000497027000000000000000006634" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P7000497027000000000000000044E2A" data-uri="chapter07.xhtml#P7000497027000000000000000044E2A" epub:type="title"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP7000497027000000000000000006160.xhtml#P7000497027000000000000000006268"><span class="pcalibre label pcalibre1">Solution to Problem </span><span class="pcalibre label pcalibre1">7.3 </span></a>(page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP7000497027000000000000000006160.xhtml#P7000497027000000000000000006253">689</a>)</h1></header>
<p id="P7000497027000000000000000044E2B" data-uri="chapter07.xhtml#P7000497027000000000000000044E2B" class="pcalibre1 pcalibre calibre2">Placing static libraries in the wrong order on the command line is a common source of linker errors that confuses many programmers. However, once you understand how linkers use static libraries to resolve references, it's pretty straightforward. This little drill checks your understanding of this idea:</p>
<ol class="pcalibre ol_upper-alpha pcalibre1" id="P7000497027000000000000000044E2C" data-uri="chapter07.xhtml#P7000497027000000000000000044E2C">
<li class="calibre12 pcalibre pcalibre1" id="P7000497027000000000000000044E2D" data-uri="chapter07.xhtml#P7000497027000000000000000044E2D"><p id="P7000497027000000000000000044E2E" data-uri="chapter07.xhtml#P7000497027000000000000000044E2E" class="pcalibre calibre3 pcalibre1"><code id="P7000497027000000000000000044E2F" data-uri="chapter07.xhtml#P7000497027000000000000000044E2F" class="pcalibre1 calibre8 pcalibre">linux&gt; gcc p.o libx.a</code></p></li>
<li class="calibre12 pcalibre pcalibre1" id="P7000497027000000000000000044E30" data-uri="chapter07.xhtml#P7000497027000000000000000044E30"><p id="P7000497027000000000000000044E31" data-uri="chapter07.xhtml#P7000497027000000000000000044E31" class="pcalibre calibre3 pcalibre1"><code id="P7000497027000000000000000044E32" data-uri="chapter07.xhtml#P7000497027000000000000000044E32" class="pcalibre1 calibre8 pcalibre">linux&gt; gcc p.o libx.a liby.a</code></p></li>
<li class="calibre12 pcalibre pcalibre1" id="P7000497027000000000000000044E33" data-uri="chapter07.xhtml#P7000497027000000000000000044E33"><p id="P7000497027000000000000000044E34" data-uri="chapter07.xhtml#P7000497027000000000000000044E34" class="pcalibre calibre3 pcalibre1"><code id="P7000497027000000000000000044E35" data-uri="chapter07.xhtml#P7000497027000000000000000044E35" class="pcalibre1 calibre8 pcalibre">linux&gt; gcc p.o libx.a liby.a libx.a</code></p></li>
</ol>
</section>
<section id="P7000497027000000000000000006641" data-uri="chapter07.xhtml#P7000497027000000000000000006641" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P7000497027000000000000000044E36" data-uri="chapter07.xhtml#P7000497027000000000000000044E36" epub:type="title"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP700049702700000000000000000627E.xhtml#P7000497027000000000000000006326"><span class="pcalibre label pcalibre1">Solution to Problem </span><span class="pcalibre label pcalibre1">7.4 </span></a>(page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP700049702700000000000000000627E.xhtml#P700049702700000000000000000630C">694</a>)</h1></header>
<p id="P7000497027000000000000000044E37" data-uri="chapter07.xhtml#P7000497027000000000000000044E37" class="pcalibre1 pcalibre calibre2">This problem concerns the disassembly listing in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP700049702700000000000000000627E.xhtml#P700049702700000000000000000630B"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">7.12(a)</span></a>. Our purpose here is to give you some practice reading disassembly listings and to check your understanding of PC-relative addressing.</p>
<ol class="pcalibre ol_upper-alpha pcalibre1" id="P7000497027000000000000000044E38" data-uri="chapter07.xhtml#P7000497027000000000000000044E38">
<li class="calibre12 pcalibre pcalibre1" id="P7000497027000000000000000044E39" data-uri="chapter07.xhtml#P7000497027000000000000000044E39"><p id="P7000497027000000000000000044E3A" data-uri="chapter07.xhtml#P7000497027000000000000000044E3A" class="pcalibre calibre3 pcalibre1">The hex address of the relocated reference in line 5 is <code id="P7000497027000000000000000044E3B" data-uri="chapter07.xhtml#P7000497027000000000000000044E3B" class="pcalibre1 calibre8 pcalibre">0x4004df</code>.</p></li>
<li class="calibre12 pcalibre pcalibre1" id="P7000497027000000000000000044E3C" data-uri="chapter07.xhtml#P7000497027000000000000000044E3C"><p id="P7000497027000000000000000044E3D" data-uri="chapter07.xhtml#P7000497027000000000000000044E3D" class="pcalibre calibre3 pcalibre1">The hex value of the relocated reference in line 5 is <code id="P7000497027000000000000000044E3E" data-uri="chapter07.xhtml#P7000497027000000000000000044E3E" class="pcalibre1 calibre8 pcalibre">0x5</code>. Remember that the disassembly listing shows the value of the reference in little-endian byte order.</p></li>
</ol>
</section>
<section id="P700049702700000000000000000664B" data-uri="chapter07.xhtml#P700049702700000000000000000664B" class="pcalibre halftitlepage pcalibre1"><header class="calibre1 pcalibre pcalibre1"><h1 class="pcalibre title1 pcalibre1" id="P7000497027000000000000000044E3F" data-uri="chapter07.xhtml#P7000497027000000000000000044E3F" epub:type="title"><a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP700049702700000000000000000627E.xhtml#P7000497027000000000000000006334"><span class="pcalibre label pcalibre1">Solution to Problem </span><span class="pcalibre label pcalibre1">7.5 </span></a>(page <a class="ulink pcalibre pcalibre4 pcalibre2 pcalibre3 pcalibre1" epub:type="pagebreak" href="fileP700049702700000000000000000627E.xhtml#P700049702700000000000000000632F">695</a>)</h1></header> 
<p id="P7000497027000000000000000044E40" data-uri="chapter07.xhtml#P7000497027000000000000000044E40" class="pcalibre1 pcalibre calibre2">This problem tests your understanding of how the linker relocates PC-relative references. You were given that</p>
<p id="P7000497027000000000000000044E41" data-uri="chapter07.xhtml#P7000497027000000000000000044E41" class="pcalibre1 pcalibre calibre2"><span class="pcalibre pagebreak pcalibre1" id="P700049702700000000000000000664F" title="719" data-uri="chapter07.xhtml#P700049702700000000000000000664F" epub:type="pagebreak"></span></p>
<pre id="P7000497027000000000000000044E42" data-uri="chapter07.xhtml#P7000497027000000000000000044E42" class="calibre9 pcalibre pcalibre1"><code id="P7000497027000000000000000044E43" data-uri="chapter07.xhtml#P7000497027000000000000000044E43" class="calibre10 pcalibre pcalibre1">ADDR(s) = ADDR(.text) = 0x4004d0</code></pre>
<p class="pcalibre1 pcalibre calibre2" id="P7000497027000000000000000044E44" data-uri="chapter07.xhtml#P7000497027000000000000000044E44">and</p>
<pre id="P7000497027000000000000000044E45" data-uri="chapter07.xhtml#P7000497027000000000000000044E45" class="calibre9 pcalibre pcalibre1"><code id="P7000497027000000000000000044E46" data-uri="chapter07.xhtml#P7000497027000000000000000044E46" class="calibre10 pcalibre pcalibre1">ADDR(r.symbol) = ADDR(swap) = 0x4004e8</code></pre>
<p id="P7000497027000000000000000044E47" data-uri="chapter07.xhtml#P7000497027000000000000000044E47" class="pcalibre1 pcalibre calibre2">Using the algorithm in <a class="pcalibre xref1 pcalibre4 pcalibre2 pcalibre3 pcalibre1" href="fileP700049702700000000000000000627E.xhtml#P70004970270000000000000000062B6"><span class="pcalibre label pcalibre1">Figure </span><span class="pcalibre label pcalibre1">7.10</span></a>, the linker first computes the run-time address of the reference:</p>
<pre id="P7000497027000000000000000044E48" data-uri="chapter07.xhtml#P7000497027000000000000000044E48" class="calibre9 pcalibre pcalibre1"><code id="P7000497027000000000000000044E49" data-uri="chapter07.xhtml#P7000497027000000000000000044E49" class="calibre10 pcalibre pcalibre1">refaddr = ADDR(s) + r.offset
= 0x4004d0 + 0xa
= 0x4004da</code></pre>
<p class="pcalibre1 pcalibre calibre2" id="P7000497027000000000000000044E4A" data-uri="chapter07.xhtml#P7000497027000000000000000044E4A">It then updates the reference:</p>
<pre id="P7000497027000000000000000044E4B" data-uri="chapter07.xhtml#P7000497027000000000000000044E4B" class="calibre9 pcalibre pcalibre1"><code id="P7000497027000000000000000044E4C" data-uri="chapter07.xhtml#P7000497027000000000000000044E4C" class="calibre10 pcalibre pcalibre1">*refptr = (unsigned) (ADDR(r.symbol) + r.addend - refaddr)
= (unsigned) (0x4004e8 + (-4) - 0x4004da)
= (unsigned) (0xa)</code></pre>
<p class="pcalibre1 pcalibre calibre2" id="P7000497027000000000000000044E4D" data-uri="chapter07.xhtml#P7000497027000000000000000044E4D">Thus, in the resulting executable object file, the PC-relative reference to <code id="P7000497027000000000000000044E4E" data-uri="chapter07.xhtml#P7000497027000000000000000044E4E" class="pcalibre1 calibre8 pcalibre">swap</code> has a value of <code id="P7000497027000000000000000044E4F" data-uri="chapter07.xhtml#P7000497027000000000000000044E4F" class="pcalibre1 calibre8 pcalibre">0xa</code>:</p>
<pre id="P7000497027000000000000000044E50" data-uri="chapter07.xhtml#P7000497027000000000000000044E50" class="calibre9 pcalibre pcalibre1"><code id="P7000497027000000000000000044E51" data-uri="chapter07.xhtml#P7000497027000000000000000044E51" class="calibre10 pcalibre pcalibre1">4004d9: e8 0a 00 00 00 callq 4004e8 &lt;swap&gt;</code></pre>
<p id="P7000497027000000000000000044E52" data-uri="chapter07.xhtml#P7000497027000000000000000044E52" class="pcalibre1 pcalibre calibre2"><span class="pcalibre pagebreak pcalibre1" id="P7000497027000000000000000006661" title="720" data-uri="chapter07.xhtml#P7000497027000000000000000006661" epub:type="pagebreak"></span></p>
</section>
</section></body></html>
