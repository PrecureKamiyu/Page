<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>39.1 Files and Directories</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part416.htm">&lt; 上一个</a><span> | </span><a href="../ostep.html">内容</a><span> | </span><a href="part418.htm">下一个 &gt;</a></p><p class="s40" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">39.1 Files and Directories</p><p style="padding-top: 7pt;padding-left: 41pt;text-indent: 11pt;line-height: 89%;text-align: justify;">Two key abstractions have developed over time in the virtualization of storage. The first is the <b>file</b>. A file is simply a linear array of bytes, each of which you can read or write. Each file has some kind of <b>low-level</b></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 21pt;text-indent: 0pt;text-align: center;">441</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s27" style="padding-top: 3pt;padding-left: 68pt;text-indent: 0pt;line-height: 89%;text-align: justify;">name<span class="p">, usually a number of some kind; often, the user is not aware of this name (as we will see). For historical reasons, the low-level name of a file is often referred to as its </span>inode number<span class="p">. We’ll be learning a lot more about inodes in future chapters; for now, just assume that each file has an inode number associated with it.</span></p><p style="padding-left: 68pt;text-indent: 12pt;line-height: 89%;text-align: right;">In most systems, the OS does not know much about the structure of the file (e.g., whether it is a picture, or a text file, or C code); rather, the responsibility of the file system is simply to store such data persistently on disk and make sure that when you request the data again, you get what you put there in the first place. Doing so is not as simple as it seems! The second abstraction is that of a <b>directory</b>. A directory, like a file, also has a low-level name (i.e., an inode number), but its contents are quite specific: it contains a list of (user-readable name, low-level name) pairs. For example, let’s say there is a file with the low-level name “10”, and it is referred to by the user-readable name of “foo”. The directory “foo” resides in thus would have an entry (“foo”, “10”) that maps the user-readable name to the low-level name. Each entry in a directory refers to either files or other directories. By placing directories within other di- rectories, users are able to build an arbitrary <b>directory tree </b>(or <b>directory</b></p><p class="s27" style="padding-left: 68pt;text-indent: 0pt;line-height: 10pt;text-align: justify;">hierarchy<span class="p">), under which all files and directories are stored.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="177" height="141" alt="image" src="Image_569.png"/></span></p><p class="s65" style="text-indent: 0pt;line-height: 5pt;text-align: left;">/</p><p style="text-indent: 0pt;text-align: left;"/><p class="s65" style="text-indent: 0pt;line-height: 5pt;text-align: left;">foo</p><p style="text-indent: 0pt;text-align: left;"/><p class="s65" style="text-indent: 0pt;line-height: 5pt;text-align: left;">bar</p><p style="text-indent: 0pt;text-align: left;"/><p class="s65" style="text-indent: 0pt;line-height: 5pt;text-align: left;">bar.txt</p><p style="text-indent: 0pt;text-align: left;"/><p class="s65" style="text-indent: 0pt;line-height: 5pt;text-align: left;">bar</p><p style="text-indent: 0pt;text-align: left;"/><p class="s65" style="text-indent: 0pt;line-height: 5pt;text-align: left;">foo</p><p style="text-indent: 0pt;text-align: left;"/><p class="s65" style="text-indent: 0pt;line-height: 5pt;text-align: left;">bar.txt</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-top: 2pt;padding-left: 133pt;text-indent: 0pt;text-align: left;">Figure 39.1: <b>An Example Directory Tree</b></p><p style="padding-top: 7pt;padding-left: 68pt;text-indent: 12pt;line-height: 88%;text-align: justify;">The directory hierarchy starts at a <b>root directory </b>(in U<span class="s7">NIX</span>-based sys- tems, the root directory is simply referred to as <span class="s41">/</span>) and uses some kind of <b>separator </b>to name subsequent <b>sub-directories </b>until the desired file or directory is named. For example, if a user created a directory <span class="s41">foo </span>in the root directory <span class="s41">/</span>, and then created a file <span class="s41">bar.txt </span>in the directory <span class="s41">foo</span>, we could refer to the file by its <b>absolute pathname</b>, which in this case would be <span class="s41">/foo/bar.txt</span>. See Figure <span style=" color: #00AEEF;">39.1 </span>for a more complex directory tree; valid directories in the example are <span class="s41">/, /foo, /bar, /bar/bar,</span></p><p class="s41" style="padding-left: 68pt;text-indent: 0pt;line-height: 89%;text-align: justify;">/bar/foo <span class="p">and valid files are </span>/foo/bar.txt <span class="p">and </span>/bar/foo/bar.txt<span class="p">. Directories and files can have the same name as long as they are in dif- ferent locations in the file-system tree (e.g., there are two files named </span>bar.txt <span class="p">in the figure, </span>/foo/bar.txt <span class="p">and </span>/bar/foo/bar.txt<span class="p">).</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 6pt;padding-left: 70pt;text-indent: 0pt;line-height: 11pt;text-align: left;">T<span class="s7">IP</span>: T<span class="s7">HINK </span>C<span class="s7">AREFULLY </span>A<span class="s7">BOUT </span>N<span class="s7">AMING</span></p><p style="padding-left: 9pt;text-indent: 0pt;line-height: 89%;text-align: justify;">Naming is an important aspect of computer systems [SK09]. In U<span class="s7">NIX </span>systems, virtually everything that you can think of is named through the file system. Beyond just files, devices, pipes, and even processes [K84] can be found in what looks like a plain old file system. This uniformity of naming eases your conceptual model of the system, and makes the system simpler and more modular. Thus, whenever creating a system or interface, think carefully about what names you are using.</p><p style="padding-left: 32pt;text-indent: 0pt;text-align: left;"/><p style="padding-top: 3pt;padding-left: 41pt;text-indent: 11pt;line-height: 88%;text-align: justify;">You may also notice that the file name in this example often has two parts: <span class="s41">bar </span>and <span class="s41">txt</span>, separated by a period. The first part is an arbitrary name, whereas the second part of the file name is usually used to indi- cate the <b>type </b>of the file, e.g., whether it is C code (e.g., <span class="s41">.c</span>), or an image (e.g., <span class="s41">.jpg</span>), or a music file (e.g., <span class="s41">.mp3</span>). However, this is usually just a <b>convention</b>: there is usually no enforcement that the data contained in a file named <span class="s41">main.c </span>is indeed C source code.</p><p style="padding-left: 41pt;text-indent: 11pt;line-height: 89%;text-align: justify;">Thus, we can see one great thing provided by the file system: a conve- nient way to <b>name </b>all the files we are interested in. Names are important in systems as the first step to accessing any resource is being able to name it. In U<span class="s7">NIX </span>systems, the file system thus provides a unified way to access files on disk, USB stick, CD-ROM, many other devices, and in fact many other things, all located under the single directory tree.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part416.htm">&lt; 上一个</a><span> | </span><a href="../ostep.html">内容</a><span> | </span><a href="part418.htm">下一个 &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
