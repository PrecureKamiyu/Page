<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>21.1 Swap Space</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part215.htm">&lt; 上一个</a><span> | </span><a href="../ostep.html">内容</a><span> | </span><a href="part217.htm">下一个 &gt;</a></p><p class="s40" style="padding-left: 38pt;text-indent: 0pt;text-align: left;">21.1 Swap Space</p><p style="padding-top: 7pt;padding-left: 68pt;text-indent: 12pt;line-height: 89%;text-align: justify;">The first thing we will need to do is to reserve some space on the disk for moving pages back and forth. In operating systems, we generally refer to such space as <b>swap space</b>, because we <i>swap </i>pages out of memory to it and <i>swap </i>pages into memory from it. Thus, we will simply assume that the OS can read from and write to the swap space, in page-sized units. To do so, the OS will need to remember the <b>disk address </b>of a given page.</p><p style="padding-left: 68pt;text-indent: 12pt;line-height: 89%;text-align: justify;">The size of the swap space is important, as ultimately it determines the maximum number of memory pages that can be in use by a system at a given time. Let us assume for simplicity that it is <i>very </i>large for now.</p><p style="padding-left: 68pt;text-indent: 12pt;line-height: 89%;text-align: justify;">In the tiny example (Figure <span style=" color: #00AEEF;">21.1</span>), you can see a little example of a 4- page physical memory and an 8-page swap space. In the example, three processes (Proc 0, Proc 1, and Proc 2) are actively sharing physical mem- ory; each of the three, however, only have some of their valid pages in memory, with the rest located in swap space on disk. A fourth process (Proc 3) has all of its pages swapped out to disk, and thus clearly isn’t currently running. One block of swap remains free. Even from this tiny example, hopefully you can see how using swap space allows the system to pretend that memory is larger than it actually is.</p><p style="padding-left: 68pt;text-indent: 12pt;line-height: 89%;text-align: justify;">We should note that swap space is not the only on-disk location for swapping traffic. For example, assume you are running a program binary (e.g., <span class="s41">ls</span>, or your own compiled <span class="s41">main </span>program). The code pages from this binary are initially found on disk, and when the program runs, they are loaded into memory (either all at once when the program starts execution,</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse" cellspacing="0"><tr style="height:29pt"><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#D3D3D3"><p class="s95" style="padding-top: 4pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">Proc 0</p><p class="s103" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">[VPN 0]</p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s95" style="padding-top: 4pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">Proc 1</p><p class="s103" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">[VPN 2]</p></td><td style="width:28pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s95" style="padding-top: 4pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">Proc 1</p><p class="s103" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">[VPN 3]</p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#A8A8A8"><p class="s95" style="padding-top: 4pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">Proc 2</p><p class="s103" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">[VPN 0]</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><p class="s47" style="padding-left: 46pt;text-indent: 0pt;line-height: 89%;text-align: left;">Physical Memory</p><p class="s65" style="padding-top: 4pt;padding-left: 8pt;text-indent: 0pt;text-align: left;">PFN 0</p><p class="s65" style="padding-top: 4pt;padding-left: 10pt;text-indent: 0pt;text-align: left;">PFN 1</p><p class="s65" style="padding-top: 4pt;padding-left: 10pt;text-indent: 0pt;text-align: left;">PFN 2</p><p class="s65" style="padding-top: 4pt;padding-left: 10pt;text-indent: 0pt;text-align: left;">PFN 3</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse" cellspacing="0"><tr style="height:29pt"><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#D3D3D3"><p class="s95" style="padding-top: 4pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">Proc 0</p><p class="s103" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">[VPN 1]</p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#D3D3D3"><p class="s95" style="padding-top: 4pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">Proc 0</p><p class="s103" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">[VPN 2]</p></td><td style="width:28pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s95" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">[Free]</p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s95" style="padding-top: 4pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">Proc 1</p><p class="s103" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">[VPN 0]</p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s95" style="padding-top: 4pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">Proc 1</p><p class="s103" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">[VPN 1]</p></td><td style="width:29pt" bgcolor="#000000"><p class="s120" style="padding-top: 4pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">Proc 3</p><p class="s121" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">[VPN 0]</p></td><td style="width:28pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#A8A8A8"><p class="s95" style="padding-top: 4pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">Proc 2</p><p class="s103" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">[VPN 1]</p></td><td style="width:30pt" bgcolor="#000000"><p class="s120" style="padding-top: 4pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">Proc 3</p><p class="s121" style="padding-left: 4pt;text-indent: 0pt;text-align: left;">[VPN 1]</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><p class="s47" style="padding-left: 48pt;text-indent: 1pt;line-height: 89%;text-align: right;">Swap Space</p><p class="s65" style="padding-top: 4pt;padding-left: 10pt;text-indent: 0pt;text-align: left;">Block 0</p><p class="s65" style="padding-top: 4pt;padding-left: 7pt;text-indent: 0pt;text-align: left;">Block 1</p><p class="s65" style="padding-top: 4pt;padding-left: 7pt;text-indent: 0pt;text-align: left;">Block 2</p><p class="s65" style="padding-top: 4pt;padding-left: 7pt;text-indent: 0pt;text-align: left;">Block 3</p><p class="s65" style="padding-top: 4pt;padding-left: 7pt;text-indent: 0pt;text-align: left;">Block 4</p><p class="s65" style="padding-top: 4pt;padding-left: 7pt;text-indent: 0pt;text-align: left;">Block 5</p><p class="s65" style="padding-top: 4pt;padding-left: 7pt;text-indent: 0pt;text-align: left;">Block 6</p><p class="s65" style="padding-top: 4pt;padding-left: 7pt;text-indent: 0pt;text-align: left;">Block 7</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="78" height="41" alt="image" src="Image_291.png"/></span></p><p style="padding-top: 2pt;padding-left: 90pt;text-indent: 0pt;text-align: justify;">Figure 21.1: <b>Physical Memory and Swap Space</b></p><p style="padding-top: 4pt;padding-left: 41pt;text-indent: 0pt;line-height: 89%;text-align: justify;">or, as in modern systems, one page at a time when needed). However, if the system needs to make room in physical memory for other needs, it can safely re-use the memory space for these code pages, knowing that it can later swap them in again from the on-disk binary in the file system.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part215.htm">&lt; 上一个</a><span> | </span><a href="../ostep.html">内容</a><span> | </span><a href="part217.htm">下一个 &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
