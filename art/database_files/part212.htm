<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Exercises</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part211.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part213.htm">下一个 &gt;</a></p><p class="s45" style="padding-top: 11pt;padding-left: 41pt;text-indent: 0pt;text-align: left;">Exercises</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s46" style="padding-left: 124pt;text-indent: -35pt;text-align: justify;">10.10 <span class="p">Give four ways in which information in web logs pertaining to the web pages visited by a user can be used by the web site.</span></p><p style="padding-top: 6pt;padding-left: 124pt;text-indent: -34pt;text-align: justify;"><b>10.11  </b>One of the characteristics of Big Data is the variety of data. Explain why this characteristic has resulted in the need for languages other than <span class="s44">SQL </span>for pro- cessing Big Data.</p><p class="s46" style="padding-top: 6pt;padding-left: 124pt;text-indent: -35pt;text-align: justify;">10.12  <span class="p">Suppose your company has built a database application that runs on a cen- tralized database, but even with a high-end computer and appropriate indices created on the data, the system is not able to handle the transaction load, lead-</span></p><p class="s66" style="padding-top: 3pt;padding-left: 119pt;text-indent: 0pt;text-align: right;">Tools  <span class="s164">515</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 155pt;text-indent: 0pt;text-align: justify;">ing to slow processing of queries. What would be some of your options to allow the application to handle the transaction load?</p><p class="s46" style="padding-top: 6pt;padding-left: 155pt;text-indent: -35pt;text-align: justify;">10.13 <span class="p">The map-reduce framework is quite useful for creating inverted indices on a set of documents. An inverted index stores for each word a list of all document IDs that it appears in (oﬀsets in the documents are also normally stored, but we shall ignore them in this question).</span></p><p style="padding-left: 170pt;text-indent: 0pt;text-align: justify;">For example, if the input document IDs and contents are as follows:</p><p style="padding-top: 4pt;padding-left: 29pt;text-indent: 0pt;text-align: center;">1: data clean</p><p style="padding-left: 26pt;text-indent: 0pt;text-align: center;">2: data base</p><p style="padding-left: 30pt;text-indent: 0pt;text-align: center;">3: clean base</p><p style="padding-left: 186pt;text-indent: -31pt;line-height: 17pt;text-align: justify;">then the inverted lists would data: 1, 2</p><p style="padding-left: 186pt;text-indent: 0pt;text-align: justify;">clean: 1, 3</p><p style="padding-left: 186pt;text-indent: 0pt;text-align: justify;">base: 2, 3</p><p style="padding-left: 155pt;text-indent: 0pt;text-align: justify;">Give pseudocode for map and reduce functions to create inverted indices on a given set of ﬁles (each ﬁle is a document). Assume the document ID is available using a function <span class="s49">context.getDocumentID()</span>, and the map function is invoked once per line of the document. The output inverted list for each word should be a list of document IDs separated by commas. The document IDs are normally sorted, but for the purpose of this question you do not need to bother to sort them.</p><p class="s46" style="padding-top: 6pt;padding-left: 155pt;text-indent: -34pt;text-align: justify;">10.14 <span class="p">Fill in the blanks below to complete the following Apache Spark program which computes the number of occurrences of each word in a ﬁle. For simplic- ity we assume that words only occur in lowercase, and there are no punctuation marks.</span></p><p class="s49" style="padding-top: 9pt;padding-left: 155pt;text-indent: 0pt;line-height: 62%;text-align: left;">JavaRDD<span class="s186">&lt;</span>String<span class="s186">&gt; </span>textFile = sc.textFile(&quot;hdfs://...&quot;); JavaPairRDD<span class="s186">&lt;</span>String, Integer<span class="s186">&gt; </span>counts =</p><p class="s49" style="padding-left: 171pt;text-indent: 0pt;line-height: 11pt;text-align: left;">textFile.<span class="s279"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(s <span class="s185">−</span><span class="s186">&gt; </span>Arrays.asList(s.split(&quot; &quot;)).<span class="s279"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>())</p><p class="s49" style="padding-left: 174pt;text-indent: 0pt;line-height: 16pt;text-align: left;">.mapToPair(word -&gt; new <span class="s279">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>).reduceByKey((a, b) <span class="s185">−</span><span class="s186">&gt; </span>a+ b);</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part211.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part213.htm">下一个 &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
