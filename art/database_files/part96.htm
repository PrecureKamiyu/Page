<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Practice Exercises</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part95.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part97.htm">下一个 &gt;</a></p><p class="s45" style="padding-top: 4pt;padding-left: 68pt;text-indent: 0pt;text-align: left;">Practice Exercises</p><p style="padding-top: 11pt;padding-left: 150pt;text-indent: -24pt;text-align: justify;"><b>3.1  </b>Write the following queries in <span class="s44">SQL</span>, using the university schema. (We suggest you actually run these queries on a database, using the sample data that we provide on the web site of the book, <span class="s49">db-book.com</span>. Instructions for setting up a database, and loading sample data, are provided on the above web site.)</p><p style="padding-top: 7pt;padding-left: 157pt;text-indent: 0pt;text-align: left;">a.  Find the titles of courses in the Comp. Sci. department that have 3 credits.</p><p style="padding-top: 6pt;padding-left: 176pt;text-indent: -19pt;text-align: left;">b.  Find the <span class="s44">ID</span>s of all students who were taught by an instructor named Ein- stein; make sure there are no duplicates in the result.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 4pt;padding-left: 126pt;text-indent: 0pt;text-align: left;">c. Find the highest salary of any instructor.</p><p style="padding-top: 6pt;padding-left: 145pt;text-indent: -19pt;text-align: left;">d.  Find all instructors earning the highest salary (there may be more than one with the same salary).</p><p style="padding-top: 6pt;padding-left: 126pt;text-indent: 0pt;text-align: left;">e.  Find the enrollment of each section that was oﬀered in Fall 2017.</p><p style="padding-top: 6pt;padding-left: 128pt;text-indent: 0pt;text-align: left;">f.  Find the maximum enrollment, across all sections, in Fall 2017.</p><p style="padding-top: 6pt;padding-left: 126pt;text-indent: 0pt;text-align: left;">g.  Find the sections that had the maximum enrollment in Fall 2017.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_538.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="31" height="1" alt="image" src="Image_539.png"/></span></p><p style="padding-top: 9pt;padding-left: 119pt;text-indent: -25pt;text-align: right;"><b>3.2 </b>Suppose you are given a relation <i>grade points</i>(<i>grade</i>, <i>points</i>) that provides a con- version from letter grades in the <i>takes </i>relation to numeric scores; for example, an “A” grade could be speciﬁed to correspond to 4 points, an “A<span class="s15">−</span>” to 3.7 points, a “B+” to 3.3 points, a “B” to 3 points, and so on. The grade points earned by a student for a course oﬀering (section) is deﬁned as the number of credits for the course multiplied by the numeric points for the grade that the student received. Given the preceding relation, and our university schema, write each of the following queries in <span class="s44">SQL</span>. You may assume for simplicity that no <i>takes </i>tuple has</p><p style="padding-left: 119pt;text-indent: 0pt;text-align: left;">the <i>null </i>value for <i>grade</i>.</p><p style="padding-top: 6pt;padding-left: 145pt;text-indent: -18pt;text-align: left;">a.  Find the total grade points earned by the student with <span class="s44">ID </span>&#39;12345&#39;, across all courses taken by the student.</p><p style="padding-top: 6pt;padding-left: 145pt;text-indent: -19pt;text-align: left;">b.  Find the grade point average (<i>GPA</i>) for the above student, that is, the total grade points divided by the total credits for the associated courses.</p><p style="padding-top: 6pt;padding-left: 126pt;text-indent: 0pt;text-align: left;">c. Find the <span class="s44">ID </span>and the grade-point average of each student.</p><p style="padding-top: 6pt;padding-left: 145pt;text-indent: -19pt;text-align: justify;">d. Now reconsider your answers to the earlier parts of this exercise under the assumption that some grades might be null. Explain whether your solutions still work and, if not, provide versions that handle nulls properly.</p><p style="padding-top: 9pt;padding-left: 119pt;text-indent: -25pt;text-align: left;"><b>3.3 </b>Write the following inserts, deletes, or updates in <span class="s44">SQL</span>, using the university schema.</p><p style="padding-top: 6pt;padding-left: 145pt;text-indent: -18pt;text-align: left;">a. Increase the salary of each instructor in the Comp. Sci. department by 10%.</p><p style="padding-top: 6pt;padding-left: 125pt;text-indent: 0pt;text-align: left;">b. Delete all courses that have never been oﬀered (i.e., do not occur in the</p><p class="s13" style="padding-left: 145pt;text-indent: 0pt;text-align: left;">section <span class="p">relation).</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_540.png"/></span></p><p style="padding-top: 6pt;padding-left: 145pt;text-indent: -18pt;text-align: left;">c.  Insert every student whose <i>tot cred </i>attribute is greater than 100 as an in- structor in the same department, with a salary of $10,000.</p><p style="padding-top: 9pt;padding-left: 119pt;text-indent: -25pt;text-align: left;"><b>3.4  </b>Consider the insurance database of Figure 3.17, where the primary keys are underlined. Construct the following <span class="s44">SQL </span>queries for this relational database.</p><p style="padding-top: 9pt;padding-left: 145pt;text-indent: -18pt;text-align: justify;">a. Find the total number of people who owned cars that were involved in accidents in 2017.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="494" height="1" alt="image" src="Image_541.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_542.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_543.png"/></span></p><p style="padding-top: 4pt;padding-bottom: 1pt;padding-left: 161pt;text-indent: 0pt;text-align: left;"><i>person </i>(<u><i>driver id</i></u>, <i>name</i>, <i>address</i>) <i>car </i>(<i>license plate</i>, <i>model</i>, <i>year</i>)</p><p style="padding-left: 182pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="69" height="1" alt="image" src="Image_544.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_545.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="80" height="1" alt="image" src="Image_546.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_547.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_548.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="69" height="1" alt="image" src="Image_549.png"/></span></p><p style="padding-left: 161pt;text-indent: 0pt;line-height: 114%;text-align: left;"><i>accident </i>(<i>report number</i>, <i>year</i>, <i>location</i>) <i>owns </i>(<u><i>driver id</i></u>, <i>license plate</i>)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_550.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_551.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_552.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_553.png"/></span></p><p class="s13" style="padding-left: 161pt;text-indent: 0pt;line-height: 13pt;text-align: left;">participated <span class="p">(</span>report number<span class="p">, </span>license plate<span class="p">, </span>driver id<span class="p">, </span>damage amount<span class="p">)</span></p><p class="s172" style="padding-left: 218pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="80" height="1" alt="image" src="Image_554.png"/></span> <span><img width="69" height="1" alt="image" src="Image_555.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="494" height="1" alt="image" src="Image_556.png"/></span></p><p class="s73" style="padding-top: 8pt;padding-left: 234pt;text-indent: 0pt;text-align: left;">Figure 3.17 <span class="s74">Insurance database</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 157pt;text-indent: 0pt;text-align: left;">b.  Delete all year-2010 cars belonging to the person whose <span class="s44">ID </span>is &#39;12345&#39;.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 150pt;text-indent: -25pt;text-align: left;"><b>3.5 </b>Suppose that we have a relation <i>marks</i>(<span class="s69">ID</span>, <i>score</i>) and we wish to assign grades to students based on the score as follows: grade <i>F </i>if <i>score </i>&lt; 40, grade <i>C </i>if 40</p><p class="s13" style="padding-left: 150pt;text-indent: 0pt;line-height: 14pt;text-align: left;"><span class="s86">≤ </span>score <span class="p">&lt; 60, grade </span>B <span class="p">if 60 </span><span class="s86">≤ </span>score <span class="p">&lt; 80, and grade </span>A <span class="p">if 80 </span><span class="s86">≤ </span>score<span class="p">. Write </span><span class="s44">SQL</span></p><p style="padding-left: 150pt;text-indent: 0pt;line-height: 12pt;text-align: left;">queries to do the following:</p><p style="padding-top: 7pt;padding-left: 157pt;text-indent: 0pt;text-align: left;">a.  Display the grade for each student, based on the <i>marks </i>relation.</p><p style="padding-top: 6pt;padding-left: 157pt;text-indent: 0pt;text-align: left;">b. Find the number of students with each grade.</p><p style="padding-top: 7pt;padding-left: 150pt;text-indent: -25pt;text-align: justify;"><b>3.6  </b>The <span class="s44">SQL </span><b>like </b>operator is case sensitive (in most systems), but the <span class="s49">lower() </span>func- tion on strings can be used to perform case-insensitive matching. To show how, write a query that ﬁnds departments whose names contain the string “sci” as a substring, regardless of the case.</p><p style="padding-top: 6pt;padding-left: 125pt;text-indent: 0pt;text-align: justify;"><b>3.7 </b>Consider the <span class="s44">SQL </span>query</p><p class="s46" style="padding-top: 8pt;padding-left: 245pt;text-indent: 0pt;text-align: left;">select <i>p.a</i><span class="p">1</span></p><p class="s13" style="padding-left: 245pt;text-indent: 0pt;text-align: left;"><b>from </b>p<span class="p">, </span>r<span class="p">1, </span>r<span class="p">2</span></p><p class="s13" style="padding-left: 245pt;text-indent: 0pt;text-align: left;"><b>where </b>p.a<span class="p">1 </span><span class="s15">= </span>r<span class="p">1.</span>a<span class="p">1 </span><b>or </b>p.a<span class="p">1 </span><span class="s15">= </span>r<span class="p">2.</span>a<span class="p">1</span></p><p class="s13" style="padding-top: 9pt;padding-left: 150pt;text-indent: 0pt;line-height: 70%;text-align: left;"><span class="p">Under what conditions does the preceding query select values of </span>p<span class="s83">.</span>a<span class="p">1 that are either in </span>r<span class="p">1 or in </span>r<span class="p">2? Examine carefully the cases where either </span>r<span class="p">1 or </span>r<span class="p">2 may be</span></p><p style="padding-top: 1pt;padding-left: 150pt;text-indent: 0pt;text-align: left;">empty.</p><p style="padding-top: 6pt;padding-left: 150pt;text-indent: -25pt;text-align: left;"><b>3.8 </b>Consider the bank database of Figure 3.18, where the primary keys are under- lined. Construct the following <span class="s44">SQL </span>queries for this relational database.</p><p style="padding-top: 7pt;padding-left: 176pt;text-indent: -18pt;text-align: left;">a.  Find the <span class="s44">ID </span>of each customer of the bank who has an account but not a loan.</p><p style="padding-top: 6pt;padding-left: 176pt;text-indent: -19pt;text-align: left;">b.  Find the <span class="s44">ID </span>of each customer who lives on the same street and in the same city as customer &#39;12345&#39;.</p><p style="padding-top: 6pt;padding-left: 176pt;text-indent: -18pt;text-align: left;">c.  Find the name of each branch that has at least one customer who has an account in the bank and who lives in “Harrison”.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 88pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="494" height="1" alt="image" src="Image_557.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_558.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_559.png"/></span></p><p style="padding-top: 4pt;padding-left: 147pt;text-indent: 0pt;text-align: left;"><i>branch</i>(<u><i>branch name</i></u>, <i>branch city, assets</i>)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_560.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_561.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_562.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_563.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_564.png"/></span></p><p style="padding-left: 147pt;text-indent: 0pt;text-align: left;"><i>customer </i>(<span class="s99">ID</span>, <i>customer name</i>, <i>customer street, customer city</i>) <i>loan </i>(<u><i>loan number</i></u>, <i>branch name, amount</i>)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_565.png"/></span></p><p style="padding-left: 147pt;text-indent: 0pt;text-align: left;"><i>borrower </i>(<span class="s99">ID</span>, <u><i>loan number</i></u>)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_566.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_567.png"/></span></p><p style="padding-left: 147pt;text-indent: 0pt;text-align: left;"><i>account </i>(<u><i>account number</i></u>, <i>branch name, balance </i>)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_568.png"/></span></p><p style="padding-left: 147pt;text-indent: 0pt;text-align: left;"><i>depositor </i>(<span class="s99">ID</span>, <u><i>account number</i></u>)</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 88pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="494" height="1" alt="image" src="Image_569.png"/></span></p><p class="s73" style="padding-top: 8pt;padding-left: 59pt;text-indent: 0pt;text-align: center;">Figure 3.18 <span class="s74">Banking database.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: -25pt;text-align: left;"><b>3.9 </b>Consider the relational database of Figure 3.19, where the primary keys are underlined. Give an expression in <span class="s44">SQL </span>for each of the following queries.</p><p style="padding-top: 8pt;padding-left: 145pt;text-indent: -18pt;text-align: justify;">a.  Find the <span class="s44">ID</span>, name, and city of residence of each employee who works for “First Bank Corporation”.</p><p style="padding-top: 6pt;padding-left: 145pt;text-indent: -19pt;text-align: justify;">b.  Find the <span class="s44">ID</span>, name, and city of residence of each employee who works for “First Bank Corporation” and earns more than $10000.</p><p style="padding-top: 6pt;padding-left: 145pt;text-indent: -18pt;text-align: justify;">c.  Find the <span class="s44">ID </span>of each employee who does not work for “First Bank Corpo- ration”.</p><p style="padding-top: 6pt;padding-left: 145pt;text-indent: -19pt;text-align: justify;">d. Find the <span class="s44">ID </span>of each employee who earns more than every employee of “Small Bank Corporation”.</p><p style="padding-top: 6pt;padding-left: 145pt;text-indent: -18pt;text-align: justify;">e.  Assume that companies may be located in several cities. Find the name of each company that is located in every city in which “Small Bank Cor- poration” is located.</p><p style="padding-top: 6pt;padding-left: 145pt;text-indent: -17pt;text-align: justify;">f.  Find the name of the company that has the most employees (or compa- nies, in the case where there is a tie for the most).</p><p style="padding-top: 6pt;padding-left: 145pt;text-indent: -18pt;text-align: justify;">g. Find the name of each company whose employees earn a higher salary, on average, than the average salary at “First Bank Corporation”.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 88pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="494" height="1" alt="image" src="Image_570.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_571.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_572.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_573.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="85" height="1" alt="image" src="Image_574.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_575.png"/></span></p><p style="padding-top: 4pt;padding-left: 193pt;text-indent: 0pt;line-height: 106%;text-align: left;"><i>employee </i>(<span class="s99">ID</span>, <i>person name</i>, <i>street</i>, <i>city</i>) <i>works </i>(<span class="s99">ID</span>, <i>company name</i>, <i>salary</i>) <i>company </i>(<i>company name</i>, <i>city</i>) <i>manages </i>(<span class="s99">ID</span>, <i>manager id</i>)</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 88pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="494" height="1" alt="image" src="Image_576.png"/></span></p><p class="s73" style="padding-top: 8pt;padding-left: 59pt;text-indent: 0pt;text-align: center;">Figure 3.19 <span class="s74">Employee database.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 4pt;padding-left: 150pt;text-indent: -29pt;text-align: left;"><b>3.10 </b>Consider the relational database of Figure 3.19. Give an expression in <span class="s44">SQL </span>for each of the following:</p><p style="padding-top: 6pt;padding-left: 176pt;text-indent: -18pt;text-align: justify;">a. Modify the database so that the employee whose <span class="s44">ID </span>is &#39;12345&#39; now lives in “Newtown”.</p><p style="padding-top: 6pt;padding-left: 176pt;text-indent: -19pt;text-align: justify;">b.  Give each manager of “First Bank Corporation” a 10 percent raise unless the salary becomes greater than $100000; in such cases, give only a 3 percent raise.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part95.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part97.htm">下一个 &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
