<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Wrapping Up Journaling: A Timeline</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part473.htm">&lt; 上一个</a><span> | </span><a href="../ostep.html">内容</a><span> | </span><a href="part475.htm">下一个 &gt;</a></p><p class="s32" style="padding-top: 6pt;padding-left: 68pt;text-indent: 0pt;text-align: justify;">Wrapping Up Journaling: A Timeline</p><p style="padding-top: 6pt;padding-left: 68pt;text-indent: 0pt;line-height: 89%;text-align: justify;">Before ending our discussion of journaling, we summarize the protocols we have discussed with timelines depicting each of them. Table <span style=" color: #00AEEF;">42.1 </span>shows the protocol when journaling data as well as metadata, whereas Table <span style=" color: #00AEEF;">42.2 </span>shows the protocol when journaling only metadata.</p><p style="padding-left: 68pt;text-indent: 12pt;line-height: 89%;text-align: justify;">In each table, time increases in the downward direction, and each row in the table shows the logical time that a write can be issued or might complete. For example, in the data journaling protocol (<span style=" color: #00AEEF;">42.1</span>), the writes of the transaction begin block (TxB) and the contents of the transaction can logically be issued at the same time, and thus can be completed in any order; however, the write to the transaction end block (TxE) must not be issued until said previous writes complete. Similarly, the checkpoint- ing writes to data and metadata blocks cannot begin until the transaction end block has committed. Horizontal dashed lines show where write- ordering requirements must be obeyed.</p><p style="padding-left: 68pt;text-indent: 12pt;line-height: 89%;text-align: justify;">A similar timeline is shown for the metadata journaling protocol. Note that the data write can logically be issued at the same time as the writes</p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:88.708pt" cellspacing="0"><tr style="height:29pt"><td style="width:38pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F"><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s108" style="padding-left: 12pt;text-indent: 0pt;text-align: left;">TxB</p></td><td style="width:43pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F"><p class="s123" style="padding-left: 5pt;text-indent: 0pt;line-height: 9pt;text-align: left;">Journal</p><p class="s108" style="padding-left: 3pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Contents</p><p class="s70" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">(metadata)</p></td><td style="width:33pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s108" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">TxE</p></td><td style="width:77pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F"><p class="s123" style="padding-left: 16pt;text-indent: 0pt;line-height: 9pt;text-align: left;">File System</p><p class="s108" style="padding-left: 2pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Metadata  Data</p></td></tr><tr style="height:38pt"><td style="width:38pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-bottom-style:dashed;border-bottom-width:1pt;border-bottom-color:#221E1F"><p class="s123" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">issue</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s123" style="padding-left: 1pt;padding-right: 1pt;text-indent: 0pt;text-align: center;">complete</p></td><td style="width:43pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-bottom-style:dashed;border-bottom-width:1pt;border-bottom-color:#221E1F"><p class="s123" style="padding-left: 1pt;padding-right: 6pt;text-indent: 0pt;line-height: 9pt;text-align: center;">issue</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s123" style="padding-left: 1pt;padding-right: 6pt;text-indent: 0pt;line-height: 9pt;text-align: center;">complete</p></td><td style="width:33pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-bottom-style:dashed;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:77pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:dashed;border-bottom-width:1pt;border-bottom-color:#221E1F"><p class="s123" style="padding-left: 39pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">issue</p><p class="s123" style="padding-left: 39pt;padding-right: 1pt;text-indent: 0pt;line-height: 10pt;text-align: center;">complete</p></td></tr><tr style="height:19pt"><td style="width:114pt;border-top-style:dashed;border-top-width:1pt;border-top-color:#221E1F;border-bottom-style:dashed;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F" colspan="3"><p class="s123" style="padding-left: 77pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">issue</p><p class="s123" style="padding-left: 77pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">complete</p></td><td style="width:77pt;border-top-style:dashed;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:dashed;border-bottom-width:1pt;border-bottom-color:#221E1F"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:19pt"><td style="width:114pt;border-top-style:dashed;border-top-width:1pt;border-top-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F" colspan="3"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:77pt;border-top-style:dashed;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F"><p class="s123" style="padding-left: 1pt;padding-right: 39pt;text-indent: 0pt;line-height: 9pt;text-align: center;">issue</p><p class="s123" style="padding-left: 1pt;padding-right: 39pt;text-indent: 0pt;line-height: 9pt;text-align: center;">complete</p></td></tr></table><p style="padding-top: 3pt;padding-left: 101pt;text-indent: 0pt;text-align: left;">Table 42.2: <b>Metadata Journaling Timeline</b></p><p style="padding-top: 5pt;padding-left: 41pt;text-indent: 0pt;line-height: 89%;text-align: justify;">to the transaction begin and the contents of the journal; however, it must be issued and complete before the transaction end has been issued.</p><p style="padding-left: 41pt;text-indent: 11pt;line-height: 89%;text-align: justify;">Finally, note that the time of completion marked for each write in the timelines is arbitrary. In a real system, completion time is determined by the I/O subsystem, which may reorder writes to improve performance. The only guarantees about ordering that we have are those that must be enforced for protocol correctness (and are shown via the horizontal dashed lines in the tables).</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part473.htm">&lt; 上一个</a><span> | </span><a href="../ostep.html">内容</a><span> | </span><a href="part475.htm">下一个 &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
