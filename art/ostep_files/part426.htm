<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>39.10 Making Directories</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part425.htm">&lt; 上一个</a><span> | </span><a href="../ostep.html">内容</a><span> | </span><a href="part427.htm">下一个 &gt;</a></p><p class="s40" style="padding-left: 33pt;text-indent: 0pt;text-align: left;">39.10 Making Directories</p><p style="padding-top: 7pt;padding-left: 68pt;text-indent: 12pt;line-height: 89%;text-align: justify;">Beyond files, a set of directory-related system calls enable you to make, read, and delete directories. Note you can never write to a directory di- rectly; because the format of the directory is considered file system meta- data, you can only update a directory indirectly by, for example, creating files, directories, or other object types within it. In this way, the file system makes sure that the contents of the directory always are as expected.</p><p style="padding-left: 68pt;text-indent: 12pt;line-height: 88%;text-align: justify;">To create a directory, a single system call, <span class="s41">mkdir()</span>, is available. The eponymous <span class="s41">mkdir </span>program can be used to create such a directory. Let’s take a look at what happens when we run the <span class="s41">mkdir </span>program to make a simple directory called <span class="s41">foo</span>:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s38" style="padding-left: 68pt;text-indent: 0pt;text-align: left;">prompt&gt; strace mkdir foo</p><p class="s38" style="padding-left: 68pt;text-indent: 0pt;text-align: left;">...</p><p class="s38" style="padding-left: 68pt;text-indent: 0pt;text-align: left;">mkdir(&quot;foo&quot;, 0777)         = 0</p><p class="s38" style="padding-left: 68pt;text-indent: 0pt;text-align: left;">...</p><p class="s38" style="padding-left: 68pt;text-indent: 0pt;text-align: left;">prompt&gt;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 68pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="154" height="1" alt="image" src="Image_577.png"/></span></p><p class="s11" style="padding-top: 2pt;padding-left: 68pt;text-indent: 13pt;line-height: 92%;text-align: left;">1<span class="s12">Some file systems call these structures similar, but slightly different, names, such as dnodes; the basic idea is similar however.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 6pt;padding-left: 67pt;text-indent: 0pt;line-height: 10pt;text-align: left;">T<span class="s7">IP</span>: B<span class="s7">E </span>W<span class="s7">ARY </span>O<span class="s7">F </span>P<span class="s7">OWERFUL </span>C<span class="s7">OMMANDS</span></p><p style="padding-left: 9pt;text-indent: 0pt;line-height: 9pt;text-align: justify;">The program <span class="s41">rm </span>provides us with a great example of powerful com-</p><p style="padding-left: 9pt;text-indent: 0pt;line-height: 89%;text-align: justify;">mands, and how sometimes too much power can be a bad thing. For example, to remove a bunch of files at once, you can type something like:</p><p class="s38" style="padding-top: 6pt;padding-left: 9pt;text-indent: 0pt;text-align: justify;">prompt&gt; rm <span class="s39">*</span></p><p style="padding-top: 3pt;padding-left: 9pt;text-indent: 0pt;line-height: 85%;text-align: justify;">where the <span class="s86">* </span>will match all files in the current directory. But sometimes you want to also delete the directories too, and in fact all of their contents. You can do this by telling <span class="s41">rm </span>to recursively descend into each directory, and remove its contents too:</p><p class="s38" style="padding-top: 6pt;padding-left: 9pt;text-indent: 0pt;text-align: justify;">prompt&gt; rm -rf <span class="s39">*</span></p><p style="padding-top: 5pt;padding-left: 9pt;text-indent: 0pt;line-height: 90%;text-align: justify;">Where you get into trouble with this small string of characters is when you issue the command, accidentally, from the root directory of a file sys- tem, thus removing every file and directory from it. Oops!</p><p style="padding-top: 2pt;padding-left: 9pt;text-indent: 0pt;line-height: 89%;text-align: justify;">Thus, remember the double-edged sword of powerful commands; while they give you the ability to do a lot of work with a small number of keystrokes, they also can quickly and readily do a great deal of harm.</p><p style="padding-left: 32pt;text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 41pt;text-indent: 11pt;line-height: 89%;text-align: justify;">When such a directory is created, it is considered “empty”, although it does have a bare minimum of contents. Specifically, an empty directory has two entries: one entry that refers to itself, and one entry that refers to its parent. The former is referred to as the “.” (dot) directory, and the latter as “..” (dot-dot). You can see these directories by passing a flag (<span class="s41">-a</span>) to the program <span class="s41">ls</span>:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s38" style="padding-left: 41pt;text-indent: 0pt;text-align: left;">prompt&gt; ls -a</p><p class="s38" style="padding-left: 41pt;text-indent: 0pt;text-align: left;">./ ../ prompt&gt; ls -al total 8</p><p class="s38" style="padding-left: 41pt;text-indent: 0pt;line-height: 8pt;text-align: left;">drwxr-x--- 2 remzi remzi  6 Apr 30 16:17 ./</p><p class="s38" style="padding-left: 41pt;text-indent: 0pt;text-align: left;">drwxr-x--- 26 remzi remzi 4096 Apr 30 16:17 ../</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part425.htm">&lt; 上一个</a><span> | </span><a href="../ostep.html">内容</a><span> | </span><a href="part427.htm">下一个 &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
