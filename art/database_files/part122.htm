<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>5.5   Advanced Aggregation Features</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part121.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part123.htm">下一个 &gt;</a></p><p class="s65" style="padding-top: 4pt;padding-left: 72pt;text-indent: 0pt;text-align: left;"><a name="bookmark73">5.5   </a><span style=" color: #00AEEF;">Advanced Aggregation Features</span><a name="bookmark113">&zwnj;</a></p><p style="padding-top: 11pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">The aggregation support in <span class="s44">SQL </span>is quite powerful and handles most common tasks with ease. However, there are some tasks that are hard to implement eﬃciently with the basic aggregation features. In this section, we study features in <span class="s44">SQL </span>to handle some such tasks.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s68" style="padding-left: 119pt;text-indent: 0pt;text-align: left;">5.5.1 Ranking</p><p style="padding-top: 6pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">Finding the position of a value within a set is a common operation. For instance, we may wish to assign students a rank in class based on their grade-point average (<span class="s44">GPA</span>), with the rank 1 going to the student with the highest <span class="s44">GPA</span>, the rank 2 to the student with the next highest <span class="s44">GPA</span>, and so on. A related type of query is to ﬁnd the percentile in which a value in a (multi)set belongs, for example, the bottom third, middle third, or top third. While such queries can be expressed using the <span class="s44">SQL </span>constructs we have seen so far, they are diﬃcult to express and ineﬃcient to evaluate. Programmers may resort to writing the query partly in <span class="s44">SQL </span>and partly in a programming language. We study <span class="s44">SQL </span>support for direct expression of these types of queries here.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1160.png"/></span></p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">In our university example, the <i>takes </i>relation shows the grade each student earned in each course taken. To illustrate ranking, let us assume we have a view <i>student grades </i>(<i>ID, GPA</i>) giving the grade-point average of each student.<span class="s76">10</span></p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">Ranking is done with an <b>order by </b>speciﬁcation. The following query gives the rank of each student:</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1161.png"/></span></p><p style="padding-top: 9pt;padding-left: 191pt;text-indent: 0pt;text-align: left;"><b>select </b><i>ID</i>, <b>rank</b>() <b>over </b>(<b>order by </b>(<i>GPA</i>) <b>desc</b>) <b>as </b><i>s rank</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1162.png"/></span></p><p class="s46" style="padding-left: 191pt;text-indent: 0pt;text-align: left;">from <i>student grades</i><span class="p">;</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: 0pt;text-align: left;">Note that the order of tuples in the output is not deﬁned, so they may not be sorted by rank. An extra <b>order by </b>clause is needed to get them in sorted order, as follows:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1163.png"/></span></p><p style="padding-left: 189pt;text-indent: 0pt;text-align: left;"><b>select </b><i>ID</i>, <b>rank </b>() <b>over </b>(<b>order by </b>(<i>GPA</i>) <b>desc</b>) <b>as </b><i>s rank</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1164.png"/></span></p><p class="s46" style="padding-left: 189pt;text-indent: 0pt;text-align: left;">from <i>student grades</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1165.png"/></span></p><p class="s46" style="padding-left: 189pt;text-indent: 0pt;text-align: left;">order by <i>s rank</i><span class="p">;</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">A basic issue with ranking is how to deal with the case of multiple tuples that are the same on the ordering attribute(s). In our example, this means deciding what to do if there are two students with the same <span class="s44">GPA</span>. The <b>rank </b>function gives the same rank to all tuples that are equal on the <b>order by </b>attributes. For instance, if the highest <span class="s44">GPA </span>is shared by two students, both would get rank 1. The next rank given would be 3, not 2, so if three students get the next highest <span class="s44">GPA</span>, they would all get rank 3, and the next</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="95" height="1" alt="image" src="Image_1166.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="3" height="1" alt="image" src="Image_1167.png"/></span></p><p class="s78" style="padding-top: 3pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;"><span class="s77">10</span>The <span class="s153">SQL </span>statement to create the view <i>student grades </i><span class="s80">is somewhat complex since we must convert the letter grades in the </span><i>takes </i><span class="s80">relation to numbers and weight the grades for each course by the number of credits for that course. The deﬁnition of this view is the goal of Exercise 4.6.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1168.png"/></span></p><p style="padding-top: 4pt;padding-left: 88pt;text-indent: 0pt;text-align: justify;">student(s) would get rank 6, and so on. There is also a <b>dense rank </b>function that does not create gaps in the ordering. In the preceding example, the tuples with the second highest value all get rank 2, and tuples with the third highest value get rank 3, and so on.</p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">If there are null values among the values being ranked, they are treated as the highest values. That makes sense in some situations, although for our example, it would result in students with no courses being shown as having the highest <span class="s44">GPA</span>s. Thus, we see that care needs to be taken in writing ranking queries in cases where null values may appear. <span class="s44">SQL </span>permits the user to specify where they should occur by using <b>nulls first </b>or <b>nulls last</b>, for instance:</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1169.png"/></span></p><p class="s46" style="padding-top: 10pt;padding-left: 142pt;text-indent: 0pt;text-align: left;">select <i>ID</i><span class="p">, </span>rank <span class="p">() </span>over <span class="p">(</span>order by <i>GPA </i>desc nulls last<span class="p">) </span>as <i>s rank</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1170.png"/></span></p><p class="s46" style="padding-left: 142pt;text-indent: 0pt;text-align: left;">from <i>student grades</i><span class="p">;</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">It is possible to express the preceding query with the basic <span class="s44">SQL </span>aggregation func- tions, using the following query:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s46" style="padding-left: 168pt;text-indent: 0pt;text-align: left;">select <i>ID</i><span class="p">, (1+ (</span>select count<span class="p">(*)</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1171.png"/></span></p><p class="s46" style="padding-left: 235pt;text-indent: 0pt;line-height: 11pt;text-align: left;">from <i>student grades B</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1172.png"/></span></p><p class="s13" style="padding-left: 235pt;text-indent: 0pt;line-height: 17pt;text-align: left;"><b>where </b>B<span class="p">.</span>GPA <span class="s83">&gt; </span>A<span class="p">.</span>GPA<span class="p">)) </span><b>as </b>s rank</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1173.png"/></span></p><p class="s46" style="padding-left: 168pt;text-indent: 0pt;line-height: 10pt;text-align: left;">from <i>student grades A</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1174.png"/></span></p><p class="s46" style="padding-left: 168pt;text-indent: 0pt;text-align: left;">order by <i>s rank</i><span class="p">;</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">It should be clear that the rank of a student is merely 1 plus the number of students with a higher <i>GPA</i>, which is exactly what the query speciﬁes.<span class="s76">11</span> However, this compu- tation of each student’s rank takes time linear in the size of the relation, leading to an overall time quadratic in the size of the relation. On large relations, the above query could take a very long time to execute. In contrast, the system’s implementation of the <b>rank </b>clause can sort the relation and compute the rank in much less time.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1175.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1176.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1177.png"/></span></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">Ranking can be done within partitions of the data. For instance, suppose we wish to rank students by department rather than across the entire university. Assume that a view is deﬁned like <i>student grades </i>but including the department name: <i>dept grades</i>(<i>ID, dept name, GPA</i>). The following query then gives the rank of students within each sec- tion:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1178.png"/></span></p><p class="s13" style="padding-top: 4pt;padding-left: 117pt;text-indent: 0pt;text-align: left;"><b>select </b>ID<span class="p">, </span>dept name<span class="p">,</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1179.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1180.png"/></span></p><p class="s46" style="padding-left: 138pt;text-indent: 0pt;text-align: left;">rank <span class="p">() </span>over <span class="p">(</span>partition by <i>dept name </i>order by <i>GPA </i>desc<span class="p">) </span>as <i>dept rank</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1181.png"/></span></p><p class="s46" style="padding-left: 117pt;text-indent: 0pt;text-align: left;">from <i>dept grades</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1182.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1183.png"/></span></p><p class="s13" style="padding-left: 117pt;text-indent: 0pt;text-align: left;"><b>order by </b>dept name<span class="p">, </span>dept rank<span class="p">;</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 88pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="96" height="1" alt="image" src="Image_1184.png"/></span></p><p class="s80" style="padding-top: 3pt;padding-left: 88pt;text-indent: 0pt;text-align: left;"><span class="s77">11 </span><span class="s78">There is a slight technical diﬀerence if a student has not taken any courses and therefore has a </span><i>null </i>GPA. Due to how comparisons of null values work in <span class="s161">SQL</span>, a student with a null GPA does not contribute to other students’ <b>count </b>values.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 4pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">The outer <b>order by </b>clause orders the result tuples by department name, and within each department by the rank.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">Multiple <b>rank </b>expressions can be used within a single <b>select </b>statement; thus, we can obtain the overall rank and the rank within the department by using two <b>rank </b>expressions in the same <b>select </b>clause. When ranking (possibly with partitioning) occurs along with a <b>group by </b>clause, the <b>group by </b>clause is applied ﬁrst, and partitioning and ranking are done on the results of the <b>group by</b>. Thus, aggregate values can then be used for ranking.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">It is often the case, especially for large results, that we may be interested only in the top-ranking tuples of the result rather than the entire list. For rank queries, this can be done by nesting the ranking query within a containing query whose <b>where </b>clause chooses only those tuples whose rank is lower than some speciﬁed value. For example, to ﬁnd the top 5 ranking students based on <span class="s44">GPA </span>we could extend our earlier example by writing:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s46" style="padding-top: 4pt;padding-left: 177pt;text-indent: 0pt;text-align: left;">select <span class="p">*</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1185.png"/></span></p><p style="padding-left: 177pt;text-indent: 0pt;text-align: left;"><b>from </b>(<b>select </b><i>ID</i>, <b>rank</b>() <b>over </b>(<b>order by </b>(<i>GPA</i>) <b>desc</b>) <b>as </b><i>s rank</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1186.png"/></span></p><p class="s46" style="padding-left: 204pt;text-indent: 0pt;line-height: 11pt;text-align: left;">from <i>student grades</i><span class="p">)</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1187.png"/></span></p><p class="s46" style="padding-left: 177pt;text-indent: 0pt;line-height: 20pt;text-align: left;">where <i>s rank </i><span class="s83">&lt;</span><span class="s15">= </span><span class="p">5;</span></p><p style="padding-top: 5pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">This query does not necessarily give 5 students, since there could be ties. For example, if 2 students tie for ﬁfth, the result would contain a total of 6 tuples. Note that the bottom <i>n </i>is simply the same as the top <i>n </i>with a reverse sorting order.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">Several database systems provide nonstandard <span class="s44">SQL </span>syntax to specify directly that only the top <i>n </i>results are required. In our example, this would allow us to ﬁnd the top 5 students without the need to use the <b>rank </b>function. However, those constructs result in exactly the number of tuples speciﬁed (5 in our example), and so ties for the ﬁnal position are broken arbitrarily. The exact syntax for these “top <i>n</i>” queries varies widely among systems; see Note 5.4 on page 222. Note that the top <i>n </i>constructs do not support partitioning; so we cannot get the top <i>n </i>within each partition without performing ranking.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1188.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1189.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1190.png"/></span></p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">Several other functions can be used in place of <b>rank</b>. For instance, <b>percent rank </b>of a tuple gives the rank of the tuple as a fraction. If there are <i>n </i>tuples in the partition<span class="s76">12</span> and the rank of the tuple is <i>r</i>, then its percent rank is deﬁned as (<i>r </i><span class="s15">− </span>1)<span class="s15">∕</span>(<i>n </i><span class="s15">− </span>1) (and as <i>null </i>if there is only one tuple in the partition). The function <b>cume dist</b>, short for cumulative distribution, for a tuple is deﬁned as <i>p</i><span class="s15">∕</span><i>n </i>where <i>p </i>is the number of tuples in the partition with ordering values preceding or equal to the ordering value of the tuple and <i>n </i>is the number of tuples in the partition. The function <b>row number </b>sorts the rows and gives each row a unique number corresponding to its position in the sort order; diﬀerent rows with the same ordering value would get diﬀerent row numbers, in a nondeterministic fashion.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="96" height="1" alt="image" src="Image_1191.png"/></span></p><p class="s77" style="padding-top: 3pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">12 <span class="s78">The entire set is treated as a single partition if no explicit partition is used.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s73" style="padding-left: 215pt;text-indent: 0pt;text-align: left;">Note 5.4 <span class="s146">TOP-N QUERIES</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 97pt;text-indent: 0pt;text-align: justify;">Often, only the ﬁrst few tuples of a query result are required. This may occur in a ranking query where only top-ranked results are of interest. Another case where this may occur is in a query with an <b>order by </b>from which only the top values are of interest. Restricting results to the top-ranked results can be done using the <b>rank </b>function as we saw earlier, but that syntax is rather cumbersome. Many databases support a simpler syntax for such restriction, but the syntax varies widely among the leading database systems. We provide a few examples here.</p><p style="padding-left: 97pt;text-indent: 17pt;text-align: justify;">Some systems (including <span class="s44">M</span>y<span class="s44">SQL </span>and <span class="s44">P</span>ostgre<span class="s44">SQL</span>) allow a clause <b>limit </b><i>n </i>to be added at the end of an <span class="s44">SQL </span>query to specify that only the ﬁrst <i>n </i>tuples should be output. This clause can be used in conjunction with an <b>order by </b>clause to fetch the top <i>n </i>tuples, as illustrated by the following query, which retrieves the <span class="s44">ID </span>and <span class="s44">GPA </span>of the top 10 students in order of <span class="s44">GPA</span>:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="padding-left: 234pt;text-indent: 0pt;text-align: left;"><b>select </b>ID<span class="p">, </span>GPA <b>from </b>student grades <b>order by </b>GPA <b>desc limit </b><span class="p">10;</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 97pt;text-indent: 0pt;text-align: justify;">In <span class="s44">IBM DB2 </span>and the most recent versions of Oracle, the equivalent of the <b>limit </b>clause is <b>fetch first </b>10 <b>rows only</b>. Microsoft <span class="s44">SQL S</span>erver places its version of this feature in the <b>select </b>clause rather than adding a separate <b>limit </b>clause. The <b>select </b>clause is written as: <b>select top </b>10 <i>ID</i>, <i>GPA</i>.</p><p style="padding-left: 97pt;text-indent: 17pt;text-align: justify;">Oracle (both current and older versions) oﬀers the concept of a <i>row number </i>to provide this feature. A special, hidden attribute <i>rownum </i>numbers tuples ofa result relation in order of retrieval. This attribute can then be used in a <b>where </b>clause within a containing query. However, the use of this feature is a bit tricky, since the <i>rownum </i>is decided before rows are sorted by an <b>order by </b>clause. To use it properly, a nested query should be used as follows:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s46" style="padding-left: 220pt;text-indent: 0pt;text-align: left;">select <span class="p">*</span></p><p class="s46" style="padding-left: 220pt;text-indent: 0pt;text-align: left;">from <span class="p">(</span>select <i>ID</i><span class="p">, </span><i>GPA</i></p><p class="s46" style="padding-left: 247pt;text-indent: 0pt;text-align: left;">from <i>student grades</i></p><p class="s46" style="padding-top: 1pt;padding-left: 220pt;text-indent: 26pt;line-height: 84%;text-align: left;">order by <i>GPA </i>desc<span class="p">) </span>where <i>rownum </i><span class="s83">&lt;</span><span class="s15">= </span><span class="p">10;</span></p><p style="padding-top: 7pt;padding-left: 97pt;text-indent: 0pt;text-align: left;">The nested query ensures that the predicate on <i>rownum </i>is applied only after the</p><p class="s46" style="padding-left: 97pt;text-indent: 0pt;text-align: left;">order by <span class="p">is applied.</span></p><p style="padding-left: 97pt;text-indent: 17pt;text-align: left;">Some database systems have features allowing tuple limits to be exceeded in case of ties. See your system’s documentation for details.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="493" height="729" alt="image" src="Image_1192.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 4pt;padding-left: 119pt;text-indent: 17pt;text-align: justify;">Finally, for a given constant <i>n</i>, the ranking function <b>ntile</b>(<i>n</i>) takes the tuples in each partition in the speciﬁed order and divides them into <i>n </i>buckets with equal numbers of tuples.<span class="s76">13</span> For each tuple, <b>ntile</b>(<i>n</i>) then gives the number of the bucket in which it is placed, with bucket numbers starting with 1. This function is particularly useful for constructing histograms based on percentiles. We can show the quartile into which each student falls based on <span class="s44">GPA </span>by the following query:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s46" style="padding-left: 186pt;text-indent: 0pt;text-align: left;">select <i>ID</i><span class="p">, </span>ntile<span class="p">(4) </span>over <span class="p">(</span>order by <span class="p">(</span><i>GPA </i>desc<span class="p">)) </span>as <i>quartile</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1193.png"/></span></p><p class="s46" style="padding-left: 186pt;text-indent: 0pt;text-align: left;">from <i>student grades</i><span class="p">;</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s68" style="padding-top: 7pt;padding-left: 119pt;text-indent: 0pt;text-align: left;">5.5.2 Windowing</p><p style="padding-top: 6pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">Window queries compute an aggregate function over ranges of tuples. This is useful, for example, to compute an aggregate of a ﬁxed range of time; the time range is called a <i>window</i>. Windows may overlap, in which case a tuple may contribute to more than one window. This is unlike the partitions we saw earlier, where a tuple could contribute to only one partition.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">An example of the use of windowing is trend analysis. Consider our earlier sales example. Sales may ﬂuctuate widely from day to day based on factors like weather (e.g., a snowstorm, ﬂood, hurricane, or earthquake might reduce sales for a period of time). However, over a suﬃciently long period of time, ﬂuctuations might be less (continuing the example, sales may “make up” for weather-related downturns). Stock-market trend analysis is another example of the use of the windowing concept. Various “moving averages” are found on business and investment web sites.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">It is relatively easy to write an <span class="s44">SQL </span>query using those features we have already studied to compute an aggregate over one window, for example, sales over a ﬁxed 3- day period. However, if we want to do this for <i>every </i>3-day period, the query becomes cumbersome.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1194.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1195.png"/></span></p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;"><span class="s42">SQL </span><span class="s43">provides a windowing feature to support such queries. Suppose we are given a view </span><i>tot credits </i>(<i>year, num credits</i>) giving the total number of credits taken by students in each year.<span class="s76">14</span> Note that this relation can contain at most one tuple for each year. Consider the following query:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1196.png"/></span></p><p style="padding-left: 192pt;text-indent: 0pt;text-align: left;"><b>select </b><i>year</i>, <b>avg</b>(<i>num credits</i>)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1197.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1198.png"/></span></p><p class="s46" style="padding-left: 260pt;text-indent: 0pt;text-align: left;">over <span class="p">(</span>order by <i>year </i>rows <span class="p">3 </span>preceding<span class="p">) </span>as <i>avg total credits</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1199.png"/></span></p><p class="s46" style="padding-left: 51pt;text-indent: 0pt;text-align: center;">from <i>tot credits</i><span class="p">;</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="95" height="1" alt="image" src="Image_1200.png"/></span></p><p class="s77" style="padding-top: 3pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">13<span class="s78">If the total number of tuples in a partition is not divisible by </span><span class="s111">n</span><span class="s80">, then the number of tuples in each bucket can diﬀer by at most 1. Tuples with the same value for the ordering attribute may be assigned to diﬀerent buckets, nondeterministically, in order to make the number of tuples in each bucket equal.</span></p><p class="s77" style="padding-left: 119pt;text-indent: 0pt;line-height: 9pt;text-align: justify;">14<span class="s78">We leave the deﬁnition of this view in terms of our university example as an exercise.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1201.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1202.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1203.png"/></span></p><p style="padding-top: 4pt;padding-left: 88pt;text-indent: 0pt;text-align: justify;">This query computes averages over the three <i>preceding </i>tuples in the speciﬁed sort order. Thus, for 2019, if tuples for years 2018 and 2017 are present in the relation <i>tot credits</i>, since each year is represented by only one tuple, the result of the window deﬁnition is the average of the values for years 2017, 2018, and 2019. The averages each year would be computed in a similar manner. For the earliest year in the relation <i>tot credits</i>, the average would be over only that year itself, while for the next year, the average would be over 2 years. Note that this example makes sense only because each year appears only once in <i>tot weight</i>. Were this not the case, then there would be several possible orderings of tuples since tuples for the same year could be in any order. We shall see shortly a windowing query that uses a range of values instead of a speciﬁc number of tuples.</p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">Suppose that instead of going back a ﬁxed number of tuples, we want the window to consist of all prior years. That means the number of prior years considered is not ﬁxed. To get the average total credits over all prior years, we write:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1204.png"/></span></p><p style="padding-left: 142pt;text-indent: 0pt;text-align: left;"><b>select </b><i>year</i>, <b>avg</b>(<i>num credits</i>)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1205.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1206.png"/></span></p><p class="s46" style="padding-left: 206pt;text-indent: 0pt;text-align: left;">over <span class="p">(</span>order by <i>year </i>rows unbounded preceding<span class="p">) </span>as <i>avg total credits</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1207.png"/></span></p><p class="s46" style="padding-left: 142pt;text-indent: 0pt;text-align: left;">from <i>tot credits</i><span class="p">;</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">It is possible to use the keyword <b>following </b>in place of <b>preceding</b>. If we did this in our example, the <i>year </i>value speciﬁes the beginning of the window instead of the end. Similarly, we can specify a window beginning before the current tuple and ending after it:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1208.png"/></span></p><p style="padding-left: 110pt;text-indent: 0pt;text-align: left;"><b>select </b><i>year</i>, <b>avg</b>(<i>num credits</i>)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1209.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1210.png"/></span></p><p class="s46" style="padding-left: 174pt;text-indent: 0pt;text-align: left;">over <span class="p">(</span>order by <i>year </i>rows between <span class="p">3 </span>preceding and <span class="p">2 </span>following<span class="p">) </span>as <i>avg total credits</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1211.png"/></span></p><p class="s46" style="padding-left: 110pt;text-indent: 0pt;text-align: left;">from <i>tot credits</i><span class="p">;</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1212.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1213.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1214.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1215.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1216.png"/></span></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">In our example, all tuples pertain to the entire university. Suppose instead we have credit data for each department in a view <i>tot credits dept </i>(<i>dept name, year, num credits</i>) giving the total number of credits students took with the particular department in the speciﬁed year. (Again, we leave writing this view deﬁnition as an exercise.) We can write windowing queries that treat each department separately by partitioning by <i>dept name</i>:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1217.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1218.png"/></span></p><p style="padding-left: 111pt;text-indent: 0pt;text-align: left;"><b>select </b><i>dept name, year</i>, <b>avg</b>(<i>num credits</i>)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1219.png"/></span></p><p class="s46" style="padding-left: 175pt;text-indent: 0pt;text-align: left;">over <span class="p">(</span>partition by <i>dept name</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1220.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1221.png"/></span></p><p class="s46" style="padding-left: 175pt;text-indent: 21pt;text-align: left;">order by <i>year </i>rows between <span class="p">3 </span>preceding and current row<span class="p">) </span>as <i>avg total credits</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1222.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1223.png"/></span></p><p class="s46" style="padding-left: 111pt;text-indent: 0pt;text-align: left;">from <i>tot credits dept</i><span class="p">;</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:200.644pt" cellspacing="0"><tr style="height:14pt"><td style="width:59pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F" bgcolor="#C6E9FA"><p class="s71" style="padding-left: 7pt;text-indent: 0pt;line-height: 11pt;text-align: left;">item name</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F" bgcolor="#C6E9FA"><p class="s71" style="padding-left: 7pt;text-indent: 0pt;line-height: 11pt;text-align: left;">color</p></td><td style="width:61pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F" bgcolor="#C6E9FA"><p class="s71" style="padding-left: 7pt;text-indent: 0pt;line-height: 11pt;text-align: left;">clothes size</p></td><td style="width:49pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F" bgcolor="#C6E9FA"><p class="s71" style="padding-right: 6pt;text-indent: 0pt;line-height: 11pt;text-align: right;">quantity</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dress</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dark</p></td><td style="width:61pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">small</p></td><td style="width:49pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">2</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dress</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dark</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">medium</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">6</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dress</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dark</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">large</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 7pt;text-indent: 0pt;line-height: 12pt;text-align: right;">12</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dress</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pastel</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">small</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">4</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dress</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pastel</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">medium</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">3</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dress</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pastel</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">large</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">3</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dress</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">white</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">small</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">2</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dress</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">white</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">medium</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">3</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dress</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">white</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">large</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">0</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pants</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dark</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">small</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 7pt;text-indent: 0pt;line-height: 12pt;text-align: right;">14</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pants</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dark</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">medium</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">6</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pants</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dark</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">large</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">0</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pants</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pastel</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">small</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">1</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pants</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pastel</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">medium</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">0</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pants</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pastel</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">large</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">1</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pants</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">white</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">small</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">3</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pants</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">white</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">medium</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">0</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pants</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">white</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">large</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">2</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">shirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dark</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">small</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">2</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">shirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dark</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">medium</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">6</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">shirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dark</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">large</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">6</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">shirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pastel</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">small</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">4</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">shirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pastel</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">medium</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">1</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">shirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pastel</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">large</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">2</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">shirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">white</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">small</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 7pt;text-indent: 0pt;line-height: 12pt;text-align: right;">17</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">shirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">white</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">medium</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">1</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">shirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">white</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">large</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 7pt;text-indent: 0pt;line-height: 12pt;text-align: right;">10</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">skirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dark</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">small</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">2</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">skirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dark</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">medium</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">5</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">skirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dark</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">large</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">1</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">skirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pastel</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">small</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 7pt;text-indent: 0pt;line-height: 12pt;text-align: right;">11</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">skirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pastel</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">medium</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">9</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">skirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pastel</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">large</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 7pt;text-indent: 0pt;line-height: 12pt;text-align: right;">15</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">skirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">white</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">small</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">2</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">skirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">white</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">medium</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">5</p></td></tr><tr style="height:14pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">skirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">white</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">large</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">3</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1224.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1225.png"/></span></p><p class="s74" style="padding-top: 4pt;padding-left: 215pt;text-indent: 0pt;text-align: left;"><span class="s73">Figure 5.17 </span>An example of <span class="s91">sales </span>relation.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:159.244pt" cellspacing="0"><tr style="height:14pt"><td style="width:59pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F" bgcolor="#C6E9FA"><p class="s71" style="padding-left: 7pt;text-indent: 0pt;line-height: 11pt;text-align: left;">item name</p></td><td style="width:61pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F" bgcolor="#C6E9FA"><p class="s71" style="padding-left: 7pt;text-indent: 0pt;line-height: 11pt;text-align: left;">clothes size</p></td><td style="width:34pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F" bgcolor="#C6E9FA"><p class="s71" style="padding-right: 6pt;text-indent: 0pt;line-height: 11pt;text-align: right;">dark</p></td><td style="width:38pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F" bgcolor="#C6E9FA"><p class="s71" style="padding-right: 6pt;text-indent: 0pt;line-height: 11pt;text-align: right;">pastel</p></td><td style="width:37pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F" bgcolor="#C6E9FA"><p class="s71" style="padding-right: 6pt;text-indent: 0pt;line-height: 11pt;text-align: right;">white</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dress</p></td><td style="width:61pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">small</p></td><td style="width:34pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">2</p></td><td style="width:38pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">4</p></td><td style="width:37pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">2</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dress</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">medium</p></td><td style="width:34pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">6</p></td><td style="width:38pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">3</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">3</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dress</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">large</p></td><td style="width:34pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 7pt;text-indent: 0pt;line-height: 12pt;text-align: right;">12</p></td><td style="width:38pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">3</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">0</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pants</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">small</p></td><td style="width:34pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 7pt;text-indent: 0pt;line-height: 12pt;text-align: right;">14</p></td><td style="width:38pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">1</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">3</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pants</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">medium</p></td><td style="width:34pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">6</p></td><td style="width:38pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">0</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">0</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pants</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">large</p></td><td style="width:34pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">0</p></td><td style="width:38pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">1</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">2</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">shirt</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">small</p></td><td style="width:34pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">2</p></td><td style="width:38pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">4</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 7pt;text-indent: 0pt;line-height: 12pt;text-align: right;">17</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">shirt</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">medium</p></td><td style="width:34pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">6</p></td><td style="width:38pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">1</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">1</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">shirt</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">large</p></td><td style="width:34pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">6</p></td><td style="width:38pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">2</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 7pt;text-indent: 0pt;line-height: 12pt;text-align: right;">10</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">skirt</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">small</p></td><td style="width:34pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">2</p></td><td style="width:38pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 7pt;text-indent: 0pt;line-height: 12pt;text-align: right;">11</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">2</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">skirt</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">medium</p></td><td style="width:34pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">5</p></td><td style="width:38pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">9</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">5</p></td></tr><tr style="height:14pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">skirt</p></td><td style="width:61pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">large</p></td><td style="width:34pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">1</p></td><td style="width:38pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 7pt;text-indent: 0pt;line-height: 12pt;text-align: right;">15</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">3</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1226.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1227.png"/></span></p><p class="s74" style="padding-top: 4pt;padding-left: 59pt;text-indent: 0pt;text-align: center;"><span class="s73">Figure 5.18 </span>Result of <span class="s157">SQL </span>pivot operation on the <span class="s91">sales </span>relation of Figure 5.17.</p><p style="padding-top: 8pt;padding-left: 88pt;text-indent: 17pt;text-align: justify;">The use of the keyword <b>range </b>in place of <b>row </b>allows the windowing query to cover all tuples with a particular value rather than covering a speciﬁc number of tuples. Thus for example, <b>rows current row </b>refers to exactly one tuple, while <b>range current row </b>refers to all tuples whose value for the <i>sort </i>attribute is the same as that of the current tuple. The <b>range </b>keyword is not implemented fully in every system.<span class="s76">15</span></p><p class="s68" style="padding-top: 11pt;padding-left: 88pt;text-indent: 0pt;text-align: left;">5.5.3 Pivoting</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1228.png"/></span></p><p style="padding-top: 6pt;padding-left: 88pt;text-indent: 0pt;text-align: justify;">Consider an application where a shop wants to ﬁnd out what kinds of clothes are pop- ular. Let us suppose that clothes are characterized by their item name, color, and size, and that we have a relation <i>sales </i>with the schema.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1229.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1230.png"/></span></p><p class="s13" style="padding-left: 56pt;text-indent: 0pt;text-align: center;">sales <span class="p">(</span>item name<span class="p">, </span>color<span class="p">, </span>clothes size<span class="p">, </span>quantity<span class="p">)</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1231.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1232.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1233.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1234.png"/></span></p><p style="padding-left: 88pt;text-indent: 0pt;text-align: justify;">Suppose that <i>item name </i>can take on the values (skirt, dress, shirt, pants), <i>color </i>can take on the values (dark, pastel, white), <i>clothes size </i>can take on values (small, medium, large), and <i>quantity </i>is an integer value representing the total number of items sold of a given (<i>item name</i>, <i>color</i>, <i>clothes size</i>) combination. An instance of the <i>sales </i>relation is shown in Figure 5.17.</p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">Figure 5.18 shows an alternative way to view the data that is present in Figure 5.17; the values “dark”, “pastel”, and “white” of attribute <i>color </i>have become attribute names in Figure 5.18. The table in Figure 5.18 is an example of a <span class="s63">cross-tabulation </span>(or <span class="s63">cross-tab</span>, for short), also referred to as a <span class="s63">pivot-table</span>.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1235.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1236.png"/></span></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">The values of the new attributes <i>dark, pastel </i>and <i>white </i>in our example are deﬁned as follows. For a particular combination of <i>item name</i>, <i>clothes size </i>(e.g., (“dress”, “dark”))</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 88pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="95" height="1" alt="image" src="Image_1237.png"/></span></p><p class="s78" style="padding-top: 3pt;padding-left: 88pt;text-indent: 0pt;text-align: justify;"><span class="s77">15</span>Some systems, such as <span class="s153">P</span>ostgre<span class="s153">SQL</span>, allow <b>range </b><span class="s80">only with </span><b>unbounded</b><span class="s80">.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 4pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">if there is a single tuple with <i>color </i>value “dark”, the <i>quantity </i>value of that attribute ap- pears as the value for the attribute <i>dark</i>. If there are multiple such tuples, the values are aggregated using the <b>sum </b>aggregate in our example; in general other aggregate func- tions could be used instead. Values for the other two attributes, <i>pastel </i>and <i>white</i>, are similarly deﬁned.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">In general, a cross-tab is a table derived from a relation (say, <i>R</i>), where values for some attribute of relation <i>R </i>(say, <i>A</i>) become attribute names in the result; the attribute <i>A </i>is the <span class="s63">pivot </span>attribute. Cross-tabs are widely used for data analysis, and are discussed in more detail in Section 11.3.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">Several <span class="s44">SQL </span>implementations, such as Microsoft <span class="s44">SQL S</span>erver, and Oracle, support a <b>pivot </b>clause that allows creation of cross-tabs. Given the <i>sales </i>relation from Figure 5.17, the query:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s46" style="padding-top: 4pt;padding-left: 219pt;text-indent: 0pt;text-align: left;">select <span class="p">* </span>from <i>sales </i>pivot <span class="p">(</span></p><p style="padding-left: 240pt;text-indent: 0pt;text-align: left;"><b>sum</b>(<i>quantity</i>)</p><p class="s46" style="padding-left: 240pt;text-indent: 0pt;text-align: left;">for <i>color </i>in <span class="p">(’dark’, ’pastel’, ’white’)</span></p><p style="text-indent: 0pt;text-align: center;">)</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: 0pt;text-align: justify;">returns the result shown in Figure 5.18.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">Note that the <b>for </b>clause within the <b>pivot </b>clause speciﬁes (i) a pivot attribute (<i>color</i>, in the above query), (ii) the values of that attribute that should appear as attribute names in the pivot result (dark, pastel and white, in the above query), and (iii) the aggregate function that should be used to compute the value of the new attributes (ag- gregate function <b>sum</b>, on the attribute <i>quantity</i>, in the above query).</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">The attribute <i>color </i>and <i>quantity </i>do not appear in the result, but all other attributes are retained. In case more than one tuple contributes values to a given cell, the aggregate operation within the <b>pivot </b>clause speciﬁes how the values should be combined. In the above example, the <i>quantity </i>values are aggregated using the <b>sum </b>function.</p><p style="padding-left: 119pt;text-indent: 17pt;text-align: justify;">A query using <b>pivot </b>can be written using basic <span class="s44">SQL </span>constructs, without using the pivot construct, but the construct simpliﬁes the task of writing such queries.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s68" style="padding-left: 119pt;text-indent: 0pt;text-align: left;">5.5.4 Rollup and Cube</p><p class="s46" style="padding-top: 6pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;"><span class="s42">SQL </span><span class="s43">supports generalizations of the </span>group by <span class="p">construct using the </span>rollup <span class="p">and </span>cube <span class="p">op- erations, which allow multiple </span>group by <span class="p">queries to be run in a single query, with the result returned as a single relation.</span></p><p style="padding-left: 137pt;text-indent: 0pt;text-align: justify;">Consider again our retail shop example and the relation:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1238.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1239.png"/></span></p><p class="s13" style="padding-left: 207pt;text-indent: 0pt;text-align: left;">sales <span class="p">(</span>item name<span class="p">, </span>color<span class="p">, </span>clothes size<span class="p">, </span>quantity<span class="p">)</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: 0pt;text-align: left;">We can ﬁnd the number of items sold in each item name by writing a simple <b>group by</b></p><p style="padding-left: 119pt;text-indent: 0pt;text-align: left;">query:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1240.png"/></span></p><p style="padding-top: 4pt;padding-left: 180pt;text-indent: 0pt;text-align: left;"><b>select </b><i>item name</i>, <b>sum</b>(<i>quantity</i>) <b>as </b><i>quantity</i></p><p class="s46" style="padding-left: 180pt;text-indent: 0pt;text-align: left;">from <i>sales</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1241.png"/></span></p><p class="s46" style="padding-left: 180pt;text-indent: 0pt;text-align: left;">group by <i>item name</i><span class="p">;</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">Similarly, we can ﬁnd the number of items sold in each color, and each size. We can further ﬁnd a breakdown of sales by item-name and color by writing:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1242.png"/></span></p><p style="padding-left: 167pt;text-indent: 0pt;text-align: left;"><b>select </b><i>item name</i>, <i>color</i>, <b>sum</b>(<i>quantity</i>) <b>as </b><i>quantity</i></p><p class="s46" style="padding-left: 167pt;text-indent: 0pt;text-align: left;">from <i>sales</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1243.png"/></span></p><p class="s13" style="padding-left: 167pt;text-indent: 0pt;text-align: left;"><b>group by </b>item name<span class="p">, </span>color <span class="p">;</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1244.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1245.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1246.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1247.png"/></span></p><p style="padding-left: 88pt;text-indent: 0pt;text-align: justify;">Similarly, a query with <b>group by </b><i>item name</i>, <i>color</i>, <i>clothes size </i>would allow us to see the sales breakdown by (<i>item name</i>, <i>color</i>, <i>clothes size</i>) combinations.</p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">Data analysts often need to view data aggregated in multiple ways as illustrated above. The <span class="s44">SQL </span><b>rollup </b>and <b>cube </b>constructs provide a concise way to get multiple such aggregates using a single query, instead of writing multiple queries.</p><p style="padding-left: 106pt;text-indent: 0pt;text-align: justify;">The <b>rollup </b>construct is illustrated using the following query:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1248.png"/></span></p><p style="padding-left: 192pt;text-indent: 0pt;text-align: left;"><b>select </b><i>item name</i>, <i>color</i>, <b>sum</b>(<i>quantity</i>) <b>from </b><i>sales</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1249.png"/></span></p><p style="padding-left: 192pt;text-indent: 0pt;text-align: left;"><b>group by rollup</b>(<i>item name</i>, <i>color</i>);</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 88pt;text-indent: 0pt;text-align: justify;">The result of the query is shown in Figure 5.19. The above query is equivalent to the following query using the <b>union </b>operation.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1250.png"/></span></p><p style="padding-left: 134pt;text-indent: 0pt;text-align: left;">(<b>select </b><i>item name</i>, <i>color</i>, <b>sum</b>(<i>quantity</i>) <b>as </b><i>quantity</i></p><p class="s46" style="padding-left: 134pt;text-indent: 0pt;text-align: left;">from <i>sales</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1251.png"/></span></p><p class="s13" style="padding-left: 134pt;text-indent: 0pt;text-align: left;"><b>group by </b>item name<span class="p">, </span>color<span class="p">)</span></p><p class="s46" style="padding-left: 134pt;text-indent: 0pt;text-align: left;">union</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1252.png"/></span></p><p style="padding-left: 134pt;text-indent: 0pt;text-align: left;">(<b>select </b><i>item name</i>, <i>null </i><b>as </b><i>color</i>, <b>sum</b>(<i>quantity</i>) <b>as </b><i>quantity</i></p><p class="s46" style="padding-left: 134pt;text-indent: 0pt;text-align: left;">from <i>sales</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1253.png"/></span></p><p class="s46" style="padding-left: 134pt;text-indent: 0pt;text-align: left;">group by <i>item name</i><span class="p">)</span></p><p class="s46" style="padding-left: 134pt;text-indent: 0pt;text-align: left;">union</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1254.png"/></span></p><p class="s13" style="padding-left: 134pt;text-indent: 0pt;text-align: left;"><span class="p">(</span><b>select </b>null <b>as </b>item name<span class="p">, </span>null <b>as </b>color<span class="p">, </span><b>sum</b><span class="p">(</span>quantity<span class="p">) </span><b>as </b>quantity</p><p class="s46" style="padding-left: 134pt;text-indent: 0pt;text-align: left;">from <i>sales</i><span class="p">)</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1255.png"/></span></p><p style="padding-left: 88pt;text-indent: 0pt;text-align: justify;">The construct <b>group by rollup</b>(<i>item name</i>, <i>color</i>) generates 3 groupings:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1256.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1257.png"/></span></p><p style="padding-left: 190pt;text-indent: 0pt;text-align: left;"><span class="s95">{ </span>(<i>item name</i>, <i>color</i>), (<i>item name</i>), () <span class="s95">}</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 88pt;text-indent: 0pt;text-align: justify;">where () denotes an empty <b>group by </b>list. Observe that a grouping is present for each preﬁx of the attributes listed in the <b>rollup </b>clause, including the empty preﬁx. The query result contains the union of the results by these groupings. The diﬀerent groupings generate diﬀerent schemas; to bring the results of the diﬀerent groupings to a common</p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:231.124pt" cellspacing="0"><tr style="height:14pt"><td style="width:59pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F" bgcolor="#C6E9FA"><p class="s71" style="padding-left: 7pt;text-indent: 0pt;line-height: 11pt;text-align: left;">item name</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F" bgcolor="#C6E9FA"><p class="s71" style="padding-left: 7pt;text-indent: 0pt;line-height: 11pt;text-align: left;">color</p></td><td style="width:49pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F" bgcolor="#C6E9FA"><p class="s71" style="padding-right: 6pt;text-indent: 0pt;line-height: 11pt;text-align: right;">quantity</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">skirt</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dark</p></td><td style="width:49pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">8</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">skirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pastel</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">35</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">skirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">white</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 7pt;text-indent: 0pt;line-height: 12pt;text-align: right;">10</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dress</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dark</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">20</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dress</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pastel</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 7pt;text-indent: 0pt;line-height: 12pt;text-align: right;">10</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dress</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">white</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">5</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">shirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dark</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 7pt;text-indent: 0pt;line-height: 12pt;text-align: right;">14</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">shirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pastel</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">7</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">shirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">white</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">28</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pants</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dark</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">20</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pants</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pastel</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">2</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pants</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">white</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">5</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">skirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s71" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">null</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">53</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dress</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s71" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">null</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">35</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">shirt</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s71" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">null</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">49</p></td></tr><tr style="height:13pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">pants</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s71" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">null</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 7pt;text-indent: 0pt;line-height: 12pt;text-align: right;">27</p></td></tr><tr style="height:14pt"><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s71" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">null</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s71" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">null</p></td><td style="width:49pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-right: 6pt;text-indent: 0pt;line-height: 12pt;text-align: right;">164</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1258.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1259.png"/></span></p><p class="s74" style="padding-top: 4pt;padding-left: 84pt;text-indent: 0pt;text-align: center;"><span class="s73">Figure 5.19 </span>Query result: <span class="s146">group by rollup </span>(<span class="s91">item name</span>, <span class="s91">color</span>).</p><p style="padding-top: 8pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">schema, tuples in the result contain <i>null </i>as the value of those attributes not present in a particular grouping.<span class="s76">16</span></p><p style="padding-left: 119pt;text-indent: 17pt;text-align: left;">The <b>cube </b>construct generates an even larger number of groupings, consisting of <i>all subsets </i>of the attributes listed in the <b>cube </b>construct. For example, the query:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1260.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1261.png"/></span></p><p style="padding-left: 197pt;text-indent: 0pt;text-align: left;"><b>select </b><i>item name</i>, <i>color</i>, <i>clothes size</i>, <b>sum</b>(<i>quantity</i>) <b>from </b><i>sales</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1262.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1263.png"/></span></p><p style="padding-left: 119pt;text-indent: 78pt;line-height: 192%;text-align: left;"><b>group by cube</b>(<i>item name</i>, <i>color</i>, <i>clothes size</i>); generates the following groupings:</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1264.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1265.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1266.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1267.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1268.png"/></span></p><p style="padding-left: 84pt;text-indent: 0pt;line-height: 12pt;text-align: center;"><span class="s95">{ </span>(<i>item name</i>, <i>color</i>, <i>clothes size</i>), (<i>item name</i>, <i>color</i>), (<i>item name</i>, <i>clothes size</i>),</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1269.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1270.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1271.png"/></span></p><p style="padding-left: 84pt;text-indent: 0pt;line-height: 13pt;text-align: center;">(<i>color</i>, <i>clothes size</i>), (<i>item name</i>), (<i>color</i>), (<i>clothes size</i>), () <span class="s95">}</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: 0pt;text-align: justify;">To bring the results of the diﬀerent groupings to a common schema, as with <b>rollup</b>, tu- ples in the result contain <i>null </i>as the value of those attributes not present in a particular grouping.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="96" height="1" alt="image" src="Image_1272.png"/></span></p><p class="s79" style="padding-top: 3pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;"><span class="s77">16</span><span class="s78">The </span><span class="s153">SQL </span>outer union <span class="s80">operation can be used to perform a union of relations that may not have a common schema. The resultant schema has the union of all the attributes across the inputs; each input tuple is mapped to an output tuple by adding all the attributes missing in that tuple, with the value set to null. Our union query can be written using outer union, and in that case we do not need to explicitly generate null-value attributes using </span><i>null </i>as <span class="s80">attribute-name constructs, as we have done in the above query.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 4pt;padding-left: 88pt;text-indent: 17pt;text-align: justify;">Multiple <b>rollup</b>s and <b>cube</b>s can be used in a single <b>group by </b>clause. For instance, the following query:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1273.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1274.png"/></span></p><p style="padding-left: 157pt;text-indent: 0pt;text-align: left;"><b>select </b><i>item name</i>, <i>color</i>, <i>clothes size</i>, <b>sum</b>(<i>quantity</i>) <b>from </b><i>sales</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1275.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1276.png"/></span></p><p style="padding-left: 88pt;text-indent: 68pt;line-height: 194%;text-align: left;"><b>group by rollup</b>(<i>item name</i>), <b>rollup</b>(<i>color</i>, <i>clothes size</i>); generates the groupings:</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1277.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1278.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1279.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1280.png"/></span></p><p style="padding-left: 59pt;text-indent: 0pt;line-height: 12pt;text-align: center;"><span class="s95">{ </span>(<i>item name</i>, <i>color</i>, <i>clothes size</i>), (<i>item name</i>, <i>color</i>), (<i>item name</i>),</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1281.png"/></span></p><p style="padding-left: 84pt;text-indent: 0pt;line-height: 13pt;text-align: center;">(<i>color</i>, <i>clothes size</i>), (<i>color</i>), () <span class="s95">}</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1282.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1283.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1284.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1285.png"/></span></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">To understand why, observe that <b>rollup</b>(<i>item name</i>) generates a set of two group- ings, <span class="s95">{</span>(<i>item name</i>), ()<span class="s95">}</span>, while <b>rollup</b>(<i>color</i>, <i>clothes size</i>) generates a set of three group- ings, <span class="s95">{</span>(<i>color</i>, <i>clothes size</i>), (<i>color</i>), () <span class="s95">}</span>. The Cartesian product of the two sets gives us the six groupings shown.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1286.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1287.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1288.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1289.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1290.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1291.png"/></span></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">Neither the <b>rollup </b>nor the <b>cube </b>clause gives complete control on the groupings that are generated. For instance, we cannot use them to specify that we want only groupings <span class="s95">{</span>(<i>color</i>, <i>clothes size</i>), (<i>clothes size</i>, <i>item name</i>)<span class="s95">}</span>. Such restricted groupings can be generated by using the <b>grouping sets </b>construct, in which one can specify the speciﬁc list of groupings to be used. To obtain only groupings <span class="s95">{</span>(<i>color</i>, <i>clothes size</i>), (<i>clothes size</i>, <i>item name</i>)<span class="s95">}</span>, we would write:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1292.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1293.png"/></span></p><p style="padding-left: 122pt;text-indent: 0pt;text-align: left;"><b>select </b><i>item name</i>, <i>color</i>, <i>clothes size</i>, <b>sum</b>(<i>quantity</i>) <b>from </b><i>sales</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1294.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1295.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1296.png"/></span></p><p style="padding-left: 122pt;text-indent: 0pt;text-align: left;"><b>group by grouping sets </b>((<i>color</i>, <i>clothes size</i>), (<i>clothes size</i>, <i>item name</i>));</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">Analysts may want to distinguish those nulls generated by <b>rollup </b>and <b>cube </b>opera- tions from “normal” nulls actually stored in the database or arising from an outer join. The <b>grouping</b>() function returns 1 if its argument is a null value generated by a <b>rollup </b>or <b>cube </b>and 0 otherwise (note that the <b>grouping </b>function is diﬀerent from the <b>grouping sets </b>construct). If we wish to display the <b>rollup </b>query result shown in Figure 5.19, but using the value “all” in place of nulls generated by <b>rollup</b>, we can use the query:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1297.png"/></span></p><p style="padding-left: 162pt;text-indent: 0pt;text-align: left;"><b>select </b>(<b>case when grouping</b>(<i>item name</i>)=1 <b>then </b>’<b>all</b>’</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1298.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1299.png"/></span></p><p class="s46" style="padding-left: 183pt;text-indent: 21pt;text-align: left;">else <i>item name </i>end<span class="p">) </span>as <i>item name</i><span class="p">, (</span>case when grouping<span class="p">(</span><i>color</i><span class="p">) = 1 </span>then <span class="p">’</span>all<span class="p">’</span></p><p class="s46" style="padding-left: 204pt;text-indent: 0pt;text-align: left;">else <i>color </i>end<span class="p">) </span>as <i>color</i><span class="p">,</span></p><p style="padding-left: 162pt;text-indent: 0pt;text-align: left;"><b>sum</b>(<i>quantity</i>) <b>as </b><i>quantity</i></p><p class="s46" style="padding-left: 162pt;text-indent: 0pt;text-align: left;">from <i>sales</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1300.png"/></span></p><p style="padding-left: 162pt;text-indent: 0pt;text-align: left;"><b>group by rollup</b>(<i>item name</i>, <i>color</i>);</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">One might consider using the following query using <b>coalesce</b>, but it would incor- rectly convert null item names and colors to <b>all</b>:</p><p class="s66" style="padding-top: 3pt;padding-left: 119pt;text-indent: 0pt;text-align: right;"><a name="bookmark74">Review Terms  </a><span class="s164">231</span><a name="bookmark114">&zwnj;</a></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1301.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1302.png"/></span></p><p style="padding-top: 4pt;padding-left: 206pt;text-indent: 0pt;text-align: left;"><b>select coalesce </b>(<i>item name</i>,’<b>all</b>’) <b>as </b><i>item name</i>,</p><p style="padding-left: 227pt;text-indent: 0pt;text-align: left;"><b>coalesce </b>(<i>color</i>,’<b>all</b>’) <b>as </b><i>color</i>,</p><p style="padding-left: 206pt;text-indent: 0pt;text-align: left;"><b>sum</b>(<i>quantity</i>) <b>as </b><i>quantity</i></p><p class="s46" style="padding-left: 206pt;text-indent: 0pt;text-align: left;">from <i>sales</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1303.png"/></span></p><p style="padding-left: 206pt;text-indent: 0pt;text-align: left;"><b>group by rollup</b>(<i>item name</i>, <i>color</i>);</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part121.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part123.htm">下一个 &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
