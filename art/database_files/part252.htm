<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>13.7  Storage Organization in Main-Memory Databases</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part251.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part253.htm">下一个 &gt;</a></p><p class="s65" style="padding-left: 72pt;text-indent: 0pt;text-align: left;">13.7  <span style=" color: #00AEEF;">Storage Organization in Main-Memory Databases</span></p><p style="padding-top: 12pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">Today, main-memory sizes are large enough, and main memory is cheap enough, that many organizational databases ﬁt entirely in memory. Such large main memories can be used by allocating a large amount of memory to the database buﬀer, which will allow the entire database to be loaded into buﬀer, avoiding disk <span class="s44">I/O </span>operations for reading data; updated blocks still have to be written back to disk for persistence. Thus, such a setup would provide much better performance than one where only part of the database can ﬁt in the buﬀer.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="96" height="1" alt="image" src="Image_2603.png"/></span></p><p class="s77" style="padding-top: 3pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">8<span class="s78">Compression can be applied to data in a disk block, but accessing them requires decompression, and the decom- pressed data may no longer ﬁt in a block. Signiﬁcant changes need to be made to the database code, including buﬀer management, to handle such issues.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 4pt;padding-left: 88pt;text-indent: 17pt;text-align: justify;">However, if the entire database ﬁts in memory, performance can be improved sig- niﬁcantly by tailoring the storage organization and database data structures to exploit the fact that data are fully in memory. A <span class="s63">main-memory database </span>is a database where all data reside in memory; main-memory database systems are typically designed to optimize performance by making use of this fact. In particular, they do away entirely with the buﬀer manager.</p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">As an example of optimizations that can be done with memory-resident data, con- sider the cost of accessing a record, given a record pointer. With disk-based databases, records are stored in blocks, and pointers to records consist of a block identiﬁer and an oﬀset or slot number within the block. Following such a record pointer requires checking if the block is in the buﬀer (usually done by using an in-memory hash index), and if it is, ﬁnding where in the buﬀer it is located. If it is not in buﬀer, it has to be fetched. All these actions take a signiﬁcant number of <span class="s44">CPU </span>cycles.</p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">In contrast, in a main-memory database, it is possible to keep direct pointers to records in memory, and accessing a record is just an in-memory pointer traversal, which is a very eﬃcient operation. This is possible as long as records are not moved around. Indeed, one reason for such movement, namely loading into buﬀer and eviction from buﬀer, is no longer an issue.</p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">If records are stored in a slotted-page structure within a block, records may move within a block as other records are deleted or resized. Direct pointers to records are not possible in that case, although records can be accessed with one level of indirection through the entries in the slotted page header. Locking of the block may be required to ensure that a record does not get moved while another process is reading its data. To avoid these overheads, many main-memory databases do not use a slotted-page struc- ture for allocating records. Instead they directly allocate records in main memory, and ensure that records never get moved due to updates to other records. However, a prob- lem with direct allocation of records is that memory may get fragmented if variable sized records are repeatedly inserted and deleted. The database must ensure that main memory does not get fragmented over time, either by using suitably designed memory management schemes or by periodically performing compaction of memory; the latter scheme will result in record movement, but it can be done without acquiring locks on blocks.</p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">If a column-oriented storage scheme is used in main memory, all the values of a column can be stored in consecutive memory locations. However, if there are ap- pends to the relation, ensuring contiguous allocation would require existing data be reallocated. To avoid this overhead, the logical array for a column may be divided into multiple physical arrays. An indirection table stores pointers to all the physical arrays. This scheme is depicted in Figure 13.16. To ﬁnd the <i>i</i>th element of a logical array, the indirection table is used to locate the physical array containing the <i>i</i>th element, and then an appropriate oﬀset is computed and looked up within that physical array.</p><p style="padding-left: 88pt;text-indent: 17pt;text-align: justify;">There are other ways in which processing can be optimized with main-memory databases, as we shall see in later chapters.</p><p class="s66" style="padding-top: 3pt;padding-left: 119pt;text-indent: 0pt;text-align: right;"><a name="bookmark272">13.8 </a><span style=" color: #00AEEF;">Summary  </span><span class="s164">617</span><a name="bookmark306">&zwnj;</a></p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:341.293pt" cellspacing="0"><tr style="height:17pt"><td style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#D2EEFC"><p class="s324" style="padding-top: 3pt;padding-left: 4pt;padding-right: 4pt;text-indent: 0pt;text-align: center;">Col1 Data</p></td></tr><tr style="height:17pt"><td style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#D2EEFC"><p class="s324" style="padding-top: 3pt;padding-left: 4pt;padding-right: 4pt;text-indent: 0pt;text-align: center;">Col2 Data</p></td></tr><tr style="height:17pt"><td style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#D2EEFC"><p class="s324" style="padding-top: 3pt;padding-left: 4pt;padding-right: 4pt;text-indent: 0pt;text-align: center;">Col3 Data</p></td></tr><tr style="height:17pt"><td style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#D2EEFC"><p class="s324" style="padding-top: 3pt;padding-left: 4pt;padding-right: 4pt;text-indent: 0pt;text-align: center;">Col4 Data</p></td></tr><tr style="height:17pt"><td style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#D2EEFC"><p class="s324" style="padding-top: 3pt;padding-left: 4pt;padding-right: 4pt;text-indent: 0pt;text-align: center;">Col5 Data</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:341.293pt" cellspacing="0"><tr style="height:17pt"><td style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#D2EEFC"><p class="s324" style="padding-top: 3pt;padding-left: 4pt;padding-right: 4pt;text-indent: 0pt;text-align: center;">Col1 Data</p></td></tr><tr style="height:17pt"><td style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#D2EEFC"><p class="s324" style="padding-top: 3pt;padding-left: 4pt;padding-right: 4pt;text-indent: 0pt;text-align: center;">Col2 Data</p></td></tr><tr style="height:17pt"><td style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#D2EEFC"><p class="s324" style="padding-top: 3pt;padding-left: 4pt;padding-right: 4pt;text-indent: 0pt;text-align: center;">Col3 Data</p></td></tr><tr style="height:17pt"><td style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#D2EEFC"><p class="s324" style="padding-top: 3pt;padding-left: 4pt;padding-right: 4pt;text-indent: 0pt;text-align: center;">Col4 Data</p></td></tr><tr style="height:17pt"><td style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#D2EEFC"><p class="s324" style="padding-top: 3pt;padding-left: 4pt;padding-right: 4pt;text-indent: 0pt;text-align: center;">Col5 Data</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="147" height="328" alt="image" src="Image_2604.png"/></span></p><table style="border-collapse:collapse" cellspacing="0"><tr style="height:17pt"><td style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#D2EEFC"><p class="s324" style="padding-top: 3pt;padding-left: 4pt;padding-right: 4pt;text-indent: 0pt;text-align: center;">Col1 Data</p></td></tr><tr style="height:17pt"><td style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#D2EEFC"><p class="s324" style="padding-top: 3pt;padding-left: 4pt;padding-right: 4pt;text-indent: 0pt;text-align: center;">Col2 Data</p></td></tr><tr style="height:17pt"><td style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#D2EEFC"><p class="s324" style="padding-top: 3pt;padding-left: 4pt;padding-right: 4pt;text-indent: 0pt;text-align: center;">Col3 Data</p></td></tr><tr style="height:17pt"><td style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#D2EEFC"><p class="s324" style="padding-top: 3pt;padding-left: 4pt;padding-right: 4pt;text-indent: 0pt;text-align: center;">Col4 Data</p></td></tr><tr style="height:17pt"><td style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" bgcolor="#D2EEFC"><p class="s324" style="padding-top: 3pt;padding-left: 4pt;padding-right: 4pt;text-indent: 0pt;text-align: center;">Col5 Data</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><p class="s325" style="padding-top: 5pt;padding-left: 9pt;text-indent: 0pt;text-align: center;">Indirection Table</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part251.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part253.htm">下一个 &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
