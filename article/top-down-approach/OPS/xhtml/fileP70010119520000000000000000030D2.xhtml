<?xml version="1.0" encoding="utf-8"?><html xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:svg="http://www.w3.org/2000/svg" xmlns:epub="http://www.idpf.org/2007/ops" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" epub:prefix="index: http://www.index.com/"><head>
<meta name="dcterms.conformsTo" content="PXE Basic 1.0"></meta>
<meta name="generator" content="PXE Tools version 1.39.109"></meta>
<!--Created by pxe.pl for standard version PXE Basic 1.0,data-profile-product=standard by PXE Tools 1.39.109, partial=false-->
<title>8.8 Securing Wireless LANs</title><link rel="alternate stylesheet" type="text/css" title="sepia" href="../css/sepia.css"></link><link rel="alternate stylesheet" type="text/css" title="night" href="../css/night.css"></link><link rel="stylesheet" type="text/css" title="day" href="../css/main.css"></link><link rel="stylesheet" type="text/css" title="day" href="../css/print.css"></link>
<script src="js/format_lg_obj.js"></script>
</head><body epub:type="bodymatter">
<section id="P70010119520000000000000000030D2" class="level1"><header><h1 class="title" id="P700101195200000000000000000B894" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B894" epub:type="title"><span class="pagebreak" title="646" id="P70010119520000000000000000030D4" data-uri="M08_KURO4140_07_SE_C08.xhtml#P70010119520000000000000000030D4" epub:type="pagebreak" role="doc-pagebreak"></span><span class="number">8.8</span> Securing Wireless LANs</h1></header>
<p id="P700101195200000000000000000B895" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B895">Security is a particularly important concern in wireless networks, where radio waves carrying frames can propagate far beyond the building containing the wireless base station and hosts. In this section we present a brief introduction to wireless security. For a more in-depth treatment, see the highly readable book by Edney and Arbaugh <a class="biblioref" href="fileP70010119520000000000000000037E0.xhtml#P70010119520000000000000000038DF" data-foobar="7">[Edney 2003]</a>.</p>
<p id="P700101195200000000000000000B896" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B896">The issue of security in 802.11 has attracted considerable attention in both technical circles and in the media. While there has been considerable discussion, there has been little debate—there seems to be universal agreement that the original 802.11 specification contains a number of serious security flaws. Indeed, public domain software can now be downloaded that exploits these holes, making those who use the vanilla 802.11 security mechanisms as open to security attacks as users who use no security features at all.</p>
<p id="P700101195200000000000000000B897" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B897">In the following section, we discuss the security mechanisms initially standardized in the 802.11 specification, known collectively as <span class="keyword" id="P70010119520000000000000000030D8" data-uri="M08_KURO4140_07_SE_C08.xhtml#P70010119520000000000000000030D8"><b>Wired Equivalent Privacy (WEP)</b></span>. As the name suggests, WEP is meant to provide a level of security similar to that found in wired networks. We’ll then discuss a few of the security holes in WEP and discuss the 802.11i standard, a fundamentally more secure version of 802.11 adopted in 2004.</p>
<section id="P70010119520000000000000000030D9" data-uri="M08_KURO4140_07_SE_C08.xhtml#P70010119520000000000000000030D9" class="level2"><header><h1 class="title" id="P700101195200000000000000000B898" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B898" epub:type="title"><span class="number">8.8.1</span> Wired Equivalent Privacy (WEP)</h1></header>
<p id="P700101195200000000000000000B899" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B899">The IEEE 802.11 WEP protocol was designed in 1999 to provide authentication and data encryption between a host and a wireless access point (that is, base station) using a symmetric shared key approach. WEP does not specify a key management algorithm, so it is assumed that the host and wireless access point have somehow agreed on the key via an out-of-band method. Authentication is carried out as ­follows:</p>
<ol id="P700101195200000000000000000B89A" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B89A">
<li id="P700101195200000000000000000B89B" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B89B"><p id="P700101195200000000000000000B89C" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B89C">A wireless host requests authentication by an access point.</p></li>
<li id="P700101195200000000000000000B89D" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B89D"><p id="P700101195200000000000000000B89E" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B89E">The access point responds to the authentication request with a 128-byte nonce value.</p></li>
<li id="P700101195200000000000000000B89F" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B89F"><p id="P700101195200000000000000000B8A0" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8A0">The wireless host encrypts the nonce using the symmetric key that it shares with the access point.</p></li>
<li id="P700101195200000000000000000B8A1" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8A1"><p id="P700101195200000000000000000B8A2" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8A2">The access point decrypts the host-encrypted nonce.</p></li>
</ol>
<p class="continued" id="P700101195200000000000000000B8A3" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8A3">If the decrypted nonce matches the nonce value originally sent to the host, then the host is authenticated by the access point.</p>
<p id="P700101195200000000000000000B8A4" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8A4">The WEP data encryption algorithm is illustrated in <a class="xref" href="#P70010119520000000000000000030E8" data-foobar="1"><span class="label">Figure</span> <span class="number">8.30</span></a>. A secret 40-bit symmetric key, <i>K<sub>S</sub></i>, is assumed to be known by both a host and the access point. In addition, a 24-bit Initialization Vector (IV) is appended to the 40-bit key to create a 64-bit key that will be used to encrypt a single frame. The IV will<span class="pagebreak" title="647" id="P70010119520000000000000000030E7" data-uri="M08_KURO4140_07_SE_C08.xhtml#P70010119520000000000000000030E7" epub:type="pagebreak" role="doc-pagebreak"></span></p>
<figure id="P70010119520000000000000000030E8" class="figure" data-uri="M08_KURO4140_07_SE_C08.xhtml#P70010119520000000000000000030E8">
<img alt="Illustration of 802.11 WEP protocol." height="220" width="861" aria-describedby="P70010119520000000000000000030EC" id="P700101195200000000000000000B8A5" data-uri="P7001011952000000000000000005629" src="../images/4055108030.png"></img>
<figcaption id="P700101195200000000000000000B8A6" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8A6"><header><h1 class="title" id="P700101195200000000000000000B8A7" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8A7" epub:type="title"><span class="label">Figure </span> <span class="number">8.30</span> 802.11 WEP protocol</h1></header>

</figcaption>
</figure><div class="longdesc" id="P70010119520000000000000000030EC" data-uri="M08_KURO4140_07_SE_C08.xhtml#P70010119520000000000000000030EC" aria-hidden="false"><a class="xref" aria-hidden="false" href="../longalt/la_4055108030.xhtml#la_4055108030"><span class="label">Description</span></a></div>
<p class="continued" id="P700101195200000000000000000B8AB" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8AB">change from one frame to another, and hence each frame will be encrypted with a different 64-bit key. Encryption is performed as follows. First a 4-byte CRC value (see <a class="xref" href="fileP70010119520000000000000000023E8.xhtml#P70010119520000000000000000023E8" data-foobar="7"><span class="label">Section</span> <span class="number">6.2</span></a>) is computed for the data payload. The payload and the four CRC bytes are then encrypted using the RC4 stream cipher. We will not cover the details of RC4 here (see <a class="biblioref" href="fileP70010119520000000000000000037E0.xhtml#P7001011952000000000000000003BF3" data-foobar="7">[Schneier 1995]</a> and <a class="biblioref" href="fileP70010119520000000000000000037E0.xhtml#P70010119520000000000000000038DF" data-foobar="7">[Edney 2003]</a> for details). For our purposes, it is enough to know that when presented with a key value (in this case, the 64-bit (<i>K<sub>S</sub></i>, <i>IV</i>) key), the RC4 algorithm produces a stream of key values, <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="140" altimg-height="20" altimg="../images/ch08math140.png"><m:mrow><m:msubsup><m:mi>k</m:mi><m:mn>1</m:mn><m:mrow><m:mi>I</m:mi><m:mi>V</m:mi></m:mrow></m:msubsup><m:mo>,</m:mo><m:msubsup><m:mi>k</m:mi><m:mn>2</m:mn><m:mrow><m:mi>I</m:mi><m:mi>V</m:mi></m:mrow></m:msubsup><m:mo>,</m:mo><m:msubsup><m:mi>k</m:mi><m:mn>3</m:mn><m:mrow><m:mi>I</m:mi><m:mi>V</m:mi></m:mrow></m:msubsup><m:mo>,</m:mo><m:mo>…</m:mo></m:mrow></m:math></span> that are used to encrypt the data and CRC value in a frame. For practical purposes, we can think of these operations being performed a byte at a time. Encryption is performed by XOR-ing the <i>i</i>th byte of data, <i>d<sub>i</sub></i>, with the <i>i</i>th key, <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="28" altimg-height="20" altimg="../images/ch08math141.png"><m:mrow><m:msubsup><m:mi>k</m:mi><m:mi>i</m:mi><m:mrow><m:mi>I</m:mi><m:mi>V</m:mi></m:mrow></m:msubsup></m:mrow></m:math></span>, in the stream of key values generated by the (<i>K<sub>S</sub></i>, <i>IV</i>) pair to produce the <i>i</i>th byte of ciphertext, <i>c<sub>i</sub></i>:</p>
<div class="informalequation" id="P70010119520000000000000000030F1" data-uri="M08_KURO4140_07_SE_C08.xhtml#P70010119520000000000000000030F1"><m:math display="block" alttext="" data-uri="" altimg-width="103" altimg-height="21" altimg="../images/ch08math142.png"><m:mrow><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:mo>=</m:mo><m:msub><m:mi>d</m:mi><m:mi>i</m:mi></m:msub><m:mo>⊕</m:mo><m:msubsup><m:mi>k</m:mi><m:mi>i</m:mi><m:mrow><m:mi>I</m:mi><m:mi>V</m:mi></m:mrow></m:msubsup></m:mrow></m:math></div>
<p id="P700101195200000000000000000B8AC" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8AC">The IV value changes from one frame to the next and is included <i>in plaintext</i> in the header of each WEP-encrypted 802.11 frame, as shown in <a class="xref" href="#P70010119520000000000000000030E8" data-foobar="1"><span class="label">Figure</span> <span class="number">8.30</span></a>. The receiver takes the secret 40-bit symmetric key that it shares with the sender, appends the IV, and uses the resulting 64-bit key (which is identical to the key used by the sender to perform encryption) to decrypt the frame:</p>
<div class="informalequation" id="P70010119520000000000000000030F3" data-uri="M08_KURO4140_07_SE_C08.xhtml#P70010119520000000000000000030F3"><m:math display="block" alttext="" data-uri="" altimg-width="103" altimg-height="20" altimg="../images/ch08math143.png"><m:mrow><m:msub><m:mi>d</m:mi><m:mi>i</m:mi></m:msub><m:mo>=</m:mo><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:mo>⊕</m:mo><m:msubsup><m:mi>k</m:mi><m:mi>i</m:mi><m:mrow><m:mi>I</m:mi><m:mi>V</m:mi></m:mrow></m:msubsup></m:mrow></m:math></div>
<p id="P700101195200000000000000000B8AD" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8AD">Proper use of the RC4 algorithm requires that the same 64-bit key value <i>never</i> be used more than once. Recall that the WEP key changes on a frame-by-frame basis. For a given <i>K<sub>S</sub></i> (which changes rarely, if ever), this means that there are only 2<sup>24</sup> unique keys. If these keys are chosen randomly, we can show <a class="biblioref" href="fileP70010119520000000000000000037E0.xhtml#P70010119520000000000000000038DF" data-foobar="7">[Edney 2003]</a> that the probability of having chosen the same IV value (and hence used the same 64-bit key) is more than 99 percent after only 12,000 frames. With 1 Kbyte frame sizes and a data transmission rate of 11 Mbps, only a few seconds are <span class="pagebreak" title="648" id="P70010119520000000000000000030F5" data-uri="M08_KURO4140_07_SE_C08.xhtml#P70010119520000000000000000030F5" epub:type="pagebreak" role="doc-pagebreak"></span>needed before 12,000 frames are transmitted. Furthermore, since the IV is transmitted in plaintext in the frame, an eavesdropper will know whenever a duplicate IV value is used.</p>
<p id="P700101195200000000000000000B8AE" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8AE">To see one of the several problems that occur when a duplicate key is used, consider the following chosen-plaintext attack taken by Trudy against Alice. Suppose that Trudy (possibly using IP spoofing) sends a request (for example, an HTTP or FTP request) to Alice to transmit a file with known content, <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="138" altimg-height="17" altimg="../images/ch08math144.png"><m:mrow><m:msub><m:mi>d</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mtext> </m:mtext><m:msub><m:mi>d</m:mi><m:mn>2</m:mn></m:msub><m:mo>,</m:mo><m:mtext> </m:mtext><m:msub><m:mi>d</m:mi><m:mn>3</m:mn></m:msub><m:mo>,</m:mo><m:mtext> </m:mtext><m:msub><m:mi>d</m:mi><m:mn>4</m:mn></m:msub><m:mo>,</m:mo><m:mo>…</m:mo><m:mo>.</m:mo></m:mrow></m:math></span> Trudy also observes the encrypted data <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="125" altimg-height="13" altimg="../images/ch08math145.png"><m:mrow><m:msub><m:mi>c</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mtext> </m:mtext><m:msub><m:mi>c</m:mi><m:mn>2</m:mn></m:msub><m:mo>,</m:mo><m:mtext> </m:mtext><m:msub><m:mi>c</m:mi><m:mn>3</m:mn></m:msub><m:mo>,</m:mo><m:mtext> </m:mtext><m:msub><m:mi>c</m:mi><m:mn>4</m:mn></m:msub><m:mo>,</m:mo><m:mo>…</m:mo><m:mo>.</m:mo></m:mrow></m:math></span> Since <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="102" altimg-height="21" altimg="../images/ch08math146.png"><m:mrow><m:msub><m:mi>d</m:mi><m:mi>i</m:mi></m:msub><m:mo>=</m:mo><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:mo>⊕</m:mo><m:msubsup><m:mi>k</m:mi><m:mi>i</m:mi><m:mrow><m:mi>I</m:mi><m:mi>V</m:mi></m:mrow></m:msubsup></m:mrow></m:math></span>, if we XOR <i>c<sub>i</sub></i> with each side of this equality we have</p>
<div class="informalequation" id="P70010119520000000000000000030F7" data-uri="M08_KURO4140_07_SE_C08.xhtml#P70010119520000000000000000030F7"><m:math display="block" alttext="" data-uri="" altimg-width="103" altimg-height="21" altimg="../images/ch08math147.png"><m:mrow><m:msub><m:mi>d</m:mi><m:mi>i</m:mi></m:msub><m:mo>⊕</m:mo><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:mo>=</m:mo><m:msubsup><m:mi>k</m:mi><m:mi>i</m:mi><m:mrow><m:mi>I</m:mi><m:mi>V</m:mi></m:mrow></m:msubsup></m:mrow></m:math></div>
<p class="continued" id="P700101195200000000000000000B8AF" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8AF">With this relationship, Trudy can use the known values of <i>d<sub>i</sub></i> and <i>c<sub>i</sub></i> to compute <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="24" altimg-height="20" altimg="../images/ch08math148.png"><m:mrow><m:msubsup><m:mi>k</m:mi><m:mi>i</m:mi><m:mrow><m:mi>I</m:mi><m:mi>V</m:mi></m:mrow></m:msubsup></m:mrow></m:math></span>. The next time Trudy sees the same value of IV being used, she will know the key sequence <span class="inlineequation"><m:math display="inline" alttext="" data-uri="" altimg-width="120" altimg-height="20" altimg="../images/ch08math149.png"><m:mrow><m:msubsup><m:mi>k</m:mi><m:mn>1</m:mn><m:mrow><m:mi>I</m:mi><m:mi>V</m:mi></m:mrow></m:msubsup><m:mo>,</m:mo><m:msubsup><m:mi>k</m:mi><m:mn>2</m:mn><m:mrow><m:mi>I</m:mi><m:mi>V</m:mi></m:mrow></m:msubsup><m:mo>,</m:mo><m:msubsup><m:mi>k</m:mi><m:mn>3</m:mn><m:mrow><m:mi>I</m:mi><m:mi>V</m:mi></m:mrow></m:msubsup><m:mo>,</m:mo><m:mo>…</m:mo></m:mrow></m:math></span> and will thus be able to decrypt the encrypted message.</p>
<p id="P700101195200000000000000000B8B0" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8B0">There are several additional security concerns with WEP as well. <a class="biblioref" href="fileP70010119520000000000000000037E0.xhtml#P700101195200000000000000000390C" data-foobar="7">[Fluhrer 2001]</a> described an attack exploiting a known weakness in RC4 when certain weak keys are chosen. <a class="biblioref" href="fileP70010119520000000000000000037E0.xhtml#P7001011952000000000000000003C33" data-foobar="7">[Stubblefield 2002]</a> discusses efficient ways to implement and exploit this attack. Another concern with WEP involves the CRC bits shown in <a class="xref" href="#P70010119520000000000000000030E8" data-foobar="1"><span class="label">Figure</span> <span class="number">8.30</span></a> and transmitted in the 802.11 frame to detect altered bits in the payload. However, an attacker who changes the encrypted content (e.g., substituting gibberish for the original encrypted data), computes a CRC over the substituted gibberish, and places the CRC into a WEP frame can produce an 802.11 frame that will be accepted by the receiver. What is needed here are message integrity techniques such as those we studied in <a class="xref" href="fileP7001011952000000000000000002E7A.xhtml#P7001011952000000000000000002E7A" data-foobar="7"><span class="label">Section</span> <span class="number">8.3</span></a> to detect content tampering or substitution. For more details of WEP security, see <a class="biblioref" href="fileP70010119520000000000000000037E0.xhtml#P70010119520000000000000000038DF" data-foobar="7">[Edney 2003</a>; <a class="biblioref" href="fileP70010119520000000000000000037E0.xhtml#P7001011952000000000000000003C86" data-foobar="7">Wright 2015]</a> and the ­references therein.</p>
</section>
<section id="P70010119520000000000000000030FA" data-uri="M08_KURO4140_07_SE_C08.xhtml#P70010119520000000000000000030FA" class="level2"><header><h1 class="title" id="P700101195200000000000000000B8B1" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8B1" epub:type="title"><span class="number">8.8.2</span> IEEE 802.11i</h1></header>
<p id="P700101195200000000000000000B8B2" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8B2">Soon after the 1999 release of IEEE 802.11, work began on developing a new and improved version of 802.11 with stronger security mechanisms. The new standard, known as 802.11i, underwent final ratification in 2004. As we’ll see, while WEP provided relatively weak encryption, only a single way to perform authentication, and no key distribution mechanisms, IEEE 802.11i provides for much stronger forms of encryption, an extensible set of authentication mechanisms, and a key distribution mechanism. In the following, we present an overview of 802.11i; an excellent (streaming audio) technical overview of 802.11i is <a class="biblioref" href="fileP70010119520000000000000000037E0.xhtml#P7001011952000000000000000003C41" data-foobar="7">[TechOnline 2012]</a>.</p>
<p id="P700101195200000000000000000B8B3" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8B3"><a class="xref" href="#P70010119520000000000000000030FF" data-foobar="1"><span class="label">Figure</span> <span class="number">8.31</span></a> overviews the 802.11i framework. In addition to the wireless client and access point, 802.11i defines an authentication server with which the AP can communicate. Separating the authentication server from the AP allows one authentication server to serve many APs, centralizing the (often sensitive) decisions<span class="pagebreak" title="649" id="P70010119520000000000000000030FE" data-uri="M08_KURO4140_07_SE_C08.xhtml#P70010119520000000000000000030FE" epub:type="pagebreak" role="doc-pagebreak"></span></p>
<figure id="P70010119520000000000000000030FF" class="figure" data-uri="M08_KURO4140_07_SE_C08.xhtml#P70010119520000000000000000030FF">
<img alt="Illustration of 802.11i: four phases of operation." height="461" width="610" aria-describedby="P7001011952000000000000000003103" id="P700101195200000000000000000B8B4" data-uri="P700101195200000000000000000562A" src="../images/4055108031.png"></img>
<figcaption id="P700101195200000000000000000B8B5" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8B5"><header><h1 class="title" id="P700101195200000000000000000B8B6" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8B6" epub:type="title"><span class="label">Figure </span> <span class="number">8.31</span> 802.11i: Four phases of operation</h1></header>

</figcaption>
</figure><div class="longdesc" id="P7001011952000000000000000003103" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000003103" aria-hidden="false"><a class="xref" aria-hidden="false" href="../longalt/la_4055108031.xhtml#la_4055108031"><span class="label">Description</span></a></div>
<p class="continued" id="P700101195200000000000000000B8BC" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8BC">regarding authentication and access within the single server, and keeping AP costs and complexity low. 802.11i operates in four phases:</p>
<ol id="P700101195200000000000000000B8BD" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8BD">
<li id="P700101195200000000000000000B8BE" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8BE"><p id="P700101195200000000000000000B8BF" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8BF"><span class="leadin">Discovery.</span> In the discovery phase, the AP advertises its presence and the forms of authentication and encryption that can be provided to the wireless client node. The client then requests the specific forms of authentication and encryption that it desires. Although the client and AP are already exchanging messages, the client has not yet been authenticated nor does it have an encryption key, and so several more steps will be required before the client can communicate with an arbitrary remote host over the wireless channel.</p></li>
<li id="P700101195200000000000000000B8C0" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8C0"><p id="P700101195200000000000000000B8C1" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8C1"><span class="leadin">Mutual authentication and Master Key (MK) generation.</span> Authentication takes place between the wireless client and the authentication server. In this phase, the access point acts essentially as a relay, forwarding messages between the client and the authentication server. The <span class="keyword" id="P700101195200000000000000000310F" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000310F"><b>Extensible Authentication Protocol (EAP)</b></span> <a class="biblioref" href="fileP70010119520000000000000000037E0.xhtml#P7001011952000000000000000003B8B" data-foobar="7">[RFC 3748]</a> defines the end-to-end message formats used in a simple request/response mode of interaction between the client and authentication server. As shown in <a class="xref" href="#P7001011952000000000000000003113" data-foobar="1"><span class="label">Figure</span> <span class="number">8.32</span></a>, EAP messages are encapsulated using <span class="keyword" id="P7001011952000000000000000003110" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000003110"><b>EAPoL</b></span> (EAP over LAN, <a class="biblioref" href="fileP70010119520000000000000000037E0.xhtml#P7001011952000000000000000003985" data-foobar="7">[IEEE 802.1X]</a>) and sent over the 802.11 wireless link. These EAP messages are then decapsulated at the access point, and then re-encapsulated using the <span class="keyword" id="P7001011952000000000000000003111" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000003111"><b>RADIUS</b></span> protocol for transmission over UDP/IP to the authentication server. While<span class="pagebreak" title="650" id="P7001011952000000000000000003112" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000003112" epub:type="pagebreak" role="doc-pagebreak"></span></p>
<figure id="P7001011952000000000000000003113" class="figure" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000003113">
<img alt="EAP is an end-to-end protocol. EAP messages are encap- sulated using EAPoL over the wireless link between the client and the access point, and using RADIUS over UDP/IP between the access point and the authentication server." height="299" width="553" aria-describedby="P7001011952000000000000000003117" id="P700101195200000000000000000B8C2" data-uri="P700101195200000000000000000562B" src="../images/4055108032.png"></img>
<figcaption id="P700101195200000000000000000B8C3" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8C3"><header><h1 class="title" id="P700101195200000000000000000B8C4" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8C4" epub:type="title"><span class="label">Figure </span> <span class="number">8.32</span> EAP is an end-to-end protocol. EAP messages are encapsulated using EAPoL over the wireless link between the ­client and the access point, and using RADIUS over UDP/IP between the access point and the authentication server</h1></header>

</figcaption>
</figure><div class="longdesc" id="P7001011952000000000000000003117" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000003117" aria-hidden="false"><a class="xref" aria-hidden="false" href="../longalt/la_4055108032.xhtml#la_4055108032"><span class="label">Description</span></a></div>
<p class="continued" id="P700101195200000000000000000B8CD" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8CD">the RADIUS server and protocol <a class="biblioref" href="fileP70010119520000000000000000037E0.xhtml#P7001011952000000000000000003B4D" data-foobar="7">[RFC 2865]</a> are not required by the 802.11i protocol, they are <i>de facto</i> standard components for 802.11i. The recently standardized <span class="keyword" id="P7001011952000000000000000003121" data-uri="M08_KURO4140_07_SE_C08.xhtml#P7001011952000000000000000003121"><b>DIAMETER</b></span> protocol <a class="biblioref" href="fileP70010119520000000000000000037E0.xhtml#P7001011952000000000000000003B85" data-foobar="7">[RFC 3588]</a> is likely to replace RADIUS in the near future.</p>
<p id="P700101195200000000000000000B8CE" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8CE">With EAP, the authentication server can choose one of a number of ways to perform authentication. While 802.11i does not mandate a particular authentication method, the EAP-TLS authentication scheme <a class="biblioref" href="fileP70010119520000000000000000037E0.xhtml#P7001011952000000000000000003BAC" data-foobar="7">[RFC 5216]</a> is often used. EAP-TLS uses public key techniques (including nonce encryption and message digests) similar to those we studied in <a class="xref" href="fileP7001011952000000000000000002E7A.xhtml#P7001011952000000000000000002E7A" data-foobar="7"><span class="label">Section</span> <span class="number">8.3</span></a> to allow the client and the authentication server to mutually authenticate each other, and to derive a Master Key (MK) that is known to both parties.</p></li>
<li id="P700101195200000000000000000B8CF" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8CF"><p id="P700101195200000000000000000B8D0" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8D0"><span class="leadin">Pairwise Master Key (PMK) generation.</span> The MK is a shared secret known only to the client and the authentication server, which they each use to generate a second key, the Pairwise Master Key (PMK). The authentication server then sends the PMK to the AP. This is where we wanted to be! The client and AP now have a shared key (recall that in WEP, the problem of key distribution was not addressed at all) and have mutually authenticated each other. They’re just about ready to get down to business.</p></li>
<li id="P700101195200000000000000000B8D1" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8D1"><p id="P700101195200000000000000000B8D2" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8D2"><span class="leadin">Temporal Key (TK) generation.</span> With the PMK, the wireless client and AP can now generate additional keys that will be used for communication. Of ­particular interest is the Temporal Key (TK), which will be used to perform the link-level encryption of data sent over the wireless link and to an arbitrary remote host.</p></li>
</ol>
<p class="continued" id="P700101195200000000000000000B8D3" data-uri="M08_KURO4140_07_SE_C08.xhtml#P700101195200000000000000000B8D3">802.11i provides several forms of encryption, including an AES-based encryption scheme and a strengthened version of WEP encryption.</p>
</section>
</section></body></html>