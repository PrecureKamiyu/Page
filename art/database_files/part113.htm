<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Exercises</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part112.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part114.htm">下一个 &gt;</a></p><p class="s45" style="padding-top: 4pt;padding-left: 68pt;text-indent: 0pt;text-align: left;">Exercises</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s46" style="padding-top: 4pt;padding-left: 121pt;text-indent: 0pt;text-align: left;">4.14 <span class="p">Consider the query</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_879.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_880.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_881.png"/></span></p><p style="padding-left: 212pt;text-indent: 0pt;text-align: left;"><b>select </b><i>course id</i>, <i>semester</i>, <i>year</i>, <i>sec id</i>, <b>avg </b>(<i>tot cred</i>)</p><p class="s46" style="padding-left: 212pt;text-indent: 0pt;text-align: left;">from <i>takes </i>natural join <i>student</i></p><p class="s46" style="padding-left: 212pt;text-indent: 0pt;text-align: left;">where <i>year </i><span class="s15">= </span><span class="p">2017</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_882.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_883.png"/></span></p><p class="s13" style="padding-left: 212pt;text-indent: 0pt;line-height: 11pt;text-align: left;"><b>group by </b>course id<span class="p">, </span>semester<span class="p">, </span>year<span class="p">, </span>sec id</p><p style="padding-left: 212pt;text-indent: 0pt;line-height: 20pt;text-align: left;"><b>having count </b>(<span class="s69">ID</span>) <span class="s83">&gt;</span><span class="s15">= </span>2;</p><p style="padding-top: 8pt;padding-left: 150pt;text-indent: 0pt;text-align: justify;">Explain why appending <b>natural join </b><i>section </i>in the <b>from </b>clause would not change the result.</p><p class="s46" style="padding-top: 6pt;padding-left: 120pt;text-indent: 0pt;text-align: left;">4.15 <span class="p">Rewrite the query</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s46" style="padding-left: 246pt;text-indent: 0pt;text-align: left;">select <span class="p">*</span></p><p class="s46" style="padding-left: 246pt;text-indent: 0pt;text-align: left;">from <i>section </i>natural join <i>classroom</i></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 150pt;text-indent: 0pt;text-align: justify;">without using a natural join but instead using an inner join with a <b>using </b>condi- tion.</p><p style="padding-top: 6pt;padding-left: 150pt;text-indent: -29pt;text-align: justify;"><b>4.16  </b>Write an <span class="s44">SQL </span>query using the university schema to ﬁnd the <span class="s44">ID </span>of each student who has never taken a course at the university. Do this using no subqueries and no set operations (use an outer join).</p><p style="padding-top: 6pt;padding-left: 121pt;text-indent: 0pt;text-align: justify;"><b>4.17  </b>Express the following query in <span class="s44">SQL </span>using no subqueries and no set operations.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_884.png"/></span></p><p class="s46" style="padding-left: 274pt;text-indent: 0pt;text-align: left;">select <span class="s69">ID </span>from <i>student </i>except select <i>s id </i>from <i>advisor</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_885.png"/></span></p><p class="s46" style="padding-left: 274pt;text-indent: 0pt;text-align: left;">where <i>i </i><span class="s101">ID </span>is not null</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 150pt;text-indent: -29pt;text-align: justify;"><b>4.18  </b>For the database of Figure 4.12, write a query to ﬁnd the <span class="s44">ID </span>of each employee with no manager. Note that an employee may simply have no manager listed or may have a <i>null </i>manager. Write your query using an outer join and then write it again using no outer join at all.</p><p class="s46" style="padding-top: 6pt;padding-left: 120pt;text-indent: 0pt;text-align: justify;">4.19 <span class="p">Under what circumstances would the query</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s46" style="padding-top: 4pt;padding-left: 191pt;text-indent: 0pt;text-align: left;"><a name="bookmark67">select </a><span class="p">*</span><a name="bookmark108">&zwnj;</a></p><p class="s46" style="padding-left: 191pt;text-indent: 0pt;text-align: left;">from <i>student </i>natural full outer join <i>takes</i></p><p class="s46" style="padding-left: 266pt;text-indent: 0pt;text-align: left;">natural full outer join <i>course</i></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 119pt;text-indent: 0pt;text-align: left;">include tuples with null values for the <i>title </i>attribute?</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_886.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_887.png"/></span></p><p style="padding-top: 6pt;padding-left: 119pt;text-indent: -31pt;text-align: left;"><b>4.20 </b>Show how to deﬁne a view <i>tot credits </i>(<i>year, num credits</i>), giving the total number of credits taken in each year.</p><p class="s46" style="padding-top: 6pt;padding-left: 119pt;text-indent: -30pt;text-align: left;">4.21  <span class="p">For the view of Exercise 4.18, explain why the database system would not allow a tuple to be inserted into the database through this view.</span></p><p class="s46" style="padding-top: 6pt;padding-left: 88pt;text-indent: 0pt;text-align: left;">4.22  <span class="p">Show how to express the </span>coalesce <span class="p">function using the </span>case <span class="p">construct.</span></p><p class="s46" style="padding-top: 6pt;padding-left: 119pt;text-indent: -31pt;text-align: justify;">4.23  <span class="p">Explain why, when a manager, say Satoshi, grants an authorization, the grant should be done by the manager role, rather than by the user Satoshi.</span></p><p style="padding-top: 6pt;padding-left: 119pt;text-indent: -31pt;text-align: justify;"><b>4.24 </b>Suppose user <i>A</i>, who has all authorization privileges on a relation <i>r</i>, grants <b>select </b>on relation <i>r </i>to <b>public </b>with grant option. Suppose user <i>B </i>then grants <b>select </b>on <i>r </i>to <i>A</i>. Does this cause a cycle in the authorization graph? Explain why.</p><p style="padding-top: 6pt;padding-left: 119pt;text-indent: -31pt;text-align: justify;"><b>4.25  </b>Suppose a user creates a new relation <i>r</i>1 with a foreign key referencing another relation <i>r</i>2. What authorization privilege does the user need on <i>r</i>2? Why should this not simply be allowed without any such authorization?</p><p class="s46" style="padding-top: 6pt;padding-left: 119pt;text-indent: -31pt;text-align: justify;">4.26 <span class="p">Explain the diﬀerence between integrity constraints and authorization con- straints.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part112.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part114.htm">下一个 &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
