<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Exercises</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part125.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part127.htm">下一个 &gt;</a></p><p class="s45" style="padding-top: 4pt;padding-left: 68pt;text-indent: 0pt;text-align: left;">Exercises</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s46" style="padding-top: 4pt;padding-left: 150pt;text-indent: -30pt;text-align: justify;">5.12  <span class="p">Write a Java program that allows university administrators to print the teaching record of an instructor.</span></p><p style="padding-top: 10pt;padding-left: 176pt;text-indent: -18pt;text-align: justify;">a.  Start by having the user input the login <span class="s69">ID </span>and password; then open the proper connection.</p><p style="padding-top: 6pt;padding-left: 176pt;text-indent: -19pt;text-align: justify;">b.  The user is asked next for a search substring and the system returns (<span class="s44">ID</span>, <i>name</i>) pairs of instructors whose names match the substring. Use the <b>like </b>(&#39;%substring%&#39;) construct in SQL to do this. If the search comes back empty, allow continued searches until there is a nonempty result.</p><p style="padding-top: 6pt;padding-left: 176pt;text-indent: -18pt;text-align: justify;">c.  Then the user is asked to enter an <span class="s44">ID </span>number, which is a number between 0 and 99999. Once a valid number is entered, check if an instructor with that <span class="s44">ID </span>exists. If there is no instructor with the given <span class="s44">ID</span>, print a reasonable message and quit.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1330.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1331.png"/></span></p><p style="padding-top: 6pt;padding-left: 176pt;text-indent: -19pt;text-align: justify;">d. If the instructor has taught no courses, print a message saying that. Other- wise print the teaching record for the instructor, showing the department name, course identiﬁer, course title, section number, semester, year, and total enrollment (and sort those by <i>dept name, course id, year, semester</i>).</p><p style="padding-top: 10pt;padding-left: 150pt;text-indent: 0pt;text-align: justify;">Test carefully for bad input. Make sure your SQL queries won’t throw an excep- tion. At login, exceptions may occur since the user might type a bad password, but catch those exceptions and allow the user to try again.</p><p style="padding-top: 6pt;padding-left: 150pt;text-indent: -30pt;text-align: justify;"><b>5.13  </b>Suppose you were asked to deﬁne a class <span class="s49">MetaDisplay </span>in Java, containing a method <span class="s49">static void printTable(String r)</span>; the method takes a relation name <i>r </i>as input, executes the query “<b>select </b>* <b>from </b><i>r</i>”, and prints the result out in tabular format, with the attribute names displayed in the header of the table.</p><p style="padding-top: 10pt;padding-left: 176pt;text-indent: -18pt;text-align: left;">a.  What do you need to know about relation <i>r </i>to be able to print the result in the speciﬁed tabular format?</p><p style="padding-top: 6pt;padding-left: 157pt;text-indent: 0pt;text-align: left;">b. What <span class="s44">JDBC </span>methods(s) can get you the required information?</p><p style="padding-top: 6pt;padding-left: 157pt;text-indent: 0pt;text-align: left;">c.  Write the method <span class="s49">printTable(String r) </span>using the <span class="s44">JDBC API</span>.</p><p style="padding-top: 10pt;padding-left: 150pt;text-indent: -29pt;text-align: justify;"><b>5.14  </b>Repeat Exercise 5.13 using <span class="s44">ODBC</span>, deﬁning <span class="s49">void printTable(char *r) </span>as a func- tion instead of a method.</p><p class="s46" style="padding-top: 6pt;padding-left: 120pt;text-indent: 0pt;text-align: left;">5.15 <span class="p">Consider an employee database with two relations</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1332.png"/></span></p><p class="s13" style="padding-top: 9pt;padding-bottom: 1pt;padding-left: 219pt;text-indent: 0pt;text-align: left;">employee <span class="p">(</span>employee name<span class="p">, </span>street<span class="p">, </span>city<span class="p">)</span></p><p style="padding-left: 264pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="86" height="1" alt="image" src="Image_1333.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1334.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1335.png"/></span></p><p class="s13" style="padding-left: 219pt;text-indent: 0pt;text-align: left;">works <span class="p">(</span>employee name<span class="p">, </span>company name<span class="p">, </span>salary<span class="p">)</span></p><p style="padding-left: 250pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="86" height="1" alt="image" src="Image_1336.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1337.png"/></span></p><p style="padding-top: 4pt;padding-left: 119pt;text-indent: 0pt;text-align: justify;">where the primary keys are underlined. Write a function <i>avg salary </i>that takes a company name as an argument and ﬁnds the average salary of employees at that company. Then, write an <span class="s44">SQL </span>statement, using that function, to ﬁnd companies whose employees earn a higher salary, on average, than the average salary at “First Bank”.</p><p class="s46" style="padding-top: 6pt;padding-left: 89pt;text-indent: 0pt;text-align: justify;">5.16 <span class="p">Consider the relational schema</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1338.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="38" height="1" alt="image" src="Image_1339.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1340.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1341.png"/></span></p><p class="s13" style="padding-top: 7pt;padding-left: 219pt;text-indent: 0pt;line-height: 114%;text-align: left;">part<span class="p">(</span>part id<span class="p">, </span>name<span class="p">, </span>cost<span class="p">) </span>subpart<span class="p">(</span>part id<span class="p">, </span>subpart id<span class="p">, </span>count<span class="p">)</span></p><p class="s188" style="padding-left: 255pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="37" height="1" alt="image" src="Image_1342.png"/></span> <span><img width="56" height="1" alt="image" src="Image_1343.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1344.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1345.png"/></span></p><p class="s13" style="padding-left: 119pt;text-indent: 0pt;text-align: justify;"><span class="p">where the primary-key attributes are underlined. A tuple (</span>p<span class="s98">1</span><span class="p">, </span>p<span class="s98">2</span><span class="p">, 3) in the </span>subpart <span class="p">relation denotes that the part with </span>part id p<span class="s98">2</span><span class="p"> is a direct subpart of the part with </span>part id p<span class="s93">1</span><span class="s94">, and </span>p<span class="s93">1 </span><span class="s94">has 3 copies of </span>p<span class="s93">2</span><span class="s94">. Note that </span>p<span class="s93">2 </span><span class="s94">may itself have further subparts. Write a recursive </span><span class="s189">SQL </span><span class="s94">query that outputs the names of all subparts of the part with part-id &#39;P-100&#39;.</span></p><p style="padding-top: 6pt;padding-left: 119pt;text-indent: -29pt;text-align: justify;"><b>5.17 </b>Consider the relational schema from Exercise 5.16. Write a <span class="s44">JDBC </span>function using nonrecursive <span class="s44">SQL </span>to ﬁnd the total cost of part “P-100”, including the costs of all its subparts. Be sure to take into account the fact that a part may have multiple occurrences of a subpart. You may use recursion in Java if you wish.</p><p style="padding-top: 6pt;padding-left: 119pt;text-indent: -29pt;text-align: justify;"><b>5.18 </b>Redo Exercise 5.12 using the language of your database system for coding stored procedures and functions. Note that you are likely to have to consult the online documentation for your system as a reference, since most systems use syntax diﬀering from the <span class="s44">SQL </span>standard version followed in the text. Speciﬁcally, write a prodedure that takes an instructor <span class="s69">ID </span>as an argument and produces printed output in the format speciﬁed in Exercise 5.12, or an appropriate message if the instructor does not exist or has taught no courses. (For a simpler version of this exercise, rather than providing printed output, assume a relation with the appropriate schema and insert your answer there without worrying about testing for erroneous argument values.)</p><p style="padding-top: 6pt;padding-left: 119pt;text-indent: -30pt;text-align: justify;"><b>5.19 </b>Suppose there are two relations <i>r </i>and <i>s</i>, such that the foreign key <i>B </i>of <i>r </i>references the primary key <i>A </i>of <i>s</i>. Describe how the trigger mechanism can be used to implement the <b>on delete cascade </b>option when a tuple is deleted from <i>s</i>.</p><p class="s46" style="padding-top: 6pt;padding-left: 119pt;text-indent: -31pt;text-align: justify;">5.20  <span class="p">The execution of a trigger can cause another action to be triggered. Most database systems place a limit on how deep the nesting can be. Explain why they might place such a limit.</span></p><p class="s46" style="padding-top: 6pt;padding-left: 88pt;text-indent: 0pt;text-align: justify;">5.21  <span class="p">Modify the recursive query in Figure 5.16 to deﬁne a relation</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1346.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1347.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1348.png"/></span></p><p class="s13" style="padding-top: 7pt;padding-left: 207pt;text-indent: 0pt;text-align: left;">prereq depth<span class="p">(</span>course id<span class="p">, </span>prereq id<span class="p">, </span>depth<span class="p">)</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1349.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1350.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1351.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1352.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1353.png"/></span></p><p class="s66" style="padding-top: 3pt;padding-left: 119pt;text-indent: 0pt;text-align: right;">Tools  <span class="s164">237</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:167.644pt" cellspacing="0"><tr style="height:14pt"><td style="width:51pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F" bgcolor="#C6E9FA"><p class="s71" style="padding-left: 7pt;text-indent: 0pt;line-height: 11pt;text-align: left;">building</p></td><td style="width:71pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F" bgcolor="#C6E9FA"><p class="s71" style="padding-left: 7pt;text-indent: 0pt;line-height: 11pt;text-align: left;">room number</p></td><td style="width:62pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F" bgcolor="#C6E9FA"><p class="s71" style="padding-left: 7pt;text-indent: 0pt;line-height: 11pt;text-align: left;">time slot id</p></td><td style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F" bgcolor="#C6E9FA"><p class="s71" style="padding-left: 4pt;padding-right: 4pt;text-indent: 0pt;line-height: 11pt;text-align: center;">course id</p></td><td style="width:38pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F" bgcolor="#C6E9FA"><p class="s71" style="padding-left: 7pt;text-indent: 0pt;line-height: 11pt;text-align: left;">sec id</p></td></tr><tr style="height:13pt"><td style="width:51pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">Garﬁeld</p></td><td style="width:71pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">359</p></td><td style="width:62pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">A</p></td><td style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 3pt;padding-right: 4pt;text-indent: 0pt;line-height: 12pt;text-align: center;">BIO-101</p></td><td style="width:38pt;border-top-style:solid;border-top-width:1pt;border-top-color:#221E1F;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">1</p></td></tr><tr style="height:13pt"><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">Garﬁeld</p></td><td style="width:71pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">359</p></td><td style="width:62pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">B</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 3pt;padding-right: 4pt;text-indent: 0pt;line-height: 12pt;text-align: center;">BIO-101</p></td><td style="width:38pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">2</p></td></tr><tr style="height:13pt"><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">Saucon</p></td><td style="width:71pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">651</p></td><td style="width:62pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">A</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 4pt;padding-right: 11pt;text-indent: 0pt;line-height: 12pt;text-align: center;">CS-101</p></td><td style="width:38pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">2</p></td></tr><tr style="height:13pt"><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">Saucon</p></td><td style="width:71pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">550</p></td><td style="width:62pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">C</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 4pt;padding-right: 11pt;text-indent: 0pt;line-height: 12pt;text-align: center;">CS-319</p></td><td style="width:38pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">1</p></td></tr><tr style="height:13pt"><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">Painter</p></td><td style="width:71pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">705</p></td><td style="width:62pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">D</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 3pt;padding-right: 4pt;text-indent: 0pt;line-height: 12pt;text-align: center;">MU-199</p></td><td style="width:38pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">1</p></td></tr><tr style="height:14pt"><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">Painter</p></td><td style="width:71pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">403</p></td><td style="width:62pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">D</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 3pt;padding-right: 4pt;text-indent: 0pt;line-height: 12pt;text-align: center;">FIN-201</p></td><td style="width:38pt;border-left-style:solid;border-left-width:1pt;border-left-color:#221E1F;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#221E1F;border-right-style:solid;border-right-width:1pt;border-right-color:#221E1F"><p class="s72" style="padding-left: 7pt;text-indent: 0pt;line-height: 12pt;text-align: left;">1</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s74" style="padding-top: 4pt;padding-left: 207pt;text-indent: 0pt;text-align: left;"><span class="s73">Figure 5.22 </span>The relation <span class="s190">r </span>for Exercise 5.24.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 150pt;text-indent: 0pt;text-align: justify;">where the attribute <i>depth </i>indicates how many levels of intermediate prerequi- sites there are between the course and the prerequisite. Direct prerequisites have a depth of 0. Note that a prerequisite course may have multiple depths and thus may appear more than once.</p><p style="padding-top: 6pt;padding-left: 150pt;text-indent: -31pt;text-align: justify;"><b>5.22  </b>Given relation <i>s</i>(<i>a</i>, <i>b</i>, <i>c</i>), write an <span class="s44">SQL </span>statement to generate a histogram show- ing the sum of <i>c </i>values versus <i>a</i>, dividing <i>a </i>into 20 equal-sized partitions (i.e., where each partition contains 5 percent of the tuples in <i>s</i>, sorted by <i>a</i>).</p><p style="padding-top: 6pt;padding-left: 150pt;text-indent: -31pt;text-align: justify;"><b>5.23  </b>Consider the <i>nyse </i>relation of Exercise 5.9. For each month of each year, show the total monthly dollar volume and the average monthly dollar volume for that month and the two prior months. (<i>Hint</i>: First write a query to ﬁnd the total dollar volume for each month of each year. Once that is right, put that in the from clause of the outer query that solves the full problem. That outer query will need windowing. The subquery does not.)</p><p style="padding-top: 6pt;padding-left: 150pt;text-indent: -31pt;text-align: justify;"><b>5.24 </b>Consider the relation, <i>r</i>, shown in Figure 5.22. Give the result of the following query:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1354.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1355.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1356.png"/></span></p><p style="padding-left: 210pt;text-indent: 0pt;text-align: left;"><b>select </b><i>building</i>, <i>room number</i>, <i>time slot id</i>, <b>count</b>(*) <b>from </b>r</p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1357.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1358.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="4" height="1" alt="image" src="Image_1359.png"/></span></p><p style="padding-left: 210pt;text-indent: 0pt;text-align: left;"><b>group by rollup </b>(<i>building</i>, <i>room number</i>, <i>time slot id</i>)</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part125.htm">&lt; 上一个</a><span> | </span><a href="../database.html">内容</a><span> | </span><a href="part127.htm">下一个 &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
