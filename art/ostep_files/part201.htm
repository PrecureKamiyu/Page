<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Questions</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part200.htm">&lt; 上一个</a><span> | </span><a href="../ostep.html">内容</a><span> | </span><a href="part202.htm">下一个 &gt;</a></p><p class="s32" style="padding-left: 68pt;text-indent: 0pt;text-align: left;">Questions</p><p style="padding-top: 8pt;padding-left: 91pt;text-indent: -9pt;line-height: 89%;text-align: justify;"><span class="s4">• </span>For timing, you’ll need to use a timer such as that made available by <span class="s41">gettimeofday()</span>. How precise is such a timer? How long does an operation have to take in order for you to time it precisely? (this will help determine how many times, in a loop, you’ll have to repeat a page access in order to time it successfully)</p><p style="padding-left: 91pt;text-indent: -9pt;line-height: 88%;text-align: justify;"><span class="s4">• </span>Write the program, called <span class="s41">tlb.c</span>, that can roughly measure the cost of accessing each page. Inputs to the program should be: the num- ber of pages to touch and the number of trials.</p><p class="s4" style="padding-left: 91pt;text-indent: -9pt;line-height: 89%;text-align: justify;">• <span class="p">Now write a script in your favorite scripting language (csh, python, etc.) to run this program, while varying the number of pages ac- cessed from 1 up to a few thousand, perhaps incrementing by a factor of two per iteration. Run the script on different machines and gather some data. How many trials are needed to get reliable measurements?</span></p><p style="padding-left: 91pt;text-indent: -9pt;line-height: 88%;text-align: justify;"><span class="s4">• </span>Next, graph the results, making a graph that looks similar to the one above. Use a good tool like <span class="s41">ploticus</span>. Visualization usually makes the data much easier to digest; why do you think that is?</p><p class="s4" style="padding-left: 91pt;text-indent: -9pt;line-height: 89%;text-align: justify;">• <span class="p">One thing to watch out for is compiler optimzation. Compilers do all sorts of clever things, including removing loops which incre- ment values that no other part of the program subsequently uses. How can you ensure the compiler does not remove the main loop above from your TLB size estimator?</span></p><p class="s4" style="padding-left: 91pt;text-indent: -9pt;line-height: 89%;text-align: justify;">• <span class="p">Another thing to watch out for is the fact that most systems today ship with multiple CPUs, and each CPU, of course, has its own TLB hierarchy. To really get good measurements, you have to run your</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 64pt;text-indent: 0pt;line-height: 89%;text-align: justify;">code on just one CPU, instead of letting the scheduler bounce it from one CPU to the next. How can you do that? (hint: look up “pinning a thread” on Google for some clues) What will happen if you don’t do this, and the code moves from one CPU to the other?</p><p style="padding-left: 64pt;text-indent: -9pt;line-height: 89%;text-align: justify;"><span class="s4">• </span>Another issue that might arise relates to initialization. If you don’t initialize the array <span class="s41">a </span>above before accessing it, the first time you access it will be very expensive, due to initial access costs such as demand zeroing. Will this affect your code and its timing? What can you do to counterbalance these potential costs?</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="430" height="57" alt="image" src="Image_262.png"/></span></p><p class="s50" style="padding-top: 7pt;text-indent: 0pt;text-align: right;">20</p><p style="text-indent: 0pt;text-align: left;"/><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part200.htm">&lt; 上一个</a><span> | </span><a href="../ostep.html">内容</a><span> | </span><a href="part202.htm">下一个 &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
